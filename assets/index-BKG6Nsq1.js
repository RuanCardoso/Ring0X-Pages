function NC(i,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in i)){const o=Object.getOwnPropertyDescriptor(n,r);o&&Object.defineProperty(i,r,o.get?o:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function JE(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var vh={exports:{}},Ho={};var By;function OC(){if(By)return Ho;By=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,o){var l=null;if(o!==void 0&&(l=""+o),r.key!==void 0&&(l=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:i,type:n,key:l,ref:r!==void 0?r:null,props:o}}return Ho.Fragment=e,Ho.jsx=t,Ho.jsxs=t,Ho}var jy;function MC(){return jy||(jy=1,vh.exports=OC()),vh.exports}var y=MC(),yh={exports:{}},Me={};var $y;function kC(){if($y)return Me;$y=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),p=Symbol.iterator;function E(M){return M===null||typeof M!="object"?null:(M=p&&M[p]||M["@@iterator"],typeof M=="function"?M:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,T={};function A(M,G,te){this.props=M,this.context=G,this.refs=T,this.updater=te||S}A.prototype.isReactComponent={},A.prototype.setState=function(M,G){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,G,"setState")},A.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function _(){}_.prototype=A.prototype;function w(M,G,te){this.props=M,this.context=G,this.refs=T,this.updater=te||S}var D=w.prototype=new _;D.constructor=w,b(D,A.prototype),D.isPureReactComponent=!0;var O=Array.isArray;function B(){}var N={H:null,A:null,T:null,S:null},U=Object.prototype.hasOwnProperty;function k(M,G,te){var V=te.ref;return{$$typeof:i,type:M,key:G,ref:V!==void 0?V:null,props:te}}function F(M,G){return k(M.type,G,M.props)}function H(M){return typeof M=="object"&&M!==null&&M.$$typeof===i}function ne(M){var G={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(te){return G[te]})}var J=/\/+/g;function le(M,G){return typeof M=="object"&&M!==null&&M.key!=null?ne(""+M.key):G.toString(36)}function de(M){switch(M.status){case"fulfilled":return M.value;case"rejected":throw M.reason;default:switch(typeof M.status=="string"?M.then(B,B):(M.status="pending",M.then(function(G){M.status==="pending"&&(M.status="fulfilled",M.value=G)},function(G){M.status==="pending"&&(M.status="rejected",M.reason=G)})),M.status){case"fulfilled":return M.value;case"rejected":throw M.reason}}throw M}function P(M,G,te,V,se){var ce=typeof M;(ce==="undefined"||ce==="boolean")&&(M=null);var fe=!1;if(M===null)fe=!0;else switch(ce){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(M.$$typeof){case i:case e:fe=!0;break;case m:return fe=M._init,P(fe(M._payload),G,te,V,se)}}if(fe)return se=se(M),fe=V===""?"."+le(M,0):V,O(se)?(te="",fe!=null&&(te=fe.replace(J,"$&/")+"/"),P(se,G,te,"",function(Qe){return Qe})):se!=null&&(H(se)&&(se=F(se,te+(se.key==null||M&&M.key===se.key?"":(""+se.key).replace(J,"$&/")+"/")+fe)),G.push(se)),1;fe=0;var ve=V===""?".":V+":";if(O(M))for(var Ae=0;Ae<M.length;Ae++)V=M[Ae],ce=ve+le(V,Ae),fe+=P(V,G,te,ce,se);else if(Ae=E(M),typeof Ae=="function")for(M=Ae.call(M),Ae=0;!(V=M.next()).done;)V=V.value,ce=ve+le(V,Ae++),fe+=P(V,G,te,ce,se);else if(ce==="object"){if(typeof M.then=="function")return P(de(M),G,te,V,se);throw G=String(M),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return fe}function K(M,G,te){if(M==null)return M;var V=[],se=0;return P(M,V,"","",function(ce){return G.call(te,ce,se++)}),V}function j(M){if(M._status===-1){var G=M._result;G=G(),G.then(function(te){(M._status===0||M._status===-1)&&(M._status=1,M._result=te)},function(te){(M._status===0||M._status===-1)&&(M._status=2,M._result=te)}),M._status===-1&&(M._status=0,M._result=G)}if(M._status===1)return M._result.default;throw M._result}var W=typeof reportError=="function"?reportError:function(M){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof M=="object"&&M!==null&&typeof M.message=="string"?String(M.message):String(M),error:M});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",M);return}console.error(M)},he={map:K,forEach:function(M,G,te){K(M,function(){G.apply(this,arguments)},te)},count:function(M){var G=0;return K(M,function(){G++}),G},toArray:function(M){return K(M,function(G){return G})||[]},only:function(M){if(!H(M))throw Error("React.Children.only expected to receive a single React element child.");return M}};return Me.Activity=g,Me.Children=he,Me.Component=A,Me.Fragment=t,Me.Profiler=r,Me.PureComponent=w,Me.StrictMode=n,Me.Suspense=f,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Me.__COMPILER_RUNTIME={__proto__:null,c:function(M){return N.H.useMemoCache(M)}},Me.cache=function(M){return function(){return M.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(M,G,te){if(M==null)throw Error("The argument must be a React element, but you passed "+M+".");var V=b({},M.props),se=M.key;if(G!=null)for(ce in G.key!==void 0&&(se=""+G.key),G)!U.call(G,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&G.ref===void 0||(V[ce]=G[ce]);var ce=arguments.length-2;if(ce===1)V.children=te;else if(1<ce){for(var fe=Array(ce),ve=0;ve<ce;ve++)fe[ve]=arguments[ve+2];V.children=fe}return k(M.type,se,V)},Me.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null},M.Provider=M,M.Consumer={$$typeof:o,_context:M},M},Me.createElement=function(M,G,te){var V,se={},ce=null;if(G!=null)for(V in G.key!==void 0&&(ce=""+G.key),G)U.call(G,V)&&V!=="key"&&V!=="__self"&&V!=="__source"&&(se[V]=G[V]);var fe=arguments.length-2;if(fe===1)se.children=te;else if(1<fe){for(var ve=Array(fe),Ae=0;Ae<fe;Ae++)ve[Ae]=arguments[Ae+2];se.children=ve}if(M&&M.defaultProps)for(V in fe=M.defaultProps,fe)se[V]===void 0&&(se[V]=fe[V]);return k(M,ce,se)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(M){return{$$typeof:u,render:M}},Me.isValidElement=H,Me.lazy=function(M){return{$$typeof:m,_payload:{_status:-1,_result:M},_init:j}},Me.memo=function(M,G){return{$$typeof:d,type:M,compare:G===void 0?null:G}},Me.startTransition=function(M){var G=N.T,te={};N.T=te;try{var V=M(),se=N.S;se!==null&&se(te,V),typeof V=="object"&&V!==null&&typeof V.then=="function"&&V.then(B,W)}catch(ce){W(ce)}finally{G!==null&&te.types!==null&&(G.types=te.types),N.T=G}},Me.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Me.use=function(M){return N.H.use(M)},Me.useActionState=function(M,G,te){return N.H.useActionState(M,G,te)},Me.useCallback=function(M,G){return N.H.useCallback(M,G)},Me.useContext=function(M){return N.H.useContext(M)},Me.useDebugValue=function(){},Me.useDeferredValue=function(M,G){return N.H.useDeferredValue(M,G)},Me.useEffect=function(M,G){return N.H.useEffect(M,G)},Me.useEffectEvent=function(M){return N.H.useEffectEvent(M)},Me.useId=function(){return N.H.useId()},Me.useImperativeHandle=function(M,G,te){return N.H.useImperativeHandle(M,G,te)},Me.useInsertionEffect=function(M,G){return N.H.useInsertionEffect(M,G)},Me.useLayoutEffect=function(M,G){return N.H.useLayoutEffect(M,G)},Me.useMemo=function(M,G){return N.H.useMemo(M,G)},Me.useOptimistic=function(M,G){return N.H.useOptimistic(M,G)},Me.useReducer=function(M,G,te){return N.H.useReducer(M,G,te)},Me.useRef=function(M){return N.H.useRef(M)},Me.useState=function(M){return N.H.useState(M)},Me.useSyncExternalStore=function(M,G,te){return N.H.useSyncExternalStore(M,G,te)},Me.useTransition=function(){return N.H.useTransition()},Me.version="19.2.3",Me}var Gy;function Bm(){return Gy||(Gy=1,yh.exports=kC()),yh.exports}var R=Bm();const Gi=JE(R),jm=NC({__proto__:null,default:Gi},[R]);var xh={exports:{}},Vo={},Eh={exports:{}},Sh={};var zy;function PC(){return zy||(zy=1,(function(i){function e(P,K){var j=P.length;P.push(K);e:for(;0<j;){var W=j-1>>>1,he=P[W];if(0<r(he,K))P[W]=K,P[j]=he,j=W;else break e}}function t(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var K=P[0],j=P.pop();if(j!==K){P[0]=j;e:for(var W=0,he=P.length,M=he>>>1;W<M;){var G=2*(W+1)-1,te=P[G],V=G+1,se=P[V];if(0>r(te,j))V<he&&0>r(se,te)?(P[W]=se,P[V]=j,W=V):(P[W]=te,P[G]=j,W=G);else if(V<he&&0>r(se,j))P[W]=se,P[V]=j,W=V;else break e}}return K}function r(P,K){var j=P.sortIndex-K.sortIndex;return j!==0?j:P.id-K.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;i.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();i.unstable_now=function(){return l.now()-u}}var f=[],d=[],m=1,g=null,p=3,E=!1,S=!1,b=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;function D(P){for(var K=t(d);K!==null;){if(K.callback===null)n(d);else if(K.startTime<=P)n(d),K.sortIndex=K.expirationTime,e(f,K);else break;K=t(d)}}function O(P){if(b=!1,D(P),!S)if(t(f)!==null)S=!0,B||(B=!0,ne());else{var K=t(d);K!==null&&de(O,K.startTime-P)}}var B=!1,N=-1,U=5,k=-1;function F(){return T?!0:!(i.unstable_now()-k<U)}function H(){if(T=!1,B){var P=i.unstable_now();k=P;var K=!0;try{e:{S=!1,b&&(b=!1,_(N),N=-1),E=!0;var j=p;try{t:{for(D(P),g=t(f);g!==null&&!(g.expirationTime>P&&F());){var W=g.callback;if(typeof W=="function"){g.callback=null,p=g.priorityLevel;var he=W(g.expirationTime<=P);if(P=i.unstable_now(),typeof he=="function"){g.callback=he,D(P),K=!0;break t}g===t(f)&&n(f),D(P)}else n(f);g=t(f)}if(g!==null)K=!0;else{var M=t(d);M!==null&&de(O,M.startTime-P),K=!1}}break e}finally{g=null,p=j,E=!1}K=void 0}}finally{K?ne():B=!1}}}var ne;if(typeof w=="function")ne=function(){w(H)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,le=J.port2;J.port1.onmessage=H,ne=function(){le.postMessage(null)}}else ne=function(){A(H,0)};function de(P,K){N=A(function(){P(i.unstable_now())},K)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(P){P.callback=null},i.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<P?Math.floor(1e3/P):5},i.unstable_getCurrentPriorityLevel=function(){return p},i.unstable_next=function(P){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var j=p;p=K;try{return P()}finally{p=j}},i.unstable_requestPaint=function(){T=!0},i.unstable_runWithPriority=function(P,K){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var j=p;p=P;try{return K()}finally{p=j}},i.unstable_scheduleCallback=function(P,K,j){var W=i.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?W+j:W):j=W,P){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=j+he,P={id:m++,callback:K,priorityLevel:P,startTime:j,expirationTime:he,sortIndex:-1},j>W?(P.sortIndex=j,e(d,P),t(f)===null&&P===t(d)&&(b?(_(N),N=-1):b=!0,de(O,j-W))):(P.sortIndex=he,e(f,P),S||E||(S=!0,B||(B=!0,ne()))),P},i.unstable_shouldYield=F,i.unstable_wrapCallback=function(P){var K=p;return function(){var j=p;p=K;try{return P.apply(this,arguments)}finally{p=j}}}})(Sh)),Sh}var Hy;function UC(){return Hy||(Hy=1,Eh.exports=PC()),Eh.exports}var bh={exports:{}},un={};var Vy;function FC(){if(Vy)return un;Vy=1;var i=Bm();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(f,d,m){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:g==null?null:""+g,children:f,containerInfo:d,implementation:m}}var l=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return un.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,un.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(f,d,null,m)},un.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},un.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},un.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},un.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,g=u(m,d.crossOrigin),p=typeof d.integrity=="string"?d.integrity:void 0,E=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:p,fetchPriority:E}):m==="script"&&n.d.X(f,{crossOrigin:g,integrity:p,fetchPriority:E,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},un.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},un.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,g=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},un.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},un.requestFormReset=function(f){n.d.r(f)},un.unstable_batchedUpdates=function(f,d){return f(d)},un.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},un.useFormStatus=function(){return l.H.useHostTransitionStatus()},un.version="19.2.3",un}var Ky;function eS(){if(Ky)return bh.exports;Ky=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),bh.exports=FC(),bh.exports}var Yy;function BC(){if(Yy)return Vo;Yy=1;var i=UC(),e=Bm(),t=eS();function n(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var a=s,c=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(c=a.return),s=a.return;while(s)}return a.tag===3?c:null}function l(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function u(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function f(s){if(o(s)!==s)throw Error(n(188))}function d(s){var a=s.alternate;if(!a){if(a=o(s),a===null)throw Error(n(188));return a!==s?null:s}for(var c=s,h=a;;){var v=c.return;if(v===null)break;var x=v.alternate;if(x===null){if(h=v.return,h!==null){c=h;continue}break}if(v.child===x.child){for(x=v.child;x;){if(x===c)return f(v),s;if(x===h)return f(v),a;x=x.sibling}throw Error(n(188))}if(c.return!==h.return)c=v,h=x;else{for(var C=!1,I=v.child;I;){if(I===c){C=!0,c=v,h=x;break}if(I===h){C=!0,h=v,c=x;break}I=I.sibling}if(!C){for(I=x.child;I;){if(I===c){C=!0,c=x,h=v;break}if(I===h){C=!0,h=x,c=v;break}I=I.sibling}if(!C)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:a}function m(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=m(s),a!==null)return a;s=s.sibling}return null}var g=Object.assign,p=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),w=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),k=Symbol.for("react.activity"),F=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=H&&s[H]||s["@@iterator"],typeof s=="function"?s:null)}var J=Symbol.for("react.client.reference");function le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===J?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case A:return"Profiler";case T:return"StrictMode";case O:return"Suspense";case B:return"SuspenseList";case k:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case S:return"Portal";case w:return s.displayName||"Context";case _:return(s._context.displayName||"Context")+".Consumer";case D:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case N:return a=s.displayName||null,a!==null?a:le(s.type)||"Memo";case U:a=s._payload,s=s._init;try{return le(s(a))}catch{}}return null}var de=Array.isArray,P=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},W=[],he=-1;function M(s){return{current:s}}function G(s){0>he||(s.current=W[he],W[he]=null,he--)}function te(s,a){he++,W[he]=s.current,s.current=a}var V=M(null),se=M(null),ce=M(null),fe=M(null);function ve(s,a){switch(te(ce,a),te(se,s),te(V,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?ly(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=ly(a),s=cy(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}G(V),te(V,s)}function Ae(){G(V),G(se),G(ce)}function Qe(s){s.memoizedState!==null&&te(fe,s);var a=V.current,c=cy(a,s.type);a!==c&&(te(se,s),te(V,c))}function Ze(s){se.current===s&&(G(V),G(se)),fe.current===s&&(G(fe),jo._currentValue=j)}var Lt,Tt;function Se(s){if(Lt===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);Lt=a&&a[1]||"",Tt=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Lt+s+Tt}var Ie=!1;function Le(s,a){if(!s||Ie)return"";Ie=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var ue=function(){throw Error()};if(Object.defineProperty(ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ue,[])}catch(ie){var ee=ie}Reflect.construct(s,[],ue)}else{try{ue.call()}catch(ie){ee=ie}s.call(ue.prototype)}}else{try{throw Error()}catch(ie){ee=ie}(ue=s())&&typeof ue.catch=="function"&&ue.catch(function(){})}}catch(ie){if(ie&&ee&&typeof ie.stack=="string")return[ie.stack,ee.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=h.DetermineComponentFrameRoot(),C=x[0],I=x[1];if(C&&I){var $=C.split(`
`),Z=I.split(`
`);for(v=h=0;h<$.length&&!$[h].includes("DetermineComponentFrameRoot");)h++;for(;v<Z.length&&!Z[v].includes("DetermineComponentFrameRoot");)v++;if(h===$.length||v===Z.length)for(h=$.length-1,v=Z.length-1;1<=h&&0<=v&&$[h]!==Z[v];)v--;for(;1<=h&&0<=v;h--,v--)if($[h]!==Z[v]){if(h!==1||v!==1)do if(h--,v--,0>v||$[h]!==Z[v]){var re=`
`+$[h].replace(" at new "," at ");return s.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",s.displayName)),re}while(1<=h&&0<=v);break}}}finally{Ie=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Se(c):""}function Ye(s,a){switch(s.tag){case 26:case 27:case 5:return Se(s.type);case 16:return Se("Lazy");case 13:return s.child!==a&&a!==null?Se("Suspense Fallback"):Se("Suspense");case 19:return Se("SuspenseList");case 0:case 15:return Le(s.type,!1);case 11:return Le(s.type.render,!1);case 1:return Le(s.type,!0);case 31:return Se("Activity");default:return""}}function qe(s){try{var a="",c=null;do a+=Ye(s,c),c=s,s=s.return;while(s);return a}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var $e=Object.prototype.hasOwnProperty,nt=i.unstable_scheduleCallback,Gt=i.unstable_cancelCallback,xt=i.unstable_shouldYield,cn=i.unstable_requestPaint,Je=i.unstable_now,Jt=i.unstable_getCurrentPriorityLevel,Ot=i.unstable_ImmediatePriority,fn=i.unstable_UserBlockingPriority,us=i.unstable_NormalPriority,Gs=i.unstable_LowPriority,bs=i.unstable_IdlePriority,ds=i.log,Za=i.unstable_setDisableYieldValue,hn=null,zt=null;function Nn(s){if(typeof ds=="function"&&Za(s),zt&&typeof zt.setStrictMode=="function")try{zt.setStrictMode(hn,s)}catch{}}var mn=Math.clz32?Math.clz32:El,xl=Math.log,ad=Math.LN2;function El(s){return s>>>=0,s===0?32:31-(xl(s)/ad|0)|0}var kr=256,nr=262144,sr=4194304;function Ts(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Pr(s,a,c){var h=s.pendingLanes;if(h===0)return 0;var v=0,x=s.suspendedLanes,C=s.pingedLanes;s=s.warmLanes;var I=h&134217727;return I!==0?(h=I&~x,h!==0?v=Ts(h):(C&=I,C!==0?v=Ts(C):c||(c=I&~s,c!==0&&(v=Ts(c))))):(I=h&~x,I!==0?v=Ts(I):C!==0?v=Ts(C):c||(c=h&~s,c!==0&&(v=Ts(c)))),v===0?0:a!==0&&a!==v&&(a&x)===0&&(x=v&-v,c=a&-a,x>=c||x===32&&(c&4194048)!==0)?a:v}function ir(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Sl(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function me(){var s=sr;return sr<<=1,(sr&62914560)===0&&(sr=4194304),s}function Re(s){for(var a=[],c=0;31>c;c++)a.push(s);return a}function ke(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Xe(s,a,c,h,v,x){var C=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var I=s.entanglements,$=s.expirationTimes,Z=s.hiddenUpdates;for(c=C&~c;0<c;){var re=31-mn(c),ue=1<<re;I[re]=0,$[re]=-1;var ee=Z[re];if(ee!==null)for(Z[re]=null,re=0;re<ee.length;re++){var ie=ee[re];ie!==null&&(ie.lane&=-536870913)}c&=~ue}h!==0&&it(s,h,0),x!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=x&~(C&~a))}function it(s,a,c){s.pendingLanes|=a,s.suspendedLanes&=~a;var h=31-mn(a);s.entangledLanes|=a,s.entanglements[h]=s.entanglements[h]|1073741824|c&261930}function _t(s,a){var c=s.entangledLanes|=a;for(s=s.entanglements;c;){var h=31-mn(c),v=1<<h;v&a|s[h]&a&&(s[h]|=a),c&=~v}}function Ur(s,a){var c=a&-a;return c=(c&42)!==0?1:Fr(c),(c&(s.suspendedLanes|a))!==0?0:c}function Fr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Ja(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Yg(){var s=K.p;return s!==0?s:(s=window.event,s===void 0?32:Ny(s.type))}function qg(s,a){var c=K.p;try{return K.p=s,a()}finally{K.p=c}}var gi=Math.random().toString(36).slice(2),en="__reactFiber$"+gi,vn="__reactProps$"+gi,Br="__reactContainer$"+gi,od="__reactEvents$"+gi,S1="__reactListeners$"+gi,b1="__reactHandles$"+gi,Xg="__reactResources$"+gi,eo="__reactMarker$"+gi;function ld(s){delete s[en],delete s[vn],delete s[od],delete s[S1],delete s[b1]}function jr(s){var a=s[en];if(a)return a;for(var c=s.parentNode;c;){if(a=c[Br]||c[en]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(s=py(s);s!==null;){if(c=s[en])return c;s=py(s)}return a}s=c,c=s.parentNode}return null}function $r(s){if(s=s[en]||s[Br]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function to(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(n(33))}function Gr(s){var a=s[Xg];return a||(a=s[Xg]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Wt(s){s[eo]=!0}var Wg=new Set,Qg={};function rr(s,a){zr(s,a),zr(s+"Capture",a)}function zr(s,a){for(Qg[s]=a,s=0;s<a.length;s++)Wg.add(a[s])}var T1=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zg={},Jg={};function A1(s){return $e.call(Jg,s)?!0:$e.call(Zg,s)?!1:T1.test(s)?Jg[s]=!0:(Zg[s]=!0,!1)}function bl(s,a,c){if(A1(a))if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+c)}}function Tl(s,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+c)}}function zs(s,a,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(a,c,""+h)}}function Yn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function e0(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function R1(s,a,c){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,x=h.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return v.call(this)},set:function(C){c=""+C,x.call(this,C)}}),Object.defineProperty(s,a,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(C){c=""+C},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function cd(s){if(!s._valueTracker){var a=e0(s)?"checked":"value";s._valueTracker=R1(s,a,""+s[a])}}function t0(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var c=a.getValue(),h="";return s&&(h=e0(s)?s.checked?"true":"false":s.value),s=h,s!==c?(a.setValue(s),!0):!1}function Al(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var C1=/[\n"\\]/g;function qn(s){return s.replace(C1,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ud(s,a,c,h,v,x,C,I){s.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.type=C:s.removeAttribute("type"),a!=null?C==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+Yn(a)):s.value!==""+Yn(a)&&(s.value=""+Yn(a)):C!=="submit"&&C!=="reset"||s.removeAttribute("value"),a!=null?dd(s,C,Yn(a)):c!=null?dd(s,C,Yn(c)):h!=null&&s.removeAttribute("value"),v==null&&x!=null&&(s.defaultChecked=!!x),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?s.name=""+Yn(I):s.removeAttribute("name")}function n0(s,a,c,h,v,x,C,I){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(s.type=x),a!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||a!=null)){cd(s);return}c=c!=null?""+Yn(c):"",a=a!=null?""+Yn(a):c,I||a===s.value||(s.value=a),s.defaultValue=a}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=I?s.checked:!!h,s.defaultChecked=!!h,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(s.name=C),cd(s)}function dd(s,a,c){a==="number"&&Al(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Hr(s,a,c,h){if(s=s.options,a){a={};for(var v=0;v<c.length;v++)a["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=a.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&h&&(s[c].defaultSelected=!0)}else{for(c=""+Yn(c),a=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,h&&(s[v].defaultSelected=!0);return}a!==null||s[v].disabled||(a=s[v])}a!==null&&(a.selected=!0)}}function s0(s,a,c){if(a!=null&&(a=""+Yn(a),a!==s.value&&(s.value=a),c==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=c!=null?""+Yn(c):""}function i0(s,a,c,h){if(a==null){if(h!=null){if(c!=null)throw Error(n(92));if(de(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),a=c}c=Yn(a),s.defaultValue=c,h=s.textContent,h===c&&h!==""&&h!==null&&(s.value=h),cd(s)}function Vr(s,a){if(a){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=a;return}}s.textContent=a}var L1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function r0(s,a,c){var h=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":h?s.setProperty(a,c):typeof c!="number"||c===0||L1.has(a)?a==="float"?s.cssFloat=c:s[a]=(""+c).trim():s[a]=c+"px"}function a0(s,a,c){if(a!=null&&typeof a!="object")throw Error(n(62));if(s=s.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var v in a)h=a[v],a.hasOwnProperty(v)&&c[v]!==h&&r0(s,v,h)}else for(var x in a)a.hasOwnProperty(x)&&r0(s,x,a[x])}function fd(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _1=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),w1=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Rl(s){return w1.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Hs(){}var hd=null;function md(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Kr=null,Yr=null;function o0(s){var a=$r(s);if(a&&(s=a.stateNode)){var c=s[vn]||null;e:switch(s=a.stateNode,a.type){case"input":if(ud(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+qn(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var h=c[a];if(h!==s&&h.form===s.form){var v=h[vn]||null;if(!v)throw Error(n(90));ud(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(a=0;a<c.length;a++)h=c[a],h.form===s.form&&t0(h)}break e;case"textarea":s0(s,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&Hr(s,!!c.multiple,a,!1)}}}var gd=!1;function l0(s,a,c){if(gd)return s(a,c);gd=!0;try{var h=s(a);return h}finally{if(gd=!1,(Kr!==null||Yr!==null)&&(fc(),Kr&&(a=Kr,s=Yr,Yr=Kr=null,o0(a),s)))for(a=0;a<s.length;a++)o0(s[a])}}function no(s,a){var c=s.stateNode;if(c===null)return null;var h=c[vn]||null;if(h===null)return null;c=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,a,typeof c));return c}var Vs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pd=!1;if(Vs)try{var so={};Object.defineProperty(so,"passive",{get:function(){pd=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{pd=!1}var pi=null,vd=null,Cl=null;function c0(){if(Cl)return Cl;var s,a=vd,c=a.length,h,v="value"in pi?pi.value:pi.textContent,x=v.length;for(s=0;s<c&&a[s]===v[s];s++);var C=c-s;for(h=1;h<=C&&a[c-h]===v[x-h];h++);return Cl=v.slice(s,1<h?1-h:void 0)}function Ll(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function _l(){return!0}function u0(){return!1}function yn(s){function a(c,h,v,x,C){this._reactName=c,this._targetInst=v,this.type=h,this.nativeEvent=x,this.target=C,this.currentTarget=null;for(var I in s)s.hasOwnProperty(I)&&(c=s[I],this[I]=c?c(x):x[I]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?_l:u0,this.isPropagationStopped=u0,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=_l)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=_l)},persist:function(){},isPersistent:_l}),a}var ar={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wl=yn(ar),io=g({},ar,{view:0,detail:0}),D1=yn(io),yd,xd,ro,Dl=g({},io,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ro&&(ro&&s.type==="mousemove"?(yd=s.screenX-ro.screenX,xd=s.screenY-ro.screenY):xd=yd=0,ro=s),yd)},movementY:function(s){return"movementY"in s?s.movementY:xd}}),d0=yn(Dl),I1=g({},Dl,{dataTransfer:0}),N1=yn(I1),O1=g({},io,{relatedTarget:0}),Ed=yn(O1),M1=g({},ar,{animationName:0,elapsedTime:0,pseudoElement:0}),k1=yn(M1),P1=g({},ar,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),U1=yn(P1),F1=g({},ar,{data:0}),f0=yn(F1),B1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},j1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function G1(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=$1[s])?!!a[s]:!1}function Sd(){return G1}var z1=g({},io,{key:function(s){if(s.key){var a=B1[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Ll(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?j1[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sd,charCode:function(s){return s.type==="keypress"?Ll(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Ll(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),H1=yn(z1),V1=g({},Dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),h0=yn(V1),K1=g({},io,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sd}),Y1=yn(K1),q1=g({},ar,{propertyName:0,elapsedTime:0,pseudoElement:0}),X1=yn(q1),W1=g({},Dl,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Q1=yn(W1),Z1=g({},ar,{newState:0,oldState:0}),J1=yn(Z1),eR=[9,13,27,32],bd=Vs&&"CompositionEvent"in window,ao=null;Vs&&"documentMode"in document&&(ao=document.documentMode);var tR=Vs&&"TextEvent"in window&&!ao,m0=Vs&&(!bd||ao&&8<ao&&11>=ao),g0=" ",p0=!1;function v0(s,a){switch(s){case"keyup":return eR.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function y0(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var qr=!1;function nR(s,a){switch(s){case"compositionend":return y0(a);case"keypress":return a.which!==32?null:(p0=!0,g0);case"textInput":return s=a.data,s===g0&&p0?null:s;default:return null}}function sR(s,a){if(qr)return s==="compositionend"||!bd&&v0(s,a)?(s=c0(),Cl=vd=pi=null,qr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return m0&&a.locale!=="ko"?null:a.data;default:return null}}var iR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x0(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!iR[s.type]:a==="textarea"}function E0(s,a,c,h){Kr?Yr?Yr.push(h):Yr=[h]:Kr=h,a=xc(a,"onChange"),0<a.length&&(c=new wl("onChange","change",null,c,h),s.push({event:c,listeners:a}))}var oo=null,lo=null;function rR(s){ny(s,0)}function Il(s){var a=to(s);if(t0(a))return s}function S0(s,a){if(s==="change")return a}var b0=!1;if(Vs){var Td;if(Vs){var Ad="oninput"in document;if(!Ad){var T0=document.createElement("div");T0.setAttribute("oninput","return;"),Ad=typeof T0.oninput=="function"}Td=Ad}else Td=!1;b0=Td&&(!document.documentMode||9<document.documentMode)}function A0(){oo&&(oo.detachEvent("onpropertychange",R0),lo=oo=null)}function R0(s){if(s.propertyName==="value"&&Il(lo)){var a=[];E0(a,lo,s,md(s)),l0(rR,a)}}function aR(s,a,c){s==="focusin"?(A0(),oo=a,lo=c,oo.attachEvent("onpropertychange",R0)):s==="focusout"&&A0()}function oR(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Il(lo)}function lR(s,a){if(s==="click")return Il(a)}function cR(s,a){if(s==="input"||s==="change")return Il(a)}function uR(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var On=typeof Object.is=="function"?Object.is:uR;function co(s,a){if(On(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var c=Object.keys(s),h=Object.keys(a);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var v=c[h];if(!$e.call(a,v)||!On(s[v],a[v]))return!1}return!0}function C0(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function L0(s,a){var c=C0(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=a&&h>=a)return{node:c,offset:a-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=C0(c)}}function _0(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?_0(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function w0(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Al(s.document);a instanceof s.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)s=a.contentWindow;else break;a=Al(s.document)}return a}function Rd(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var dR=Vs&&"documentMode"in document&&11>=document.documentMode,Xr=null,Cd=null,uo=null,Ld=!1;function D0(s,a,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Ld||Xr==null||Xr!==Al(h)||(h=Xr,"selectionStart"in h&&Rd(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),uo&&co(uo,h)||(uo=h,h=xc(Cd,"onSelect"),0<h.length&&(a=new wl("onSelect","select",null,a,c),s.push({event:a,listeners:h}),a.target=Xr)))}function or(s,a){var c={};return c[s.toLowerCase()]=a.toLowerCase(),c["Webkit"+s]="webkit"+a,c["Moz"+s]="moz"+a,c}var Wr={animationend:or("Animation","AnimationEnd"),animationiteration:or("Animation","AnimationIteration"),animationstart:or("Animation","AnimationStart"),transitionrun:or("Transition","TransitionRun"),transitionstart:or("Transition","TransitionStart"),transitioncancel:or("Transition","TransitionCancel"),transitionend:or("Transition","TransitionEnd")},_d={},I0={};Vs&&(I0=document.createElement("div").style,"AnimationEvent"in window||(delete Wr.animationend.animation,delete Wr.animationiteration.animation,delete Wr.animationstart.animation),"TransitionEvent"in window||delete Wr.transitionend.transition);function lr(s){if(_d[s])return _d[s];if(!Wr[s])return s;var a=Wr[s],c;for(c in a)if(a.hasOwnProperty(c)&&c in I0)return _d[s]=a[c];return s}var N0=lr("animationend"),O0=lr("animationiteration"),M0=lr("animationstart"),fR=lr("transitionrun"),hR=lr("transitionstart"),mR=lr("transitioncancel"),k0=lr("transitionend"),P0=new Map,wd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wd.push("scrollEnd");function fs(s,a){P0.set(s,a),rr(a,[s])}var Nl=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Xn=[],Qr=0,Dd=0;function Ol(){for(var s=Qr,a=Dd=Qr=0;a<s;){var c=Xn[a];Xn[a++]=null;var h=Xn[a];Xn[a++]=null;var v=Xn[a];Xn[a++]=null;var x=Xn[a];if(Xn[a++]=null,h!==null&&v!==null){var C=h.pending;C===null?v.next=v:(v.next=C.next,C.next=v),h.pending=v}x!==0&&U0(c,v,x)}}function Ml(s,a,c,h){Xn[Qr++]=s,Xn[Qr++]=a,Xn[Qr++]=c,Xn[Qr++]=h,Dd|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Id(s,a,c,h){return Ml(s,a,c,h),kl(s)}function cr(s,a){return Ml(s,null,null,a),kl(s)}function U0(s,a,c){s.lanes|=c;var h=s.alternate;h!==null&&(h.lanes|=c);for(var v=!1,x=s.return;x!==null;)x.childLanes|=c,h=x.alternate,h!==null&&(h.childLanes|=c),x.tag===22&&(s=x.stateNode,s===null||s._visibility&1||(v=!0)),s=x,x=x.return;return s.tag===3?(x=s.stateNode,v&&a!==null&&(v=31-mn(c),s=x.hiddenUpdates,h=s[v],h===null?s[v]=[a]:h.push(a),a.lane=c|536870912),x):null}function kl(s){if(50<Oo)throw Oo=0,$f=null,Error(n(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Zr={};function gR(s,a,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(s,a,c,h){return new gR(s,a,c,h)}function Nd(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ks(s,a){var c=s.alternate;return c===null?(c=Mn(s.tag,a,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=a,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,a=s.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function F0(s,a){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,a=c.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function Pl(s,a,c,h,v,x){var C=0;if(h=s,typeof s=="function")Nd(s)&&(C=1);else if(typeof s=="string")C=EC(s,c,V.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case k:return s=Mn(31,c,a,v),s.elementType=k,s.lanes=x,s;case b:return ur(c.children,v,x,a);case T:C=8,v|=24;break;case A:return s=Mn(12,c,a,v|2),s.elementType=A,s.lanes=x,s;case O:return s=Mn(13,c,a,v),s.elementType=O,s.lanes=x,s;case B:return s=Mn(19,c,a,v),s.elementType=B,s.lanes=x,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case w:C=10;break e;case _:C=9;break e;case D:C=11;break e;case N:C=14;break e;case U:C=16,h=null;break e}C=29,c=Error(n(130,s===null?"null":typeof s,"")),h=null}return a=Mn(C,c,a,v),a.elementType=s,a.type=h,a.lanes=x,a}function ur(s,a,c,h){return s=Mn(7,s,h,a),s.lanes=c,s}function Od(s,a,c){return s=Mn(6,s,null,a),s.lanes=c,s}function B0(s){var a=Mn(18,null,null,0);return a.stateNode=s,a}function Md(s,a,c){return a=Mn(4,s.children!==null?s.children:[],s.key,a),a.lanes=c,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var j0=new WeakMap;function Wn(s,a){if(typeof s=="object"&&s!==null){var c=j0.get(s);return c!==void 0?c:(a={value:s,source:a,stack:qe(a)},j0.set(s,a),a)}return{value:s,source:a,stack:qe(a)}}var Jr=[],ea=0,Ul=null,fo=0,Qn=[],Zn=0,vi=null,As=1,Rs="";function Ys(s,a){Jr[ea++]=fo,Jr[ea++]=Ul,Ul=s,fo=a}function $0(s,a,c){Qn[Zn++]=As,Qn[Zn++]=Rs,Qn[Zn++]=vi,vi=s;var h=As;s=Rs;var v=32-mn(h)-1;h&=~(1<<v),c+=1;var x=32-mn(a)+v;if(30<x){var C=v-v%5;x=(h&(1<<C)-1).toString(32),h>>=C,v-=C,As=1<<32-mn(a)+v|c<<v|h,Rs=x+s}else As=1<<x|c<<v|h,Rs=s}function kd(s){s.return!==null&&(Ys(s,1),$0(s,1,0))}function Pd(s){for(;s===Ul;)Ul=Jr[--ea],Jr[ea]=null,fo=Jr[--ea],Jr[ea]=null;for(;s===vi;)vi=Qn[--Zn],Qn[Zn]=null,Rs=Qn[--Zn],Qn[Zn]=null,As=Qn[--Zn],Qn[Zn]=null}function G0(s,a){Qn[Zn++]=As,Qn[Zn++]=Rs,Qn[Zn++]=vi,As=a.id,Rs=a.overflow,vi=s}var tn=null,Et=null,We=!1,yi=null,Jn=!1,Ud=Error(n(519));function xi(s){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ho(Wn(a,s)),Ud}function z0(s){var a=s.stateNode,c=s.type,h=s.memoizedProps;switch(a[en]=s,a[vn]=h,c){case"dialog":He("cancel",a),He("close",a);break;case"iframe":case"object":case"embed":He("load",a);break;case"video":case"audio":for(c=0;c<ko.length;c++)He(ko[c],a);break;case"source":He("error",a);break;case"img":case"image":case"link":He("error",a),He("load",a);break;case"details":He("toggle",a);break;case"input":He("invalid",a),n0(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":He("invalid",a);break;case"textarea":He("invalid",a),i0(a,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||h.suppressHydrationWarning===!0||ay(a.textContent,c)?(h.popover!=null&&(He("beforetoggle",a),He("toggle",a)),h.onScroll!=null&&He("scroll",a),h.onScrollEnd!=null&&He("scrollend",a),h.onClick!=null&&(a.onclick=Hs),a=!0):a=!1,a||xi(s,!0)}function H0(s){for(tn=s.return;tn;)switch(tn.tag){case 5:case 31:case 13:Jn=!1;return;case 27:case 3:Jn=!0;return;default:tn=tn.return}}function ta(s){if(s!==tn)return!1;if(!We)return H0(s),We=!0,!1;var a=s.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||nh(s.type,s.memoizedProps)),c=!c),c&&Et&&xi(s),H0(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Et=gy(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Et=gy(s)}else a===27?(a=Et,Oi(s.type)?(s=oh,oh=null,Et=s):Et=a):Et=tn?ts(s.stateNode.nextSibling):null;return!0}function dr(){Et=tn=null,We=!1}function Fd(){var s=yi;return s!==null&&(bn===null?bn=s:bn.push.apply(bn,s),yi=null),s}function ho(s){yi===null?yi=[s]:yi.push(s)}var Bd=M(null),fr=null,qs=null;function Ei(s,a,c){te(Bd,a._currentValue),a._currentValue=c}function Xs(s){s._currentValue=Bd.current,G(Bd)}function jd(s,a,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),s===c)break;s=s.return}}function $d(s,a,c,h){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var x=v.dependencies;if(x!==null){var C=v.child;x=x.firstContext;e:for(;x!==null;){var I=x;x=v;for(var $=0;$<a.length;$++)if(I.context===a[$]){x.lanes|=c,I=x.alternate,I!==null&&(I.lanes|=c),jd(x.return,c,s),h||(C=null);break e}x=I.next}}else if(v.tag===18){if(C=v.return,C===null)throw Error(n(341));C.lanes|=c,x=C.alternate,x!==null&&(x.lanes|=c),jd(C,c,s),C=null}else C=v.child;if(C!==null)C.return=v;else for(C=v;C!==null;){if(C===s){C=null;break}if(v=C.sibling,v!==null){v.return=C.return,C=v;break}C=C.return}v=C}}function na(s,a,c,h){s=null;for(var v=a,x=!1;v!==null;){if(!x){if((v.flags&524288)!==0)x=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var C=v.alternate;if(C===null)throw Error(n(387));if(C=C.memoizedProps,C!==null){var I=v.type;On(v.pendingProps.value,C.value)||(s!==null?s.push(I):s=[I])}}else if(v===fe.current){if(C=v.alternate,C===null)throw Error(n(387));C.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(jo):s=[jo])}v=v.return}s!==null&&$d(a,s,c,h),a.flags|=262144}function Fl(s){for(s=s.firstContext;s!==null;){if(!On(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function hr(s){fr=s,qs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function nn(s){return V0(fr,s)}function Bl(s,a){return fr===null&&hr(s),V0(s,a)}function V0(s,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},qs===null){if(s===null)throw Error(n(308));qs=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else qs=qs.next=a;return c}var pR=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(c,h){s.push(h)}};this.abort=function(){a.aborted=!0,s.forEach(function(c){return c()})}},vR=i.unstable_scheduleCallback,yR=i.unstable_NormalPriority,Ut={$$typeof:w,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Gd(){return{controller:new pR,data:new Map,refCount:0}}function mo(s){s.refCount--,s.refCount===0&&vR(yR,function(){s.controller.abort()})}var go=null,zd=0,sa=0,ia=null;function xR(s,a){if(go===null){var c=go=[];zd=0,sa=Yf(),ia={status:"pending",value:void 0,then:function(h){c.push(h)}}}return zd++,a.then(K0,K0),a}function K0(){if(--zd===0&&go!==null){ia!==null&&(ia.status="fulfilled");var s=go;go=null,sa=0,ia=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function ER(s,a){var c=[],h={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){h.status="fulfilled",h.value=a;for(var v=0;v<c.length;v++)(0,c[v])(a)},function(v){for(h.status="rejected",h.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),h}var Y0=P.S;P.S=function(s,a){Dv=Je(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&xR(s,a),Y0!==null&&Y0(s,a)};var mr=M(null);function Hd(){var s=mr.current;return s!==null?s:mt.pooledCache}function jl(s,a){a===null?te(mr,mr.current):te(mr,a.pool)}function q0(){var s=Hd();return s===null?null:{parent:Ut._currentValue,pool:s}}var ra=Error(n(460)),Vd=Error(n(474)),$l=Error(n(542)),Gl={then:function(){}};function X0(s){return s=s.status,s==="fulfilled"||s==="rejected"}function W0(s,a,c){switch(c=s[c],c===void 0?s.push(a):c!==a&&(a.then(Hs,Hs),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Z0(s),s;default:if(typeof a.status=="string")a.then(Hs,Hs);else{if(s=mt,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=a,s.status="pending",s.then(function(h){if(a.status==="pending"){var v=a;v.status="fulfilled",v.value=h}},function(h){if(a.status==="pending"){var v=a;v.status="rejected",v.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,Z0(s),s}throw pr=a,ra}}function gr(s){try{var a=s._init;return a(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(pr=c,ra):c}}var pr=null;function Q0(){if(pr===null)throw Error(n(459));var s=pr;return pr=null,s}function Z0(s){if(s===ra||s===$l)throw Error(n(483))}var aa=null,po=0;function zl(s){var a=po;return po+=1,aa===null&&(aa=[]),W0(aa,s,a)}function vo(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Hl(s,a){throw a.$$typeof===p?Error(n(525)):(s=Object.prototype.toString.call(a),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function J0(s){function a(Y,z){if(s){var Q=Y.deletions;Q===null?(Y.deletions=[z],Y.flags|=16):Q.push(z)}}function c(Y,z){if(!s)return null;for(;z!==null;)a(Y,z),z=z.sibling;return null}function h(Y){for(var z=new Map;Y!==null;)Y.key!==null?z.set(Y.key,Y):z.set(Y.index,Y),Y=Y.sibling;return z}function v(Y,z){return Y=Ks(Y,z),Y.index=0,Y.sibling=null,Y}function x(Y,z,Q){return Y.index=Q,s?(Q=Y.alternate,Q!==null?(Q=Q.index,Q<z?(Y.flags|=67108866,z):Q):(Y.flags|=67108866,z)):(Y.flags|=1048576,z)}function C(Y){return s&&Y.alternate===null&&(Y.flags|=67108866),Y}function I(Y,z,Q,oe){return z===null||z.tag!==6?(z=Od(Q,Y.mode,oe),z.return=Y,z):(z=v(z,Q),z.return=Y,z)}function $(Y,z,Q,oe){var _e=Q.type;return _e===b?re(Y,z,Q.props.children,oe,Q.key):z!==null&&(z.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===U&&gr(_e)===z.type)?(z=v(z,Q.props),vo(z,Q),z.return=Y,z):(z=Pl(Q.type,Q.key,Q.props,null,Y.mode,oe),vo(z,Q),z.return=Y,z)}function Z(Y,z,Q,oe){return z===null||z.tag!==4||z.stateNode.containerInfo!==Q.containerInfo||z.stateNode.implementation!==Q.implementation?(z=Md(Q,Y.mode,oe),z.return=Y,z):(z=v(z,Q.children||[]),z.return=Y,z)}function re(Y,z,Q,oe,_e){return z===null||z.tag!==7?(z=ur(Q,Y.mode,oe,_e),z.return=Y,z):(z=v(z,Q),z.return=Y,z)}function ue(Y,z,Q){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Od(""+z,Y.mode,Q),z.return=Y,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case E:return Q=Pl(z.type,z.key,z.props,null,Y.mode,Q),vo(Q,z),Q.return=Y,Q;case S:return z=Md(z,Y.mode,Q),z.return=Y,z;case U:return z=gr(z),ue(Y,z,Q)}if(de(z)||ne(z))return z=ur(z,Y.mode,Q,null),z.return=Y,z;if(typeof z.then=="function")return ue(Y,zl(z),Q);if(z.$$typeof===w)return ue(Y,Bl(Y,z),Q);Hl(Y,z)}return null}function ee(Y,z,Q,oe){var _e=z!==null?z.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return _e!==null?null:I(Y,z,""+Q,oe);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case E:return Q.key===_e?$(Y,z,Q,oe):null;case S:return Q.key===_e?Z(Y,z,Q,oe):null;case U:return Q=gr(Q),ee(Y,z,Q,oe)}if(de(Q)||ne(Q))return _e!==null?null:re(Y,z,Q,oe,null);if(typeof Q.then=="function")return ee(Y,z,zl(Q),oe);if(Q.$$typeof===w)return ee(Y,z,Bl(Y,Q),oe);Hl(Y,Q)}return null}function ie(Y,z,Q,oe,_e){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return Y=Y.get(Q)||null,I(z,Y,""+oe,_e);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case E:return Y=Y.get(oe.key===null?Q:oe.key)||null,$(z,Y,oe,_e);case S:return Y=Y.get(oe.key===null?Q:oe.key)||null,Z(z,Y,oe,_e);case U:return oe=gr(oe),ie(Y,z,Q,oe,_e)}if(de(oe)||ne(oe))return Y=Y.get(Q)||null,re(z,Y,oe,_e,null);if(typeof oe.then=="function")return ie(Y,z,Q,zl(oe),_e);if(oe.$$typeof===w)return ie(Y,z,Q,Bl(z,oe),_e);Hl(z,oe)}return null}function ye(Y,z,Q,oe){for(var _e=null,et=null,be=z,Ue=z=0,Ke=null;be!==null&&Ue<Q.length;Ue++){be.index>Ue?(Ke=be,be=null):Ke=be.sibling;var tt=ee(Y,be,Q[Ue],oe);if(tt===null){be===null&&(be=Ke);break}s&&be&&tt.alternate===null&&a(Y,be),z=x(tt,z,Ue),et===null?_e=tt:et.sibling=tt,et=tt,be=Ke}if(Ue===Q.length)return c(Y,be),We&&Ys(Y,Ue),_e;if(be===null){for(;Ue<Q.length;Ue++)be=ue(Y,Q[Ue],oe),be!==null&&(z=x(be,z,Ue),et===null?_e=be:et.sibling=be,et=be);return We&&Ys(Y,Ue),_e}for(be=h(be);Ue<Q.length;Ue++)Ke=ie(be,Y,Ue,Q[Ue],oe),Ke!==null&&(s&&Ke.alternate!==null&&be.delete(Ke.key===null?Ue:Ke.key),z=x(Ke,z,Ue),et===null?_e=Ke:et.sibling=Ke,et=Ke);return s&&be.forEach(function(Fi){return a(Y,Fi)}),We&&Ys(Y,Ue),_e}function De(Y,z,Q,oe){if(Q==null)throw Error(n(151));for(var _e=null,et=null,be=z,Ue=z=0,Ke=null,tt=Q.next();be!==null&&!tt.done;Ue++,tt=Q.next()){be.index>Ue?(Ke=be,be=null):Ke=be.sibling;var Fi=ee(Y,be,tt.value,oe);if(Fi===null){be===null&&(be=Ke);break}s&&be&&Fi.alternate===null&&a(Y,be),z=x(Fi,z,Ue),et===null?_e=Fi:et.sibling=Fi,et=Fi,be=Ke}if(tt.done)return c(Y,be),We&&Ys(Y,Ue),_e;if(be===null){for(;!tt.done;Ue++,tt=Q.next())tt=ue(Y,tt.value,oe),tt!==null&&(z=x(tt,z,Ue),et===null?_e=tt:et.sibling=tt,et=tt);return We&&Ys(Y,Ue),_e}for(be=h(be);!tt.done;Ue++,tt=Q.next())tt=ie(be,Y,Ue,tt.value,oe),tt!==null&&(s&&tt.alternate!==null&&be.delete(tt.key===null?Ue:tt.key),z=x(tt,z,Ue),et===null?_e=tt:et.sibling=tt,et=tt);return s&&be.forEach(function(IC){return a(Y,IC)}),We&&Ys(Y,Ue),_e}function ft(Y,z,Q,oe){if(typeof Q=="object"&&Q!==null&&Q.type===b&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case E:e:{for(var _e=Q.key;z!==null;){if(z.key===_e){if(_e=Q.type,_e===b){if(z.tag===7){c(Y,z.sibling),oe=v(z,Q.props.children),oe.return=Y,Y=oe;break e}}else if(z.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===U&&gr(_e)===z.type){c(Y,z.sibling),oe=v(z,Q.props),vo(oe,Q),oe.return=Y,Y=oe;break e}c(Y,z);break}else a(Y,z);z=z.sibling}Q.type===b?(oe=ur(Q.props.children,Y.mode,oe,Q.key),oe.return=Y,Y=oe):(oe=Pl(Q.type,Q.key,Q.props,null,Y.mode,oe),vo(oe,Q),oe.return=Y,Y=oe)}return C(Y);case S:e:{for(_e=Q.key;z!==null;){if(z.key===_e)if(z.tag===4&&z.stateNode.containerInfo===Q.containerInfo&&z.stateNode.implementation===Q.implementation){c(Y,z.sibling),oe=v(z,Q.children||[]),oe.return=Y,Y=oe;break e}else{c(Y,z);break}else a(Y,z);z=z.sibling}oe=Md(Q,Y.mode,oe),oe.return=Y,Y=oe}return C(Y);case U:return Q=gr(Q),ft(Y,z,Q,oe)}if(de(Q))return ye(Y,z,Q,oe);if(ne(Q)){if(_e=ne(Q),typeof _e!="function")throw Error(n(150));return Q=_e.call(Q),De(Y,z,Q,oe)}if(typeof Q.then=="function")return ft(Y,z,zl(Q),oe);if(Q.$$typeof===w)return ft(Y,z,Bl(Y,Q),oe);Hl(Y,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint"?(Q=""+Q,z!==null&&z.tag===6?(c(Y,z.sibling),oe=v(z,Q),oe.return=Y,Y=oe):(c(Y,z),oe=Od(Q,Y.mode,oe),oe.return=Y,Y=oe),C(Y)):c(Y,z)}return function(Y,z,Q,oe){try{po=0;var _e=ft(Y,z,Q,oe);return aa=null,_e}catch(be){if(be===ra||be===$l)throw be;var et=Mn(29,be,null,Y.mode);return et.lanes=oe,et.return=Y,et}}}var vr=J0(!0),ep=J0(!1),Si=!1;function Kd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yd(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function bi(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Ti(s,a,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(st&2)!==0){var v=h.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),h.pending=a,a=kl(s),U0(s,null,c),a}return Ml(s,h,a,c),kl(s)}function yo(s,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var h=a.lanes;h&=s.pendingLanes,c|=h,a.lanes=c,_t(s,c)}}function qd(s,a){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var v=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?v=x=C:x=x.next=C,c=c.next}while(c!==null);x===null?v=x=a:x=x.next=a}else v=x=a;c={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:x,shared:h.shared,callbacks:h.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=a:s.next=a,c.lastBaseUpdate=a}var Xd=!1;function xo(){if(Xd){var s=ia;if(s!==null)throw s}}function Eo(s,a,c,h){Xd=!1;var v=s.updateQueue;Si=!1;var x=v.firstBaseUpdate,C=v.lastBaseUpdate,I=v.shared.pending;if(I!==null){v.shared.pending=null;var $=I,Z=$.next;$.next=null,C===null?x=Z:C.next=Z,C=$;var re=s.alternate;re!==null&&(re=re.updateQueue,I=re.lastBaseUpdate,I!==C&&(I===null?re.firstBaseUpdate=Z:I.next=Z,re.lastBaseUpdate=$))}if(x!==null){var ue=v.baseState;C=0,re=Z=$=null,I=x;do{var ee=I.lane&-536870913,ie=ee!==I.lane;if(ie?(Ve&ee)===ee:(h&ee)===ee){ee!==0&&ee===sa&&(Xd=!0),re!==null&&(re=re.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});e:{var ye=s,De=I;ee=a;var ft=c;switch(De.tag){case 1:if(ye=De.payload,typeof ye=="function"){ue=ye.call(ft,ue,ee);break e}ue=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=De.payload,ee=typeof ye=="function"?ye.call(ft,ue,ee):ye,ee==null)break e;ue=g({},ue,ee);break e;case 2:Si=!0}}ee=I.callback,ee!==null&&(s.flags|=64,ie&&(s.flags|=8192),ie=v.callbacks,ie===null?v.callbacks=[ee]:ie.push(ee))}else ie={lane:ee,tag:I.tag,payload:I.payload,callback:I.callback,next:null},re===null?(Z=re=ie,$=ue):re=re.next=ie,C|=ee;if(I=I.next,I===null){if(I=v.shared.pending,I===null)break;ie=I,I=ie.next,ie.next=null,v.lastBaseUpdate=ie,v.shared.pending=null}}while(!0);re===null&&($=ue),v.baseState=$,v.firstBaseUpdate=Z,v.lastBaseUpdate=re,x===null&&(v.shared.lanes=0),_i|=C,s.lanes=C,s.memoizedState=ue}}function tp(s,a){if(typeof s!="function")throw Error(n(191,s));s.call(a)}function np(s,a){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)tp(c[s],a)}var oa=M(null),Vl=M(0);function sp(s,a){s=ii,te(Vl,s),te(oa,a),ii=s|a.baseLanes}function Wd(){te(Vl,ii),te(oa,oa.current)}function Qd(){ii=Vl.current,G(oa),G(Vl)}var kn=M(null),es=null;function Ai(s){var a=s.alternate;te(Mt,Mt.current&1),te(kn,s),es===null&&(a===null||oa.current!==null||a.memoizedState!==null)&&(es=s)}function Zd(s){te(Mt,Mt.current),te(kn,s),es===null&&(es=s)}function ip(s){s.tag===22?(te(Mt,Mt.current),te(kn,s),es===null&&(es=s)):Ri()}function Ri(){te(Mt,Mt.current),te(kn,kn.current)}function Pn(s){G(kn),es===s&&(es=null),G(Mt)}var Mt=M(0);function Kl(s){for(var a=s;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||rh(c)||ah(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Ws=0,Pe=null,ut=null,Ft=null,Yl=!1,la=!1,yr=!1,ql=0,So=0,ca=null,SR=0;function wt(){throw Error(n(321))}function Jd(s,a){if(a===null)return!1;for(var c=0;c<a.length&&c<s.length;c++)if(!On(s[c],a[c]))return!1;return!0}function ef(s,a,c,h,v,x){return Ws=x,Pe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,P.H=s===null||s.memoizedState===null?$p:pf,yr=!1,x=c(h,v),yr=!1,la&&(x=ap(a,c,h,v)),rp(s),x}function rp(s){P.H=Ao;var a=ut!==null&&ut.next!==null;if(Ws=0,Ft=ut=Pe=null,Yl=!1,So=0,ca=null,a)throw Error(n(300));s===null||Bt||(s=s.dependencies,s!==null&&Fl(s)&&(Bt=!0))}function ap(s,a,c,h){Pe=s;var v=0;do{if(la&&(ca=null),So=0,la=!1,25<=v)throw Error(n(301));if(v+=1,Ft=ut=null,s.updateQueue!=null){var x=s.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}P.H=Gp,x=a(c,h)}while(la);return x}function bR(){var s=P.H,a=s.useState()[0];return a=typeof a.then=="function"?bo(a):a,s=s.useState()[0],(ut!==null?ut.memoizedState:null)!==s&&(Pe.flags|=1024),a}function tf(){var s=ql!==0;return ql=0,s}function nf(s,a,c){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~c}function sf(s){if(Yl){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Yl=!1}Ws=0,Ft=ut=Pe=null,la=!1,So=ql=0,ca=null}function gn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?Pe.memoizedState=Ft=s:Ft=Ft.next=s,Ft}function kt(){if(ut===null){var s=Pe.alternate;s=s!==null?s.memoizedState:null}else s=ut.next;var a=Ft===null?Pe.memoizedState:Ft.next;if(a!==null)Ft=a,ut=s;else{if(s===null)throw Pe.alternate===null?Error(n(467)):Error(n(310));ut=s,s={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},Ft===null?Pe.memoizedState=Ft=s:Ft=Ft.next=s}return Ft}function Xl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function bo(s){var a=So;return So+=1,ca===null&&(ca=[]),s=W0(ca,s,a),a=Pe,(Ft===null?a.memoizedState:Ft.next)===null&&(a=a.alternate,P.H=a===null||a.memoizedState===null?$p:pf),s}function Wl(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return bo(s);if(s.$$typeof===w)return nn(s)}throw Error(n(438,String(s)))}function rf(s){var a=null,c=Pe.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var h=Pe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(v){return v.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=Xl(),Pe.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(s),h=0;h<s;h++)c[h]=F;return a.index++,c}function Qs(s,a){return typeof a=="function"?a(s):a}function Ql(s){var a=kt();return af(a,ut,s)}function af(s,a,c){var h=s.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var v=s.baseQueue,x=h.pending;if(x!==null){if(v!==null){var C=v.next;v.next=x.next,x.next=C}a.baseQueue=v=x,h.pending=null}if(x=s.baseState,v===null)s.memoizedState=x;else{a=v.next;var I=C=null,$=null,Z=a,re=!1;do{var ue=Z.lane&-536870913;if(ue!==Z.lane?(Ve&ue)===ue:(Ws&ue)===ue){var ee=Z.revertLane;if(ee===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),ue===sa&&(re=!0);else if((Ws&ee)===ee){Z=Z.next,ee===sa&&(re=!0);continue}else ue={lane:0,revertLane:Z.revertLane,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},$===null?(I=$=ue,C=x):$=$.next=ue,Pe.lanes|=ee,_i|=ee;ue=Z.action,yr&&c(x,ue),x=Z.hasEagerState?Z.eagerState:c(x,ue)}else ee={lane:ue,revertLane:Z.revertLane,gesture:Z.gesture,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},$===null?(I=$=ee,C=x):$=$.next=ee,Pe.lanes|=ue,_i|=ue;Z=Z.next}while(Z!==null&&Z!==a);if($===null?C=x:$.next=I,!On(x,s.memoizedState)&&(Bt=!0,re&&(c=ia,c!==null)))throw c;s.memoizedState=x,s.baseState=C,s.baseQueue=$,h.lastRenderedState=x}return v===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function of(s){var a=kt(),c=a.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,v=c.pending,x=a.memoizedState;if(v!==null){c.pending=null;var C=v=v.next;do x=s(x,C.action),C=C.next;while(C!==v);On(x,a.memoizedState)||(Bt=!0),a.memoizedState=x,a.baseQueue===null&&(a.baseState=x),c.lastRenderedState=x}return[x,h]}function op(s,a,c){var h=Pe,v=kt(),x=We;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=a();var C=!On((ut||v).memoizedState,c);if(C&&(v.memoizedState=c,Bt=!0),v=v.queue,uf(up.bind(null,h,v,s),[s]),v.getSnapshot!==a||C||Ft!==null&&Ft.memoizedState.tag&1){if(h.flags|=2048,ua(9,{destroy:void 0},cp.bind(null,h,v,c,a),null),mt===null)throw Error(n(349));x||(Ws&127)!==0||lp(h,a,c)}return c}function lp(s,a,c){s.flags|=16384,s={getSnapshot:a,value:c},a=Pe.updateQueue,a===null?(a=Xl(),Pe.updateQueue=a,a.stores=[s]):(c=a.stores,c===null?a.stores=[s]:c.push(s))}function cp(s,a,c,h){a.value=c,a.getSnapshot=h,dp(a)&&fp(s)}function up(s,a,c){return c(function(){dp(a)&&fp(s)})}function dp(s){var a=s.getSnapshot;s=s.value;try{var c=a();return!On(s,c)}catch{return!0}}function fp(s){var a=cr(s,2);a!==null&&Tn(a,s,2)}function lf(s){var a=gn();if(typeof s=="function"){var c=s;if(s=c(),yr){Nn(!0);try{c()}finally{Nn(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qs,lastRenderedState:s},a}function hp(s,a,c,h){return s.baseState=c,af(s,ut,typeof h=="function"?h:Qs)}function TR(s,a,c,h,v){if(ec(s))throw Error(n(485));if(s=a.action,s!==null){var x={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){x.listeners.push(C)}};P.T!==null?c(!0):x.isTransition=!1,h(x),c=a.pending,c===null?(x.next=a.pending=x,mp(a,x)):(x.next=c.next,a.pending=c.next=x)}}function mp(s,a){var c=a.action,h=a.payload,v=s.state;if(a.isTransition){var x=P.T,C={};P.T=C;try{var I=c(v,h),$=P.S;$!==null&&$(C,I),gp(s,a,I)}catch(Z){cf(s,a,Z)}finally{x!==null&&C.types!==null&&(x.types=C.types),P.T=x}}else try{x=c(v,h),gp(s,a,x)}catch(Z){cf(s,a,Z)}}function gp(s,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){pp(s,a,h)},function(h){return cf(s,a,h)}):pp(s,a,c)}function pp(s,a,c){a.status="fulfilled",a.value=c,vp(a),s.state=c,a=s.pending,a!==null&&(c=a.next,c===a?s.pending=null:(c=c.next,a.next=c,mp(s,c)))}function cf(s,a,c){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=c,vp(a),a=a.next;while(a!==h)}s.action=null}function vp(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function yp(s,a){return a}function xp(s,a){if(We){var c=mt.formState;if(c!==null){e:{var h=Pe;if(We){if(Et){t:{for(var v=Et,x=Jn;v.nodeType!==8;){if(!x){v=null;break t}if(v=ts(v.nextSibling),v===null){v=null;break t}}x=v.data,v=x==="F!"||x==="F"?v:null}if(v){Et=ts(v.nextSibling),h=v.data==="F!";break e}}xi(h)}h=!1}h&&(a=c[0])}}return c=gn(),c.memoizedState=c.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yp,lastRenderedState:a},c.queue=h,c=Fp.bind(null,Pe,h),h.dispatch=c,h=lf(!1),x=gf.bind(null,Pe,!1,h.queue),h=gn(),v={state:a,dispatch:null,action:s,pending:null},h.queue=v,c=TR.bind(null,Pe,v,x,c),v.dispatch=c,h.memoizedState=s,[a,c,!1]}function Ep(s){var a=kt();return Sp(a,ut,s)}function Sp(s,a,c){if(a=af(s,a,yp)[0],s=Ql(Qs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=bo(a)}catch(C){throw C===ra?$l:C}else h=a;a=kt();var v=a.queue,x=v.dispatch;return c!==a.memoizedState&&(Pe.flags|=2048,ua(9,{destroy:void 0},AR.bind(null,v,c),null)),[h,x,s]}function AR(s,a){s.action=a}function bp(s){var a=kt(),c=ut;if(c!==null)return Sp(a,c,s);kt(),a=a.memoizedState,c=kt();var h=c.queue.dispatch;return c.memoizedState=s,[a,h,!1]}function ua(s,a,c,h){return s={tag:s,create:c,deps:h,inst:a,next:null},a=Pe.updateQueue,a===null&&(a=Xl(),Pe.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,a.lastEffect=s),s}function Tp(){return kt().memoizedState}function Zl(s,a,c,h){var v=gn();Pe.flags|=s,v.memoizedState=ua(1|a,{destroy:void 0},c,h===void 0?null:h)}function Jl(s,a,c,h){var v=kt();h=h===void 0?null:h;var x=v.memoizedState.inst;ut!==null&&h!==null&&Jd(h,ut.memoizedState.deps)?v.memoizedState=ua(a,x,c,h):(Pe.flags|=s,v.memoizedState=ua(1|a,x,c,h))}function Ap(s,a){Zl(8390656,8,s,a)}function uf(s,a){Jl(2048,8,s,a)}function RR(s){Pe.flags|=4;var a=Pe.updateQueue;if(a===null)a=Xl(),Pe.updateQueue=a,a.events=[s];else{var c=a.events;c===null?a.events=[s]:c.push(s)}}function Rp(s){var a=kt().memoizedState;return RR({ref:a,nextImpl:s}),function(){if((st&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function Cp(s,a){return Jl(4,2,s,a)}function Lp(s,a){return Jl(4,4,s,a)}function _p(s,a){if(typeof a=="function"){s=s();var c=a(s);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function wp(s,a,c){c=c!=null?c.concat([s]):null,Jl(4,4,_p.bind(null,a,s),c)}function df(){}function Dp(s,a){var c=kt();a=a===void 0?null:a;var h=c.memoizedState;return a!==null&&Jd(a,h[1])?h[0]:(c.memoizedState=[s,a],s)}function Ip(s,a){var c=kt();a=a===void 0?null:a;var h=c.memoizedState;if(a!==null&&Jd(a,h[1]))return h[0];if(h=s(),yr){Nn(!0);try{s()}finally{Nn(!1)}}return c.memoizedState=[h,a],h}function ff(s,a,c){return c===void 0||(Ws&1073741824)!==0&&(Ve&261930)===0?s.memoizedState=a:(s.memoizedState=c,s=Nv(),Pe.lanes|=s,_i|=s,c)}function Np(s,a,c,h){return On(c,a)?c:oa.current!==null?(s=ff(s,c,h),On(s,a)||(Bt=!0),s):(Ws&42)===0||(Ws&1073741824)!==0&&(Ve&261930)===0?(Bt=!0,s.memoizedState=c):(s=Nv(),Pe.lanes|=s,_i|=s,a)}function Op(s,a,c,h,v){var x=K.p;K.p=x!==0&&8>x?x:8;var C=P.T,I={};P.T=I,gf(s,!1,a,c);try{var $=v(),Z=P.S;if(Z!==null&&Z(I,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var re=ER($,h);To(s,a,re,Bn(s))}else To(s,a,h,Bn(s))}catch(ue){To(s,a,{then:function(){},status:"rejected",reason:ue},Bn())}finally{K.p=x,C!==null&&I.types!==null&&(C.types=I.types),P.T=C}}function CR(){}function hf(s,a,c,h){if(s.tag!==5)throw Error(n(476));var v=Mp(s).queue;Op(s,v,a,j,c===null?CR:function(){return kp(s),c(h)})}function Mp(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qs,lastRenderedState:j},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Qs,lastRenderedState:c},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function kp(s){var a=Mp(s);a.next===null&&(a=s.alternate.memoizedState),To(s,a.next.queue,{},Bn())}function mf(){return nn(jo)}function Pp(){return kt().memoizedState}function Up(){return kt().memoizedState}function LR(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var c=Bn();s=bi(c);var h=Ti(a,s,c);h!==null&&(Tn(h,a,c),yo(h,a,c)),a={cache:Gd()},s.payload=a;return}a=a.return}}function _R(s,a,c){var h=Bn();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ec(s)?Bp(a,c):(c=Id(s,a,c,h),c!==null&&(Tn(c,s,h),jp(c,a,h)))}function Fp(s,a,c){var h=Bn();To(s,a,c,h)}function To(s,a,c,h){var v={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(ec(s))Bp(a,v);else{var x=s.alternate;if(s.lanes===0&&(x===null||x.lanes===0)&&(x=a.lastRenderedReducer,x!==null))try{var C=a.lastRenderedState,I=x(C,c);if(v.hasEagerState=!0,v.eagerState=I,On(I,C))return Ml(s,a,v,0),mt===null&&Ol(),!1}catch{}if(c=Id(s,a,v,h),c!==null)return Tn(c,s,h),jp(c,a,h),!0}return!1}function gf(s,a,c,h){if(h={lane:2,revertLane:Yf(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},ec(s)){if(a)throw Error(n(479))}else a=Id(s,c,h,2),a!==null&&Tn(a,s,2)}function ec(s){var a=s.alternate;return s===Pe||a!==null&&a===Pe}function Bp(s,a){la=Yl=!0;var c=s.pending;c===null?a.next=a:(a.next=c.next,c.next=a),s.pending=a}function jp(s,a,c){if((c&4194048)!==0){var h=a.lanes;h&=s.pendingLanes,c|=h,a.lanes=c,_t(s,c)}}var Ao={readContext:nn,use:Wl,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useLayoutEffect:wt,useInsertionEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useSyncExternalStore:wt,useId:wt,useHostTransitionStatus:wt,useFormState:wt,useActionState:wt,useOptimistic:wt,useMemoCache:wt,useCacheRefresh:wt};Ao.useEffectEvent=wt;var $p={readContext:nn,use:Wl,useCallback:function(s,a){return gn().memoizedState=[s,a===void 0?null:a],s},useContext:nn,useEffect:Ap,useImperativeHandle:function(s,a,c){c=c!=null?c.concat([s]):null,Zl(4194308,4,_p.bind(null,a,s),c)},useLayoutEffect:function(s,a){return Zl(4194308,4,s,a)},useInsertionEffect:function(s,a){Zl(4,2,s,a)},useMemo:function(s,a){var c=gn();a=a===void 0?null:a;var h=s();if(yr){Nn(!0);try{s()}finally{Nn(!1)}}return c.memoizedState=[h,a],h},useReducer:function(s,a,c){var h=gn();if(c!==void 0){var v=c(a);if(yr){Nn(!0);try{c(a)}finally{Nn(!1)}}}else v=a;return h.memoizedState=h.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},h.queue=s,s=s.dispatch=_R.bind(null,Pe,s),[h.memoizedState,s]},useRef:function(s){var a=gn();return s={current:s},a.memoizedState=s},useState:function(s){s=lf(s);var a=s.queue,c=Fp.bind(null,Pe,a);return a.dispatch=c,[s.memoizedState,c]},useDebugValue:df,useDeferredValue:function(s,a){var c=gn();return ff(c,s,a)},useTransition:function(){var s=lf(!1);return s=Op.bind(null,Pe,s.queue,!0,!1),gn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,c){var h=Pe,v=gn();if(We){if(c===void 0)throw Error(n(407));c=c()}else{if(c=a(),mt===null)throw Error(n(349));(Ve&127)!==0||lp(h,a,c)}v.memoizedState=c;var x={value:c,getSnapshot:a};return v.queue=x,Ap(up.bind(null,h,x,s),[s]),h.flags|=2048,ua(9,{destroy:void 0},cp.bind(null,h,x,c,a),null),c},useId:function(){var s=gn(),a=mt.identifierPrefix;if(We){var c=Rs,h=As;c=(h&~(1<<32-mn(h)-1)).toString(32)+c,a="_"+a+"R_"+c,c=ql++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=SR++,a="_"+a+"r_"+c.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:mf,useFormState:xp,useActionState:xp,useOptimistic:function(s){var a=gn();a.memoizedState=a.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=gf.bind(null,Pe,!0,c),c.dispatch=a,[s,a]},useMemoCache:rf,useCacheRefresh:function(){return gn().memoizedState=LR.bind(null,Pe)},useEffectEvent:function(s){var a=gn(),c={impl:s};return a.memoizedState=c,function(){if((st&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},pf={readContext:nn,use:Wl,useCallback:Dp,useContext:nn,useEffect:uf,useImperativeHandle:wp,useInsertionEffect:Cp,useLayoutEffect:Lp,useMemo:Ip,useReducer:Ql,useRef:Tp,useState:function(){return Ql(Qs)},useDebugValue:df,useDeferredValue:function(s,a){var c=kt();return Np(c,ut.memoizedState,s,a)},useTransition:function(){var s=Ql(Qs)[0],a=kt().memoizedState;return[typeof s=="boolean"?s:bo(s),a]},useSyncExternalStore:op,useId:Pp,useHostTransitionStatus:mf,useFormState:Ep,useActionState:Ep,useOptimistic:function(s,a){var c=kt();return hp(c,ut,s,a)},useMemoCache:rf,useCacheRefresh:Up};pf.useEffectEvent=Rp;var Gp={readContext:nn,use:Wl,useCallback:Dp,useContext:nn,useEffect:uf,useImperativeHandle:wp,useInsertionEffect:Cp,useLayoutEffect:Lp,useMemo:Ip,useReducer:of,useRef:Tp,useState:function(){return of(Qs)},useDebugValue:df,useDeferredValue:function(s,a){var c=kt();return ut===null?ff(c,s,a):Np(c,ut.memoizedState,s,a)},useTransition:function(){var s=of(Qs)[0],a=kt().memoizedState;return[typeof s=="boolean"?s:bo(s),a]},useSyncExternalStore:op,useId:Pp,useHostTransitionStatus:mf,useFormState:bp,useActionState:bp,useOptimistic:function(s,a){var c=kt();return ut!==null?hp(c,ut,s,a):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:rf,useCacheRefresh:Up};Gp.useEffectEvent=Rp;function vf(s,a,c,h){a=s.memoizedState,c=c(h,a),c=c==null?a:g({},a,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var yf={enqueueSetState:function(s,a,c){s=s._reactInternals;var h=Bn(),v=bi(h);v.payload=a,c!=null&&(v.callback=c),a=Ti(s,v,h),a!==null&&(Tn(a,s,h),yo(a,s,h))},enqueueReplaceState:function(s,a,c){s=s._reactInternals;var h=Bn(),v=bi(h);v.tag=1,v.payload=a,c!=null&&(v.callback=c),a=Ti(s,v,h),a!==null&&(Tn(a,s,h),yo(a,s,h))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var c=Bn(),h=bi(c);h.tag=2,a!=null&&(h.callback=a),a=Ti(s,h,c),a!==null&&(Tn(a,s,c),yo(a,s,c))}};function zp(s,a,c,h,v,x,C){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,x,C):a.prototype&&a.prototype.isPureReactComponent?!co(c,h)||!co(v,x):!0}function Hp(s,a,c,h){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,h),a.state!==s&&yf.enqueueReplaceState(a,a.state,null)}function xr(s,a){var c=a;if("ref"in a){c={};for(var h in a)h!=="ref"&&(c[h]=a[h])}if(s=s.defaultProps){c===a&&(c=g({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}function Vp(s){Nl(s)}function Kp(s){console.error(s)}function Yp(s){Nl(s)}function tc(s,a){try{var c=s.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function qp(s,a,c){try{var h=s.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function xf(s,a,c){return c=bi(c),c.tag=3,c.payload={element:null},c.callback=function(){tc(s,a)},c}function Xp(s){return s=bi(s),s.tag=3,s}function Wp(s,a,c,h){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var x=h.value;s.payload=function(){return v(x)},s.callback=function(){qp(a,c,h)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(s.callback=function(){qp(a,c,h),typeof v!="function"&&(wi===null?wi=new Set([this]):wi.add(this));var I=h.stack;this.componentDidCatch(h.value,{componentStack:I!==null?I:""})})}function wR(s,a,c,h,v){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=c.alternate,a!==null&&na(a,c,v,!0),c=kn.current,c!==null){switch(c.tag){case 31:case 13:return es===null?hc():c.alternate===null&&Dt===0&&(Dt=3),c.flags&=-257,c.flags|=65536,c.lanes=v,h===Gl?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([h]):a.add(h),Hf(s,h,v)),!1;case 22:return c.flags|=65536,h===Gl?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([h]):c.add(h)),Hf(s,h,v)),!1}throw Error(n(435,c.tag))}return Hf(s,h,v),hc(),!1}if(We)return a=kn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=v,h!==Ud&&(s=Error(n(422),{cause:h}),ho(Wn(s,c)))):(h!==Ud&&(a=Error(n(423),{cause:h}),ho(Wn(a,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,h=Wn(h,c),v=xf(s.stateNode,h,v),qd(s,v),Dt!==4&&(Dt=2)),!1;var x=Error(n(520),{cause:h});if(x=Wn(x,c),No===null?No=[x]:No.push(x),Dt!==4&&(Dt=2),a===null)return!0;h=Wn(h,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=xf(c.stateNode,h,s),qd(c,s),!1;case 1:if(a=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(wi===null||!wi.has(x))))return c.flags|=65536,v&=-v,c.lanes|=v,v=Xp(v),Wp(v,s,c,h),qd(c,v),!1}c=c.return}while(c!==null);return!1}var Ef=Error(n(461)),Bt=!1;function sn(s,a,c,h){a.child=s===null?ep(a,null,c,h):vr(a,s.child,c,h)}function Qp(s,a,c,h,v){c=c.render;var x=a.ref;if("ref"in h){var C={};for(var I in h)I!=="ref"&&(C[I]=h[I])}else C=h;return hr(a),h=ef(s,a,c,C,x,v),I=tf(),s!==null&&!Bt?(nf(s,a,v),Zs(s,a,v)):(We&&I&&kd(a),a.flags|=1,sn(s,a,h,v),a.child)}function Zp(s,a,c,h,v){if(s===null){var x=c.type;return typeof x=="function"&&!Nd(x)&&x.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=x,Jp(s,a,x,h,v)):(s=Pl(c.type,null,h,a,a.mode,v),s.ref=a.ref,s.return=a,a.child=s)}if(x=s.child,!_f(s,v)){var C=x.memoizedProps;if(c=c.compare,c=c!==null?c:co,c(C,h)&&s.ref===a.ref)return Zs(s,a,v)}return a.flags|=1,s=Ks(x,h),s.ref=a.ref,s.return=a,a.child=s}function Jp(s,a,c,h,v){if(s!==null){var x=s.memoizedProps;if(co(x,h)&&s.ref===a.ref)if(Bt=!1,a.pendingProps=h=x,_f(s,v))(s.flags&131072)!==0&&(Bt=!0);else return a.lanes=s.lanes,Zs(s,a,v)}return Sf(s,a,c,h,v)}function ev(s,a,c,h){var v=h.children,x=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((a.flags&128)!==0){if(x=x!==null?x.baseLanes|c:c,s!==null){for(h=a.child=s.child,v=0;h!==null;)v=v|h.lanes|h.childLanes,h=h.sibling;h=v&~x}else h=0,a.child=null;return tv(s,a,x,c,h)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&jl(a,x!==null?x.cachePool:null),x!==null?sp(a,x):Wd(),ip(a);else return h=a.lanes=536870912,tv(s,a,x!==null?x.baseLanes|c:c,c,h)}else x!==null?(jl(a,x.cachePool),sp(a,x),Ri(),a.memoizedState=null):(s!==null&&jl(a,null),Wd(),Ri());return sn(s,a,v,c),a.child}function Ro(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function tv(s,a,c,h,v){var x=Hd();return x=x===null?null:{parent:Ut._currentValue,pool:x},a.memoizedState={baseLanes:c,cachePool:x},s!==null&&jl(a,null),Wd(),ip(a),s!==null&&na(s,a,h,!0),a.childLanes=v,null}function nc(s,a){return a=ic({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function nv(s,a,c){return vr(a,s.child,null,c),s=nc(a,a.pendingProps),s.flags|=2,Pn(a),a.memoizedState=null,s}function DR(s,a,c){var h=a.pendingProps,v=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(We){if(h.mode==="hidden")return s=nc(a,h),a.lanes=536870912,Ro(null,s);if(Zd(a),(s=Et)?(s=my(s,Jn),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:vi!==null?{id:As,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},c=B0(s),c.return=a,a.child=c,tn=a,Et=null)):s=null,s===null)throw xi(a);return a.lanes=536870912,null}return nc(a,h)}var x=s.memoizedState;if(x!==null){var C=x.dehydrated;if(Zd(a),v)if(a.flags&256)a.flags&=-257,a=nv(s,a,c);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(n(558));else if(Bt||na(s,a,c,!1),v=(c&s.childLanes)!==0,Bt||v){if(h=mt,h!==null&&(C=Ur(h,c),C!==0&&C!==x.retryLane))throw x.retryLane=C,cr(s,C),Tn(h,s,C),Ef;hc(),a=nv(s,a,c)}else s=x.treeContext,Et=ts(C.nextSibling),tn=a,We=!0,yi=null,Jn=!1,s!==null&&G0(a,s),a=nc(a,h),a.flags|=4096;return a}return s=Ks(s.child,{mode:h.mode,children:h.children}),s.ref=a.ref,a.child=s,s.return=a,s}function sc(s,a){var c=a.ref;if(c===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(a.flags|=4194816)}}function Sf(s,a,c,h,v){return hr(a),c=ef(s,a,c,h,void 0,v),h=tf(),s!==null&&!Bt?(nf(s,a,v),Zs(s,a,v)):(We&&h&&kd(a),a.flags|=1,sn(s,a,c,v),a.child)}function sv(s,a,c,h,v,x){return hr(a),a.updateQueue=null,c=ap(a,h,c,v),rp(s),h=tf(),s!==null&&!Bt?(nf(s,a,x),Zs(s,a,x)):(We&&h&&kd(a),a.flags|=1,sn(s,a,c,x),a.child)}function iv(s,a,c,h,v){if(hr(a),a.stateNode===null){var x=Zr,C=c.contextType;typeof C=="object"&&C!==null&&(x=nn(C)),x=new c(h,x),a.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=yf,a.stateNode=x,x._reactInternals=a,x=a.stateNode,x.props=h,x.state=a.memoizedState,x.refs={},Kd(a),C=c.contextType,x.context=typeof C=="object"&&C!==null?nn(C):Zr,x.state=a.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(vf(a,c,C,h),x.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(C=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),C!==x.state&&yf.enqueueReplaceState(x,x.state,null),Eo(a,h,x,v),xo(),x.state=a.memoizedState),typeof x.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(s===null){x=a.stateNode;var I=a.memoizedProps,$=xr(c,I);x.props=$;var Z=x.context,re=c.contextType;C=Zr,typeof re=="object"&&re!==null&&(C=nn(re));var ue=c.getDerivedStateFromProps;re=typeof ue=="function"||typeof x.getSnapshotBeforeUpdate=="function",I=a.pendingProps!==I,re||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(I||Z!==C)&&Hp(a,x,h,C),Si=!1;var ee=a.memoizedState;x.state=ee,Eo(a,h,x,v),xo(),Z=a.memoizedState,I||ee!==Z||Si?(typeof ue=="function"&&(vf(a,c,ue,h),Z=a.memoizedState),($=Si||zp(a,c,$,h,ee,Z,C))?(re||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(a.flags|=4194308)):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=Z),x.props=h,x.state=Z,x.context=C,h=$):(typeof x.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{x=a.stateNode,Yd(s,a),C=a.memoizedProps,re=xr(c,C),x.props=re,ue=a.pendingProps,ee=x.context,Z=c.contextType,$=Zr,typeof Z=="object"&&Z!==null&&($=nn(Z)),I=c.getDerivedStateFromProps,(Z=typeof I=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(C!==ue||ee!==$)&&Hp(a,x,h,$),Si=!1,ee=a.memoizedState,x.state=ee,Eo(a,h,x,v),xo();var ie=a.memoizedState;C!==ue||ee!==ie||Si||s!==null&&s.dependencies!==null&&Fl(s.dependencies)?(typeof I=="function"&&(vf(a,c,I,h),ie=a.memoizedState),(re=Si||zp(a,c,re,h,ee,ie,$)||s!==null&&s.dependencies!==null&&Fl(s.dependencies))?(Z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,ie,$),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,ie,$)),typeof x.componentDidUpdate=="function"&&(a.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof x.componentDidUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=ie),x.props=h,x.state=ie,x.context=$,h=re):(typeof x.componentDidUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(a.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&ee===s.memoizedState||(a.flags|=1024),h=!1)}return x=h,sc(s,a),h=(a.flags&128)!==0,x||h?(x=a.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:x.render(),a.flags|=1,s!==null&&h?(a.child=vr(a,s.child,null,v),a.child=vr(a,null,c,v)):sn(s,a,c,v),a.memoizedState=x.state,s=a.child):s=Zs(s,a,v),s}function rv(s,a,c,h){return dr(),a.flags|=256,sn(s,a,c,h),a.child}var bf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Tf(s){return{baseLanes:s,cachePool:q0()}}function Af(s,a,c){return s=s!==null?s.childLanes&~c:0,a&&(s|=Fn),s}function av(s,a,c){var h=a.pendingProps,v=!1,x=(a.flags&128)!==0,C;if((C=x)||(C=s!==null&&s.memoizedState===null?!1:(Mt.current&2)!==0),C&&(v=!0,a.flags&=-129),C=(a.flags&32)!==0,a.flags&=-33,s===null){if(We){if(v?Ai(a):Ri(),(s=Et)?(s=my(s,Jn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:vi!==null?{id:As,overflow:Rs}:null,retryLane:536870912,hydrationErrors:null},c=B0(s),c.return=a,a.child=c,tn=a,Et=null)):s=null,s===null)throw xi(a);return ah(s)?a.lanes=32:a.lanes=536870912,null}var I=h.children;return h=h.fallback,v?(Ri(),v=a.mode,I=ic({mode:"hidden",children:I},v),h=ur(h,v,c,null),I.return=a,h.return=a,I.sibling=h,a.child=I,h=a.child,h.memoizedState=Tf(c),h.childLanes=Af(s,C,c),a.memoizedState=bf,Ro(null,h)):(Ai(a),Rf(a,I))}var $=s.memoizedState;if($!==null&&(I=$.dehydrated,I!==null)){if(x)a.flags&256?(Ai(a),a.flags&=-257,a=Cf(s,a,c)):a.memoizedState!==null?(Ri(),a.child=s.child,a.flags|=128,a=null):(Ri(),I=h.fallback,v=a.mode,h=ic({mode:"visible",children:h.children},v),I=ur(I,v,c,null),I.flags|=2,h.return=a,I.return=a,h.sibling=I,a.child=h,vr(a,s.child,null,c),h=a.child,h.memoizedState=Tf(c),h.childLanes=Af(s,C,c),a.memoizedState=bf,a=Ro(null,h));else if(Ai(a),ah(I)){if(C=I.nextSibling&&I.nextSibling.dataset,C)var Z=C.dgst;C=Z,h=Error(n(419)),h.stack="",h.digest=C,ho({value:h,source:null,stack:null}),a=Cf(s,a,c)}else if(Bt||na(s,a,c,!1),C=(c&s.childLanes)!==0,Bt||C){if(C=mt,C!==null&&(h=Ur(C,c),h!==0&&h!==$.retryLane))throw $.retryLane=h,cr(s,h),Tn(C,s,h),Ef;rh(I)||hc(),a=Cf(s,a,c)}else rh(I)?(a.flags|=192,a.child=s.child,a=null):(s=$.treeContext,Et=ts(I.nextSibling),tn=a,We=!0,yi=null,Jn=!1,s!==null&&G0(a,s),a=Rf(a,h.children),a.flags|=4096);return a}return v?(Ri(),I=h.fallback,v=a.mode,$=s.child,Z=$.sibling,h=Ks($,{mode:"hidden",children:h.children}),h.subtreeFlags=$.subtreeFlags&65011712,Z!==null?I=Ks(Z,I):(I=ur(I,v,c,null),I.flags|=2),I.return=a,h.return=a,h.sibling=I,a.child=h,Ro(null,h),h=a.child,I=s.child.memoizedState,I===null?I=Tf(c):(v=I.cachePool,v!==null?($=Ut._currentValue,v=v.parent!==$?{parent:$,pool:$}:v):v=q0(),I={baseLanes:I.baseLanes|c,cachePool:v}),h.memoizedState=I,h.childLanes=Af(s,C,c),a.memoizedState=bf,Ro(s.child,h)):(Ai(a),c=s.child,s=c.sibling,c=Ks(c,{mode:"visible",children:h.children}),c.return=a,c.sibling=null,s!==null&&(C=a.deletions,C===null?(a.deletions=[s],a.flags|=16):C.push(s)),a.child=c,a.memoizedState=null,c)}function Rf(s,a){return a=ic({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function ic(s,a){return s=Mn(22,s,null,a),s.lanes=0,s}function Cf(s,a,c){return vr(a,s.child,null,c),s=Rf(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function ov(s,a,c){s.lanes|=a;var h=s.alternate;h!==null&&(h.lanes|=a),jd(s.return,a,c)}function Lf(s,a,c,h,v,x){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:v,treeForkCount:x}:(C.isBackwards=a,C.rendering=null,C.renderingStartTime=0,C.last=h,C.tail=c,C.tailMode=v,C.treeForkCount=x)}function lv(s,a,c){var h=a.pendingProps,v=h.revealOrder,x=h.tail;h=h.children;var C=Mt.current,I=(C&2)!==0;if(I?(C=C&1|2,a.flags|=128):C&=1,te(Mt,C),sn(s,a,h,c),h=We?fo:0,!I&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&ov(s,c,a);else if(s.tag===19)ov(s,c,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(c=a.child,v=null;c!==null;)s=c.alternate,s!==null&&Kl(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=a.child,a.child=null):(v=c.sibling,c.sibling=null),Lf(a,!1,v,c,x,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=a.child,a.child=null;v!==null;){if(s=v.alternate,s!==null&&Kl(s)===null){a.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Lf(a,!0,c,null,x,h);break;case"together":Lf(a,!1,null,null,void 0,h);break;default:a.memoizedState=null}return a.child}function Zs(s,a,c){if(s!==null&&(a.dependencies=s.dependencies),_i|=a.lanes,(c&a.childLanes)===0)if(s!==null){if(na(s,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(n(153));if(a.child!==null){for(s=a.child,c=Ks(s,s.pendingProps),a.child=c,c.return=a;s.sibling!==null;)s=s.sibling,c=c.sibling=Ks(s,s.pendingProps),c.return=a;c.sibling=null}return a.child}function _f(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&Fl(s)))}function IR(s,a,c){switch(a.tag){case 3:ve(a,a.stateNode.containerInfo),Ei(a,Ut,s.memoizedState.cache),dr();break;case 27:case 5:Qe(a);break;case 4:ve(a,a.stateNode.containerInfo);break;case 10:Ei(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Zd(a),null;break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(Ai(a),a.flags|=128,null):(c&a.child.childLanes)!==0?av(s,a,c):(Ai(a),s=Zs(s,a,c),s!==null?s.sibling:null);Ai(a);break;case 19:var v=(s.flags&128)!==0;if(h=(c&a.childLanes)!==0,h||(na(s,a,c,!1),h=(c&a.childLanes)!==0),v){if(h)return lv(s,a,c);a.flags|=128}if(v=a.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),te(Mt,Mt.current),h)break;return null;case 22:return a.lanes=0,ev(s,a,c,a.pendingProps);case 24:Ei(a,Ut,s.memoizedState.cache)}return Zs(s,a,c)}function cv(s,a,c){if(s!==null)if(s.memoizedProps!==a.pendingProps)Bt=!0;else{if(!_f(s,c)&&(a.flags&128)===0)return Bt=!1,IR(s,a,c);Bt=(s.flags&131072)!==0}else Bt=!1,We&&(a.flags&1048576)!==0&&$0(a,fo,a.index);switch(a.lanes=0,a.tag){case 16:e:{var h=a.pendingProps;if(s=gr(a.elementType),a.type=s,typeof s=="function")Nd(s)?(h=xr(s,h),a.tag=1,a=iv(null,a,s,h,c)):(a.tag=0,a=Sf(null,a,s,h,c));else{if(s!=null){var v=s.$$typeof;if(v===D){a.tag=11,a=Qp(null,a,s,h,c);break e}else if(v===N){a.tag=14,a=Zp(null,a,s,h,c);break e}}throw a=le(s)||s,Error(n(306,a,""))}}return a;case 0:return Sf(s,a,a.type,a.pendingProps,c);case 1:return h=a.type,v=xr(h,a.pendingProps),iv(s,a,h,v,c);case 3:e:{if(ve(a,a.stateNode.containerInfo),s===null)throw Error(n(387));h=a.pendingProps;var x=a.memoizedState;v=x.element,Yd(s,a),Eo(a,h,null,c);var C=a.memoizedState;if(h=C.cache,Ei(a,Ut,h),h!==x.cache&&$d(a,[Ut],c,!0),xo(),h=C.element,x.isDehydrated)if(x={element:h,isDehydrated:!1,cache:C.cache},a.updateQueue.baseState=x,a.memoizedState=x,a.flags&256){a=rv(s,a,h,c);break e}else if(h!==v){v=Wn(Error(n(424)),a),ho(v),a=rv(s,a,h,c);break e}else for(s=a.stateNode.containerInfo,s.nodeType===9?s=s.body:s=s.nodeName==="HTML"?s.ownerDocument.body:s,Et=ts(s.firstChild),tn=a,We=!0,yi=null,Jn=!0,c=ep(a,null,h,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(dr(),h===v){a=Zs(s,a,c);break e}sn(s,a,h,c)}a=a.child}return a;case 26:return sc(s,a),s===null?(c=Ey(a.type,null,a.pendingProps,null))?a.memoizedState=c:We||(c=a.type,s=a.pendingProps,h=Ec(ce.current).createElement(c),h[en]=a,h[vn]=s,rn(h,c,s),Wt(h),a.stateNode=h):a.memoizedState=Ey(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Qe(a),s===null&&We&&(h=a.stateNode=vy(a.type,a.pendingProps,ce.current),tn=a,Jn=!0,v=Et,Oi(a.type)?(oh=v,Et=ts(h.firstChild)):Et=v),sn(s,a,a.pendingProps.children,c),sc(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&We&&((v=h=Et)&&(h=oC(h,a.type,a.pendingProps,Jn),h!==null?(a.stateNode=h,tn=a,Et=ts(h.firstChild),Jn=!1,v=!0):v=!1),v||xi(a)),Qe(a),v=a.type,x=a.pendingProps,C=s!==null?s.memoizedProps:null,h=x.children,nh(v,x)?h=null:C!==null&&nh(v,C)&&(a.flags|=32),a.memoizedState!==null&&(v=ef(s,a,bR,null,null,c),jo._currentValue=v),sc(s,a),sn(s,a,h,c),a.child;case 6:return s===null&&We&&((s=c=Et)&&(c=lC(c,a.pendingProps,Jn),c!==null?(a.stateNode=c,tn=a,Et=null,s=!0):s=!1),s||xi(a)),null;case 13:return av(s,a,c);case 4:return ve(a,a.stateNode.containerInfo),h=a.pendingProps,s===null?a.child=vr(a,null,h,c):sn(s,a,h,c),a.child;case 11:return Qp(s,a,a.type,a.pendingProps,c);case 7:return sn(s,a,a.pendingProps,c),a.child;case 8:return sn(s,a,a.pendingProps.children,c),a.child;case 12:return sn(s,a,a.pendingProps.children,c),a.child;case 10:return h=a.pendingProps,Ei(a,a.type,h.value),sn(s,a,h.children,c),a.child;case 9:return v=a.type._context,h=a.pendingProps.children,hr(a),v=nn(v),h=h(v),a.flags|=1,sn(s,a,h,c),a.child;case 14:return Zp(s,a,a.type,a.pendingProps,c);case 15:return Jp(s,a,a.type,a.pendingProps,c);case 19:return lv(s,a,c);case 31:return DR(s,a,c);case 22:return ev(s,a,c,a.pendingProps);case 24:return hr(a),h=nn(Ut),s===null?(v=Hd(),v===null&&(v=mt,x=Gd(),v.pooledCache=x,x.refCount++,x!==null&&(v.pooledCacheLanes|=c),v=x),a.memoizedState={parent:h,cache:v},Kd(a),Ei(a,Ut,v)):((s.lanes&c)!==0&&(Yd(s,a),Eo(a,null,null,c),xo()),v=s.memoizedState,x=a.memoizedState,v.parent!==h?(v={parent:h,cache:h},a.memoizedState=v,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=v),Ei(a,Ut,h)):(h=x.cache,Ei(a,Ut,h),h!==v.cache&&$d(a,[Ut],c,!0))),sn(s,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Js(s){s.flags|=4}function wf(s,a,c,h,v){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(Pv())s.flags|=8192;else throw pr=Gl,Vd}else s.flags&=-16777217}function uv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Ry(a))if(Pv())s.flags|=8192;else throw pr=Gl,Vd}function rc(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?me():536870912,s.lanes|=a,ma|=a)}function Co(s,a){if(!We)switch(s.tailMode){case"hidden":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function St(s){var a=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(a)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=h,s.childLanes=c,a}function NR(s,a,c){var h=a.pendingProps;switch(Pd(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(a),null;case 1:return St(a),null;case 3:return c=a.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),Xs(Ut),Ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(ta(a)?Js(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Fd())),St(a),null;case 26:var v=a.type,x=a.memoizedState;return s===null?(Js(a),x!==null?(St(a),uv(a,x)):(St(a),wf(a,v,null,h,c))):x?x!==s.memoizedState?(Js(a),St(a),uv(a,x)):(St(a),a.flags&=-16777217):(s=s.memoizedProps,s!==h&&Js(a),St(a),wf(a,v,s,h,c)),null;case 27:if(Ze(a),c=ce.current,v=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==h&&Js(a);else{if(!h){if(a.stateNode===null)throw Error(n(166));return St(a),null}s=V.current,ta(a)?z0(a):(s=vy(v,h,c),a.stateNode=s,Js(a))}return St(a),null;case 5:if(Ze(a),v=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==h&&Js(a);else{if(!h){if(a.stateNode===null)throw Error(n(166));return St(a),null}if(x=V.current,ta(a))z0(a);else{var C=Ec(ce.current);switch(x){case 1:x=C.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:x=C.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":x=C.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":x=C.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":x=C.createElement("div"),x.innerHTML="<script><\/script>",x=x.removeChild(x.firstChild);break;case"select":x=typeof h.is=="string"?C.createElement("select",{is:h.is}):C.createElement("select"),h.multiple?x.multiple=!0:h.size&&(x.size=h.size);break;default:x=typeof h.is=="string"?C.createElement(v,{is:h.is}):C.createElement(v)}}x[en]=a,x[vn]=h;e:for(C=a.child;C!==null;){if(C.tag===5||C.tag===6)x.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===a)break e;for(;C.sibling===null;){if(C.return===null||C.return===a)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}a.stateNode=x;e:switch(rn(x,v,h),v){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Js(a)}}return St(a),wf(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,c),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==h&&Js(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(n(166));if(s=ce.current,ta(a)){if(s=a.stateNode,c=a.memoizedProps,h=null,v=tn,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}s[en]=a,s=!!(s.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||ay(s.nodeValue,c)),s||xi(a,!0)}else s=Ec(s).createTextNode(h),s[en]=a,a.stateNode=s}return St(a),null;case 31:if(c=a.memoizedState,s===null||s.memoizedState!==null){if(h=ta(a),c!==null){if(s===null){if(!h)throw Error(n(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[en]=a}else dr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;St(a),s=!1}else c=Fd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return a.flags&256?(Pn(a),a):(Pn(a),null);if((a.flags&128)!==0)throw Error(n(558))}return St(a),null;case 13:if(h=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=ta(a),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[en]=a}else dr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;St(a),v=!1}else v=Fd(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return a.flags&256?(Pn(a),a):(Pn(a),null)}return Pn(a),(a.flags&128)!==0?(a.lanes=c,a):(c=h!==null,s=s!==null&&s.memoizedState!==null,c&&(h=a.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool),x=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(x=h.memoizedState.cachePool.pool),x!==v&&(h.flags|=2048)),c!==s&&c&&(a.child.flags|=8192),rc(a,a.updateQueue),St(a),null);case 4:return Ae(),s===null&&Qf(a.stateNode.containerInfo),St(a),null;case 10:return Xs(a.type),St(a),null;case 19:if(G(Mt),h=a.memoizedState,h===null)return St(a),null;if(v=(a.flags&128)!==0,x=h.rendering,x===null)if(v)Co(h,!1);else{if(Dt!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(x=Kl(s),x!==null){for(a.flags|=128,Co(h,!1),s=x.updateQueue,a.updateQueue=s,rc(a,s),a.subtreeFlags=0,s=c,c=a.child;c!==null;)F0(c,s),c=c.sibling;return te(Mt,Mt.current&1|2),We&&Ys(a,h.treeForkCount),a.child}s=s.sibling}h.tail!==null&&Je()>uc&&(a.flags|=128,v=!0,Co(h,!1),a.lanes=4194304)}else{if(!v)if(s=Kl(x),s!==null){if(a.flags|=128,v=!0,s=s.updateQueue,a.updateQueue=s,rc(a,s),Co(h,!0),h.tail===null&&h.tailMode==="hidden"&&!x.alternate&&!We)return St(a),null}else 2*Je()-h.renderingStartTime>uc&&c!==536870912&&(a.flags|=128,v=!0,Co(h,!1),a.lanes=4194304);h.isBackwards?(x.sibling=a.child,a.child=x):(s=h.last,s!==null?s.sibling=x:a.child=x,h.last=x)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=Je(),s.sibling=null,c=Mt.current,te(Mt,v?c&1|2:c&1),We&&Ys(a,h.treeForkCount),s):(St(a),null);case 22:case 23:return Pn(a),Qd(),h=a.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(c&536870912)!==0&&(a.flags&128)===0&&(St(a),a.subtreeFlags&6&&(a.flags|=8192)):St(a),c=a.updateQueue,c!==null&&rc(a,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==c&&(a.flags|=2048),s!==null&&G(mr),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Xs(Ut),St(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function OR(s,a){switch(Pd(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Xs(Ut),Ae(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return Ze(a),null;case 31:if(a.memoizedState!==null){if(Pn(a),a.alternate===null)throw Error(n(340));dr()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Pn(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(n(340));dr()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return G(Mt),null;case 4:return Ae(),null;case 10:return Xs(a.type),null;case 22:case 23:return Pn(a),Qd(),s!==null&&G(mr),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Xs(Ut),null;case 25:return null;default:return null}}function dv(s,a){switch(Pd(a),a.tag){case 3:Xs(Ut),Ae();break;case 26:case 27:case 5:Ze(a);break;case 4:Ae();break;case 31:a.memoizedState!==null&&Pn(a);break;case 13:Pn(a);break;case 19:G(Mt);break;case 10:Xs(a.type);break;case 22:case 23:Pn(a),Qd(),s!==null&&G(mr);break;case 24:Xs(Ut)}}function Lo(s,a){try{var c=a.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var v=h.next;c=v;do{if((c.tag&s)===s){h=void 0;var x=c.create,C=c.inst;h=x(),C.destroy=h}c=c.next}while(c!==v)}}catch(I){at(a,a.return,I)}}function Ci(s,a,c){try{var h=a.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var x=v.next;h=x;do{if((h.tag&s)===s){var C=h.inst,I=C.destroy;if(I!==void 0){C.destroy=void 0,v=a;var $=c,Z=I;try{Z()}catch(re){at(v,$,re)}}}h=h.next}while(h!==x)}}catch(re){at(a,a.return,re)}}function fv(s){var a=s.updateQueue;if(a!==null){var c=s.stateNode;try{np(a,c)}catch(h){at(s,s.return,h)}}}function hv(s,a,c){c.props=xr(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(h){at(s,a,h)}}function _o(s,a){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof c=="function"?s.refCleanup=c(h):c.current=h}}catch(v){at(s,a,v)}}function Cs(s,a){var c=s.ref,h=s.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(v){at(s,a,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){at(s,a,v)}else c.current=null}function mv(s){var a=s.type,c=s.memoizedProps,h=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(v){at(s,s.return,v)}}function Df(s,a,c){try{var h=s.stateNode;tC(h,s.type,c,a),h[vn]=a}catch(v){at(s,s.return,v)}}function gv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Oi(s.type)||s.tag===4}function If(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||gv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Oi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Nf(s,a,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(s),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Hs));else if(h!==4&&(h===27&&Oi(s.type)&&(c=s.stateNode,a=null),s=s.child,s!==null))for(Nf(s,a,c),s=s.sibling;s!==null;)Nf(s,a,c),s=s.sibling}function ac(s,a,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,a?c.insertBefore(s,a):c.appendChild(s);else if(h!==4&&(h===27&&Oi(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(ac(s,a,c),s=s.sibling;s!==null;)ac(s,a,c),s=s.sibling}function pv(s){var a=s.stateNode,c=s.memoizedProps;try{for(var h=s.type,v=a.attributes;v.length;)a.removeAttributeNode(v[0]);rn(a,h,c),a[en]=s,a[vn]=c}catch(x){at(s,s.return,x)}}var ei=!1,jt=!1,Of=!1,vv=typeof WeakSet=="function"?WeakSet:Set,Qt=null;function MR(s,a){if(s=s.containerInfo,eh=Lc,s=w0(s),Rd(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var v=h.anchorOffset,x=h.focusNode;h=h.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var C=0,I=-1,$=-1,Z=0,re=0,ue=s,ee=null;t:for(;;){for(var ie;ue!==c||v!==0&&ue.nodeType!==3||(I=C+v),ue!==x||h!==0&&ue.nodeType!==3||($=C+h),ue.nodeType===3&&(C+=ue.nodeValue.length),(ie=ue.firstChild)!==null;)ee=ue,ue=ie;for(;;){if(ue===s)break t;if(ee===c&&++Z===v&&(I=C),ee===x&&++re===h&&($=C),(ie=ue.nextSibling)!==null)break;ue=ee,ee=ue.parentNode}ue=ie}c=I===-1||$===-1?null:{start:I,end:$}}else c=null}c=c||{start:0,end:0}}else c=null;for(th={focusedElem:s,selectionRange:c},Lc=!1,Qt=a;Qt!==null;)if(a=Qt,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Qt=s;else for(;Qt!==null;){switch(a=Qt,x=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)v=s[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&x!==null){s=void 0,c=a,v=x.memoizedProps,x=x.memoizedState,h=c.stateNode;try{var ye=xr(c.type,v);s=h.getSnapshotBeforeUpdate(ye,x),h.__reactInternalSnapshotBeforeUpdate=s}catch(De){at(c,c.return,De)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,c=s.nodeType,c===9)ih(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ih(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=a.sibling,s!==null){s.return=a.return,Qt=s;break}Qt=a.return}}function yv(s,a,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:ni(s,c),h&4&&Lo(5,c);break;case 1:if(ni(s,c),h&4)if(s=c.stateNode,a===null)try{s.componentDidMount()}catch(C){at(c,c.return,C)}else{var v=xr(c.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(v,a,s.__reactInternalSnapshotBeforeUpdate)}catch(C){at(c,c.return,C)}}h&64&&fv(c),h&512&&_o(c,c.return);break;case 3:if(ni(s,c),h&64&&(s=c.updateQueue,s!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{np(s,a)}catch(C){at(c,c.return,C)}}break;case 27:a===null&&h&4&&pv(c);case 26:case 5:ni(s,c),a===null&&h&4&&mv(c),h&512&&_o(c,c.return);break;case 12:ni(s,c);break;case 31:ni(s,c),h&4&&Sv(s,c);break;case 13:ni(s,c),h&4&&bv(s,c),h&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=zR.bind(null,c),cC(s,c))));break;case 22:if(h=c.memoizedState!==null||ei,!h){a=a!==null&&a.memoizedState!==null||jt,v=ei;var x=jt;ei=h,(jt=a)&&!x?si(s,c,(c.subtreeFlags&8772)!==0):ni(s,c),ei=v,jt=x}break;case 30:break;default:ni(s,c)}}function xv(s){var a=s.alternate;a!==null&&(s.alternate=null,xv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&ld(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var bt=null,xn=!1;function ti(s,a,c){for(c=c.child;c!==null;)Ev(s,a,c),c=c.sibling}function Ev(s,a,c){if(zt&&typeof zt.onCommitFiberUnmount=="function")try{zt.onCommitFiberUnmount(hn,c)}catch{}switch(c.tag){case 26:jt||Cs(c,a),ti(s,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:jt||Cs(c,a);var h=bt,v=xn;Oi(c.type)&&(bt=c.stateNode,xn=!1),ti(s,a,c),Uo(c.stateNode),bt=h,xn=v;break;case 5:jt||Cs(c,a);case 6:if(h=bt,v=xn,bt=null,ti(s,a,c),bt=h,xn=v,bt!==null)if(xn)try{(bt.nodeType===9?bt.body:bt.nodeName==="HTML"?bt.ownerDocument.body:bt).removeChild(c.stateNode)}catch(x){at(c,a,x)}else try{bt.removeChild(c.stateNode)}catch(x){at(c,a,x)}break;case 18:bt!==null&&(xn?(s=bt,fy(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),ba(s)):fy(bt,c.stateNode));break;case 4:h=bt,v=xn,bt=c.stateNode.containerInfo,xn=!0,ti(s,a,c),bt=h,xn=v;break;case 0:case 11:case 14:case 15:Ci(2,c,a),jt||Ci(4,c,a),ti(s,a,c);break;case 1:jt||(Cs(c,a),h=c.stateNode,typeof h.componentWillUnmount=="function"&&hv(c,a,h)),ti(s,a,c);break;case 21:ti(s,a,c);break;case 22:jt=(h=jt)||c.memoizedState!==null,ti(s,a,c),jt=h;break;default:ti(s,a,c)}}function Sv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{ba(s)}catch(c){at(a,a.return,c)}}}function bv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{ba(s)}catch(c){at(a,a.return,c)}}function kR(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new vv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new vv),a;default:throw Error(n(435,s.tag))}}function oc(s,a){var c=kR(s);a.forEach(function(h){if(!c.has(h)){c.add(h);var v=HR.bind(null,s,h);h.then(v,v)}})}function En(s,a){var c=a.deletions;if(c!==null)for(var h=0;h<c.length;h++){var v=c[h],x=s,C=a,I=C;e:for(;I!==null;){switch(I.tag){case 27:if(Oi(I.type)){bt=I.stateNode,xn=!1;break e}break;case 5:bt=I.stateNode,xn=!1;break e;case 3:case 4:bt=I.stateNode.containerInfo,xn=!0;break e}I=I.return}if(bt===null)throw Error(n(160));Ev(x,C,v),bt=null,xn=!1,x=v.alternate,x!==null&&(x.return=null),v.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Tv(a,s),a=a.sibling}var hs=null;function Tv(s,a){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:En(a,s),Sn(s),h&4&&(Ci(3,s,s.return),Lo(3,s),Ci(5,s,s.return));break;case 1:En(a,s),Sn(s),h&512&&(jt||c===null||Cs(c,c.return)),h&64&&ei&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var v=hs;if(En(a,s),Sn(s),h&512&&(jt||c===null||Cs(c,c.return)),h&4){var x=c!==null?c.memoizedState:null;if(h=s.memoizedState,c===null)if(h===null)if(s.stateNode===null){e:{h=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":x=v.getElementsByTagName("title")[0],(!x||x[eo]||x[en]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=v.createElement(h),v.head.insertBefore(x,v.querySelector("head > title"))),rn(x,h,c),x[en]=s,Wt(x),h=x;break e;case"link":var C=Ty("link","href",v).get(h+(c.href||""));if(C){for(var I=0;I<C.length;I++)if(x=C[I],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(I,1);break t}}x=v.createElement(h),rn(x,h,c),v.head.appendChild(x);break;case"meta":if(C=Ty("meta","content",v).get(h+(c.content||""))){for(I=0;I<C.length;I++)if(x=C[I],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(I,1);break t}}x=v.createElement(h),rn(x,h,c),v.head.appendChild(x);break;default:throw Error(n(468,h))}x[en]=s,Wt(x),h=x}s.stateNode=h}else Ay(v,s.type,s.stateNode);else s.stateNode=by(v,h,s.memoizedProps);else x!==h?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,h===null?Ay(v,s.type,s.stateNode):by(v,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Df(s,s.memoizedProps,c.memoizedProps)}break;case 27:En(a,s),Sn(s),h&512&&(jt||c===null||Cs(c,c.return)),c!==null&&h&4&&Df(s,s.memoizedProps,c.memoizedProps);break;case 5:if(En(a,s),Sn(s),h&512&&(jt||c===null||Cs(c,c.return)),s.flags&32){v=s.stateNode;try{Vr(v,"")}catch(ye){at(s,s.return,ye)}}h&4&&s.stateNode!=null&&(v=s.memoizedProps,Df(s,v,c!==null?c.memoizedProps:v)),h&1024&&(Of=!0);break;case 6:if(En(a,s),Sn(s),h&4){if(s.stateNode===null)throw Error(n(162));h=s.memoizedProps,c=s.stateNode;try{c.nodeValue=h}catch(ye){at(s,s.return,ye)}}break;case 3:if(Tc=null,v=hs,hs=Sc(a.containerInfo),En(a,s),hs=v,Sn(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{ba(a.containerInfo)}catch(ye){at(s,s.return,ye)}Of&&(Of=!1,Av(s));break;case 4:h=hs,hs=Sc(s.stateNode.containerInfo),En(a,s),Sn(s),hs=h;break;case 12:En(a,s),Sn(s);break;case 31:En(a,s),Sn(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,oc(s,h)));break;case 13:En(a,s),Sn(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(cc=Je()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,oc(s,h)));break;case 22:v=s.memoizedState!==null;var $=c!==null&&c.memoizedState!==null,Z=ei,re=jt;if(ei=Z||v,jt=re||$,En(a,s),jt=re,ei=Z,Sn(s),h&8192)e:for(a=s.stateNode,a._visibility=v?a._visibility&-2:a._visibility|1,v&&(c===null||$||ei||jt||Er(s)),c=null,a=s;;){if(a.tag===5||a.tag===26){if(c===null){$=c=a;try{if(x=$.stateNode,v)C=x.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{I=$.stateNode;var ue=$.memoizedProps.style,ee=ue!=null&&ue.hasOwnProperty("display")?ue.display:null;I.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(ye){at($,$.return,ye)}}}else if(a.tag===6){if(c===null){$=a;try{$.stateNode.nodeValue=v?"":$.memoizedProps}catch(ye){at($,$.return,ye)}}}else if(a.tag===18){if(c===null){$=a;try{var ie=$.stateNode;v?hy(ie,!0):hy($.stateNode,!1)}catch(ye){at($,$.return,ye)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=s.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,oc(s,c))));break;case 19:En(a,s),Sn(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,oc(s,h)));break;case 30:break;case 21:break;default:En(a,s),Sn(s)}}function Sn(s){var a=s.flags;if(a&2){try{for(var c,h=s.return;h!==null;){if(gv(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,x=If(s);ac(s,x,v);break;case 5:var C=c.stateNode;c.flags&32&&(Vr(C,""),c.flags&=-33);var I=If(s);ac(s,I,C);break;case 3:case 4:var $=c.stateNode.containerInfo,Z=If(s);Nf(s,Z,$);break;default:throw Error(n(161))}}catch(re){at(s,s.return,re)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function Av(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;Av(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function ni(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)yv(s,a.alternate,a),a=a.sibling}function Er(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Ci(4,a,a.return),Er(a);break;case 1:Cs(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&hv(a,a.return,c),Er(a);break;case 27:Uo(a.stateNode);case 26:case 5:Cs(a,a.return),Er(a);break;case 22:a.memoizedState===null&&Er(a);break;case 30:Er(a);break;default:Er(a)}s=s.sibling}}function si(s,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,v=s,x=a,C=x.flags;switch(x.tag){case 0:case 11:case 15:si(v,x,c),Lo(4,x);break;case 1:if(si(v,x,c),h=x,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(Z){at(h,h.return,Z)}if(h=x,v=h.updateQueue,v!==null){var I=h.stateNode;try{var $=v.shared.hiddenCallbacks;if($!==null)for(v.shared.hiddenCallbacks=null,v=0;v<$.length;v++)tp($[v],I)}catch(Z){at(h,h.return,Z)}}c&&C&64&&fv(x),_o(x,x.return);break;case 27:pv(x);case 26:case 5:si(v,x,c),c&&h===null&&C&4&&mv(x),_o(x,x.return);break;case 12:si(v,x,c);break;case 31:si(v,x,c),c&&C&4&&Sv(v,x);break;case 13:si(v,x,c),c&&C&4&&bv(v,x);break;case 22:x.memoizedState===null&&si(v,x,c),_o(x,x.return);break;case 30:break;default:si(v,x,c)}a=a.sibling}}function Mf(s,a){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&mo(c))}function kf(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&mo(s))}function ms(s,a,c,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Rv(s,a,c,h),a=a.sibling}function Rv(s,a,c,h){var v=a.flags;switch(a.tag){case 0:case 11:case 15:ms(s,a,c,h),v&2048&&Lo(9,a);break;case 1:ms(s,a,c,h);break;case 3:ms(s,a,c,h),v&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&mo(s)));break;case 12:if(v&2048){ms(s,a,c,h),s=a.stateNode;try{var x=a.memoizedProps,C=x.id,I=x.onPostCommit;typeof I=="function"&&I(C,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch($){at(a,a.return,$)}}else ms(s,a,c,h);break;case 31:ms(s,a,c,h);break;case 13:ms(s,a,c,h);break;case 23:break;case 22:x=a.stateNode,C=a.alternate,a.memoizedState!==null?x._visibility&2?ms(s,a,c,h):wo(s,a):x._visibility&2?ms(s,a,c,h):(x._visibility|=2,da(s,a,c,h,(a.subtreeFlags&10256)!==0||!1)),v&2048&&Mf(C,a);break;case 24:ms(s,a,c,h),v&2048&&kf(a.alternate,a);break;default:ms(s,a,c,h)}}function da(s,a,c,h,v){for(v=v&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var x=s,C=a,I=c,$=h,Z=C.flags;switch(C.tag){case 0:case 11:case 15:da(x,C,I,$,v),Lo(8,C);break;case 23:break;case 22:var re=C.stateNode;C.memoizedState!==null?re._visibility&2?da(x,C,I,$,v):wo(x,C):(re._visibility|=2,da(x,C,I,$,v)),v&&Z&2048&&Mf(C.alternate,C);break;case 24:da(x,C,I,$,v),v&&Z&2048&&kf(C.alternate,C);break;default:da(x,C,I,$,v)}a=a.sibling}}function wo(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=s,h=a,v=h.flags;switch(h.tag){case 22:wo(c,h),v&2048&&Mf(h.alternate,h);break;case 24:wo(c,h),v&2048&&kf(h.alternate,h);break;default:wo(c,h)}a=a.sibling}}var Do=8192;function fa(s,a,c){if(s.subtreeFlags&Do)for(s=s.child;s!==null;)Cv(s,a,c),s=s.sibling}function Cv(s,a,c){switch(s.tag){case 26:fa(s,a,c),s.flags&Do&&s.memoizedState!==null&&SC(c,hs,s.memoizedState,s.memoizedProps);break;case 5:fa(s,a,c);break;case 3:case 4:var h=hs;hs=Sc(s.stateNode.containerInfo),fa(s,a,c),hs=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=Do,Do=16777216,fa(s,a,c),Do=h):fa(s,a,c));break;default:fa(s,a,c)}}function Lv(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Io(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];Qt=h,wv(h,s)}Lv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)_v(s),s=s.sibling}function _v(s){switch(s.tag){case 0:case 11:case 15:Io(s),s.flags&2048&&Ci(9,s,s.return);break;case 3:Io(s);break;case 12:Io(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,lc(s)):Io(s);break;default:Io(s)}}function lc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var h=a[c];Qt=h,wv(h,s)}Lv(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Ci(8,a,a.return),lc(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,lc(a));break;default:lc(a)}s=s.sibling}}function wv(s,a){for(;Qt!==null;){var c=Qt;switch(c.tag){case 0:case 11:case 15:Ci(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:mo(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,Qt=h;else e:for(c=s;Qt!==null;){h=Qt;var v=h.sibling,x=h.return;if(xv(h),h===c){Qt=null;break e}if(v!==null){v.return=x,Qt=v;break e}Qt=x}}}var PR={getCacheForType:function(s){var a=nn(Ut),c=a.data.get(s);return c===void 0&&(c=s(),a.data.set(s,c)),c},cacheSignal:function(){return nn(Ut).controller.signal}},UR=typeof WeakMap=="function"?WeakMap:Map,st=0,mt=null,ze=null,Ve=0,rt=0,Un=null,Li=!1,ha=!1,Pf=!1,ii=0,Dt=0,_i=0,Sr=0,Uf=0,Fn=0,ma=0,No=null,bn=null,Ff=!1,cc=0,Dv=0,uc=1/0,dc=null,wi=null,Ht=0,Di=null,ga=null,ri=0,Bf=0,jf=null,Iv=null,Oo=0,$f=null;function Bn(){return(st&2)!==0&&Ve!==0?Ve&-Ve:P.T!==null?Yf():Yg()}function Nv(){if(Fn===0)if((Ve&536870912)===0||We){var s=nr;nr<<=1,(nr&3932160)===0&&(nr=262144),Fn=s}else Fn=536870912;return s=kn.current,s!==null&&(s.flags|=32),Fn}function Tn(s,a,c){(s===mt&&(rt===2||rt===9)||s.cancelPendingCommit!==null)&&(pa(s,0),Ii(s,Ve,Fn,!1)),ke(s,c),((st&2)===0||s!==mt)&&(s===mt&&((st&2)===0&&(Sr|=c),Dt===4&&Ii(s,Ve,Fn,!1)),Ls(s))}function Ov(s,a,c){if((st&6)!==0)throw Error(n(327));var h=!c&&(a&127)===0&&(a&s.expiredLanes)===0||ir(s,a),v=h?jR(s,a):zf(s,a,!0),x=h;do{if(v===0){ha&&!h&&Ii(s,a,0,!1);break}else{if(c=s.current.alternate,x&&!FR(c)){v=zf(s,a,!1),x=!1;continue}if(v===2){if(x=a,s.errorRecoveryDisabledLanes&x)var C=0;else C=s.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){a=C;e:{var I=s;v=No;var $=I.current.memoizedState.isDehydrated;if($&&(pa(I,C).flags|=256),C=zf(I,C,!1),C!==2){if(Pf&&!$){I.errorRecoveryDisabledLanes|=x,Sr|=x,v=4;break e}x=bn,bn=v,x!==null&&(bn===null?bn=x:bn.push.apply(bn,x))}v=C}if(x=!1,v!==2)continue}}if(v===1){pa(s,0),Ii(s,a,0,!0);break}e:{switch(h=s,x=v,x){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Ii(h,a,Fn,!Li);break e;case 2:bn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(v=cc+300-Je(),10<v)){if(Ii(h,a,Fn,!Li),Pr(h,0,!0)!==0)break e;ri=a,h.timeoutHandle=uy(Mv.bind(null,h,c,bn,dc,Ff,a,Fn,Sr,ma,Li,x,"Throttled",-0,0),v);break e}Mv(h,c,bn,dc,Ff,a,Fn,Sr,ma,Li,x,null,-0,0)}}break}while(!0);Ls(s)}function Mv(s,a,c,h,v,x,C,I,$,Z,re,ue,ee,ie){if(s.timeoutHandle=-1,ue=a.subtreeFlags,ue&8192||(ue&16785408)===16785408){ue={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Hs},Cv(a,x,ue);var ye=(x&62914560)===x?cc-Je():(x&4194048)===x?Dv-Je():0;if(ye=bC(ue,ye),ye!==null){ri=x,s.cancelPendingCommit=ye(Gv.bind(null,s,a,x,c,h,v,C,I,$,re,ue,null,ee,ie)),Ii(s,x,C,!Z);return}}Gv(s,a,x,c,h,v,C,I,$)}function FR(s){for(var a=s;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var v=c[h],x=v.getSnapshot;v=v.value;try{if(!On(x(),v))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ii(s,a,c,h){a&=~Uf,a&=~Sr,s.suspendedLanes|=a,s.pingedLanes&=~a,h&&(s.warmLanes|=a),h=s.expirationTimes;for(var v=a;0<v;){var x=31-mn(v),C=1<<x;h[x]=-1,v&=~C}c!==0&&it(s,c,a)}function fc(){return(st&6)===0?(Mo(0),!1):!0}function Gf(){if(ze!==null){if(rt===0)var s=ze.return;else s=ze,qs=fr=null,sf(s),aa=null,po=0,s=ze;for(;s!==null;)dv(s.alternate,s),s=s.return;ze=null}}function pa(s,a){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,iC(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),ri=0,Gf(),mt=s,ze=c=Ks(s.current,null),Ve=a,rt=0,Un=null,Li=!1,ha=ir(s,a),Pf=!1,ma=Fn=Uf=Sr=_i=Dt=0,bn=No=null,Ff=!1,(a&8)!==0&&(a|=a&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=a;0<h;){var v=31-mn(h),x=1<<v;a|=s[v],h&=~x}return ii=a,Ol(),c}function kv(s,a){Pe=null,P.H=Ao,a===ra||a===$l?(a=Q0(),rt=3):a===Vd?(a=Q0(),rt=4):rt=a===Ef?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Un=a,ze===null&&(Dt=1,tc(s,Wn(a,s.current)))}function Pv(){var s=kn.current;return s===null?!0:(Ve&4194048)===Ve?es===null:(Ve&62914560)===Ve||(Ve&536870912)!==0?s===es:!1}function Uv(){var s=P.H;return P.H=Ao,s===null?Ao:s}function Fv(){var s=P.A;return P.A=PR,s}function hc(){Dt=4,Li||(Ve&4194048)!==Ve&&kn.current!==null||(ha=!0),(_i&134217727)===0&&(Sr&134217727)===0||mt===null||Ii(mt,Ve,Fn,!1)}function zf(s,a,c){var h=st;st|=2;var v=Uv(),x=Fv();(mt!==s||Ve!==a)&&(dc=null,pa(s,a)),a=!1;var C=Dt;e:do try{if(rt!==0&&ze!==null){var I=ze,$=Un;switch(rt){case 8:Gf(),C=6;break e;case 3:case 2:case 9:case 6:kn.current===null&&(a=!0);var Z=rt;if(rt=0,Un=null,va(s,I,$,Z),c&&ha){C=0;break e}break;default:Z=rt,rt=0,Un=null,va(s,I,$,Z)}}BR(),C=Dt;break}catch(re){kv(s,re)}while(!0);return a&&s.shellSuspendCounter++,qs=fr=null,st=h,P.H=v,P.A=x,ze===null&&(mt=null,Ve=0,Ol()),C}function BR(){for(;ze!==null;)Bv(ze)}function jR(s,a){var c=st;st|=2;var h=Uv(),v=Fv();mt!==s||Ve!==a?(dc=null,uc=Je()+500,pa(s,a)):ha=ir(s,a);e:do try{if(rt!==0&&ze!==null){a=ze;var x=Un;t:switch(rt){case 1:rt=0,Un=null,va(s,a,x,1);break;case 2:case 9:if(X0(x)){rt=0,Un=null,jv(a);break}a=function(){rt!==2&&rt!==9||mt!==s||(rt=7),Ls(s)},x.then(a,a);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:X0(x)?(rt=0,Un=null,jv(a)):(rt=0,Un=null,va(s,a,x,7));break;case 5:var C=null;switch(ze.tag){case 26:C=ze.memoizedState;case 5:case 27:var I=ze;if(C?Ry(C):I.stateNode.complete){rt=0,Un=null;var $=I.sibling;if($!==null)ze=$;else{var Z=I.return;Z!==null?(ze=Z,mc(Z)):ze=null}break t}}rt=0,Un=null,va(s,a,x,5);break;case 6:rt=0,Un=null,va(s,a,x,6);break;case 8:Gf(),Dt=6;break e;default:throw Error(n(462))}}$R();break}catch(re){kv(s,re)}while(!0);return qs=fr=null,P.H=h,P.A=v,st=c,ze!==null?0:(mt=null,Ve=0,Ol(),Dt)}function $R(){for(;ze!==null&&!xt();)Bv(ze)}function Bv(s){var a=cv(s.alternate,s,ii);s.memoizedProps=s.pendingProps,a===null?mc(s):ze=a}function jv(s){var a=s,c=a.alternate;switch(a.tag){case 15:case 0:a=sv(c,a,a.pendingProps,a.type,void 0,Ve);break;case 11:a=sv(c,a,a.pendingProps,a.type.render,a.ref,Ve);break;case 5:sf(a);default:dv(c,a),a=ze=F0(a,ii),a=cv(c,a,ii)}s.memoizedProps=s.pendingProps,a===null?mc(s):ze=a}function va(s,a,c,h){qs=fr=null,sf(a),aa=null,po=0;var v=a.return;try{if(wR(s,v,a,c,Ve)){Dt=1,tc(s,Wn(c,s.current)),ze=null;return}}catch(x){if(v!==null)throw ze=v,x;Dt=1,tc(s,Wn(c,s.current)),ze=null;return}a.flags&32768?(We||h===1?s=!0:ha||(Ve&536870912)!==0?s=!1:(Li=s=!0,(h===2||h===9||h===3||h===6)&&(h=kn.current,h!==null&&h.tag===13&&(h.flags|=16384))),$v(a,s)):mc(a)}function mc(s){var a=s;do{if((a.flags&32768)!==0){$v(a,Li);return}s=a.return;var c=NR(a.alternate,a,ii);if(c!==null){ze=c;return}if(a=a.sibling,a!==null){ze=a;return}ze=a=s}while(a!==null);Dt===0&&(Dt=5)}function $v(s,a){do{var c=OR(s.alternate,s);if(c!==null){c.flags&=32767,ze=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(s=s.sibling,s!==null)){ze=s;return}ze=s=c}while(s!==null);Dt=6,ze=null}function Gv(s,a,c,h,v,x,C,I,$){s.cancelPendingCommit=null;do gc();while(Ht!==0);if((st&6)!==0)throw Error(n(327));if(a!==null){if(a===s.current)throw Error(n(177));if(x=a.lanes|a.childLanes,x|=Dd,Xe(s,c,x,C,I,$),s===mt&&(ze=mt=null,Ve=0),ga=a,Di=s,ri=c,Bf=x,jf=v,Iv=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,VR(us,function(){return Yv(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=P.T,P.T=null,v=K.p,K.p=2,C=st,st|=4;try{MR(s,a,c)}finally{st=C,K.p=v,P.T=h}}Ht=1,zv(),Hv(),Vv()}}function zv(){if(Ht===1){Ht=0;var s=Di,a=ga,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=P.T,P.T=null;var h=K.p;K.p=2;var v=st;st|=4;try{Tv(a,s);var x=th,C=w0(s.containerInfo),I=x.focusedElem,$=x.selectionRange;if(C!==I&&I&&I.ownerDocument&&_0(I.ownerDocument.documentElement,I)){if($!==null&&Rd(I)){var Z=$.start,re=$.end;if(re===void 0&&(re=Z),"selectionStart"in I)I.selectionStart=Z,I.selectionEnd=Math.min(re,I.value.length);else{var ue=I.ownerDocument||document,ee=ue&&ue.defaultView||window;if(ee.getSelection){var ie=ee.getSelection(),ye=I.textContent.length,De=Math.min($.start,ye),ft=$.end===void 0?De:Math.min($.end,ye);!ie.extend&&De>ft&&(C=ft,ft=De,De=C);var Y=L0(I,De),z=L0(I,ft);if(Y&&z&&(ie.rangeCount!==1||ie.anchorNode!==Y.node||ie.anchorOffset!==Y.offset||ie.focusNode!==z.node||ie.focusOffset!==z.offset)){var Q=ue.createRange();Q.setStart(Y.node,Y.offset),ie.removeAllRanges(),De>ft?(ie.addRange(Q),ie.extend(z.node,z.offset)):(Q.setEnd(z.node,z.offset),ie.addRange(Q))}}}}for(ue=[],ie=I;ie=ie.parentNode;)ie.nodeType===1&&ue.push({element:ie,left:ie.scrollLeft,top:ie.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<ue.length;I++){var oe=ue[I];oe.element.scrollLeft=oe.left,oe.element.scrollTop=oe.top}}Lc=!!eh,th=eh=null}finally{st=v,K.p=h,P.T=c}}s.current=a,Ht=2}}function Hv(){if(Ht===2){Ht=0;var s=Di,a=ga,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=P.T,P.T=null;var h=K.p;K.p=2;var v=st;st|=4;try{yv(s,a.alternate,a)}finally{st=v,K.p=h,P.T=c}}Ht=3}}function Vv(){if(Ht===4||Ht===3){Ht=0,cn();var s=Di,a=ga,c=ri,h=Iv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ht=5:(Ht=0,ga=Di=null,Kv(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(wi=null),Ja(c),a=a.stateNode,zt&&typeof zt.onCommitFiberRoot=="function")try{zt.onCommitFiberRoot(hn,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=P.T,v=K.p,K.p=2,P.T=null;try{for(var x=s.onRecoverableError,C=0;C<h.length;C++){var I=h[C];x(I.value,{componentStack:I.stack})}}finally{P.T=a,K.p=v}}(ri&3)!==0&&gc(),Ls(s),v=s.pendingLanes,(c&261930)!==0&&(v&42)!==0?s===$f?Oo++:(Oo=0,$f=s):Oo=0,Mo(0)}}function Kv(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,mo(a)))}function gc(){return zv(),Hv(),Vv(),Yv()}function Yv(){if(Ht!==5)return!1;var s=Di,a=Bf;Bf=0;var c=Ja(ri),h=P.T,v=K.p;try{K.p=32>c?32:c,P.T=null,c=jf,jf=null;var x=Di,C=ri;if(Ht=0,ga=Di=null,ri=0,(st&6)!==0)throw Error(n(331));var I=st;if(st|=4,_v(x.current),Rv(x,x.current,C,c),st=I,Mo(0,!1),zt&&typeof zt.onPostCommitFiberRoot=="function")try{zt.onPostCommitFiberRoot(hn,x)}catch{}return!0}finally{K.p=v,P.T=h,Kv(s,a)}}function qv(s,a,c){a=Wn(c,a),a=xf(s.stateNode,a,2),s=Ti(s,a,2),s!==null&&(ke(s,2),Ls(s))}function at(s,a,c){if(s.tag===3)qv(s,s,c);else for(;a!==null;){if(a.tag===3){qv(a,s,c);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(wi===null||!wi.has(h))){s=Wn(c,s),c=Xp(2),h=Ti(a,c,2),h!==null&&(Wp(c,h,a,s),ke(h,2),Ls(h));break}}a=a.return}}function Hf(s,a,c){var h=s.pingCache;if(h===null){h=s.pingCache=new UR;var v=new Set;h.set(a,v)}else v=h.get(a),v===void 0&&(v=new Set,h.set(a,v));v.has(c)||(Pf=!0,v.add(c),s=GR.bind(null,s,a,c),a.then(s,s))}function GR(s,a,c){var h=s.pingCache;h!==null&&h.delete(a),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,mt===s&&(Ve&c)===c&&(Dt===4||Dt===3&&(Ve&62914560)===Ve&&300>Je()-cc?(st&2)===0&&pa(s,0):Uf|=c,ma===Ve&&(ma=0)),Ls(s)}function Xv(s,a){a===0&&(a=me()),s=cr(s,a),s!==null&&(ke(s,a),Ls(s))}function zR(s){var a=s.memoizedState,c=0;a!==null&&(c=a.retryLane),Xv(s,c)}function HR(s,a){var c=0;switch(s.tag){case 31:case 13:var h=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(a),Xv(s,c)}function VR(s,a){return nt(s,a)}var pc=null,ya=null,Vf=!1,vc=!1,Kf=!1,Ni=0;function Ls(s){s!==ya&&s.next===null&&(ya===null?pc=ya=s:ya=ya.next=s),vc=!0,Vf||(Vf=!0,YR())}function Mo(s,a){if(!Kf&&vc){Kf=!0;do for(var c=!1,h=pc;h!==null;){if(s!==0){var v=h.pendingLanes;if(v===0)var x=0;else{var C=h.suspendedLanes,I=h.pingedLanes;x=(1<<31-mn(42|s)+1)-1,x&=v&~(C&~I),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,Jv(h,x))}else x=Ve,x=Pr(h,h===mt?x:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(x&3)===0||ir(h,x)||(c=!0,Jv(h,x));h=h.next}while(c);Kf=!1}}function KR(){Wv()}function Wv(){vc=Vf=!1;var s=0;Ni!==0&&sC()&&(s=Ni);for(var a=Je(),c=null,h=pc;h!==null;){var v=h.next,x=Qv(h,a);x===0?(h.next=null,c===null?pc=v:c.next=v,v===null&&(ya=c)):(c=h,(s!==0||(x&3)!==0)&&(vc=!0)),h=v}Ht!==0&&Ht!==5||Mo(s),Ni!==0&&(Ni=0)}function Qv(s,a){for(var c=s.suspendedLanes,h=s.pingedLanes,v=s.expirationTimes,x=s.pendingLanes&-62914561;0<x;){var C=31-mn(x),I=1<<C,$=v[C];$===-1?((I&c)===0||(I&h)!==0)&&(v[C]=Sl(I,a)):$<=a&&(s.expiredLanes|=I),x&=~I}if(a=mt,c=Ve,c=Pr(s,s===a?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,c===0||s===a&&(rt===2||rt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Gt(h),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||ir(s,c)){if(a=c&-c,a===s.callbackPriority)return a;switch(h!==null&&Gt(h),Ja(c)){case 2:case 8:c=fn;break;case 32:c=us;break;case 268435456:c=bs;break;default:c=us}return h=Zv.bind(null,s),c=nt(c,h),s.callbackPriority=a,s.callbackNode=c,a}return h!==null&&h!==null&&Gt(h),s.callbackPriority=2,s.callbackNode=null,2}function Zv(s,a){if(Ht!==0&&Ht!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(gc()&&s.callbackNode!==c)return null;var h=Ve;return h=Pr(s,s===mt?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(Ov(s,h,a),Qv(s,Je()),s.callbackNode!=null&&s.callbackNode===c?Zv.bind(null,s):null)}function Jv(s,a){if(gc())return null;Ov(s,a,!0)}function YR(){rC(function(){(st&6)!==0?nt(Ot,KR):Wv()})}function Yf(){if(Ni===0){var s=sa;s===0&&(s=kr,kr<<=1,(kr&261888)===0&&(kr=256)),Ni=s}return Ni}function ey(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Rl(""+s)}function ty(s,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,s.id&&c.setAttribute("form",s.id),a.parentNode.insertBefore(c,a),s=new FormData(s),c.parentNode.removeChild(c),s}function qR(s,a,c,h,v){if(a==="submit"&&c&&c.stateNode===v){var x=ey((v[vn]||null).action),C=h.submitter;C&&(a=(a=C[vn]||null)?ey(a.formAction):C.getAttribute("formAction"),a!==null&&(x=a,C=null));var I=new wl("action","action",null,h,v);s.push({event:I,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ni!==0){var $=C?ty(v,C):new FormData(v);hf(c,{pending:!0,data:$,method:v.method,action:x},null,$)}}else typeof x=="function"&&(I.preventDefault(),$=C?ty(v,C):new FormData(v),hf(c,{pending:!0,data:$,method:v.method,action:x},x,$))},currentTarget:v}]})}}for(var qf=0;qf<wd.length;qf++){var Xf=wd[qf],XR=Xf.toLowerCase(),WR=Xf[0].toUpperCase()+Xf.slice(1);fs(XR,"on"+WR)}fs(N0,"onAnimationEnd"),fs(O0,"onAnimationIteration"),fs(M0,"onAnimationStart"),fs("dblclick","onDoubleClick"),fs("focusin","onFocus"),fs("focusout","onBlur"),fs(fR,"onTransitionRun"),fs(hR,"onTransitionStart"),fs(mR,"onTransitionCancel"),fs(k0,"onTransitionEnd"),zr("onMouseEnter",["mouseout","mouseover"]),zr("onMouseLeave",["mouseout","mouseover"]),zr("onPointerEnter",["pointerout","pointerover"]),zr("onPointerLeave",["pointerout","pointerover"]),rr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rr("onBeforeInput",["compositionend","keypress","textInput","paste"]),rr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ko));function ny(s,a){a=(a&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],v=h.event;h=h.listeners;e:{var x=void 0;if(a)for(var C=h.length-1;0<=C;C--){var I=h[C],$=I.instance,Z=I.currentTarget;if(I=I.listener,$!==x&&v.isPropagationStopped())break e;x=I,v.currentTarget=Z;try{x(v)}catch(re){Nl(re)}v.currentTarget=null,x=$}else for(C=0;C<h.length;C++){if(I=h[C],$=I.instance,Z=I.currentTarget,I=I.listener,$!==x&&v.isPropagationStopped())break e;x=I,v.currentTarget=Z;try{x(v)}catch(re){Nl(re)}v.currentTarget=null,x=$}}}}function He(s,a){var c=a[od];c===void 0&&(c=a[od]=new Set);var h=s+"__bubble";c.has(h)||(sy(a,s,2,!1),c.add(h))}function Wf(s,a,c){var h=0;a&&(h|=4),sy(c,s,h,a)}var yc="_reactListening"+Math.random().toString(36).slice(2);function Qf(s){if(!s[yc]){s[yc]=!0,Wg.forEach(function(c){c!=="selectionchange"&&(QR.has(c)||Wf(c,!1,s),Wf(c,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[yc]||(a[yc]=!0,Wf("selectionchange",!1,a))}}function sy(s,a,c,h){switch(Ny(a)){case 2:var v=RC;break;case 8:v=CC;break;default:v=fh}c=v.bind(null,a,c,s),v=void 0,!pd||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(v=!0),h?v!==void 0?s.addEventListener(a,c,{capture:!0,passive:v}):s.addEventListener(a,c,!0):v!==void 0?s.addEventListener(a,c,{passive:v}):s.addEventListener(a,c,!1)}function Zf(s,a,c,h,v){var x=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var C=h.tag;if(C===3||C===4){var I=h.stateNode.containerInfo;if(I===v)break;if(C===4)for(C=h.return;C!==null;){var $=C.tag;if(($===3||$===4)&&C.stateNode.containerInfo===v)return;C=C.return}for(;I!==null;){if(C=jr(I),C===null)return;if($=C.tag,$===5||$===6||$===26||$===27){h=x=C;continue e}I=I.parentNode}}h=h.return}l0(function(){var Z=x,re=md(c),ue=[];e:{var ee=P0.get(s);if(ee!==void 0){var ie=wl,ye=s;switch(s){case"keypress":if(Ll(c)===0)break e;case"keydown":case"keyup":ie=H1;break;case"focusin":ye="focus",ie=Ed;break;case"focusout":ye="blur",ie=Ed;break;case"beforeblur":case"afterblur":ie=Ed;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ie=d0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ie=N1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ie=Y1;break;case N0:case O0:case M0:ie=k1;break;case k0:ie=X1;break;case"scroll":case"scrollend":ie=D1;break;case"wheel":ie=Q1;break;case"copy":case"cut":case"paste":ie=U1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ie=h0;break;case"toggle":case"beforetoggle":ie=J1}var De=(a&4)!==0,ft=!De&&(s==="scroll"||s==="scrollend"),Y=De?ee!==null?ee+"Capture":null:ee;De=[];for(var z=Z,Q;z!==null;){var oe=z;if(Q=oe.stateNode,oe=oe.tag,oe!==5&&oe!==26&&oe!==27||Q===null||Y===null||(oe=no(z,Y),oe!=null&&De.push(Po(z,oe,Q))),ft)break;z=z.return}0<De.length&&(ee=new ie(ee,ye,null,c,re),ue.push({event:ee,listeners:De}))}}if((a&7)===0){e:{if(ee=s==="mouseover"||s==="pointerover",ie=s==="mouseout"||s==="pointerout",ee&&c!==hd&&(ye=c.relatedTarget||c.fromElement)&&(jr(ye)||ye[Br]))break e;if((ie||ee)&&(ee=re.window===re?re:(ee=re.ownerDocument)?ee.defaultView||ee.parentWindow:window,ie?(ye=c.relatedTarget||c.toElement,ie=Z,ye=ye?jr(ye):null,ye!==null&&(ft=o(ye),De=ye.tag,ye!==ft||De!==5&&De!==27&&De!==6)&&(ye=null)):(ie=null,ye=Z),ie!==ye)){if(De=d0,oe="onMouseLeave",Y="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(De=h0,oe="onPointerLeave",Y="onPointerEnter",z="pointer"),ft=ie==null?ee:to(ie),Q=ye==null?ee:to(ye),ee=new De(oe,z+"leave",ie,c,re),ee.target=ft,ee.relatedTarget=Q,oe=null,jr(re)===Z&&(De=new De(Y,z+"enter",ye,c,re),De.target=Q,De.relatedTarget=ft,oe=De),ft=oe,ie&&ye)t:{for(De=ZR,Y=ie,z=ye,Q=0,oe=Y;oe;oe=De(oe))Q++;oe=0;for(var _e=z;_e;_e=De(_e))oe++;for(;0<Q-oe;)Y=De(Y),Q--;for(;0<oe-Q;)z=De(z),oe--;for(;Q--;){if(Y===z||z!==null&&Y===z.alternate){De=Y;break t}Y=De(Y),z=De(z)}De=null}else De=null;ie!==null&&iy(ue,ee,ie,De,!1),ye!==null&&ft!==null&&iy(ue,ft,ye,De,!0)}}e:{if(ee=Z?to(Z):window,ie=ee.nodeName&&ee.nodeName.toLowerCase(),ie==="select"||ie==="input"&&ee.type==="file")var et=S0;else if(x0(ee))if(b0)et=cR;else{et=oR;var be=aR}else ie=ee.nodeName,!ie||ie.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?Z&&fd(Z.elementType)&&(et=S0):et=lR;if(et&&(et=et(s,Z))){E0(ue,et,c,re);break e}be&&be(s,ee,Z),s==="focusout"&&Z&&ee.type==="number"&&Z.memoizedProps.value!=null&&dd(ee,"number",ee.value)}switch(be=Z?to(Z):window,s){case"focusin":(x0(be)||be.contentEditable==="true")&&(Xr=be,Cd=Z,uo=null);break;case"focusout":uo=Cd=Xr=null;break;case"mousedown":Ld=!0;break;case"contextmenu":case"mouseup":case"dragend":Ld=!1,D0(ue,c,re);break;case"selectionchange":if(dR)break;case"keydown":case"keyup":D0(ue,c,re)}var Ue;if(bd)e:{switch(s){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else qr?v0(s,c)&&(Ke="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Ke="onCompositionStart");Ke&&(m0&&c.locale!=="ko"&&(qr||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&qr&&(Ue=c0()):(pi=re,vd="value"in pi?pi.value:pi.textContent,qr=!0)),be=xc(Z,Ke),0<be.length&&(Ke=new f0(Ke,s,null,c,re),ue.push({event:Ke,listeners:be}),Ue?Ke.data=Ue:(Ue=y0(c),Ue!==null&&(Ke.data=Ue)))),(Ue=tR?nR(s,c):sR(s,c))&&(Ke=xc(Z,"onBeforeInput"),0<Ke.length&&(be=new f0("onBeforeInput","beforeinput",null,c,re),ue.push({event:be,listeners:Ke}),be.data=Ue)),qR(ue,s,Z,c,re)}ny(ue,a)})}function Po(s,a,c){return{instance:s,listener:a,currentTarget:c}}function xc(s,a){for(var c=a+"Capture",h=[];s!==null;){var v=s,x=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||x===null||(v=no(s,c),v!=null&&h.unshift(Po(s,v,x)),v=no(s,a),v!=null&&h.push(Po(s,v,x))),s.tag===3)return h;s=s.return}return[]}function ZR(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function iy(s,a,c,h,v){for(var x=a._reactName,C=[];c!==null&&c!==h;){var I=c,$=I.alternate,Z=I.stateNode;if(I=I.tag,$!==null&&$===h)break;I!==5&&I!==26&&I!==27||Z===null||($=Z,v?(Z=no(c,x),Z!=null&&C.unshift(Po(c,Z,$))):v||(Z=no(c,x),Z!=null&&C.push(Po(c,Z,$)))),c=c.return}C.length!==0&&s.push({event:a,listeners:C})}var JR=/\r\n?/g,eC=/\u0000|\uFFFD/g;function ry(s){return(typeof s=="string"?s:""+s).replace(JR,`
`).replace(eC,"")}function ay(s,a){return a=ry(a),ry(s)===a}function dt(s,a,c,h,v,x){switch(c){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||Vr(s,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&Vr(s,""+h);break;case"className":Tl(s,"class",h);break;case"tabIndex":Tl(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Tl(s,c,h);break;case"style":a0(s,h,x);break;case"data":if(a!=="object"){Tl(s,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||c!=="href")){s.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=Rl(""+h),s.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(a!=="input"&&dt(s,a,"name",v.name,v,null),dt(s,a,"formEncType",v.formEncType,v,null),dt(s,a,"formMethod",v.formMethod,v,null),dt(s,a,"formTarget",v.formTarget,v,null)):(dt(s,a,"encType",v.encType,v,null),dt(s,a,"method",v.method,v,null),dt(s,a,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=Rl(""+h),s.setAttribute(c,h);break;case"onClick":h!=null&&(s.onclick=Hs);break;case"onScroll":h!=null&&He("scroll",s);break;case"onScrollEnd":h!=null&&He("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}c=Rl(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""+h):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":h===!0?s.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,h):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(c,h):s.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(c):s.setAttribute(c,h);break;case"popover":He("beforetoggle",s),He("toggle",s),bl(s,"popover",h);break;case"xlinkActuate":zs(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":zs(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":zs(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":zs(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":zs(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":zs(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":zs(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":zs(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":zs(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":bl(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=_1.get(c)||c,bl(s,c,h))}}function Jf(s,a,c,h,v,x){switch(c){case"style":a0(s,h,x);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof h=="string"?Vr(s,h):(typeof h=="number"||typeof h=="bigint")&&Vr(s,""+h);break;case"onScroll":h!=null&&He("scroll",s);break;case"onScrollEnd":h!=null&&He("scrollend",s);break;case"onClick":h!=null&&(s.onclick=Hs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Qg.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),a=c.slice(2,v?c.length-7:void 0),x=s[vn]||null,x=x!=null?x[c]:null,typeof x=="function"&&s.removeEventListener(a,x,v),typeof h=="function")){typeof x!="function"&&x!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(a,h,v);break e}c in s?s[c]=h:h===!0?s.setAttribute(c,""):bl(s,c,h)}}}function rn(s,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",s),He("load",s);var h=!1,v=!1,x;for(x in c)if(c.hasOwnProperty(x)){var C=c[x];if(C!=null)switch(x){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:dt(s,a,x,C,c,null)}}v&&dt(s,a,"srcSet",c.srcSet,c,null),h&&dt(s,a,"src",c.src,c,null);return;case"input":He("invalid",s);var I=x=C=v=null,$=null,Z=null;for(h in c)if(c.hasOwnProperty(h)){var re=c[h];if(re!=null)switch(h){case"name":v=re;break;case"type":C=re;break;case"checked":$=re;break;case"defaultChecked":Z=re;break;case"value":x=re;break;case"defaultValue":I=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(n(137,a));break;default:dt(s,a,h,re,c,null)}}n0(s,x,I,$,Z,C,v,!1);return;case"select":He("invalid",s),h=C=x=null;for(v in c)if(c.hasOwnProperty(v)&&(I=c[v],I!=null))switch(v){case"value":x=I;break;case"defaultValue":C=I;break;case"multiple":h=I;default:dt(s,a,v,I,c,null)}a=x,c=C,s.multiple=!!h,a!=null?Hr(s,!!h,a,!1):c!=null&&Hr(s,!!h,c,!0);return;case"textarea":He("invalid",s),x=v=h=null;for(C in c)if(c.hasOwnProperty(C)&&(I=c[C],I!=null))switch(C){case"value":h=I;break;case"defaultValue":v=I;break;case"children":x=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(n(91));break;default:dt(s,a,C,I,c,null)}i0(s,h,v,x);return;case"option":for($ in c)c.hasOwnProperty($)&&(h=c[$],h!=null)&&($==="selected"?s.selected=h&&typeof h!="function"&&typeof h!="symbol":dt(s,a,$,h,c,null));return;case"dialog":He("beforetoggle",s),He("toggle",s),He("cancel",s),He("close",s);break;case"iframe":case"object":He("load",s);break;case"video":case"audio":for(h=0;h<ko.length;h++)He(ko[h],s);break;case"image":He("error",s),He("load",s);break;case"details":He("toggle",s);break;case"embed":case"source":case"link":He("error",s),He("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in c)if(c.hasOwnProperty(Z)&&(h=c[Z],h!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:dt(s,a,Z,h,c,null)}return;default:if(fd(a)){for(re in c)c.hasOwnProperty(re)&&(h=c[re],h!==void 0&&Jf(s,a,re,h,c,void 0));return}}for(I in c)c.hasOwnProperty(I)&&(h=c[I],h!=null&&dt(s,a,I,h,c,null))}function tC(s,a,c,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,x=null,C=null,I=null,$=null,Z=null,re=null;for(ie in c){var ue=c[ie];if(c.hasOwnProperty(ie)&&ue!=null)switch(ie){case"checked":break;case"value":break;case"defaultValue":$=ue;default:h.hasOwnProperty(ie)||dt(s,a,ie,null,h,ue)}}for(var ee in h){var ie=h[ee];if(ue=c[ee],h.hasOwnProperty(ee)&&(ie!=null||ue!=null))switch(ee){case"type":x=ie;break;case"name":v=ie;break;case"checked":Z=ie;break;case"defaultChecked":re=ie;break;case"value":C=ie;break;case"defaultValue":I=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(n(137,a));break;default:ie!==ue&&dt(s,a,ee,ie,h,ue)}}ud(s,C,I,$,Z,re,x,v);return;case"select":ie=C=I=ee=null;for(x in c)if($=c[x],c.hasOwnProperty(x)&&$!=null)switch(x){case"value":break;case"multiple":ie=$;default:h.hasOwnProperty(x)||dt(s,a,x,null,h,$)}for(v in h)if(x=h[v],$=c[v],h.hasOwnProperty(v)&&(x!=null||$!=null))switch(v){case"value":ee=x;break;case"defaultValue":I=x;break;case"multiple":C=x;default:x!==$&&dt(s,a,v,x,h,$)}a=I,c=C,h=ie,ee!=null?Hr(s,!!c,ee,!1):!!h!=!!c&&(a!=null?Hr(s,!!c,a,!0):Hr(s,!!c,c?[]:"",!1));return;case"textarea":ie=ee=null;for(I in c)if(v=c[I],c.hasOwnProperty(I)&&v!=null&&!h.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:dt(s,a,I,null,h,v)}for(C in h)if(v=h[C],x=c[C],h.hasOwnProperty(C)&&(v!=null||x!=null))switch(C){case"value":ee=v;break;case"defaultValue":ie=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==x&&dt(s,a,C,v,h,x)}s0(s,ee,ie);return;case"option":for(var ye in c)ee=c[ye],c.hasOwnProperty(ye)&&ee!=null&&!h.hasOwnProperty(ye)&&(ye==="selected"?s.selected=!1:dt(s,a,ye,null,h,ee));for($ in h)ee=h[$],ie=c[$],h.hasOwnProperty($)&&ee!==ie&&(ee!=null||ie!=null)&&($==="selected"?s.selected=ee&&typeof ee!="function"&&typeof ee!="symbol":dt(s,a,$,ee,h,ie));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var De in c)ee=c[De],c.hasOwnProperty(De)&&ee!=null&&!h.hasOwnProperty(De)&&dt(s,a,De,null,h,ee);for(Z in h)if(ee=h[Z],ie=c[Z],h.hasOwnProperty(Z)&&ee!==ie&&(ee!=null||ie!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(n(137,a));break;default:dt(s,a,Z,ee,h,ie)}return;default:if(fd(a)){for(var ft in c)ee=c[ft],c.hasOwnProperty(ft)&&ee!==void 0&&!h.hasOwnProperty(ft)&&Jf(s,a,ft,void 0,h,ee);for(re in h)ee=h[re],ie=c[re],!h.hasOwnProperty(re)||ee===ie||ee===void 0&&ie===void 0||Jf(s,a,re,ee,h,ie);return}}for(var Y in c)ee=c[Y],c.hasOwnProperty(Y)&&ee!=null&&!h.hasOwnProperty(Y)&&dt(s,a,Y,null,h,ee);for(ue in h)ee=h[ue],ie=c[ue],!h.hasOwnProperty(ue)||ee===ie||ee==null&&ie==null||dt(s,a,ue,ee,h,ie)}function oy(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function nC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var v=c[h],x=v.transferSize,C=v.initiatorType,I=v.duration;if(x&&I&&oy(C)){for(C=0,I=v.responseEnd,h+=1;h<c.length;h++){var $=c[h],Z=$.startTime;if(Z>I)break;var re=$.transferSize,ue=$.initiatorType;re&&oy(ue)&&($=$.responseEnd,C+=re*($<I?1:(I-Z)/($-Z)))}if(--h,a+=8*(x+C)/(v.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var eh=null,th=null;function Ec(s){return s.nodeType===9?s:s.ownerDocument}function ly(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cy(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function nh(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var sh=null;function sC(){var s=window.event;return s&&s.type==="popstate"?s===sh?!1:(sh=s,!0):(sh=null,!1)}var uy=typeof setTimeout=="function"?setTimeout:void 0,iC=typeof clearTimeout=="function"?clearTimeout:void 0,dy=typeof Promise=="function"?Promise:void 0,rC=typeof queueMicrotask=="function"?queueMicrotask:typeof dy<"u"?function(s){return dy.resolve(null).then(s).catch(aC)}:uy;function aC(s){setTimeout(function(){throw s})}function Oi(s){return s==="head"}function fy(s,a){var c=a,h=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(h===0){s.removeChild(v),ba(a);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Uo(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Uo(c);for(var x=c.firstChild;x;){var C=x.nextSibling,I=x.nodeName;x[eo]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&x.rel.toLowerCase()==="stylesheet"||c.removeChild(x),x=C}}else c==="body"&&Uo(s.ownerDocument.body);c=v}while(c);ba(a)}function hy(s,a){var c=s;s=0;do{var h=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=h}while(c)}function ih(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":ih(c),ld(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function oC(s,a,c,h){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[eo])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(x=s.getAttribute("rel"),x==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(x!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(x=s.getAttribute("src"),(x!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&x&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var x=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===x)return s}else return s;if(s=ts(s.nextSibling),s===null)break}return null}function lC(s,a,c){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=ts(s.nextSibling),s===null))return null;return s}function my(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ts(s.nextSibling),s===null))return null;return s}function rh(s){return s.data==="$?"||s.data==="$~"}function ah(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function cC(s,a){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||c.readyState!=="loading")a();else{var h=function(){a(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function ts(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var oh=null;function gy(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(a===0)return ts(s.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}s=s.nextSibling}return null}function py(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return s;a--}else c!=="/$"&&c!=="/&"||a++}s=s.previousSibling}return null}function vy(s,a,c){switch(a=Ec(c),s){case"html":if(s=a.documentElement,!s)throw Error(n(452));return s;case"head":if(s=a.head,!s)throw Error(n(453));return s;case"body":if(s=a.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Uo(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);ld(s)}var ns=new Map,yy=new Set;function Sc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var ai=K.d;K.d={f:uC,r:dC,D:fC,C:hC,L:mC,m:gC,X:vC,S:pC,M:yC};function uC(){var s=ai.f(),a=fc();return s||a}function dC(s){var a=$r(s);a!==null&&a.tag===5&&a.type==="form"?kp(a):ai.r(s)}var xa=typeof document>"u"?null:document;function xy(s,a,c){var h=xa;if(h&&typeof a=="string"&&a){var v=qn(a);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),yy.has(v)||(yy.add(v),s={rel:s,crossOrigin:c,href:a},h.querySelector(v)===null&&(a=h.createElement("link"),rn(a,"link",s),Wt(a),h.head.appendChild(a)))}}function fC(s){ai.D(s),xy("dns-prefetch",s,null)}function hC(s,a){ai.C(s,a),xy("preconnect",s,a)}function mC(s,a,c){ai.L(s,a,c);var h=xa;if(h&&s&&a){var v='link[rel="preload"][as="'+qn(a)+'"]';a==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+qn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+qn(c.imageSizes)+'"]')):v+='[href="'+qn(s)+'"]';var x=v;switch(a){case"style":x=Ea(s);break;case"script":x=Sa(s)}ns.has(x)||(s=g({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:s,as:a},c),ns.set(x,s),h.querySelector(v)!==null||a==="style"&&h.querySelector(Fo(x))||a==="script"&&h.querySelector(Bo(x))||(a=h.createElement("link"),rn(a,"link",s),Wt(a),h.head.appendChild(a)))}}function gC(s,a){ai.m(s,a);var c=xa;if(c&&s){var h=a&&typeof a.as=="string"?a.as:"script",v='link[rel="modulepreload"][as="'+qn(h)+'"][href="'+qn(s)+'"]',x=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Sa(s)}if(!ns.has(x)&&(s=g({rel:"modulepreload",href:s},a),ns.set(x,s),c.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Bo(x)))return}h=c.createElement("link"),rn(h,"link",s),Wt(h),c.head.appendChild(h)}}}function pC(s,a,c){ai.S(s,a,c);var h=xa;if(h&&s){var v=Gr(h).hoistableStyles,x=Ea(s);a=a||"default";var C=v.get(x);if(!C){var I={loading:0,preload:null};if(C=h.querySelector(Fo(x)))I.loading=5;else{s=g({rel:"stylesheet",href:s,"data-precedence":a},c),(c=ns.get(x))&&lh(s,c);var $=C=h.createElement("link");Wt($),rn($,"link",s),$._p=new Promise(function(Z,re){$.onload=Z,$.onerror=re}),$.addEventListener("load",function(){I.loading|=1}),$.addEventListener("error",function(){I.loading|=2}),I.loading|=4,bc(C,a,h)}C={type:"stylesheet",instance:C,count:1,state:I},v.set(x,C)}}}function vC(s,a){ai.X(s,a);var c=xa;if(c&&s){var h=Gr(c).hoistableScripts,v=Sa(s),x=h.get(v);x||(x=c.querySelector(Bo(v)),x||(s=g({src:s,async:!0},a),(a=ns.get(v))&&ch(s,a),x=c.createElement("script"),Wt(x),rn(x,"link",s),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(v,x))}}function yC(s,a){ai.M(s,a);var c=xa;if(c&&s){var h=Gr(c).hoistableScripts,v=Sa(s),x=h.get(v);x||(x=c.querySelector(Bo(v)),x||(s=g({src:s,async:!0,type:"module"},a),(a=ns.get(v))&&ch(s,a),x=c.createElement("script"),Wt(x),rn(x,"link",s),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},h.set(v,x))}}function Ey(s,a,c,h){var v=(v=ce.current)?Sc(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=Ea(c.href),c=Gr(v).hoistableStyles,h=c.get(a),h||(h={type:"style",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Ea(c.href);var x=Gr(v).hoistableStyles,C=x.get(s);if(C||(v=v.ownerDocument||v,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(s,C),(x=v.querySelector(Fo(s)))&&!x._p&&(C.instance=x,C.state.loading=5),ns.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},ns.set(s,c),x||xC(v,s,c,C.state))),a&&h===null)throw Error(n(528,""));return C}if(a&&h!==null)throw Error(n(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Sa(c),c=Gr(v).hoistableScripts,h=c.get(a),h||(h={type:"script",instance:null,count:0,state:null},c.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Ea(s){return'href="'+qn(s)+'"'}function Fo(s){return'link[rel="stylesheet"]['+s+"]"}function Sy(s){return g({},s,{"data-precedence":s.precedence,precedence:null})}function xC(s,a,c,h){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=s.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),rn(a,"link",c),Wt(a),s.head.appendChild(a))}function Sa(s){return'[src="'+qn(s)+'"]'}function Bo(s){return"script[async]"+s}function by(s,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var h=s.querySelector('style[data-href~="'+qn(c.href)+'"]');if(h)return a.instance=h,Wt(h),h;var v=g({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),Wt(h),rn(h,"style",v),bc(h,c.precedence,s),a.instance=h;case"stylesheet":v=Ea(c.href);var x=s.querySelector(Fo(v));if(x)return a.state.loading|=4,a.instance=x,Wt(x),x;h=Sy(c),(v=ns.get(v))&&lh(h,v),x=(s.ownerDocument||s).createElement("link"),Wt(x);var C=x;return C._p=new Promise(function(I,$){C.onload=I,C.onerror=$}),rn(x,"link",h),a.state.loading|=4,bc(x,c.precedence,s),a.instance=x;case"script":return x=Sa(c.src),(v=s.querySelector(Bo(x)))?(a.instance=v,Wt(v),v):(h=c,(v=ns.get(x))&&(h=g({},c),ch(h,v)),s=s.ownerDocument||s,v=s.createElement("script"),Wt(v),rn(v,"link",h),s.head.appendChild(v),a.instance=v);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,bc(h,c.precedence,s));return a.instance}function bc(s,a,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,x=v,C=0;C<h.length;C++){var I=h[C];if(I.dataset.precedence===a)x=I;else if(x!==v)break}x?x.parentNode.insertBefore(s,x.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(s,a.firstChild))}function lh(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function ch(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Tc=null;function Ty(s,a,c){if(Tc===null){var h=new Map,v=Tc=new Map;v.set(c,h)}else v=Tc,h=v.get(c),h||(h=new Map,v.set(c,h));if(h.has(s))return h;for(h.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var x=c[v];if(!(x[eo]||x[en]||s==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var C=x.getAttribute(a)||"";C=s+C;var I=h.get(C);I?I.push(x):h.set(C,[x])}}return h}function Ay(s,a,c){s=s.ownerDocument||s,s.head.insertBefore(c,a==="title"?s.querySelector("head > title"):null)}function EC(s,a,c){if(c===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;return a.rel==="stylesheet"?(s=a.disabled,typeof a.precedence=="string"&&s==null):!0;case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Ry(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function SC(s,a,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=Ea(h.href),x=a.querySelector(Fo(v));if(x){a=x._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Ac.bind(s),a.then(s,s)),c.state.loading|=4,c.instance=x,Wt(x);return}x=a.ownerDocument||a,h=Sy(h),(v=ns.get(v))&&lh(h,v),x=x.createElement("link"),Wt(x);var C=x;C._p=new Promise(function(I,$){C.onload=I,C.onerror=$}),rn(x,"link",h),c.instance=x}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=Ac.bind(s),a.addEventListener("load",c),a.addEventListener("error",c))}}var uh=0;function bC(s,a){return s.stylesheets&&s.count===0&&Cc(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var h=setTimeout(function(){if(s.stylesheets&&Cc(s,s.stylesheets),s.unsuspend){var x=s.unsuspend;s.unsuspend=null,x()}},6e4+a);0<s.imgBytes&&uh===0&&(uh=62500*nC());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Cc(s,s.stylesheets),s.unsuspend)){var x=s.unsuspend;s.unsuspend=null,x()}},(s.imgBytes>uh?50:800)+a);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(v)}}:null}function Ac(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cc(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Rc=null;function Cc(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Rc=new Map,a.forEach(TC,s),Rc=null,Ac.call(s))}function TC(s,a){if(!(a.state.loading&4)){var c=Rc.get(s);if(c)var h=c.get(null);else{c=new Map,Rc.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<v.length;x++){var C=v[x];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),h=C)}h&&c.set(null,h)}v=a.instance,C=v.getAttribute("data-precedence"),x=c.get(C)||h,x===h&&c.set(null,v),c.set(C,v),this.count++,h=Ac.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),x?x.parentNode.insertBefore(v,x.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),a.state.loading|=4}}var jo={$$typeof:w,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function AC(s,a,c,h,v,x,C,I,$){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Re(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Re(0),this.hiddenUpdates=Re(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=x,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Cy(s,a,c,h,v,x,C,I,$,Z,re,ue){return s=new AC(s,a,c,C,$,Z,re,ue,I),a=1,x===!0&&(a|=24),x=Mn(3,null,null,a),s.current=x,x.stateNode=s,a=Gd(),a.refCount++,s.pooledCache=a,a.refCount++,x.memoizedState={element:h,isDehydrated:c,cache:a},Kd(x),s}function Ly(s){return s?(s=Zr,s):Zr}function _y(s,a,c,h,v,x){v=Ly(v),h.context===null?h.context=v:h.pendingContext=v,h=bi(a),h.payload={element:c},x=x===void 0?null:x,x!==null&&(h.callback=x),c=Ti(s,h,a),c!==null&&(Tn(c,s,a),yo(c,s,a))}function wy(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<a?c:a}}function dh(s,a){wy(s,a),(s=s.alternate)&&wy(s,a)}function Dy(s){if(s.tag===13||s.tag===31){var a=cr(s,67108864);a!==null&&Tn(a,s,67108864),dh(s,67108864)}}function Iy(s){if(s.tag===13||s.tag===31){var a=Bn();a=Fr(a);var c=cr(s,a);c!==null&&Tn(c,s,a),dh(s,a)}}var Lc=!0;function RC(s,a,c,h){var v=P.T;P.T=null;var x=K.p;try{K.p=2,fh(s,a,c,h)}finally{K.p=x,P.T=v}}function CC(s,a,c,h){var v=P.T;P.T=null;var x=K.p;try{K.p=8,fh(s,a,c,h)}finally{K.p=x,P.T=v}}function fh(s,a,c,h){if(Lc){var v=hh(h);if(v===null)Zf(s,a,h,_c,c),Oy(s,h);else if(_C(v,s,a,c,h))h.stopPropagation();else if(Oy(s,h),a&4&&-1<LC.indexOf(s)){for(;v!==null;){var x=$r(v);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var C=Ts(x.pendingLanes);if(C!==0){var I=x;for(I.pendingLanes|=2,I.entangledLanes|=2;C;){var $=1<<31-mn(C);I.entanglements[1]|=$,C&=~$}Ls(x),(st&6)===0&&(uc=Je()+500,Mo(0))}}break;case 31:case 13:I=cr(x,2),I!==null&&Tn(I,x,2),fc(),dh(x,2)}if(x=hh(h),x===null&&Zf(s,a,h,_c,c),x===v)break;v=x}v!==null&&h.stopPropagation()}else Zf(s,a,h,null,c)}}function hh(s){return s=md(s),mh(s)}var _c=null;function mh(s){if(_c=null,s=jr(s),s!==null){var a=o(s);if(a===null)s=null;else{var c=a.tag;if(c===13){if(s=l(a),s!==null)return s;s=null}else if(c===31){if(s=u(a),s!==null)return s;s=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return _c=s,null}function Ny(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Jt()){case Ot:return 2;case fn:return 8;case us:case Gs:return 32;case bs:return 268435456;default:return 32}default:return 32}}var gh=!1,Mi=null,ki=null,Pi=null,$o=new Map,Go=new Map,Ui=[],LC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Oy(s,a){switch(s){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":$o.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Go.delete(a.pointerId)}}function zo(s,a,c,h,v,x){return s===null||s.nativeEvent!==x?(s={blockedOn:a,domEventName:c,eventSystemFlags:h,nativeEvent:x,targetContainers:[v]},a!==null&&(a=$r(a),a!==null&&Dy(a)),s):(s.eventSystemFlags|=h,a=s.targetContainers,v!==null&&a.indexOf(v)===-1&&a.push(v),s)}function _C(s,a,c,h,v){switch(a){case"focusin":return Mi=zo(Mi,s,a,c,h,v),!0;case"dragenter":return ki=zo(ki,s,a,c,h,v),!0;case"mouseover":return Pi=zo(Pi,s,a,c,h,v),!0;case"pointerover":var x=v.pointerId;return $o.set(x,zo($o.get(x)||null,s,a,c,h,v)),!0;case"gotpointercapture":return x=v.pointerId,Go.set(x,zo(Go.get(x)||null,s,a,c,h,v)),!0}return!1}function My(s){var a=jr(s.target);if(a!==null){var c=o(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){s.blockedOn=a,qg(s.priority,function(){Iy(c)});return}}else if(a===31){if(a=u(c),a!==null){s.blockedOn=a,qg(s.priority,function(){Iy(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function wc(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var c=hh(s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);hd=h,c.target.dispatchEvent(h),hd=null}else return a=$r(c),a!==null&&Dy(a),s.blockedOn=c,!1;a.shift()}return!0}function ky(s,a,c){wc(s)&&c.delete(a)}function wC(){gh=!1,Mi!==null&&wc(Mi)&&(Mi=null),ki!==null&&wc(ki)&&(ki=null),Pi!==null&&wc(Pi)&&(Pi=null),$o.forEach(ky),Go.forEach(ky)}function Dc(s,a){s.blockedOn===a&&(s.blockedOn=null,gh||(gh=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,wC)))}var Ic=null;function Py(s){Ic!==s&&(Ic=s,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Ic===s&&(Ic=null);for(var a=0;a<s.length;a+=3){var c=s[a],h=s[a+1],v=s[a+2];if(typeof h!="function"){if(mh(h||c)===null)continue;break}var x=$r(c);x!==null&&(s.splice(a,3),a-=3,hf(x,{pending:!0,data:v,method:c.method,action:h},h,v))}}))}function ba(s){function a($){return Dc($,s)}Mi!==null&&Dc(Mi,s),ki!==null&&Dc(ki,s),Pi!==null&&Dc(Pi,s),$o.forEach(a),Go.forEach(a);for(var c=0;c<Ui.length;c++){var h=Ui[c];h.blockedOn===s&&(h.blockedOn=null)}for(;0<Ui.length&&(c=Ui[0],c.blockedOn===null);)My(c),c.blockedOn===null&&Ui.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var v=c[h],x=c[h+1],C=v[vn]||null;if(typeof x=="function")C||Py(c);else if(C){var I=null;if(x&&x.hasAttribute("formAction")){if(v=x,C=x[vn]||null)I=C.formAction;else if(mh(v)!==null)continue}else I=C.action;typeof I=="function"?c[h+1]=I:(c.splice(h,3),h-=3),Py(c)}}}function Uy(){function s(x){x.canIntercept&&x.info==="react-transition"&&x.intercept({handler:function(){return new Promise(function(C){return v=C})},focusReset:"manual",scroll:"manual"})}function a(){v!==null&&(v(),v=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var x=navigation.currentEntry;x&&x.url!=null&&navigation.navigate(x.url,{state:x.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),v!==null&&(v(),v=null)}}}function ph(s){this._internalRoot=s}Nc.prototype.render=ph.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(n(409));var c=a.current,h=Bn();_y(c,h,s,a,null,null)},Nc.prototype.unmount=ph.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;_y(s.current,2,null,s,null,null),fc(),a[Br]=null}};function Nc(s){this._internalRoot=s}Nc.prototype.unstable_scheduleHydration=function(s){if(s){var a=Yg();s={blockedOn:null,target:s,priority:a};for(var c=0;c<Ui.length&&a!==0&&a<Ui[c].priority;c++);Ui.splice(c,0,s),c===0&&My(s)}};var Fy=e.version;if(Fy!=="19.2.3")throw Error(n(527,Fy,"19.2.3"));K.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=d(a),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var DC={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:P,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oc.isDisabled&&Oc.supportsFiber)try{hn=Oc.inject(DC),zt=Oc}catch{}}return Vo.createRoot=function(s,a){if(!r(s))throw Error(n(299));var c=!1,h="",v=Vp,x=Kp,C=Yp;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(x=a.onCaughtError),a.onRecoverableError!==void 0&&(C=a.onRecoverableError)),a=Cy(s,1,!1,null,null,c,h,null,v,x,C,Uy),s[Br]=a.current,Qf(s),new ph(a)},Vo.hydrateRoot=function(s,a,c){if(!r(s))throw Error(n(299));var h=!1,v="",x=Vp,C=Kp,I=Yp,$=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(I=c.onRecoverableError),c.formState!==void 0&&($=c.formState)),a=Cy(s,1,!0,a,c??null,h,v,$,x,C,I,Uy),a.context=Ly(null),c=a.current,h=Bn(),h=Fr(h),v=bi(h),v.callback=null,Ti(c,v,h),c=h,a.current.lanes=c,ke(a,c),Ls(a),s[Br]=a.current,Qf(s),new Nc(a)},Vo.version="19.2.3",Vo}var qy;function jC(){if(qy)return xh.exports;qy=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),xh.exports=BC(),xh.exports}var $C=jC();function Xy(i,e){if(typeof i=="function")return i(e);i!=null&&(i.current=e)}function Or(...i){return e=>{let t=!1;const n=i.map(r=>{const o=Xy(r,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let r=0;r<n.length;r++){const o=n[r];typeof o=="function"?o():Xy(i[r],null)}}}}function yt(...i){return R.useCallback(Or(...i),i)}var GC=Symbol.for("react.lazy"),gu=jm[" use ".trim().toString()];function zC(i){return typeof i=="object"&&i!==null&&"then"in i}function tS(i){return i!=null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===GC&&"_payload"in i&&zC(i._payload)}function $m(i){const e=HC(i),t=R.forwardRef((n,r)=>{let{children:o,...l}=n;tS(o)&&typeof gu=="function"&&(o=gu(o._payload));const u=R.Children.toArray(o),f=u.find(KC);if(f){const d=f.props.children,m=u.map(g=>g===f?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:g);return y.jsx(e,{...l,ref:r,children:R.isValidElement(d)?R.cloneElement(d,void 0,m):null})}return y.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${i}.Slot`,t}var nS=$m("Slot");function HC(i){const e=R.forwardRef((t,n)=>{let{children:r,...o}=t;if(tS(r)&&typeof gu=="function"&&(r=gu(r._payload)),R.isValidElement(r)){const l=qC(r),u=YC(o,r.props);return r.type!==R.Fragment&&(u.ref=n?Or(n,l):l),R.cloneElement(r,u)}return R.Children.count(r)>1?R.Children.only(null):null});return e.displayName=`${i}.SlotClone`,e}var VC=Symbol("radix.slottable");function KC(i){return R.isValidElement(i)&&typeof i.type=="function"&&"__radixId"in i.type&&i.type.__radixId===VC}function YC(i,e){const t={...e};for(const n in e){const r=i[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...i,...t}}function qC(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}function sS(i){var e,t,n="";if(typeof i=="string"||typeof i=="number")n+=i;else if(typeof i=="object")if(Array.isArray(i)){var r=i.length;for(e=0;e<r;e++)i[e]&&(t=sS(i[e]))&&(n&&(n+=" "),n+=t)}else for(t in i)i[t]&&(n&&(n+=" "),n+=t);return n}function iS(){for(var i,e,t=0,n="",r=arguments.length;t<r;t++)(i=arguments[t])&&(e=sS(i))&&(n&&(n+=" "),n+=e);return n}const Wy=i=>typeof i=="boolean"?`${i}`:i===0?"0":i,Qy=iS,Gm=(i,e)=>t=>{var n;if(e?.variants==null)return Qy(i,t?.class,t?.className);const{variants:r,defaultVariants:o}=e,l=Object.keys(r).map(d=>{const m=t?.[d],g=o?.[d];if(m===null)return null;const p=Wy(m)||Wy(g);return r[d][p]}),u=t&&Object.entries(t).reduce((d,m)=>{let[g,p]=m;return p===void 0||(d[g]=p),d},{}),f=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,m)=>{let{class:g,className:p,...E}=m;return Object.entries(E).every(S=>{let[b,T]=S;return Array.isArray(T)?T.includes({...o,...u}[b]):{...o,...u}[b]===T})?[...d,g,p]:d},[]);return Qy(i,l,f,t?.class,t?.className)},XC=(i,e)=>{const t=new Array(i.length+e.length);for(let n=0;n<i.length;n++)t[n]=i[n];for(let n=0;n<e.length;n++)t[i.length+n]=e[n];return t},WC=(i,e)=>({classGroupId:i,validator:e}),rS=(i=new Map,e=null,t)=>({nextPart:i,validators:e,classGroupId:t}),pu="-",Zy=[],QC="arbitrary..",ZC=i=>{const e=eL(i),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=i;return{getClassGroupId:l=>{if(l.startsWith("[")&&l.endsWith("]"))return JC(l);const u=l.split(pu),f=u[0]===""&&u.length>1?1:0;return aS(u,f,e)},getConflictingClassGroupIds:(l,u)=>{if(u){const f=n[l],d=t[l];return f?d?XC(d,f):f:d||Zy}return t[l]||Zy}}},aS=(i,e,t)=>{if(i.length-e===0)return t.classGroupId;const r=i[e],o=t.nextPart.get(r);if(o){const d=aS(i,e+1,o);if(d)return d}const l=t.validators;if(l===null)return;const u=e===0?i.join(pu):i.slice(e).join(pu),f=l.length;for(let d=0;d<f;d++){const m=l[d];if(m.validator(u))return m.classGroupId}},JC=i=>i.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=i.slice(1,-1),t=e.indexOf(":"),n=e.slice(0,t);return n?QC+n:void 0})(),eL=i=>{const{theme:e,classGroups:t}=i;return tL(t,e)},tL=(i,e)=>{const t=rS();for(const n in i){const r=i[n];zm(r,t,n,e)}return t},zm=(i,e,t,n)=>{const r=i.length;for(let o=0;o<r;o++){const l=i[o];nL(l,e,t,n)}},nL=(i,e,t,n)=>{if(typeof i=="string"){sL(i,e,t);return}if(typeof i=="function"){iL(i,e,t,n);return}rL(i,e,t,n)},sL=(i,e,t)=>{const n=i===""?e:oS(e,i);n.classGroupId=t},iL=(i,e,t,n)=>{if(aL(i)){zm(i(n),e,t,n);return}e.validators===null&&(e.validators=[]),e.validators.push(WC(t,i))},rL=(i,e,t,n)=>{const r=Object.entries(i),o=r.length;for(let l=0;l<o;l++){const[u,f]=r[l];zm(f,oS(e,u),t,n)}},oS=(i,e)=>{let t=i;const n=e.split(pu),r=n.length;for(let o=0;o<r;o++){const l=n[o];let u=t.nextPart.get(l);u||(u=rS(),t.nextPart.set(l,u)),t=u}return t},aL=i=>"isThemeGetter"in i&&i.isThemeGetter===!0,oL=i=>{if(i<1)return{get:()=>{},set:()=>{}};let e=0,t=Object.create(null),n=Object.create(null);const r=(o,l)=>{t[o]=l,e++,e>i&&(e=0,n=t,t=Object.create(null))};return{get(o){let l=t[o];if(l!==void 0)return l;if((l=n[o])!==void 0)return r(o,l),l},set(o,l){o in t?t[o]=l:r(o,l)}}},cm="!",Jy=":",lL=[],ex=(i,e,t,n,r)=>({modifiers:i,hasImportantModifier:e,baseClassName:t,maybePostfixModifierPosition:n,isExternal:r}),cL=i=>{const{prefix:e,experimentalParseClassName:t}=i;let n=r=>{const o=[];let l=0,u=0,f=0,d;const m=r.length;for(let b=0;b<m;b++){const T=r[b];if(l===0&&u===0){if(T===Jy){o.push(r.slice(f,b)),f=b+1;continue}if(T==="/"){d=b;continue}}T==="["?l++:T==="]"?l--:T==="("?u++:T===")"&&u--}const g=o.length===0?r:r.slice(f);let p=g,E=!1;g.endsWith(cm)?(p=g.slice(0,-1),E=!0):g.startsWith(cm)&&(p=g.slice(1),E=!0);const S=d&&d>f?d-f:void 0;return ex(o,E,p,S)};if(e){const r=e+Jy,o=n;n=l=>l.startsWith(r)?o(l.slice(r.length)):ex(lL,!1,l,void 0,!0)}if(t){const r=n;n=o=>t({className:o,parseClassName:r})}return n},uL=i=>{const e=new Map;return i.orderSensitiveModifiers.forEach((t,n)=>{e.set(t,1e6+n)}),t=>{const n=[];let r=[];for(let o=0;o<t.length;o++){const l=t[o],u=l[0]==="[",f=e.has(l);u||f?(r.length>0&&(r.sort(),n.push(...r),r=[]),n.push(l)):r.push(l)}return r.length>0&&(r.sort(),n.push(...r)),n}},dL=i=>({cache:oL(i.cacheSize),parseClassName:cL(i),sortModifiers:uL(i),...ZC(i)}),fL=/\s+/,hL=(i,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:r,sortModifiers:o}=e,l=[],u=i.trim().split(fL);let f="";for(let d=u.length-1;d>=0;d-=1){const m=u[d],{isExternal:g,modifiers:p,hasImportantModifier:E,baseClassName:S,maybePostfixModifierPosition:b}=t(m);if(g){f=m+(f.length>0?" "+f:f);continue}let T=!!b,A=n(T?S.substring(0,b):S);if(!A){if(!T){f=m+(f.length>0?" "+f:f);continue}if(A=n(S),!A){f=m+(f.length>0?" "+f:f);continue}T=!1}const _=p.length===0?"":p.length===1?p[0]:o(p).join(":"),w=E?_+cm:_,D=w+A;if(l.indexOf(D)>-1)continue;l.push(D);const O=r(A,T);for(let B=0;B<O.length;++B){const N=O[B];l.push(w+N)}f=m+(f.length>0?" "+f:f)}return f},mL=(...i)=>{let e=0,t,n,r="";for(;e<i.length;)(t=i[e++])&&(n=lS(t))&&(r&&(r+=" "),r+=n);return r},lS=i=>{if(typeof i=="string")return i;let e,t="";for(let n=0;n<i.length;n++)i[n]&&(e=lS(i[n]))&&(t&&(t+=" "),t+=e);return t},gL=(i,...e)=>{let t,n,r,o;const l=f=>{const d=e.reduce((m,g)=>g(m),i());return t=dL(d),n=t.cache.get,r=t.cache.set,o=u,u(f)},u=f=>{const d=n(f);if(d)return d;const m=hL(f,t);return r(f,m),m};return o=l,(...f)=>o(mL(...f))},pL=[],Vt=i=>{const e=t=>t[i]||pL;return e.isThemeGetter=!0,e},cS=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,uS=/^\((?:(\w[\w-]*):)?(.+)\)$/i,vL=/^\d+\/\d+$/,yL=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,xL=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,EL=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,SL=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,bL=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ta=i=>vL.test(i),Fe=i=>!!i&&!Number.isNaN(Number(i)),Bi=i=>!!i&&Number.isInteger(Number(i)),Th=i=>i.endsWith("%")&&Fe(i.slice(0,-1)),oi=i=>yL.test(i),TL=()=>!0,AL=i=>xL.test(i)&&!EL.test(i),dS=()=>!1,RL=i=>SL.test(i),CL=i=>bL.test(i),LL=i=>!xe(i)&&!Ee(i),_L=i=>Ya(i,mS,dS),xe=i=>cS.test(i),br=i=>Ya(i,gS,AL),Ah=i=>Ya(i,OL,Fe),tx=i=>Ya(i,fS,dS),wL=i=>Ya(i,hS,CL),Mc=i=>Ya(i,pS,RL),Ee=i=>uS.test(i),Ko=i=>qa(i,gS),DL=i=>qa(i,ML),nx=i=>qa(i,fS),IL=i=>qa(i,mS),NL=i=>qa(i,hS),kc=i=>qa(i,pS,!0),Ya=(i,e,t)=>{const n=cS.exec(i);return n?n[1]?e(n[1]):t(n[2]):!1},qa=(i,e,t=!1)=>{const n=uS.exec(i);return n?n[1]?e(n[1]):t:!1},fS=i=>i==="position"||i==="percentage",hS=i=>i==="image"||i==="url",mS=i=>i==="length"||i==="size"||i==="bg-size",gS=i=>i==="length",OL=i=>i==="number",ML=i=>i==="family-name",pS=i=>i==="shadow",kL=()=>{const i=Vt("color"),e=Vt("font"),t=Vt("text"),n=Vt("font-weight"),r=Vt("tracking"),o=Vt("leading"),l=Vt("breakpoint"),u=Vt("container"),f=Vt("spacing"),d=Vt("radius"),m=Vt("shadow"),g=Vt("inset-shadow"),p=Vt("text-shadow"),E=Vt("drop-shadow"),S=Vt("blur"),b=Vt("perspective"),T=Vt("aspect"),A=Vt("ease"),_=Vt("animate"),w=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],O=()=>[...D(),Ee,xe],B=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto","contain","none"],U=()=>[Ee,xe,f],k=()=>[Ta,"full","auto",...U()],F=()=>[Bi,"none","subgrid",Ee,xe],H=()=>["auto",{span:["full",Bi,Ee,xe]},Bi,Ee,xe],ne=()=>[Bi,"auto",Ee,xe],J=()=>["auto","min","max","fr",Ee,xe],le=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],de=()=>["start","end","center","stretch","center-safe","end-safe"],P=()=>["auto",...U()],K=()=>[Ta,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...U()],j=()=>[i,Ee,xe],W=()=>[...D(),nx,tx,{position:[Ee,xe]}],he=()=>["no-repeat",{repeat:["","x","y","space","round"]}],M=()=>["auto","cover","contain",IL,_L,{size:[Ee,xe]}],G=()=>[Th,Ko,br],te=()=>["","none","full",d,Ee,xe],V=()=>["",Fe,Ko,br],se=()=>["solid","dashed","dotted","double"],ce=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>[Fe,Th,nx,tx],ve=()=>["","none",S,Ee,xe],Ae=()=>["none",Fe,Ee,xe],Qe=()=>["none",Fe,Ee,xe],Ze=()=>[Fe,Ee,xe],Lt=()=>[Ta,"full",...U()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[oi],breakpoint:[oi],color:[TL],container:[oi],"drop-shadow":[oi],ease:["in","out","in-out"],font:[LL],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[oi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[oi],shadow:[oi],spacing:["px",Fe],text:[oi],"text-shadow":[oi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Ta,xe,Ee,T]}],container:["container"],columns:[{columns:[Fe,xe,Ee,u]}],"break-after":[{"break-after":w()}],"break-before":[{"break-before":w()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:O()}],overflow:[{overflow:B()}],"overflow-x":[{"overflow-x":B()}],"overflow-y":[{"overflow-y":B()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:k()}],"inset-x":[{"inset-x":k()}],"inset-y":[{"inset-y":k()}],start:[{start:k()}],end:[{end:k()}],top:[{top:k()}],right:[{right:k()}],bottom:[{bottom:k()}],left:[{left:k()}],visibility:["visible","invisible","collapse"],z:[{z:[Bi,"auto",Ee,xe]}],basis:[{basis:[Ta,"full","auto",u,...U()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Fe,Ta,"auto","initial","none",xe]}],grow:[{grow:["",Fe,Ee,xe]}],shrink:[{shrink:["",Fe,Ee,xe]}],order:[{order:[Bi,"first","last","none",Ee,xe]}],"grid-cols":[{"grid-cols":F()}],"col-start-end":[{col:H()}],"col-start":[{"col-start":ne()}],"col-end":[{"col-end":ne()}],"grid-rows":[{"grid-rows":F()}],"row-start-end":[{row:H()}],"row-start":[{"row-start":ne()}],"row-end":[{"row-end":ne()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":J()}],"auto-rows":[{"auto-rows":J()}],gap:[{gap:U()}],"gap-x":[{"gap-x":U()}],"gap-y":[{"gap-y":U()}],"justify-content":[{justify:[...le(),"normal"]}],"justify-items":[{"justify-items":[...de(),"normal"]}],"justify-self":[{"justify-self":["auto",...de()]}],"align-content":[{content:["normal",...le()]}],"align-items":[{items:[...de(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...de(),{baseline:["","last"]}]}],"place-content":[{"place-content":le()}],"place-items":[{"place-items":[...de(),"baseline"]}],"place-self":[{"place-self":["auto",...de()]}],p:[{p:U()}],px:[{px:U()}],py:[{py:U()}],ps:[{ps:U()}],pe:[{pe:U()}],pt:[{pt:U()}],pr:[{pr:U()}],pb:[{pb:U()}],pl:[{pl:U()}],m:[{m:P()}],mx:[{mx:P()}],my:[{my:P()}],ms:[{ms:P()}],me:[{me:P()}],mt:[{mt:P()}],mr:[{mr:P()}],mb:[{mb:P()}],ml:[{ml:P()}],"space-x":[{"space-x":U()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":U()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[u,"screen",...K()]}],"min-w":[{"min-w":[u,"screen","none",...K()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[l]},...K()]}],h:[{h:["screen","lh",...K()]}],"min-h":[{"min-h":["screen","lh","none",...K()]}],"max-h":[{"max-h":["screen","lh",...K()]}],"font-size":[{text:["base",t,Ko,br]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Ee,Ah]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Th,xe]}],"font-family":[{font:[DL,xe,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,Ee,xe]}],"line-clamp":[{"line-clamp":[Fe,"none",Ee,Ah]}],leading:[{leading:[o,...U()]}],"list-image":[{"list-image":["none",Ee,xe]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ee,xe]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:j()}],"text-color":[{text:j()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...se(),"wavy"]}],"text-decoration-thickness":[{decoration:[Fe,"from-font","auto",Ee,br]}],"text-decoration-color":[{decoration:j()}],"underline-offset":[{"underline-offset":[Fe,"auto",Ee,xe]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ee,xe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ee,xe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:W()}],"bg-repeat":[{bg:he()}],"bg-size":[{bg:M()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Bi,Ee,xe],radial:["",Ee,xe],conic:[Bi,Ee,xe]},NL,wL]}],"bg-color":[{bg:j()}],"gradient-from-pos":[{from:G()}],"gradient-via-pos":[{via:G()}],"gradient-to-pos":[{to:G()}],"gradient-from":[{from:j()}],"gradient-via":[{via:j()}],"gradient-to":[{to:j()}],rounded:[{rounded:te()}],"rounded-s":[{"rounded-s":te()}],"rounded-e":[{"rounded-e":te()}],"rounded-t":[{"rounded-t":te()}],"rounded-r":[{"rounded-r":te()}],"rounded-b":[{"rounded-b":te()}],"rounded-l":[{"rounded-l":te()}],"rounded-ss":[{"rounded-ss":te()}],"rounded-se":[{"rounded-se":te()}],"rounded-ee":[{"rounded-ee":te()}],"rounded-es":[{"rounded-es":te()}],"rounded-tl":[{"rounded-tl":te()}],"rounded-tr":[{"rounded-tr":te()}],"rounded-br":[{"rounded-br":te()}],"rounded-bl":[{"rounded-bl":te()}],"border-w":[{border:V()}],"border-w-x":[{"border-x":V()}],"border-w-y":[{"border-y":V()}],"border-w-s":[{"border-s":V()}],"border-w-e":[{"border-e":V()}],"border-w-t":[{"border-t":V()}],"border-w-r":[{"border-r":V()}],"border-w-b":[{"border-b":V()}],"border-w-l":[{"border-l":V()}],"divide-x":[{"divide-x":V()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":V()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...se(),"hidden","none"]}],"divide-style":[{divide:[...se(),"hidden","none"]}],"border-color":[{border:j()}],"border-color-x":[{"border-x":j()}],"border-color-y":[{"border-y":j()}],"border-color-s":[{"border-s":j()}],"border-color-e":[{"border-e":j()}],"border-color-t":[{"border-t":j()}],"border-color-r":[{"border-r":j()}],"border-color-b":[{"border-b":j()}],"border-color-l":[{"border-l":j()}],"divide-color":[{divide:j()}],"outline-style":[{outline:[...se(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Fe,Ee,xe]}],"outline-w":[{outline:["",Fe,Ko,br]}],"outline-color":[{outline:j()}],shadow:[{shadow:["","none",m,kc,Mc]}],"shadow-color":[{shadow:j()}],"inset-shadow":[{"inset-shadow":["none",g,kc,Mc]}],"inset-shadow-color":[{"inset-shadow":j()}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:j()}],"ring-offset-w":[{"ring-offset":[Fe,br]}],"ring-offset-color":[{"ring-offset":j()}],"inset-ring-w":[{"inset-ring":V()}],"inset-ring-color":[{"inset-ring":j()}],"text-shadow":[{"text-shadow":["none",p,kc,Mc]}],"text-shadow-color":[{"text-shadow":j()}],opacity:[{opacity:[Fe,Ee,xe]}],"mix-blend":[{"mix-blend":[...ce(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":ce()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Fe]}],"mask-image-linear-from-pos":[{"mask-linear-from":fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":fe()}],"mask-image-linear-from-color":[{"mask-linear-from":j()}],"mask-image-linear-to-color":[{"mask-linear-to":j()}],"mask-image-t-from-pos":[{"mask-t-from":fe()}],"mask-image-t-to-pos":[{"mask-t-to":fe()}],"mask-image-t-from-color":[{"mask-t-from":j()}],"mask-image-t-to-color":[{"mask-t-to":j()}],"mask-image-r-from-pos":[{"mask-r-from":fe()}],"mask-image-r-to-pos":[{"mask-r-to":fe()}],"mask-image-r-from-color":[{"mask-r-from":j()}],"mask-image-r-to-color":[{"mask-r-to":j()}],"mask-image-b-from-pos":[{"mask-b-from":fe()}],"mask-image-b-to-pos":[{"mask-b-to":fe()}],"mask-image-b-from-color":[{"mask-b-from":j()}],"mask-image-b-to-color":[{"mask-b-to":j()}],"mask-image-l-from-pos":[{"mask-l-from":fe()}],"mask-image-l-to-pos":[{"mask-l-to":fe()}],"mask-image-l-from-color":[{"mask-l-from":j()}],"mask-image-l-to-color":[{"mask-l-to":j()}],"mask-image-x-from-pos":[{"mask-x-from":fe()}],"mask-image-x-to-pos":[{"mask-x-to":fe()}],"mask-image-x-from-color":[{"mask-x-from":j()}],"mask-image-x-to-color":[{"mask-x-to":j()}],"mask-image-y-from-pos":[{"mask-y-from":fe()}],"mask-image-y-to-pos":[{"mask-y-to":fe()}],"mask-image-y-from-color":[{"mask-y-from":j()}],"mask-image-y-to-color":[{"mask-y-to":j()}],"mask-image-radial":[{"mask-radial":[Ee,xe]}],"mask-image-radial-from-pos":[{"mask-radial-from":fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":fe()}],"mask-image-radial-from-color":[{"mask-radial-from":j()}],"mask-image-radial-to-color":[{"mask-radial-to":j()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[Fe]}],"mask-image-conic-from-pos":[{"mask-conic-from":fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":fe()}],"mask-image-conic-from-color":[{"mask-conic-from":j()}],"mask-image-conic-to-color":[{"mask-conic-to":j()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:W()}],"mask-repeat":[{mask:he()}],"mask-size":[{mask:M()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ee,xe]}],filter:[{filter:["","none",Ee,xe]}],blur:[{blur:ve()}],brightness:[{brightness:[Fe,Ee,xe]}],contrast:[{contrast:[Fe,Ee,xe]}],"drop-shadow":[{"drop-shadow":["","none",E,kc,Mc]}],"drop-shadow-color":[{"drop-shadow":j()}],grayscale:[{grayscale:["",Fe,Ee,xe]}],"hue-rotate":[{"hue-rotate":[Fe,Ee,xe]}],invert:[{invert:["",Fe,Ee,xe]}],saturate:[{saturate:[Fe,Ee,xe]}],sepia:[{sepia:["",Fe,Ee,xe]}],"backdrop-filter":[{"backdrop-filter":["","none",Ee,xe]}],"backdrop-blur":[{"backdrop-blur":ve()}],"backdrop-brightness":[{"backdrop-brightness":[Fe,Ee,xe]}],"backdrop-contrast":[{"backdrop-contrast":[Fe,Ee,xe]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Fe,Ee,xe]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Fe,Ee,xe]}],"backdrop-invert":[{"backdrop-invert":["",Fe,Ee,xe]}],"backdrop-opacity":[{"backdrop-opacity":[Fe,Ee,xe]}],"backdrop-saturate":[{"backdrop-saturate":[Fe,Ee,xe]}],"backdrop-sepia":[{"backdrop-sepia":["",Fe,Ee,xe]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":U()}],"border-spacing-x":[{"border-spacing-x":U()}],"border-spacing-y":[{"border-spacing-y":U()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ee,xe]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Fe,"initial",Ee,xe]}],ease:[{ease:["linear","initial",A,Ee,xe]}],delay:[{delay:[Fe,Ee,xe]}],animate:[{animate:["none",_,Ee,xe]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,Ee,xe]}],"perspective-origin":[{"perspective-origin":O()}],rotate:[{rotate:Ae()}],"rotate-x":[{"rotate-x":Ae()}],"rotate-y":[{"rotate-y":Ae()}],"rotate-z":[{"rotate-z":Ae()}],scale:[{scale:Qe()}],"scale-x":[{"scale-x":Qe()}],"scale-y":[{"scale-y":Qe()}],"scale-z":[{"scale-z":Qe()}],"scale-3d":["scale-3d"],skew:[{skew:Ze()}],"skew-x":[{"skew-x":Ze()}],"skew-y":[{"skew-y":Ze()}],transform:[{transform:[Ee,xe,"","none","gpu","cpu"]}],"transform-origin":[{origin:O()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Lt()}],"translate-x":[{"translate-x":Lt()}],"translate-y":[{"translate-y":Lt()}],"translate-z":[{"translate-z":Lt()}],"translate-none":["translate-none"],accent:[{accent:j()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:j()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ee,xe]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ee,xe]}],fill:[{fill:["none",...j()]}],"stroke-w":[{stroke:[Fe,Ko,br,Ah]}],stroke:[{stroke:["none",...j()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},PL=gL(kL);function vt(...i){return PL(iS(i))}const UL=Gm("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",xs:"h-6 gap-1 rounded-md px-2 text-xs has-[>svg]:px-1.5 [&_svg:not([class*='size-'])]:size-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-xs":"size-6 rounded-md [&_svg:not([class*='size-'])]:size-3","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function Ce({className:i,variant:e="default",size:t="default",asChild:n=!1,...r}){const o=n?nS:"button";return y.jsx(o,{"data-slot":"button","data-variant":e,"data-size":t,className:vt(UL({variant:e,size:t,className:i})),...r})}var Hm=eS();const FL=JE(Hm);function BL(i){const e=jL(i),t=R.forwardRef((n,r)=>{const{children:o,...l}=n,u=R.Children.toArray(o),f=u.find(GL);if(f){const d=f.props.children,m=u.map(g=>g===f?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:g);return y.jsx(e,{...l,ref:r,children:R.isValidElement(d)?R.cloneElement(d,void 0,m):null})}return y.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${i}.Slot`,t}function jL(i){const e=R.forwardRef((t,n)=>{const{children:r,...o}=t;if(R.isValidElement(r)){const l=HL(r),u=zL(o,r.props);return r.type!==R.Fragment&&(u.ref=n?Or(n,l):l),R.cloneElement(r,u)}return R.Children.count(r)>1?R.Children.only(null):null});return e.displayName=`${i}.SlotClone`,e}var $L=Symbol("radix.slottable");function GL(i){return R.isValidElement(i)&&typeof i.type=="function"&&"__radixId"in i.type&&i.type.__radixId===$L}function zL(i,e){const t={...e};for(const n in e){const r=i[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...i,...t}}function HL(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}var VL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ct=VL.reduce((i,e)=>{const t=BL(`Primitive.${e}`),n=R.forwardRef((r,o)=>{const{asChild:l,...u}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),y.jsx(f,{...u,ref:o})});return n.displayName=`Primitive.${e}`,{...i,[e]:n}},{});function vS(i,e){i&&Hm.flushSync(()=>i.dispatchEvent(e))}var fi=globalThis?.document?R.useLayoutEffect:()=>{};function KL(i,e){return R.useReducer((t,n)=>e[t][n]??t,i)}var os=i=>{const{present:e,children:t}=i,n=YL(e),r=typeof t=="function"?t({present:n.isPresent}):R.Children.only(t),o=yt(n.ref,qL(r));return typeof t=="function"||n.isPresent?R.cloneElement(r,{ref:o}):null};os.displayName="Presence";function YL(i){const[e,t]=R.useState(),n=R.useRef(null),r=R.useRef(i),o=R.useRef("none"),l=i?"mounted":"unmounted",[u,f]=KL(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return R.useEffect(()=>{const d=Pc(n.current);o.current=u==="mounted"?d:"none"},[u]),fi(()=>{const d=n.current,m=r.current;if(m!==i){const p=o.current,E=Pc(d);i?f("MOUNT"):E==="none"||d?.display==="none"?f("UNMOUNT"):f(m&&p!==E?"ANIMATION_OUT":"UNMOUNT"),r.current=i}},[i,f]),fi(()=>{if(e){let d;const m=e.ownerDocument.defaultView??window,g=E=>{const b=Pc(n.current).includes(CSS.escape(E.animationName));if(E.target===e&&b&&(f("ANIMATION_END"),!r.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",d=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},p=E=>{E.target===e&&(o.current=Pc(n.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",g),e.addEventListener("animationend",g),()=>{m.clearTimeout(d),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",g),e.removeEventListener("animationend",g)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:R.useCallback(d=>{n.current=d?getComputedStyle(d):null,t(d)},[])}}function Pc(i){return i?.animationName||"none"}function qL(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}function XL(i,e){const t=R.createContext(e),n=o=>{const{children:l,...u}=o,f=R.useMemo(()=>u,Object.values(u));return y.jsx(t.Provider,{value:f,children:l})};n.displayName=i+"Provider";function r(o){const l=R.useContext(t);if(l)return l;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${i}\``)}return[n,r]}function Ji(i,e=[]){let t=[];function n(o,l){const u=R.createContext(l),f=t.length;t=[...t,l];const d=g=>{const{scope:p,children:E,...S}=g,b=p?.[i]?.[f]||u,T=R.useMemo(()=>S,Object.values(S));return y.jsx(b.Provider,{value:T,children:E})};d.displayName=o+"Provider";function m(g,p){const E=p?.[i]?.[f]||u,S=R.useContext(E);if(S)return S;if(l!==void 0)return l;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[d,m]}const r=()=>{const o=t.map(l=>R.createContext(l));return function(u){const f=u?.[i]||o;return R.useMemo(()=>({[`__scope${i}`]:{...u,[i]:f}}),[u,f])}};return r.scopeName=i,[n,WL(r,...e)]}function WL(...i){const e=i[0];if(i.length===1)return e;const t=()=>{const n=i.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const l=n.reduce((u,{useScope:f,scopeName:d})=>{const g=f(o)[`__scope${d}`];return{...u,...g}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}function dn(i){const e=R.useRef(i);return R.useEffect(()=>{e.current=i}),R.useMemo(()=>(...t)=>e.current?.(...t),[])}var QL=R.createContext(void 0);function Gu(i){const e=R.useContext(QL);return i||e||"ltr"}function ZL(i,[e,t]){return Math.min(t,Math.max(e,i))}function we(i,e,{checkForDefaultPrevented:t=!0}={}){return function(r){if(i?.(r),t===!1||!r.defaultPrevented)return e?.(r)}}function JL(i,e){return R.useReducer((t,n)=>e[t][n]??t,i)}var Vm="ScrollArea",[yS]=Ji(Vm),[e_,ls]=yS(Vm),xS=R.forwardRef((i,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:r,scrollHideDelay:o=600,...l}=i,[u,f]=R.useState(null),[d,m]=R.useState(null),[g,p]=R.useState(null),[E,S]=R.useState(null),[b,T]=R.useState(null),[A,_]=R.useState(0),[w,D]=R.useState(0),[O,B]=R.useState(!1),[N,U]=R.useState(!1),k=yt(e,H=>f(H)),F=Gu(r);return y.jsx(e_,{scope:t,type:n,dir:F,scrollHideDelay:o,scrollArea:u,viewport:d,onViewportChange:m,content:g,onContentChange:p,scrollbarX:E,onScrollbarXChange:S,scrollbarXEnabled:O,onScrollbarXEnabledChange:B,scrollbarY:b,onScrollbarYChange:T,scrollbarYEnabled:N,onScrollbarYEnabledChange:U,onCornerWidthChange:_,onCornerHeightChange:D,children:y.jsx(ct.div,{dir:F,...l,ref:k,style:{position:"relative","--radix-scroll-area-corner-width":A+"px","--radix-scroll-area-corner-height":w+"px",...i.style}})})});xS.displayName=Vm;var ES="ScrollAreaViewport",SS=R.forwardRef((i,e)=>{const{__scopeScrollArea:t,children:n,nonce:r,...o}=i,l=ls(ES,t),u=R.useRef(null),f=yt(e,u,l.onViewportChange);return y.jsxs(y.Fragment,{children:[y.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),y.jsx(ct.div,{"data-radix-scroll-area-viewport":"",...o,ref:f,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...i.style},children:y.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});SS.displayName=ES;var js="ScrollAreaScrollbar",bS=R.forwardRef((i,e)=>{const{forceMount:t,...n}=i,r=ls(js,i.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:l}=r,u=i.orientation==="horizontal";return R.useEffect(()=>(u?o(!0):l(!0),()=>{u?o(!1):l(!1)}),[u,o,l]),r.type==="hover"?y.jsx(t_,{...n,ref:e,forceMount:t}):r.type==="scroll"?y.jsx(n_,{...n,ref:e,forceMount:t}):r.type==="auto"?y.jsx(TS,{...n,ref:e,forceMount:t}):r.type==="always"?y.jsx(Km,{...n,ref:e}):null});bS.displayName=js;var t_=R.forwardRef((i,e)=>{const{forceMount:t,...n}=i,r=ls(js,i.__scopeScrollArea),[o,l]=R.useState(!1);return R.useEffect(()=>{const u=r.scrollArea;let f=0;if(u){const d=()=>{window.clearTimeout(f),l(!0)},m=()=>{f=window.setTimeout(()=>l(!1),r.scrollHideDelay)};return u.addEventListener("pointerenter",d),u.addEventListener("pointerleave",m),()=>{window.clearTimeout(f),u.removeEventListener("pointerenter",d),u.removeEventListener("pointerleave",m)}}},[r.scrollArea,r.scrollHideDelay]),y.jsx(os,{present:t||o,children:y.jsx(TS,{"data-state":o?"visible":"hidden",...n,ref:e})})}),n_=R.forwardRef((i,e)=>{const{forceMount:t,...n}=i,r=ls(js,i.__scopeScrollArea),o=i.orientation==="horizontal",l=Hu(()=>f("SCROLL_END"),100),[u,f]=JL("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return R.useEffect(()=>{if(u==="idle"){const d=window.setTimeout(()=>f("HIDE"),r.scrollHideDelay);return()=>window.clearTimeout(d)}},[u,r.scrollHideDelay,f]),R.useEffect(()=>{const d=r.viewport,m=o?"scrollLeft":"scrollTop";if(d){let g=d[m];const p=()=>{const E=d[m];g!==E&&(f("SCROLL"),l()),g=E};return d.addEventListener("scroll",p),()=>d.removeEventListener("scroll",p)}},[r.viewport,o,f,l]),y.jsx(os,{present:t||u!=="hidden",children:y.jsx(Km,{"data-state":u==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:we(i.onPointerEnter,()=>f("POINTER_ENTER")),onPointerLeave:we(i.onPointerLeave,()=>f("POINTER_LEAVE"))})})}),TS=R.forwardRef((i,e)=>{const t=ls(js,i.__scopeScrollArea),{forceMount:n,...r}=i,[o,l]=R.useState(!1),u=i.orientation==="horizontal",f=Hu(()=>{if(t.viewport){const d=t.viewport.offsetWidth<t.viewport.scrollWidth,m=t.viewport.offsetHeight<t.viewport.scrollHeight;l(u?d:m)}},10);return za(t.viewport,f),za(t.content,f),y.jsx(os,{present:n||o,children:y.jsx(Km,{"data-state":o?"visible":"hidden",...r,ref:e})})}),Km=R.forwardRef((i,e)=>{const{orientation:t="vertical",...n}=i,r=ls(js,i.__scopeScrollArea),o=R.useRef(null),l=R.useRef(0),[u,f]=R.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=_S(u.viewport,u.content),m={...n,sizes:u,onSizesChange:f,hasThumb:d>0&&d<1,onThumbChange:p=>o.current=p,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:p=>l.current=p};function g(p,E){return l_(p,l.current,u,E)}return t==="horizontal"?y.jsx(s_,{...m,ref:e,onThumbPositionChange:()=>{if(r.viewport&&o.current){const p=r.viewport.scrollLeft,E=sx(p,u,r.dir);o.current.style.transform=`translate3d(${E}px, 0, 0)`}},onWheelScroll:p=>{r.viewport&&(r.viewport.scrollLeft=p)},onDragScroll:p=>{r.viewport&&(r.viewport.scrollLeft=g(p,r.dir))}}):t==="vertical"?y.jsx(i_,{...m,ref:e,onThumbPositionChange:()=>{if(r.viewport&&o.current){const p=r.viewport.scrollTop,E=sx(p,u);o.current.style.transform=`translate3d(0, ${E}px, 0)`}},onWheelScroll:p=>{r.viewport&&(r.viewport.scrollTop=p)},onDragScroll:p=>{r.viewport&&(r.viewport.scrollTop=g(p))}}):null}),s_=R.forwardRef((i,e)=>{const{sizes:t,onSizesChange:n,...r}=i,o=ls(js,i.__scopeScrollArea),[l,u]=R.useState(),f=R.useRef(null),d=yt(e,f,o.onScrollbarXChange);return R.useEffect(()=>{f.current&&u(getComputedStyle(f.current))},[f]),y.jsx(RS,{"data-orientation":"horizontal",...r,ref:d,sizes:t,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":zu(t)+"px",...i.style},onThumbPointerDown:m=>i.onThumbPointerDown(m.x),onDragScroll:m=>i.onDragScroll(m.x),onWheelScroll:(m,g)=>{if(o.viewport){const p=o.viewport.scrollLeft+m.deltaX;i.onWheelScroll(p),DS(p,g)&&m.preventDefault()}},onResize:()=>{f.current&&o.viewport&&l&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:yu(l.paddingLeft),paddingEnd:yu(l.paddingRight)}})}})}),i_=R.forwardRef((i,e)=>{const{sizes:t,onSizesChange:n,...r}=i,o=ls(js,i.__scopeScrollArea),[l,u]=R.useState(),f=R.useRef(null),d=yt(e,f,o.onScrollbarYChange);return R.useEffect(()=>{f.current&&u(getComputedStyle(f.current))},[f]),y.jsx(RS,{"data-orientation":"vertical",...r,ref:d,sizes:t,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":zu(t)+"px",...i.style},onThumbPointerDown:m=>i.onThumbPointerDown(m.y),onDragScroll:m=>i.onDragScroll(m.y),onWheelScroll:(m,g)=>{if(o.viewport){const p=o.viewport.scrollTop+m.deltaY;i.onWheelScroll(p),DS(p,g)&&m.preventDefault()}},onResize:()=>{f.current&&o.viewport&&l&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:yu(l.paddingTop),paddingEnd:yu(l.paddingBottom)}})}})}),[r_,AS]=yS(js),RS=R.forwardRef((i,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:r,onThumbChange:o,onThumbPointerUp:l,onThumbPointerDown:u,onThumbPositionChange:f,onDragScroll:d,onWheelScroll:m,onResize:g,...p}=i,E=ls(js,t),[S,b]=R.useState(null),T=yt(e,k=>b(k)),A=R.useRef(null),_=R.useRef(""),w=E.viewport,D=n.content-n.viewport,O=dn(m),B=dn(f),N=Hu(g,10);function U(k){if(A.current){const F=k.clientX-A.current.left,H=k.clientY-A.current.top;d({x:F,y:H})}}return R.useEffect(()=>{const k=F=>{const H=F.target;S?.contains(H)&&O(F,D)};return document.addEventListener("wheel",k,{passive:!1}),()=>document.removeEventListener("wheel",k,{passive:!1})},[w,S,D,O]),R.useEffect(B,[n,B]),za(S,N),za(E.content,N),y.jsx(r_,{scope:t,scrollbar:S,hasThumb:r,onThumbChange:dn(o),onThumbPointerUp:dn(l),onThumbPositionChange:B,onThumbPointerDown:dn(u),children:y.jsx(ct.div,{...p,ref:T,style:{position:"absolute",...p.style},onPointerDown:we(i.onPointerDown,k=>{k.button===0&&(k.target.setPointerCapture(k.pointerId),A.current=S.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",E.viewport&&(E.viewport.style.scrollBehavior="auto"),U(k))}),onPointerMove:we(i.onPointerMove,U),onPointerUp:we(i.onPointerUp,k=>{const F=k.target;F.hasPointerCapture(k.pointerId)&&F.releasePointerCapture(k.pointerId),document.body.style.webkitUserSelect=_.current,E.viewport&&(E.viewport.style.scrollBehavior=""),A.current=null})})})}),vu="ScrollAreaThumb",CS=R.forwardRef((i,e)=>{const{forceMount:t,...n}=i,r=AS(vu,i.__scopeScrollArea);return y.jsx(os,{present:t||r.hasThumb,children:y.jsx(a_,{ref:e,...n})})}),a_=R.forwardRef((i,e)=>{const{__scopeScrollArea:t,style:n,...r}=i,o=ls(vu,t),l=AS(vu,t),{onThumbPositionChange:u}=l,f=yt(e,g=>l.onThumbChange(g)),d=R.useRef(void 0),m=Hu(()=>{d.current&&(d.current(),d.current=void 0)},100);return R.useEffect(()=>{const g=o.viewport;if(g){const p=()=>{if(m(),!d.current){const E=c_(g,u);d.current=E,u()}};return u(),g.addEventListener("scroll",p),()=>g.removeEventListener("scroll",p)}},[o.viewport,m,u]),y.jsx(ct.div,{"data-state":l.hasThumb?"visible":"hidden",...r,ref:f,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:we(i.onPointerDownCapture,g=>{const E=g.target.getBoundingClientRect(),S=g.clientX-E.left,b=g.clientY-E.top;l.onThumbPointerDown({x:S,y:b})}),onPointerUp:we(i.onPointerUp,l.onThumbPointerUp)})});CS.displayName=vu;var Ym="ScrollAreaCorner",LS=R.forwardRef((i,e)=>{const t=ls(Ym,i.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?y.jsx(o_,{...i,ref:e}):null});LS.displayName=Ym;var o_=R.forwardRef((i,e)=>{const{__scopeScrollArea:t,...n}=i,r=ls(Ym,t),[o,l]=R.useState(0),[u,f]=R.useState(0),d=!!(o&&u);return za(r.scrollbarX,()=>{const m=r.scrollbarX?.offsetHeight||0;r.onCornerHeightChange(m),f(m)}),za(r.scrollbarY,()=>{const m=r.scrollbarY?.offsetWidth||0;r.onCornerWidthChange(m),l(m)}),d?y.jsx(ct.div,{...n,ref:e,style:{width:o,height:u,position:"absolute",right:r.dir==="ltr"?0:void 0,left:r.dir==="rtl"?0:void 0,bottom:0,...i.style}}):null});function yu(i){return i?parseInt(i,10):0}function _S(i,e){const t=i/e;return isNaN(t)?0:t}function zu(i){const e=_S(i.viewport,i.content),t=i.scrollbar.paddingStart+i.scrollbar.paddingEnd,n=(i.scrollbar.size-t)*e;return Math.max(n,18)}function l_(i,e,t,n="ltr"){const r=zu(t),o=r/2,l=e||o,u=r-l,f=t.scrollbar.paddingStart+l,d=t.scrollbar.size-t.scrollbar.paddingEnd-u,m=t.content-t.viewport,g=n==="ltr"?[0,m]:[m*-1,0];return wS([f,d],g)(i)}function sx(i,e,t="ltr"){const n=zu(e),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-r,l=e.content-e.viewport,u=o-n,f=t==="ltr"?[0,l]:[l*-1,0],d=ZL(i,f);return wS([0,l],[0,u])(d)}function wS(i,e){return t=>{if(i[0]===i[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(i[1]-i[0]);return e[0]+n*(t-i[0])}}function DS(i,e){return i>0&&i<e}var c_=(i,e=()=>{})=>{let t={left:i.scrollLeft,top:i.scrollTop},n=0;return(function r(){const o={left:i.scrollLeft,top:i.scrollTop},l=t.left!==o.left,u=t.top!==o.top;(l||u)&&e(),t=o,n=window.requestAnimationFrame(r)})(),()=>window.cancelAnimationFrame(n)};function Hu(i,e){const t=dn(i),n=R.useRef(0);return R.useEffect(()=>()=>window.clearTimeout(n.current),[]),R.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function za(i,e){const t=dn(e);fi(()=>{let n=0;if(i){const r=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return r.observe(i),()=>{window.cancelAnimationFrame(n),r.unobserve(i)}}},[i,t])}var u_=xS,d_=SS,f_=LS;function h_({className:i,children:e,...t}){return y.jsxs(u_,{"data-slot":"scroll-area",className:vt("relative",i),...t,children:[y.jsx(d_,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:e}),y.jsx(m_,{}),y.jsx(f_,{})]})}function m_({className:i,orientation:e="vertical",...t}){return y.jsx(bS,{"data-slot":"scroll-area-scrollbar",orientation:e,className:vt("flex touch-none p-px transition-colors select-none",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",i),...t,children:y.jsx(CS,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}var g_=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],p_=g_.reduce((i,e)=>{const t=$m(`Primitive.${e}`),n=R.forwardRef((r,o)=>{const{asChild:l,...u}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),y.jsx(f,{...u,ref:o})});return n.displayName=`Primitive.${e}`,{...i,[e]:n}},{}),v_="Separator",ix="horizontal",y_=["horizontal","vertical"],IS=R.forwardRef((i,e)=>{const{decorative:t,orientation:n=ix,...r}=i,o=x_(n)?n:ix,u=t?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return y.jsx(p_.div,{"data-orientation":o,...u,...r,ref:e})});IS.displayName=v_;function x_(i){return y_.includes(i)}var E_=IS;function Yo({className:i,orientation:e="horizontal",decorative:t=!0,...n}){return y.jsx(E_,{"data-slot":"separator",decorative:t,orientation:e,className:vt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",i),...n})}const NS=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();const S_=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const b_=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());const rx=i=>{const e=b_(i);return e.charAt(0).toUpperCase()+e.slice(1)};var T_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const A_=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};const R_=R.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:o,iconNode:l,...u},f)=>R.createElement("svg",{ref:f,...T_,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:NS("lucide",r),...!o&&!A_(u)&&{"aria-hidden":"true"},...u},[...l.map(([d,m])=>R.createElement(d,m)),...Array.isArray(o)?o:[o]]));const je=(i,e)=>{const t=R.forwardRef(({className:n,...r},o)=>R.createElement(R_,{ref:o,iconNode:e,className:NS(`lucide-${S_(rx(i))}`,`lucide-${i}`,n),...r}));return t.displayName=rx(i),t};const C_=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],fl=je("book-open",C_);const L_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],__=je("check",L_);const w_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],OS=je("chevron-down",w_);const D_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],MS=je("chevron-right",D_);const I_=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ax=je("circle-check-big",I_);const N_=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xu=je("circle-play",N_);const O_=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Eu=je("clock",O_);const M_=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],k_=je("code",M_);const P_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M15.033 13.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56v-4.704a.645.645 0 0 1 .967-.56z",key:"1tzo1f"}]],ox=je("file-play",P_);const U_=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],F_=je("github",U_);const B_=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],j_=je("house",B_);const $_=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],G_=je("layout-dashboard",$_);const z_=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],H_=je("linkedin",z_);const V_=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],kS=je("list",V_);const K_=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Y_=je("loader-circle",K_);const q_=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],X_=je("lock",q_);const W_=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Q_=je("log-out",W_);const Z_=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],J_=je("mail",Z_);const ew=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],tw=je("map-pin",ew);const nw=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],sw=je("maximize-2",nw);const iw=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],rw=je("menu",iw);const aw=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],ow=je("message-circle",aw);const lw=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Rh=je("pause",lw);const cw=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],uw=je("phone",cw);const dw=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],su=je("play",dw);const fw=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],qm=je("plus",fw);const hw=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],PS=je("shield",hw);const mw=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],gw=je("sparkles",mw);const pw=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],qi=je("square-pen",pw);const vw=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],US=je("target",vw);const yw=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Pa=je("trash-2",yw);const xw=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ew=je("triangle-alert",xw);const Sw=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],FS=je("trophy",Sw);const bw=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],BS=je("upload",bw);const Tw=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Aw=je("user",Tw);const Rw=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Cw=je("users",Rw);const Lw=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],_w=je("volume-2",Lw);const ww=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vu=je("x",ww);const Dw=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Iw=je("zap",Dw);function $t({className:i,type:e,...t}){return y.jsx("input",{type:e,"data-slot":"input",className:vt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",i),...t})}var Nw=jm[" useId ".trim().toString()]||(()=>{}),Ow=0;function Cr(i){const[e,t]=R.useState(Nw());return fi(()=>{t(n=>n??String(Ow++))},[i]),i||(e?`radix-${e}`:"")}var Mw=jm[" useInsertionEffect ".trim().toString()]||fi;function Ku({prop:i,defaultProp:e,onChange:t=()=>{},caller:n}){const[r,o,l]=kw({defaultProp:e,onChange:t}),u=i!==void 0,f=u?i:r;{const m=R.useRef(i!==void 0);R.useEffect(()=>{const g=m.current;g!==u&&console.warn(`${n} is changing from ${g?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),m.current=u},[u,n])}const d=R.useCallback(m=>{if(u){const g=Pw(m)?m(i):m;g!==i&&l.current?.(g)}else o(m)},[u,i,o,l]);return[f,d]}function kw({defaultProp:i,onChange:e}){const[t,n]=R.useState(i),r=R.useRef(t),o=R.useRef(e);return Mw(()=>{o.current=e},[e]),R.useEffect(()=>{r.current!==t&&(o.current?.(t),r.current=t)},[t,r]),[t,n,o]}function Pw(i){return typeof i=="function"}function Uw(i,e=globalThis?.document){const t=dn(i);R.useEffect(()=>{const n=r=>{r.key==="Escape"&&t(r)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var Fw="DismissableLayer",um="dismissableLayer.update",Bw="dismissableLayer.pointerDownOutside",jw="dismissableLayer.focusOutside",lx,jS=R.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Xm=R.forwardRef((i,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:o,onInteractOutside:l,onDismiss:u,...f}=i,d=R.useContext(jS),[m,g]=R.useState(null),p=m?.ownerDocument??globalThis?.document,[,E]=R.useState({}),S=yt(e,N=>g(N)),b=Array.from(d.layers),[T]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),A=b.indexOf(T),_=m?b.indexOf(m):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,D=_>=A,O=zw(N=>{const U=N.target,k=[...d.branches].some(F=>F.contains(U));!D||k||(r?.(N),l?.(N),N.defaultPrevented||u?.())},p),B=Hw(N=>{const U=N.target;[...d.branches].some(F=>F.contains(U))||(o?.(N),l?.(N),N.defaultPrevented||u?.())},p);return Uw(N=>{_===d.layers.size-1&&(n?.(N),!N.defaultPrevented&&u&&(N.preventDefault(),u()))},p),R.useEffect(()=>{if(m)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(lx=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),cx(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=lx)}},[m,p,t,d]),R.useEffect(()=>()=>{m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),cx())},[m,d]),R.useEffect(()=>{const N=()=>E({});return document.addEventListener(um,N),()=>document.removeEventListener(um,N)},[]),y.jsx(ct.div,{...f,ref:S,style:{pointerEvents:w?D?"auto":"none":void 0,...i.style},onFocusCapture:we(i.onFocusCapture,B.onFocusCapture),onBlurCapture:we(i.onBlurCapture,B.onBlurCapture),onPointerDownCapture:we(i.onPointerDownCapture,O.onPointerDownCapture)})});Xm.displayName=Fw;var $w="DismissableLayerBranch",Gw=R.forwardRef((i,e)=>{const t=R.useContext(jS),n=R.useRef(null),r=yt(e,n);return R.useEffect(()=>{const o=n.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),y.jsx(ct.div,{...i,ref:r})});Gw.displayName=$w;function zw(i,e=globalThis?.document){const t=dn(i),n=R.useRef(!1),r=R.useRef(()=>{});return R.useEffect(()=>{const o=u=>{if(u.target&&!n.current){let f=function(){$S(Bw,t,d,{discrete:!0})};const d={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=f,e.addEventListener("click",r.current,{once:!0})):f()}else e.removeEventListener("click",r.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",o),e.removeEventListener("click",r.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function Hw(i,e=globalThis?.document){const t=dn(i),n=R.useRef(!1);return R.useEffect(()=>{const r=o=>{o.target&&!n.current&&$S(jw,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function cx(){const i=new CustomEvent(um);document.dispatchEvent(i)}function $S(i,e,t,{discrete:n}){const r=t.originalEvent.target,o=new CustomEvent(i,{bubbles:!1,cancelable:!0,detail:t});e&&r.addEventListener(i,e,{once:!0}),n?vS(r,o):r.dispatchEvent(o)}var Ch="focusScope.autoFocusOnMount",Lh="focusScope.autoFocusOnUnmount",ux={bubbles:!1,cancelable:!0},Vw="FocusScope",Wm=R.forwardRef((i,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:r,onUnmountAutoFocus:o,...l}=i,[u,f]=R.useState(null),d=dn(r),m=dn(o),g=R.useRef(null),p=yt(e,b=>f(b)),E=R.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;R.useEffect(()=>{if(n){let b=function(w){if(E.paused||!u)return;const D=w.target;u.contains(D)?g.current=D:zi(g.current,{select:!0})},T=function(w){if(E.paused||!u)return;const D=w.relatedTarget;D!==null&&(u.contains(D)||zi(g.current,{select:!0}))},A=function(w){if(document.activeElement===document.body)for(const O of w)O.removedNodes.length>0&&zi(u)};document.addEventListener("focusin",b),document.addEventListener("focusout",T);const _=new MutationObserver(A);return u&&_.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",T),_.disconnect()}}},[n,u,E.paused]),R.useEffect(()=>{if(u){fx.add(E);const b=document.activeElement;if(!u.contains(b)){const A=new CustomEvent(Ch,ux);u.addEventListener(Ch,d),u.dispatchEvent(A),A.defaultPrevented||(Kw(Qw(GS(u)),{select:!0}),document.activeElement===b&&zi(u))}return()=>{u.removeEventListener(Ch,d),setTimeout(()=>{const A=new CustomEvent(Lh,ux);u.addEventListener(Lh,m),u.dispatchEvent(A),A.defaultPrevented||zi(b??document.body,{select:!0}),u.removeEventListener(Lh,m),fx.remove(E)},0)}}},[u,d,m,E]);const S=R.useCallback(b=>{if(!t&&!n||E.paused)return;const T=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,A=document.activeElement;if(T&&A){const _=b.currentTarget,[w,D]=Yw(_);w&&D?!b.shiftKey&&A===D?(b.preventDefault(),t&&zi(w,{select:!0})):b.shiftKey&&A===w&&(b.preventDefault(),t&&zi(D,{select:!0})):A===_&&b.preventDefault()}},[t,n,E.paused]);return y.jsx(ct.div,{tabIndex:-1,...l,ref:p,onKeyDown:S})});Wm.displayName=Vw;function Kw(i,{select:e=!1}={}){const t=document.activeElement;for(const n of i)if(zi(n,{select:e}),document.activeElement!==t)return}function Yw(i){const e=GS(i),t=dx(e,i),n=dx(e.reverse(),i);return[t,n]}function GS(i){const e=[],t=document.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const r=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||r?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function dx(i,e){for(const t of i)if(!qw(t,{upTo:e}))return t}function qw(i,{upTo:e}){if(getComputedStyle(i).visibility==="hidden")return!0;for(;i;){if(e!==void 0&&i===e)return!1;if(getComputedStyle(i).display==="none")return!0;i=i.parentElement}return!1}function Xw(i){return i instanceof HTMLInputElement&&"select"in i}function zi(i,{select:e=!1}={}){if(i&&i.focus){const t=document.activeElement;i.focus({preventScroll:!0}),i!==t&&Xw(i)&&e&&i.select()}}var fx=Ww();function Ww(){let i=[];return{add(e){const t=i[0];e!==t&&t?.pause(),i=hx(i,e),i.unshift(e)},remove(e){i=hx(i,e),i[0]?.resume()}}}function hx(i,e){const t=[...i],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function Qw(i){return i.filter(e=>e.tagName!=="A")}var Zw="Portal",zS=R.forwardRef((i,e)=>{const{container:t,...n}=i,[r,o]=R.useState(!1);fi(()=>o(!0),[]);const l=t||r&&globalThis?.document?.body;return l?FL.createPortal(y.jsx(ct.div,{...n,ref:e}),l):null});zS.displayName=Zw;var _h=0;function HS(){R.useEffect(()=>{const i=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",i[0]??mx()),document.body.insertAdjacentElement("beforeend",i[1]??mx()),_h++,()=>{_h===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),_h--}},[])}function mx(){const i=document.createElement("span");return i.setAttribute("data-radix-focus-guard",""),i.tabIndex=0,i.style.outline="none",i.style.opacity="0",i.style.position="fixed",i.style.pointerEvents="none",i}var Ns=function(){return Ns=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Ns.apply(this,arguments)};function VS(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(t[n[r]]=i[n[r]]);return t}function Jw(i,e,t){if(t||arguments.length===2)for(var n=0,r=e.length,o;n<r;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return i.concat(o||Array.prototype.slice.call(e))}var iu="right-scroll-bar-position",ru="width-before-scroll-bar",eD="with-scroll-bars-hidden",tD="--removed-body-scroll-bar-size";function wh(i,e){return typeof i=="function"?i(e):i&&(i.current=e),i}function nD(i,e){var t=R.useState(function(){return{value:i,callback:e,facade:{get current(){return t.value},set current(n){var r=t.value;r!==n&&(t.value=n,t.callback(n,r))}}}})[0];return t.callback=e,t.facade}var sD=typeof window<"u"?R.useLayoutEffect:R.useEffect,gx=new WeakMap;function iD(i,e){var t=nD(null,function(n){return i.forEach(function(r){return wh(r,n)})});return sD(function(){var n=gx.get(t);if(n){var r=new Set(n),o=new Set(i),l=t.current;r.forEach(function(u){o.has(u)||wh(u,null)}),o.forEach(function(u){r.has(u)||wh(u,l)})}gx.set(t,i)},[i]),t}function rD(i){return i}function aD(i,e){e===void 0&&(e=rD);var t=[],n=!1,r={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:i},useMedium:function(o){var l=e(o,n);return t.push(l),function(){t=t.filter(function(u){return u!==l})}},assignSyncMedium:function(o){for(n=!0;t.length;){var l=t;t=[],l.forEach(o)}t={push:function(u){return o(u)},filter:function(){return t}}},assignMedium:function(o){n=!0;var l=[];if(t.length){var u=t;t=[],u.forEach(o),l=t}var f=function(){var m=l;l=[],m.forEach(o)},d=function(){return Promise.resolve().then(f)};d(),t={push:function(m){l.push(m),d()},filter:function(m){return l=l.filter(m),t}}}};return r}function oD(i){i===void 0&&(i={});var e=aD(null);return e.options=Ns({async:!0,ssr:!1},i),e}var KS=function(i){var e=i.sideCar,t=VS(i,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return R.createElement(n,Ns({},t))};KS.isSideCarExport=!0;function lD(i,e){return i.useMedium(e),KS}var YS=oD(),Dh=function(){},Yu=R.forwardRef(function(i,e){var t=R.useRef(null),n=R.useState({onScrollCapture:Dh,onWheelCapture:Dh,onTouchMoveCapture:Dh}),r=n[0],o=n[1],l=i.forwardProps,u=i.children,f=i.className,d=i.removeScrollBar,m=i.enabled,g=i.shards,p=i.sideCar,E=i.noRelative,S=i.noIsolation,b=i.inert,T=i.allowPinchZoom,A=i.as,_=A===void 0?"div":A,w=i.gapMode,D=VS(i,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),O=p,B=iD([t,e]),N=Ns(Ns({},D),r);return R.createElement(R.Fragment,null,m&&R.createElement(O,{sideCar:YS,removeScrollBar:d,shards:g,noRelative:E,noIsolation:S,inert:b,setCallbacks:o,allowPinchZoom:!!T,lockRef:t,gapMode:w}),l?R.cloneElement(R.Children.only(u),Ns(Ns({},N),{ref:B})):R.createElement(_,Ns({},N,{className:f,ref:B}),u))});Yu.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Yu.classNames={fullWidth:ru,zeroRight:iu};var cD=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function uD(){if(!document)return null;var i=document.createElement("style");i.type="text/css";var e=cD();return e&&i.setAttribute("nonce",e),i}function dD(i,e){i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}function fD(i){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(i)}var hD=function(){var i=0,e=null;return{add:function(t){i==0&&(e=uD())&&(dD(e,t),fD(e)),i++},remove:function(){i--,!i&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},mD=function(){var i=hD();return function(e,t){R.useEffect(function(){return i.add(e),function(){i.remove()}},[e&&t])}},qS=function(){var i=mD(),e=function(t){var n=t.styles,r=t.dynamic;return i(n,r),null};return e},gD={left:0,top:0,right:0,gap:0},Ih=function(i){return parseInt(i||"",10)||0},pD=function(i){var e=window.getComputedStyle(document.body),t=e[i==="padding"?"paddingLeft":"marginLeft"],n=e[i==="padding"?"paddingTop":"marginTop"],r=e[i==="padding"?"paddingRight":"marginRight"];return[Ih(t),Ih(n),Ih(r)]},vD=function(i){if(i===void 0&&(i="margin"),typeof window>"u")return gD;var e=pD(i),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},yD=qS(),Ua="data-scroll-locked",xD=function(i,e,t,n){var r=i.left,o=i.top,l=i.right,u=i.gap;return t===void 0&&(t="margin"),`
  .`.concat(eD,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(Ua,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(r,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(iu,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(ru,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(iu," .").concat(iu,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(ru," .").concat(ru,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Ua,`] {
    `).concat(tD,": ").concat(u,`px;
  }
`)},px=function(){var i=parseInt(document.body.getAttribute(Ua)||"0",10);return isFinite(i)?i:0},ED=function(){R.useEffect(function(){return document.body.setAttribute(Ua,(px()+1).toString()),function(){var i=px()-1;i<=0?document.body.removeAttribute(Ua):document.body.setAttribute(Ua,i.toString())}},[])},SD=function(i){var e=i.noRelative,t=i.noImportant,n=i.gapMode,r=n===void 0?"margin":n;ED();var o=R.useMemo(function(){return vD(r)},[r]);return R.createElement(yD,{styles:xD(o,!e,r,t?"":"!important")})},dm=!1;if(typeof window<"u")try{var Uc=Object.defineProperty({},"passive",{get:function(){return dm=!0,!0}});window.addEventListener("test",Uc,Uc),window.removeEventListener("test",Uc,Uc)}catch{dm=!1}var Aa=dm?{passive:!1}:!1,bD=function(i){return i.tagName==="TEXTAREA"},XS=function(i,e){if(!(i instanceof Element))return!1;var t=window.getComputedStyle(i);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!bD(i)&&t[e]==="visible")},TD=function(i){return XS(i,"overflowY")},AD=function(i){return XS(i,"overflowX")},vx=function(i,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=WS(i,n);if(r){var o=QS(i,n),l=o[1],u=o[2];if(l>u)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},RD=function(i){var e=i.scrollTop,t=i.scrollHeight,n=i.clientHeight;return[e,t,n]},CD=function(i){var e=i.scrollLeft,t=i.scrollWidth,n=i.clientWidth;return[e,t,n]},WS=function(i,e){return i==="v"?TD(e):AD(e)},QS=function(i,e){return i==="v"?RD(e):CD(e)},LD=function(i,e){return i==="h"&&e==="rtl"?-1:1},_D=function(i,e,t,n,r){var o=LD(i,window.getComputedStyle(e).direction),l=o*n,u=t.target,f=e.contains(u),d=!1,m=l>0,g=0,p=0;do{if(!u)break;var E=QS(i,u),S=E[0],b=E[1],T=E[2],A=b-T-o*S;(S||A)&&WS(i,u)&&(g+=A,p+=S);var _=u.parentNode;u=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!f&&u!==document.body||f&&(e.contains(u)||e===u));return(m&&Math.abs(g)<1||!m&&Math.abs(p)<1)&&(d=!0),d},Fc=function(i){return"changedTouches"in i?[i.changedTouches[0].clientX,i.changedTouches[0].clientY]:[0,0]},yx=function(i){return[i.deltaX,i.deltaY]},xx=function(i){return i&&"current"in i?i.current:i},wD=function(i,e){return i[0]===e[0]&&i[1]===e[1]},DD=function(i){return`
  .block-interactivity-`.concat(i,` {pointer-events: none;}
  .allow-interactivity-`).concat(i,` {pointer-events: all;}
`)},ID=0,Ra=[];function ND(i){var e=R.useRef([]),t=R.useRef([0,0]),n=R.useRef(),r=R.useState(ID++)[0],o=R.useState(qS)[0],l=R.useRef(i);R.useEffect(function(){l.current=i},[i]),R.useEffect(function(){if(i.inert){document.body.classList.add("block-interactivity-".concat(r));var b=Jw([i.lockRef.current],(i.shards||[]).map(xx),!0).filter(Boolean);return b.forEach(function(T){return T.classList.add("allow-interactivity-".concat(r))}),function(){document.body.classList.remove("block-interactivity-".concat(r)),b.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(r))})}}},[i.inert,i.lockRef.current,i.shards]);var u=R.useCallback(function(b,T){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!l.current.allowPinchZoom;var A=Fc(b),_=t.current,w="deltaX"in b?b.deltaX:_[0]-A[0],D="deltaY"in b?b.deltaY:_[1]-A[1],O,B=b.target,N=Math.abs(w)>Math.abs(D)?"h":"v";if("touches"in b&&N==="h"&&B.type==="range")return!1;var U=window.getSelection(),k=U&&U.anchorNode,F=k?k===B||k.contains(B):!1;if(F)return!1;var H=vx(N,B);if(!H)return!0;if(H?O=N:(O=N==="v"?"h":"v",H=vx(N,B)),!H)return!1;if(!n.current&&"changedTouches"in b&&(w||D)&&(n.current=O),!O)return!0;var ne=n.current||O;return _D(ne,T,b,ne==="h"?w:D)},[]),f=R.useCallback(function(b){var T=b;if(!(!Ra.length||Ra[Ra.length-1]!==o)){var A="deltaY"in T?yx(T):Fc(T),_=e.current.filter(function(O){return O.name===T.type&&(O.target===T.target||T.target===O.shadowParent)&&wD(O.delta,A)})[0];if(_&&_.should){T.cancelable&&T.preventDefault();return}if(!_){var w=(l.current.shards||[]).map(xx).filter(Boolean).filter(function(O){return O.contains(T.target)}),D=w.length>0?u(T,w[0]):!l.current.noIsolation;D&&T.cancelable&&T.preventDefault()}}},[]),d=R.useCallback(function(b,T,A,_){var w={name:b,delta:T,target:A,should:_,shadowParent:OD(A)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(D){return D!==w})},1)},[]),m=R.useCallback(function(b){t.current=Fc(b),n.current=void 0},[]),g=R.useCallback(function(b){d(b.type,yx(b),b.target,u(b,i.lockRef.current))},[]),p=R.useCallback(function(b){d(b.type,Fc(b),b.target,u(b,i.lockRef.current))},[]);R.useEffect(function(){return Ra.push(o),i.setCallbacks({onScrollCapture:g,onWheelCapture:g,onTouchMoveCapture:p}),document.addEventListener("wheel",f,Aa),document.addEventListener("touchmove",f,Aa),document.addEventListener("touchstart",m,Aa),function(){Ra=Ra.filter(function(b){return b!==o}),document.removeEventListener("wheel",f,Aa),document.removeEventListener("touchmove",f,Aa),document.removeEventListener("touchstart",m,Aa)}},[]);var E=i.removeScrollBar,S=i.inert;return R.createElement(R.Fragment,null,S?R.createElement(o,{styles:DD(r)}):null,E?R.createElement(SD,{noRelative:i.noRelative,gapMode:i.gapMode}):null)}function OD(i){for(var e=null;i!==null;)i instanceof ShadowRoot&&(e=i.host,i=i.host),i=i.parentNode;return e}const MD=lD(YS,ND);var Qm=R.forwardRef(function(i,e){return R.createElement(Yu,Ns({},i,{ref:e,sideCar:MD}))});Qm.classNames=Yu.classNames;var kD=function(i){if(typeof document>"u")return null;var e=Array.isArray(i)?i[0]:i;return e.ownerDocument.body},Ca=new WeakMap,Bc=new WeakMap,jc={},Nh=0,ZS=function(i){return i&&(i.host||ZS(i.parentNode))},PD=function(i,e){return e.map(function(t){if(i.contains(t))return t;var n=ZS(t);return n&&i.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",i,". Doing nothing"),null)}).filter(function(t){return!!t})},UD=function(i,e,t,n){var r=PD(e,Array.isArray(i)?i:[i]);jc[t]||(jc[t]=new WeakMap);var o=jc[t],l=[],u=new Set,f=new Set(r),d=function(g){!g||u.has(g)||(u.add(g),d(g.parentNode))};r.forEach(d);var m=function(g){!g||f.has(g)||Array.prototype.forEach.call(g.children,function(p){if(u.has(p))m(p);else try{var E=p.getAttribute(n),S=E!==null&&E!=="false",b=(Ca.get(p)||0)+1,T=(o.get(p)||0)+1;Ca.set(p,b),o.set(p,T),l.push(p),b===1&&S&&Bc.set(p,!0),T===1&&p.setAttribute(t,"true"),S||p.setAttribute(n,"true")}catch(A){console.error("aria-hidden: cannot operate on ",p,A)}})};return m(e),u.clear(),Nh++,function(){l.forEach(function(g){var p=Ca.get(g)-1,E=o.get(g)-1;Ca.set(g,p),o.set(g,E),p||(Bc.has(g)||g.removeAttribute(n),Bc.delete(g)),E||g.removeAttribute(t)}),Nh--,Nh||(Ca=new WeakMap,Ca=new WeakMap,Bc=new WeakMap,jc={})}},JS=function(i,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(i)?i:[i]),r=kD(i);return r?(n.push.apply(n,Array.from(r.querySelectorAll("[aria-live], script"))),UD(n,r,t,"aria-hidden")):function(){return null}};function FD(i){const e=BD(i),t=R.forwardRef((n,r)=>{const{children:o,...l}=n,u=R.Children.toArray(o),f=u.find($D);if(f){const d=f.props.children,m=u.map(g=>g===f?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:g);return y.jsx(e,{...l,ref:r,children:R.isValidElement(d)?R.cloneElement(d,void 0,m):null})}return y.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${i}.Slot`,t}function BD(i){const e=R.forwardRef((t,n)=>{const{children:r,...o}=t;if(R.isValidElement(r)){const l=zD(r),u=GD(o,r.props);return r.type!==R.Fragment&&(u.ref=n?Or(n,l):l),R.cloneElement(r,u)}return R.Children.count(r)>1?R.Children.only(null):null});return e.displayName=`${i}.SlotClone`,e}var jD=Symbol("radix.slottable");function $D(i){return R.isValidElement(i)&&typeof i.type=="function"&&"__radixId"in i.type&&i.type.__radixId===jD}function GD(i,e){const t={...e};for(const n in e){const r=i[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...i,...t}}function zD(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}var qu="Dialog",[eb]=Ji(qu),[HD,Ss]=eb(qu),tb=i=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:r,onOpenChange:o,modal:l=!0}=i,u=R.useRef(null),f=R.useRef(null),[d,m]=Ku({prop:n,defaultProp:r??!1,onChange:o,caller:qu});return y.jsx(HD,{scope:e,triggerRef:u,contentRef:f,contentId:Cr(),titleId:Cr(),descriptionId:Cr(),open:d,onOpenChange:m,onOpenToggle:R.useCallback(()=>m(g=>!g),[m]),modal:l,children:t})};tb.displayName=qu;var nb="DialogTrigger",sb=R.forwardRef((i,e)=>{const{__scopeDialog:t,...n}=i,r=Ss(nb,t),o=yt(e,r.triggerRef);return y.jsx(ct.button,{type:"button","aria-haspopup":"dialog","aria-expanded":r.open,"aria-controls":r.contentId,"data-state":eg(r.open),...n,ref:o,onClick:we(i.onClick,r.onOpenToggle)})});sb.displayName=nb;var Zm="DialogPortal",[VD,ib]=eb(Zm,{forceMount:void 0}),rb=i=>{const{__scopeDialog:e,forceMount:t,children:n,container:r}=i,o=Ss(Zm,e);return y.jsx(VD,{scope:e,forceMount:t,children:R.Children.map(n,l=>y.jsx(os,{present:t||o.open,children:y.jsx(zS,{asChild:!0,container:r,children:l})}))})};rb.displayName=Zm;var Su="DialogOverlay",ab=R.forwardRef((i,e)=>{const t=ib(Su,i.__scopeDialog),{forceMount:n=t.forceMount,...r}=i,o=Ss(Su,i.__scopeDialog);return o.modal?y.jsx(os,{present:n||o.open,children:y.jsx(YD,{...r,ref:e})}):null});ab.displayName=Su;var KD=FD("DialogOverlay.RemoveScroll"),YD=R.forwardRef((i,e)=>{const{__scopeDialog:t,...n}=i,r=Ss(Su,t);return y.jsx(Qm,{as:KD,allowPinchZoom:!0,shards:[r.contentRef],children:y.jsx(ct.div,{"data-state":eg(r.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),_r="DialogContent",ob=R.forwardRef((i,e)=>{const t=ib(_r,i.__scopeDialog),{forceMount:n=t.forceMount,...r}=i,o=Ss(_r,i.__scopeDialog);return y.jsx(os,{present:n||o.open,children:o.modal?y.jsx(qD,{...r,ref:e}):y.jsx(XD,{...r,ref:e})})});ob.displayName=_r;var qD=R.forwardRef((i,e)=>{const t=Ss(_r,i.__scopeDialog),n=R.useRef(null),r=yt(e,t.contentRef,n);return R.useEffect(()=>{const o=n.current;if(o)return JS(o)},[]),y.jsx(lb,{...i,ref:r,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:we(i.onCloseAutoFocus,o=>{o.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:we(i.onPointerDownOutside,o=>{const l=o.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0;(l.button===2||u)&&o.preventDefault()}),onFocusOutside:we(i.onFocusOutside,o=>o.preventDefault())})}),XD=R.forwardRef((i,e)=>{const t=Ss(_r,i.__scopeDialog),n=R.useRef(!1),r=R.useRef(!1);return y.jsx(lb,{...i,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{i.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||t.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,r.current=!1},onInteractOutside:o=>{i.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(r.current=!0));const l=o.target;t.triggerRef.current?.contains(l)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&r.current&&o.preventDefault()}})}),lb=R.forwardRef((i,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:r,onCloseAutoFocus:o,...l}=i,u=Ss(_r,t),f=R.useRef(null),d=yt(e,f);return HS(),y.jsxs(y.Fragment,{children:[y.jsx(Wm,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:r,onUnmountAutoFocus:o,children:y.jsx(Xm,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":eg(u.open),...l,ref:d,onDismiss:()=>u.onOpenChange(!1)})}),y.jsxs(y.Fragment,{children:[y.jsx(WD,{titleId:u.titleId}),y.jsx(ZD,{contentRef:f,descriptionId:u.descriptionId})]})]})}),Jm="DialogTitle",cb=R.forwardRef((i,e)=>{const{__scopeDialog:t,...n}=i,r=Ss(Jm,t);return y.jsx(ct.h2,{id:r.titleId,...n,ref:e})});cb.displayName=Jm;var ub="DialogDescription",db=R.forwardRef((i,e)=>{const{__scopeDialog:t,...n}=i,r=Ss(ub,t);return y.jsx(ct.p,{id:r.descriptionId,...n,ref:e})});db.displayName=ub;var fb="DialogClose",hb=R.forwardRef((i,e)=>{const{__scopeDialog:t,...n}=i,r=Ss(fb,t);return y.jsx(ct.button,{type:"button",...n,ref:e,onClick:we(i.onClick,()=>r.onOpenChange(!1))})});hb.displayName=fb;function eg(i){return i?"open":"closed"}var mb="DialogTitleWarning",[jB,gb]=XL(mb,{contentName:_r,titleName:Jm,docsSlug:"dialog"}),WD=({titleId:i})=>{const e=gb(mb),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return R.useEffect(()=>{i&&(document.getElementById(i)||console.error(t))},[t,i]),null},QD="DialogDescriptionWarning",ZD=({contentRef:i,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${gb(QD).contentName}}.`;return R.useEffect(()=>{const r=i.current?.getAttribute("aria-describedby");e&&r&&(document.getElementById(e)||console.warn(n))},[n,i,e]),null},JD=tb,eI=sb,tI=rb,nI=ab,sI=ob,iI=cb,rI=db,pb=hb;function Cn({...i}){return y.jsx(JD,{"data-slot":"dialog",...i})}function er({...i}){return y.jsx(eI,{"data-slot":"dialog-trigger",...i})}function aI({...i}){return y.jsx(tI,{"data-slot":"dialog-portal",...i})}function oI({className:i,...e}){return y.jsx(nI,{"data-slot":"dialog-overlay",className:vt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",i),...e})}function Ln({className:i,children:e,showCloseButton:t=!0,...n}){return y.jsxs(aI,{"data-slot":"dialog-portal",children:[y.jsx(oI,{}),y.jsxs(sI,{"data-slot":"dialog-content",className:vt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",i),...n,children:[e,t&&y.jsxs(pb,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[y.jsx(Vu,{}),y.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function _n({className:i,...e}){return y.jsx("div",{"data-slot":"dialog-header",className:vt("flex flex-col gap-2 text-center sm:text-left",i),...e})}function tr({className:i,showCloseButton:e=!1,children:t,...n}){return y.jsxs("div",{"data-slot":"dialog-footer",className:vt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",i),...n,children:[t,e&&y.jsx(pb,{asChild:!0,children:y.jsx(Ce,{variant:"outline",children:"Close"})})]})}function wn({className:i,...e}){return y.jsx(iI,{"data-slot":"dialog-title",className:vt("text-lg leading-none font-semibold",i),...e})}function Dn({className:i,...e}){return y.jsx(rI,{"data-slot":"dialog-description",className:vt("text-muted-foreground text-sm",i),...e})}const lI=Gm("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function tg({className:i,variant:e,...t}){return y.jsx("div",{"data-slot":"alert",role:"alert",className:vt(lI({variant:e}),i),...t})}function ng({className:i,...e}){return y.jsx("div",{"data-slot":"alert-description",className:vt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",i),...e})}const Kt="https://ring0xapi.guaranihub.com:8443",Yt={REGISTER:"/user/create-account",LOGIN:"/user/getusertoken",RECOVER:"/user/recover",VERIFY_CODE:"/user/verify-code",RESET_PASSWORD:"/user/reset-password",CATEGORIES:"/admin/categories",CATEGORIES_CREATE:"/admin/categories/create",CATEGORIES_UPDATE:"/admin/categories/update",CATEGORIES_DELETE:"/admin/categories/delete",COURSES_CREATE:"/admin/courses/create",COURSES_UPDATE:"/admin/courses/update",COURSES_DELETE:"/admin/courses/delete",COURSES_BY_CATEGORY:"/admin/courses/category",LESSONS_CREATE:"/admin/lessons/create",LESSONS_UPDATE:"/admin/lessons/update",LESSONS_DELETE:"/admin/lessons/delete",LESSONS_BY_COURSE:"/admin/lessons/course",VIDEO_UPLOAD:"/admin/video/upload",GET_SIGNED_URL:"/api/get-signed-url"},Rt={REGISTER:`${Kt}${Yt.REGISTER}`,LOGIN:`${Kt}${Yt.LOGIN}`,RECOVER:`${Kt}${Yt.RECOVER}`,VERIFY_CODE:`${Kt}${Yt.VERIFY_CODE}`,RESET_PASSWORD:`${Kt}${Yt.RESET_PASSWORD}`,CATEGORIES:`${Kt}${Yt.CATEGORIES}`,CATEGORIES_CREATE:`${Kt}${Yt.CATEGORIES_CREATE}`,CATEGORIES_UPDATE:`${Kt}${Yt.CATEGORIES_UPDATE}`,CATEGORIES_DELETE:`${Kt}${Yt.CATEGORIES_DELETE}`,COURSES_CREATE:`${Kt}${Yt.COURSES_CREATE}`,COURSES_UPDATE:`${Kt}${Yt.COURSES_UPDATE}`,COURSES_DELETE:`${Kt}${Yt.COURSES_DELETE}`,COURSES_BY_CATEGORY:`${Kt}${Yt.COURSES_BY_CATEGORY}`,LESSONS_CREATE:`${Kt}${Yt.LESSONS_CREATE}`,LESSONS_UPDATE:`${Kt}${Yt.LESSONS_UPDATE}`,LESSONS_DELETE:`${Kt}${Yt.LESSONS_DELETE}`,LESSONS_BY_COURSE:`${Kt}${Yt.LESSONS_BY_COURSE}`,VIDEO_UPLOAD:`${Kt}${Yt.VIDEO_UPLOAD}`,GET_SIGNED_URL:`${Kt}${Yt.GET_SIGNED_URL}`},cI=(i,e=null)=>{localStorage.setItem("authToken",i),e&&localStorage.setItem("userData",JSON.stringify(e))},hl=()=>localStorage.getItem("authToken"),Oa=()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userData")},uI=()=>{const i=hl();if(!i)return!1;try{const e=i.split(".");if(e.length!==3)return console.error("Token JWT invlido: formato incorreto"),Oa(),!1;const t=JSON.parse(atob(e[0])),n=JSON.parse(atob(e[1]));if(t.alg!=="HS256")return console.error("Algoritmo de token invlido. Esperado HS256, recebido:",t.alg),Oa(),!1;if(n.iss!=="ring0x")return console.error('Issuer de token invlido. Esperado "ring0x", recebido:',n.iss),Oa(),!1;const r=Date.now()/1e3;return n.exp<=r?(console.error("Token expirado"),Oa(),!1):!0}catch(e){return console.error("Erro ao decodificar token:",e),Oa(),!1}},vb=()=>{try{const i=localStorage.getItem("userData");return i?JSON.parse(i):null}catch(i){return console.error("Erro ao obter dados do usurio:",i),null}},dI=()=>vb()?.fullname||null,fI=()=>vb()?.isadmin===!0,hI="login-success";function mI(){const[i,e]=R.useState(!1),[t,n]=R.useState(!0),[r,o]=R.useState({show:!1,message:"",variant:"default"}),[l,u]=R.useState({email:"",password:"",name:"",confirmPassword:""}),f=p=>{u({...l,[p.target.name]:p.target.value})},d=(p,E="default")=>{o({show:!0,message:p,variant:E}),setTimeout(()=>o({show:!1,message:"",variant:"default"}),5e3)},m=async p=>{if(p.preventDefault(),t)try{const S=await(await fetch(Rt.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.email,password:l.password})})).json();S.StatusCode===200&&S.Result?(cI(S.Result.token,S.Result),d("Login realizado com sucesso!","default"),window.dispatchEvent(new CustomEvent(hI)),e(!1),u({email:"",password:"",name:"",confirmPassword:""})):d(S.StatusMessage||"Erro ao fazer login. Tente novamente.","destructive")}catch(E){console.error("Erro na requisio:",E),d("Erro ao conectar com o servidor. Tente novamente.","destructive")}else try{const S=await(await fetch(Rt.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.email,password:l.password,fullname:l.name})})).json();S.StatusCode===200?(d(S.StatusMessage,"default"),n(!0)):d(S.StatusMessage||"Erro ao criar conta. Tente novamente.","destructive")}catch(E){console.error("Erro na requisio:",E),d("Erro ao conectar com o servidor. Tente novamente.","destructive")}t||(e(!1),u({email:"",password:"",name:"",confirmPassword:""}))},g=()=>{n(!t),u({email:"",password:"",name:"",confirmPassword:""})};return y.jsxs(Cn,{open:i,onOpenChange:e,children:[y.jsx(er,{asChild:!0,children:y.jsx(Ce,{"data-testid":"login-trigger",variant:"ghost",className:"w-full text-white hover:bg-neutral-800 border border-neutral-700",children:"Login"})}),y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsx(wn,{className:"text-xl font-bold",children:t?"Entrar na sua conta":"Criar nova conta"}),y.jsx(Dn,{className:"text-neutral-400",children:t?"Digite suas credenciais para acessar a plataforma":"Preencha os dados abaixo para criar sua conta"})]}),r.show&&y.jsx(tg,{variant:r.variant,className:"mt-4",children:y.jsx(ng,{children:r.message})}),y.jsxs("form",{onSubmit:m,className:"space-y-4",children:[!t&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"name",className:"text-sm font-medium text-neutral-300",children:"Nome completo"}),y.jsx($t,{id:"name",name:"name",type:"text",value:l.name,onChange:f,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Seu nome completo"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"email",className:"text-sm font-medium text-neutral-300",children:"E-mail"}),y.jsx($t,{id:"email",name:"email",type:"email",value:l.email,onChange:f,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"seu@email.com"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-neutral-300",children:"Senha"}),y.jsx($t,{id:"password",name:"password",type:"password",value:l.password,onChange:f,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:""})]}),!t&&y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium text-neutral-300",children:"Confirmar senha"}),y.jsx($t,{id:"confirmPassword",name:"confirmPassword",type:"password",value:l.confirmPassword,onChange:f,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:""})]}),y.jsx(Ce,{type:"submit",className:"w-full bg-green-600 text-white hover:bg-green-700",children:t?"Entrar":"Criar conta"})]}),y.jsxs("div",{className:"mt-4 text-center space-y-2",children:[y.jsx("button",{type:"button",onClick:g,className:"text-sm text-green-400 hover:text-green-300 transition-colors",children:t?"No tem uma conta? Criar conta":"J tem uma conta? Fazer login"}),t&&y.jsx("button",{type:"button",onClick:()=>{e(!1),setTimeout(()=>{const p=document.querySelector('[data-testid="recover-trigger"]');p&&p.click()},100)},className:"block w-full text-sm text-neutral-400 hover:text-neutral-300 transition-colors",children:"Esqueceu sua senha?"})]})]})]})}function gI(){const[i,e]=R.useState(!1),[t,n]=R.useState({show:!1,message:"",variant:"default"}),[r,o]=R.useState({name:"",email:"",password:"",confirmPassword:""}),l=d=>{o({...r,[d.target.name]:d.target.value})},u=(d,m="default")=>{n({show:!0,message:d,variant:m}),setTimeout(()=>n({show:!1,message:"",variant:"default"}),5e3)},f=async d=>{d.preventDefault();try{const g=await(await fetch(Rt.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,password:r.password,fullname:r.name})})).json();g.StatusCode===200?(u(g.StatusMessage,"default"),e(!1),setTimeout(()=>{const p=document.querySelector('[data-testid="login-trigger"]');p&&p.click()},100)):u(g.StatusMessage||"Erro ao criar conta. Tente novamente.","destructive")}catch(m){console.error("Erro na requisio:",m),u("Erro ao conectar com o servidor. Tente novamente.","destructive")}o({name:"",email:"",password:"",confirmPassword:""})};return y.jsxs(Cn,{open:i,onOpenChange:e,children:[y.jsx(er,{asChild:!0,children:y.jsx(Ce,{className:"w-full bg-green-600 text-white hover:bg-green-700",children:"Criar conta"})}),y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsx(wn,{className:"text-xl font-bold",children:"Criar nova conta"}),y.jsx(Dn,{className:"text-neutral-400",children:"Preencha os dados abaixo para criar sua conta"})]}),t.show&&y.jsx(tg,{variant:t.variant,className:"mt-4",children:y.jsx(ng,{children:t.message})}),y.jsxs("form",{onSubmit:f,className:"space-y-4",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"name",className:"text-sm font-medium text-neutral-300",children:"Nome completo"}),y.jsx($t,{id:"name",name:"name",type:"text",value:r.name,onChange:l,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Seu nome completo"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"email",className:"text-sm font-medium text-neutral-300",children:"E-mail"}),y.jsx($t,{id:"email",name:"email",type:"email",value:r.email,onChange:l,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"seu@email.com"})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"password",className:"text-sm font-medium text-neutral-300",children:"Senha"}),y.jsx($t,{id:"password",name:"password",type:"password",value:r.password,onChange:l,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:""})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium text-neutral-300",children:"Confirmar senha"}),y.jsx($t,{id:"confirmPassword",name:"confirmPassword",type:"password",value:r.confirmPassword,onChange:l,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:""})]}),y.jsx(Ce,{type:"submit",className:"w-full bg-green-600 text-white hover:bg-green-700",children:"Criar conta"})]}),y.jsx("div",{className:"mt-4 text-center",children:y.jsxs("span",{className:"text-sm text-neutral-400",children:["J tem uma conta?"," ",y.jsx("button",{type:"button",onClick:()=>{e(!1),setTimeout(()=>{const d=document.querySelector('[data-testid="login-trigger"]');d&&d.click()},100)},className:"text-green-400 hover:text-green-300 transition-colors",children:"Fazer login"})]})})]})]})}var pI=Object.defineProperty,vI=Object.defineProperties,yI=Object.getOwnPropertyDescriptors,bu=Object.getOwnPropertySymbols,yb=Object.prototype.hasOwnProperty,xb=Object.prototype.propertyIsEnumerable,Ex=(i,e,t)=>e in i?pI(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,xI=(i,e)=>{for(var t in e||(e={}))yb.call(e,t)&&Ex(i,t,e[t]);if(bu)for(var t of bu(e))xb.call(e,t)&&Ex(i,t,e[t]);return i},EI=(i,e)=>vI(i,yI(e)),SI=(i,e)=>{var t={};for(var n in i)yb.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&bu)for(var n of bu(i))e.indexOf(n)<0&&xb.call(i,n)&&(t[n]=i[n]);return t};function bI(i){let e=setTimeout(i,0),t=setTimeout(i,10),n=setTimeout(i,50);return[e,t,n]}function TI(i){let e=R.useRef();return R.useEffect(()=>{e.current=i}),e.current}var AI=18,Eb=40,RI=`${Eb}px`,CI=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function LI({containerRef:i,inputRef:e,pushPasswordManagerStrategy:t,isFocused:n}){let[r,o]=R.useState(!1),[l,u]=R.useState(!1),[f,d]=R.useState(!1),m=R.useMemo(()=>t==="none"?!1:(t==="increase-width"||t==="experimental-no-flickering")&&r&&l,[r,l,t]),g=R.useCallback(()=>{let p=i.current,E=e.current;if(!p||!E||f||t==="none")return;let S=p,b=S.getBoundingClientRect().left+S.offsetWidth,T=S.getBoundingClientRect().top+S.offsetHeight/2,A=b-AI,_=T;document.querySelectorAll(CI).length===0&&document.elementFromPoint(A,_)===p||(o(!0),d(!0))},[i,e,f,t]);return R.useEffect(()=>{let p=i.current;if(!p||t==="none")return;function E(){let b=window.innerWidth-p.getBoundingClientRect().right;u(b>=Eb)}E();let S=setInterval(E,1e3);return()=>{clearInterval(S)}},[i,t]),R.useEffect(()=>{let p=n||document.activeElement===e.current;if(t==="none"||!p)return;let E=setTimeout(g,0),S=setTimeout(g,2e3),b=setTimeout(g,5e3),T=setTimeout(()=>{d(!0)},6e3);return()=>{clearTimeout(E),clearTimeout(S),clearTimeout(b),clearTimeout(T)}},[e,n,t,g]),{hasPWMBadge:r,willPushPWMBadge:m,PWM_BADGE_SPACE_WIDTH:RI}}var Sb=R.createContext({}),bb=R.forwardRef((i,e)=>{var t=i,{value:n,onChange:r,maxLength:o,textAlign:l="left",pattern:u,placeholder:f,inputMode:d="numeric",onComplete:m,pushPasswordManagerStrategy:g="increase-width",pasteTransformer:p,containerClassName:E,noScriptCSSFallback:S=_I,render:b,children:T}=t,A=SI(t,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),_,w,D,O,B;let[N,U]=R.useState(typeof A.defaultValue=="string"?A.defaultValue:""),k=n??N,F=TI(k),H=R.useCallback(Se=>{r?.(Se),U(Se)},[r]),ne=R.useMemo(()=>u?typeof u=="string"?new RegExp(u):u:null,[u]),J=R.useRef(null),le=R.useRef(null),de=R.useRef({value:k,onChange:H,isIOS:typeof window<"u"&&((w=(_=window?.CSS)==null?void 0:_.supports)==null?void 0:w.call(_,"-webkit-touch-callout","none"))}),P=R.useRef({prev:[(D=J.current)==null?void 0:D.selectionStart,(O=J.current)==null?void 0:O.selectionEnd,(B=J.current)==null?void 0:B.selectionDirection]});R.useImperativeHandle(e,()=>J.current,[]),R.useEffect(()=>{let Se=J.current,Ie=le.current;if(!Se||!Ie)return;de.current.value!==Se.value&&de.current.onChange(Se.value),P.current.prev=[Se.selectionStart,Se.selectionEnd,Se.selectionDirection];function Le(){if(document.activeElement!==Se){G(null),V(null);return}let $e=Se.selectionStart,nt=Se.selectionEnd,Gt=Se.selectionDirection,xt=Se.maxLength,cn=Se.value,Je=P.current.prev,Jt=-1,Ot=-1,fn;if(cn.length!==0&&$e!==null&&nt!==null){let ds=$e===nt,Za=$e===cn.length&&cn.length<xt;if(ds&&!Za){let hn=$e;if(hn===0)Jt=0,Ot=1,fn="forward";else if(hn===xt)Jt=hn-1,Ot=hn,fn="backward";else if(xt>1&&cn.length>1){let zt=0;if(Je[0]!==null&&Je[1]!==null){fn=hn<Je[1]?"backward":"forward";let Nn=Je[0]===Je[1]&&Je[0]<xt;fn==="backward"&&!Nn&&(zt=-1)}Jt=zt+hn,Ot=zt+hn+1}}Jt!==-1&&Ot!==-1&&Jt!==Ot&&J.current.setSelectionRange(Jt,Ot,fn)}let us=Jt!==-1?Jt:$e,Gs=Ot!==-1?Ot:nt,bs=fn??Gt;G(us),V(Gs),P.current.prev=[us,Gs,bs]}if(document.addEventListener("selectionchange",Le,{capture:!0}),Le(),document.activeElement===Se&&he(!0),!document.getElementById("input-otp-style")){let $e=document.createElement("style");if($e.id="input-otp-style",document.head.appendChild($e),$e.sheet){let nt="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";qo($e.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),qo($e.sheet,`[data-input-otp]:autofill { ${nt} }`),qo($e.sheet,`[data-input-otp]:-webkit-autofill { ${nt} }`),qo($e.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),qo($e.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Ye=()=>{Ie&&Ie.style.setProperty("--root-height",`${Se.clientHeight}px`)};Ye();let qe=new ResizeObserver(Ye);return qe.observe(Se),()=>{document.removeEventListener("selectionchange",Le,{capture:!0}),qe.disconnect()}},[]);let[K,j]=R.useState(!1),[W,he]=R.useState(!1),[M,G]=R.useState(null),[te,V]=R.useState(null);R.useEffect(()=>{bI(()=>{var Se,Ie,Le,Ye;(Se=J.current)==null||Se.dispatchEvent(new Event("input"));let qe=(Ie=J.current)==null?void 0:Ie.selectionStart,$e=(Le=J.current)==null?void 0:Le.selectionEnd,nt=(Ye=J.current)==null?void 0:Ye.selectionDirection;qe!==null&&$e!==null&&(G(qe),V($e),P.current.prev=[qe,$e,nt])})},[k,W]),R.useEffect(()=>{F!==void 0&&k!==F&&F.length<o&&k.length===o&&m?.(k)},[o,m,F,k]);let se=LI({containerRef:le,inputRef:J,pushPasswordManagerStrategy:g,isFocused:W}),ce=R.useCallback(Se=>{let Ie=Se.currentTarget.value.slice(0,o);if(Ie.length>0&&ne&&!ne.test(Ie)){Se.preventDefault();return}typeof F=="string"&&Ie.length<F.length&&document.dispatchEvent(new Event("selectionchange")),H(Ie)},[o,H,F,ne]),fe=R.useCallback(()=>{var Se;if(J.current){let Ie=Math.min(J.current.value.length,o-1),Le=J.current.value.length;(Se=J.current)==null||Se.setSelectionRange(Ie,Le),G(Ie),V(Le)}he(!0)},[o]),ve=R.useCallback(Se=>{var Ie,Le;let Ye=J.current;if(!p&&(!de.current.isIOS||!Se.clipboardData||!Ye))return;let qe=Se.clipboardData.getData("text/plain"),$e=p?p(qe):qe;Se.preventDefault();let nt=(Ie=J.current)==null?void 0:Ie.selectionStart,Gt=(Le=J.current)==null?void 0:Le.selectionEnd,xt=(nt!==Gt?k.slice(0,nt)+$e+k.slice(Gt):k.slice(0,nt)+$e+k.slice(nt)).slice(0,o);if(xt.length>0&&ne&&!ne.test(xt))return;Ye.value=xt,H(xt);let cn=Math.min(xt.length,o-1),Je=xt.length;Ye.setSelectionRange(cn,Je),G(cn),V(Je)},[o,H,ne,k]),Ae=R.useMemo(()=>({position:"relative",cursor:A.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[A.disabled]),Qe=R.useMemo(()=>({position:"absolute",inset:0,width:se.willPushPWMBadge?`calc(100% + ${se.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:se.willPushPWMBadge?`inset(0 ${se.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:l,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[se.PWM_BADGE_SPACE_WIDTH,se.willPushPWMBadge,l]),Ze=R.useMemo(()=>R.createElement("input",EI(xI({autoComplete:A.autoComplete||"one-time-code"},A),{"data-input-otp":!0,"data-input-otp-placeholder-shown":k.length===0||void 0,"data-input-otp-mss":M,"data-input-otp-mse":te,inputMode:d,pattern:ne?.source,"aria-placeholder":f,style:Qe,maxLength:o,value:k,ref:J,onPaste:Se=>{var Ie;ve(Se),(Ie=A.onPaste)==null||Ie.call(A,Se)},onChange:ce,onMouseOver:Se=>{var Ie;j(!0),(Ie=A.onMouseOver)==null||Ie.call(A,Se)},onMouseLeave:Se=>{var Ie;j(!1),(Ie=A.onMouseLeave)==null||Ie.call(A,Se)},onFocus:Se=>{var Ie;fe(),(Ie=A.onFocus)==null||Ie.call(A,Se)},onBlur:Se=>{var Ie;he(!1),(Ie=A.onBlur)==null||Ie.call(A,Se)}})),[ce,fe,ve,d,Qe,o,te,M,A,ne?.source,k]),Lt=R.useMemo(()=>({slots:Array.from({length:o}).map((Se,Ie)=>{var Le;let Ye=W&&M!==null&&te!==null&&(M===te&&Ie===M||Ie>=M&&Ie<te),qe=k[Ie]!==void 0?k[Ie]:null,$e=k[0]!==void 0?null:(Le=f?.[Ie])!=null?Le:null;return{char:qe,placeholderChar:$e,isActive:Ye,hasFakeCaret:Ye&&qe===null}}),isFocused:W,isHovering:!A.disabled&&K}),[W,K,o,te,M,A.disabled,k]),Tt=R.useMemo(()=>b?b(Lt):R.createElement(Sb.Provider,{value:Lt},T),[T,Lt,b]);return R.createElement(R.Fragment,null,S!==null&&R.createElement("noscript",null,R.createElement("style",null,S)),R.createElement("div",{ref:le,"data-input-otp-container":!0,style:Ae,className:E},Tt,R.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Ze)))});bb.displayName="Input";function qo(i,e){try{i.insertRule(e)}catch{console.error("input-otp could not insert CSS rule:",e)}}var _I=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;function wI({className:i,containerClassName:e,...t}){return y.jsx(bb,{"data-slot":"input-otp",containerClassName:vt("flex items-center gap-2 has-disabled:opacity-50",e),className:vt("disabled:cursor-not-allowed",i),...t})}function DI({className:i,...e}){return y.jsx("div",{"data-slot":"input-otp-group",className:vt("flex items-center",i),...e})}function La({index:i,className:e,...t}){const n=R.useContext(Sb),{char:r,hasFakeCaret:o,isActive:l}=n?.slots[i]??{};return y.jsxs("div",{"data-slot":"input-otp-slot","data-active":l,className:vt("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",e),...t,children:[r,o&&y.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:y.jsx("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}function II(){const[i,e]=R.useState(!1),[t,n]=R.useState(1),[r,o]=R.useState({show:!1,message:"",variant:"default"}),[l,u]=R.useState({email:"",code:"",newPassword:"",confirmPassword:""}),f=(b,T="default")=>{o({show:!0,message:b,variant:T}),setTimeout(()=>o({show:!1,message:"",variant:"default"}),5e3)},d=b=>{u({...l,[b.target.name]:b.target.value})},m=b=>{u({...l,code:b})},g=async b=>{b.preventDefault();try{const A=await(await fetch(Rt.RECOVER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.email})})).json();A.StatusCode===200?(f(A.StatusMessage,"default"),n(2)):f(A.StatusMessage||"Erro ao enviar cdigo. Tente novamente.","destructive")}catch(T){console.error("Erro na requisio:",T),f("Erro ao conectar com o servidor. Tente novamente.","destructive")}},p=async b=>{b.preventDefault();try{const A=await(await fetch(Rt.VERIFY_CODE,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.email,code:l.code})})).json();A.StatusCode===200?(f(A.StatusMessage,"default"),n(3)):f(A.StatusMessage||"Cdigo invlido. Tente novamente.","destructive")}catch(T){console.error("Erro na requisio:",T),f("Erro ao conectar com o servidor. Tente novamente.","destructive")}},E=async b=>{if(b.preventDefault(),l.newPassword!==l.confirmPassword){f("As senhas no coincidem.","destructive");return}try{const A=await(await fetch(Rt.RESET_PASSWORD,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l.email,code:l.code,newPassword:l.newPassword})})).json();A.StatusCode===200?(f(A.StatusMessage,"default"),setTimeout(()=>{e(!1),n(1),u({email:"",code:"",newPassword:"",confirmPassword:""});const _=document.querySelector('[data-testid="login-trigger"]');_&&_.click()},2e3)):f(A.StatusMessage||"Erro ao redefinir senha. Tente novamente.","destructive")}catch(T){console.error("Erro na requisio:",T),f("Erro ao conectar com o servidor. Tente novamente.","destructive")}},S=()=>{n(1),u({email:"",code:"",newPassword:"",confirmPassword:""})};return y.jsxs(Cn,{open:i,onOpenChange:b=>{e(b),b||S()},children:[y.jsx(er,{asChild:!0,children:y.jsx(Ce,{"data-testid":"recover-trigger",variant:"ghost",className:"w-full text-white hover:bg-neutral-800 border border-neutral-700",children:"Recuperar Senha"})}),y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsxs(wn,{className:"text-xl font-bold",children:[t===1&&"Recuperar Senha",t===2&&"Verificar Cdigo",t===3&&"Nova Senha"]}),y.jsxs(Dn,{className:"text-neutral-400",children:[t===1&&"Digite seu e-mail para receber um cdigo de recuperao",t===2&&"Digite o cdigo de 6 dgitos enviado para seu e-mail",t===3&&"Digite sua nova senha"]})]}),r.show&&y.jsx(tg,{variant:r.variant,className:"mt-4",children:y.jsx(ng,{children:r.message})}),t===1&&y.jsxs("form",{onSubmit:g,className:"space-y-4",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"email",className:"text-sm font-medium text-neutral-300",children:"E-mail"}),y.jsx($t,{id:"email",name:"email",type:"email",value:l.email,onChange:d,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"seu@email.com"})]}),y.jsx(Ce,{type:"submit",className:"w-full bg-green-600 text-white hover:bg-green-700",children:"Enviar Cdigo"})]}),t===2&&y.jsxs("form",{onSubmit:p,className:"space-y-4",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{className:"text-sm font-medium text-neutral-300",children:"Cdigo de Verificao"}),y.jsx("div",{className:"flex justify-center",children:y.jsx(wI,{maxLength:6,value:l.code,onChange:m,children:y.jsxs(DI,{children:[y.jsx(La,{index:0}),y.jsx(La,{index:1}),y.jsx(La,{index:2}),y.jsx(La,{index:3}),y.jsx(La,{index:4}),y.jsx(La,{index:5})]})})})]}),y.jsx(Ce,{type:"submit",className:"w-full bg-green-600 text-white hover:bg-green-700",disabled:l.code.length!==6,children:"Verificar Cdigo"})]}),t===3&&y.jsxs("form",{onSubmit:E,className:"space-y-4",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"newPassword",className:"text-sm font-medium text-neutral-300",children:"Nova Senha"}),y.jsx($t,{id:"newPassword",name:"newPassword",type:"password",value:l.newPassword,onChange:d,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:""})]}),y.jsxs("div",{className:"space-y-2",children:[y.jsx("label",{htmlFor:"confirmPassword",className:"text-sm font-medium text-neutral-300",children:"Confirmar Nova Senha"}),y.jsx($t,{id:"confirmPassword",name:"confirmPassword",type:"password",value:l.confirmPassword,onChange:d,required:!0,className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:""})]}),y.jsx(Ce,{type:"submit",className:"w-full bg-green-600 text-white hover:bg-green-700",children:"Redefinir Senha"})]}),y.jsx("div",{className:"mt-4 text-center",children:y.jsx("button",{type:"button",onClick:()=>{e(!1),setTimeout(()=>{const b=document.querySelector('[data-testid="login-trigger"]');b&&b.click()},100)},className:"text-sm text-green-400 hover:text-green-300 transition-colors",children:"Voltar para o Login"})})]})]})}function is({className:i,...e}){return y.jsx("div",{"data-slot":"card",className:vt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",i),...e})}function wr({className:i,...e}){return y.jsx("div",{"data-slot":"card-header",className:vt("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",i),...e})}function Dr({className:i,...e}){return y.jsx("div",{"data-slot":"card-title",className:vt("leading-none font-semibold",i),...e})}function Tb({className:i,...e}){return y.jsx("div",{"data-slot":"card-description",className:vt("text-muted-foreground text-sm",i),...e})}function vs({className:i,...e}){return y.jsx("div",{"data-slot":"card-content",className:vt("px-6",i),...e})}const NI=Gm("inline-flex items-center justify-center rounded-full border border-transparent px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border-border text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",ghost:"[a&]:hover:bg-accent [a&]:hover:text-accent-foreground",link:"text-primary underline-offset-4 [a&]:hover:underline"}},defaultVariants:{variant:"default"}});function Oh({className:i,variant:e="default",asChild:t=!1,...n}){const r=t?nS:"span";return y.jsx(r,{"data-slot":"badge","data-variant":e,className:vt(NI({variant:e}),i),...n})}function OI(i,e=[]){let t=[];function n(o,l){const u=R.createContext(l);u.displayName=o+"Context";const f=t.length;t=[...t,l];const d=g=>{const{scope:p,children:E,...S}=g,b=p?.[i]?.[f]||u,T=R.useMemo(()=>S,Object.values(S));return y.jsx(b.Provider,{value:T,children:E})};d.displayName=o+"Provider";function m(g,p){const E=p?.[i]?.[f]||u,S=R.useContext(E);if(S)return S;if(l!==void 0)return l;throw new Error(`\`${g}\` must be used within \`${o}\``)}return[d,m]}const r=()=>{const o=t.map(l=>R.createContext(l));return function(u){const f=u?.[i]||o;return R.useMemo(()=>({[`__scope${i}`]:{...u,[i]:f}}),[u,f])}};return r.scopeName=i,[n,MI(r,...e)]}function MI(...i){const e=i[0];if(i.length===1)return e;const t=()=>{const n=i.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const l=n.reduce((u,{useScope:f,scopeName:d})=>{const g=f(o)[`__scope${d}`];return{...u,...g}},{});return R.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}var kI=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ab=kI.reduce((i,e)=>{const t=$m(`Primitive.${e}`),n=R.forwardRef((r,o)=>{const{asChild:l,...u}=r,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),y.jsx(f,{...u,ref:o})});return n.displayName=`Primitive.${e}`,{...i,[e]:n}},{}),sg="Progress",ig=100,[PI]=OI(sg),[UI,FI]=PI(sg),Rb=R.forwardRef((i,e)=>{const{__scopeProgress:t,value:n=null,max:r,getValueLabel:o=BI,...l}=i;(r||r===0)&&!Sx(r)&&console.error(jI(`${r}`,"Progress"));const u=Sx(r)?r:ig;n!==null&&!bx(n,u)&&console.error($I(`${n}`,"Progress"));const f=bx(n,u)?n:null,d=Tu(f)?o(f,u):void 0;return y.jsx(UI,{scope:t,value:f,max:u,children:y.jsx(Ab.div,{"aria-valuemax":u,"aria-valuemin":0,"aria-valuenow":Tu(f)?f:void 0,"aria-valuetext":d,role:"progressbar","data-state":_b(f,u),"data-value":f??void 0,"data-max":u,...l,ref:e})})});Rb.displayName=sg;var Cb="ProgressIndicator",Lb=R.forwardRef((i,e)=>{const{__scopeProgress:t,...n}=i,r=FI(Cb,t);return y.jsx(Ab.div,{"data-state":_b(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...n,ref:e})});Lb.displayName=Cb;function BI(i,e){return`${Math.round(i/e*100)}%`}function _b(i,e){return i==null?"indeterminate":i===e?"complete":"loading"}function Tu(i){return typeof i=="number"}function Sx(i){return Tu(i)&&!isNaN(i)&&i>0}function bx(i,e){return Tu(i)&&!isNaN(i)&&i<=e&&i>=0}function jI(i,e){return`Invalid prop \`max\` of value \`${i}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${ig}\`.`}function $I(i,e){return`Invalid prop \`value\` of value \`${i}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${ig} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var GI=Rb,zI=Lb;function wb({className:i,value:e,...t}){return y.jsx(GI,{"data-slot":"progress",className:vt("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",i),...t,children:y.jsx(zI,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})})}function HI({children:i}){const[e,t]=R.useState(!1),n=[{id:1,title:"Desenvolvimento Web Completo",instructor:"Ruan Cardoso",progress:75,totalLessons:45,completedLessons:34,duration:"12h 30min",thumbnail:"https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=400&h=200&fit=crop",status:"in_progress",lastAccessed:"H 2 dias"},{id:2,title:"React Avanado",instructor:"Ruan Cardoso",progress:100,totalLessons:32,completedLessons:32,duration:"8h 15min",thumbnail:"https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=400&h=200&fit=crop",status:"completed",lastAccessed:"H 1 semana"},{id:3,title:"Cybersecurity Fundamentals",instructor:"Ruan Cardoso",progress:30,totalLessons:28,completedLessons:8,duration:"6h 45min",thumbnail:"https://images.unsplash.com/photo-1563013544-824ae1b704d3?w=400&h=200&fit=crop",status:"in_progress",lastAccessed:"H 5 dias"},{id:4,title:"Machine Learning Basics",instructor:"Ruan Cardoso",progress:0,totalLessons:40,completedLessons:0,duration:"15h 20min",thumbnail:"https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?w=400&h=200&fit=crop",status:"not_started",lastAccessed:"Nunca"}],r=l=>{switch(l){case"completed":return y.jsx(Oh,{className:"bg-green-600 hover:bg-green-700",children:"Concludo"});case"in_progress":return y.jsx(Oh,{className:"bg-blue-600 hover:bg-blue-700",children:"Em andamento"});case"not_started":return y.jsx(Oh,{variant:"secondary",children:"No iniciado"});default:return null}},o=l=>{switch(l){case"completed":return y.jsx(ax,{className:"h-5 w-5 text-green-400"});case"in_progress":return y.jsx(xu,{className:"h-5 w-5 text-blue-400"});case"not_started":return y.jsx(X_,{className:"h-5 w-5 text-neutral-400"});default:return null}};return y.jsxs(Cn,{open:e,onOpenChange:t,children:[y.jsx(er,{asChild:!0,children:i}),y.jsx(Ln,{className:"bg-neutral-950 border-neutral-800 text-white w-[calc(100vw-1.5rem)] sm:w-full max-w-6xl sm:max-w-6xl max-h-[90vh] overflow-hidden p-0",children:y.jsxs("div",{className:"flex flex-col h-full",children:[y.jsxs(_n,{className:"px-4 sm:px-6 py-4 border-b border-neutral-800",children:[y.jsx(wn,{className:"text-2xl font-bold text-white",children:"Meus Cursos"}),y.jsx(Dn,{className:"text-neutral-400",children:"Acompanhe seu progresso e continue seus estudos"})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4",children:[y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[y.jsx(is,{className:"bg-neutral-900 border-neutral-800",children:y.jsx(vs,{className:"p-4",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(fl,{className:"h-8 w-8 text-green-400"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-2xl font-bold text-white",children:"4"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Cursos"})]})]})})}),y.jsx(is,{className:"bg-neutral-900 border-neutral-800",children:y.jsx(vs,{className:"p-4",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(ax,{className:"h-8 w-8 text-green-400"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-2xl font-bold text-white",children:"1"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Concludos"})]})]})})}),y.jsx(is,{className:"bg-neutral-900 border-neutral-800",children:y.jsx(vs,{className:"p-4",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(xu,{className:"h-8 w-8 text-blue-400"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-2xl font-bold text-white",children:"2"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Em andamento"})]})]})})}),y.jsx(is,{className:"bg-neutral-900 border-neutral-800",children:y.jsx(vs,{className:"p-4",children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx(Eu,{className:"h-8 w-8 text-yellow-400"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-2xl font-bold text-white",children:"42h"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Total de contedo"})]})]})})})]}),y.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.map(l=>y.jsxs(is,{className:"bg-neutral-900 border-neutral-800 hover:border-neutral-700 transition-colors",children:[y.jsx(wr,{className:"pb-3",children:y.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[y.jsxs("div",{className:"relative shrink-0 w-full sm:w-24 h-40 sm:h-16 rounded-lg overflow-hidden",children:[y.jsx("img",{src:l.thumbnail,alt:l.title,className:"w-full h-full object-cover"}),y.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:o(l.status)})]}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx(Dr,{className:"text-lg font-semibold text-white leading-snug wrap-break-word mb-1",children:l.title}),y.jsxs("p",{className:"text-sm text-neutral-400 mb-2",children:["por ",l.instructor]}),y.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r(l.status),y.jsx("span",{className:"text-xs text-neutral-500",children:l.lastAccessed})]})]})]})}),y.jsx(vs,{className:"pt-0",children:y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"space-y-2",children:[y.jsxs("div",{className:"flex justify-between text-sm",children:[y.jsx("span",{className:"text-neutral-400",children:"Progresso"}),y.jsxs("span",{className:"text-white font-medium",children:[l.progress,"%"]})]}),y.jsx(wb,{value:l.progress,className:"h-2 bg-neutral-700"})]}),y.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 text-sm",children:y.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-neutral-400",children:[y.jsxs("span",{children:[l.completedLessons,"/",l.totalLessons," aulas"]}),y.jsx("span",{children:l.duration})]})}),y.jsx(Ce,{className:"w-full bg-green-600 hover:bg-green-700 text-white",disabled:l.status==="not_started",children:l.status==="completed"?"Rever Curso":l.status==="in_progress"?"Continuar":"Comear Curso"})]})})]},l.id))})]})]})})]})}const ss=async(i,e={})=>{const t=hl();if(!t)throw new Error("Token de autenticao no encontrado");const n={"Content-Type":"application/json",Authorization:`Bearer ${t}`,...e.headers},r=await fetch(i,{...e,headers:n});if(!r.ok){const o=await r.json().catch(()=>({}));throw new Error(o.message||`HTTP error! status: ${r.status}`)}return r.json()},VI=async(i,e,t,n)=>{const r=hl();if(!r)throw new Error("Token de autenticao no encontrado");const o=new FormData;if(o.append("video",e),n){const l=new Blob([n],{type:"text/plain"}),u=new File([l],n,{type:"text/plain"});o.append("videoPath",u)}return new Promise((l,u)=>{const f=new XMLHttpRequest;t&&f.upload.addEventListener("progress",d=>{if(d.lengthComputable){const m=Math.round(d.loaded/d.total*90);t(m)}}),f.addEventListener("load",()=>{if(f.status>=200&&f.status<300)try{const d=JSON.parse(f.responseText);l(d)}catch{u(new Error("Resposta invlida do servidor"))}else try{const d=JSON.parse(f.responseText);u(new Error(d.message||`HTTP error! status: ${f.status}`))}catch{u(new Error(`HTTP error! status: ${f.status}`))}}),f.addEventListener("error",()=>{u(new Error("Erro de conexo"))}),f.open("POST",i),f.setRequestHeader("Authorization",`Bearer ${r}`),f.send(o)})},It={getCategories:async()=>await ss(Rt.CATEGORIES,{method:"GET"}),createCategory:async(i,e)=>await ss(Rt.CATEGORIES_CREATE,{method:"POST",body:JSON.stringify({name:i,description:e})}),updateCategory:async(i,e,t)=>await ss(Rt.CATEGORIES_UPDATE,{method:"POST",body:JSON.stringify({id:i,name:e,description:t})}),deleteCategory:async i=>await ss(Rt.CATEGORIES_DELETE,{method:"POST",body:JSON.stringify({id:i})}),createCourse:async(i,e,t)=>await ss(Rt.COURSES_CREATE,{method:"POST",body:JSON.stringify({categoryId:i,title:e,description:t})}),updateCourse:async(i,e,t)=>await ss(Rt.COURSES_UPDATE,{method:"POST",body:JSON.stringify({id:i,title:e,description:t})}),deleteCourse:async i=>await ss(Rt.COURSES_DELETE,{method:"POST",body:JSON.stringify({id:i})}),createLesson:async(i,e,t,n)=>await ss(Rt.LESSONS_CREATE,{method:"POST",body:JSON.stringify({courseId:i,title:e,duration:t,description:n})}),updateLesson:async(i,e,t,n,r)=>await ss(Rt.LESSONS_UPDATE,{method:"POST",body:JSON.stringify({id:i,title:e,duration:t,description:n,isPaid:r})}),deleteLesson:async i=>await ss(Rt.LESSONS_DELETE,{method:"POST",body:JSON.stringify({id:i})}),getCoursesByCategory:async i=>await ss(`${Rt.COURSES_BY_CATEGORY}?categoryId=${i}`,{method:"GET"}),getLessonsByCourse:async i=>await ss(`${Rt.LESSONS_BY_COURSE}?courseId=${i}`,{method:"GET"}),uploadVideo:async(i,e,t)=>await VI(Rt.VIDEO_UPLOAD,i,e,t)};function KI({isOpen:i,onOpenChange:e,categoryName:t,onCategoryNameChange:n,categoryDescription:r,onCategoryDescriptionChange:o,onCreateCategory:l}){return y.jsxs(Cn,{open:i,onOpenChange:e,children:[y.jsx(er,{asChild:!0,children:y.jsxs(Ce,{className:"bg-green-600 hover:bg-green-700",children:[y.jsx(qm,{className:"h-4 w-4 mr-2"}),"Nova Categoria"]})}),y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsx(wn,{children:"Criar Nova Categoria"}),y.jsx(Dn,{className:"text-neutral-400",children:"Digite o nome da nova categoria para adicionar ao dashboard."})]}),y.jsxs("div",{className:"py-4 space-y-4",children:[y.jsx($t,{value:t,onChange:u=>n(u.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Nome da categoria",onKeyDown:u=>{u.key==="Enter"&&l()}}),y.jsx("textarea",{value:r,onChange:u=>o(u.target.value),className:"w-full bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500 rounded-md px-3 py-2 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-transparent",placeholder:"Descrio da categoria",rows:3,required:!0})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>{e(!1),n(""),o("")},className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:l,className:"bg-green-600 hover:bg-green-700",disabled:!t.trim()||!r.trim(),children:"Criar Categoria"})]})]})]})}function YI({isOpen:i,onOpenChange:e,courseTitle:t,onCourseTitleChange:n,courseDescription:r,onCourseDescriptionChange:o,onCreateCourse:l,selectedCategoryId:u,categories:f}){const d=f.find(m=>m.id===u);return y.jsxs(Cn,{open:i,onOpenChange:e,children:[y.jsx(er,{asChild:!0,children:y.jsxs(Ce,{variant:"ghost",className:"border border-neutral-700 hover:bg-neutral-900",disabled:!u,children:[y.jsx(qm,{className:"h-4 w-4 mr-2"}),"Novo Curso"]})}),y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsx(wn,{children:"Criar Novo Curso"}),y.jsx(Dn,{className:"text-neutral-400",children:u?`Adicionando um novo curso  categoria: ${d?.name}`:"Selecione uma categoria primeiro para criar um curso."})]}),y.jsxs("div",{className:"py-4 space-y-4",children:[y.jsx($t,{value:t,onChange:m=>n(m.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Ttulo do curso",onKeyDown:m=>{m.key==="Enter"&&l()}}),y.jsx("textarea",{value:r,onChange:m=>o(m.target.value),className:"w-full bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500 rounded-md px-3 py-2 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-transparent",placeholder:"Descrio do curso",rows:3,required:!0})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>{e(!1),n(""),o("")},className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:l,className:"bg-green-600 hover:bg-green-700",disabled:!t.trim()||!r.trim()||!u,children:"Criar Curso"})]})]})]})}function Db({isOpen:i,onOpenChange:e,lessonTitle:t,onLessonTitleChange:n,lessonDuration:r,onLessonDurationChange:o,lessonDescription:l,onLessonDescriptionChange:u,onCreateLesson:f,selectedCategoryId:d,selectedCourseId:m,categories:g}){const E=g.find(S=>S.id===d)?.courses.find(S=>S.id===m);return y.jsxs(Cn,{open:i,onOpenChange:e,children:[y.jsx(er,{asChild:!0,children:y.jsxs(Ce,{variant:"ghost",className:"border border-neutral-700 hover:bg-neutral-900",disabled:!m,children:[y.jsx(qm,{className:"h-4 w-4 mr-2"}),"Nova Aula"]})}),y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsx(wn,{children:"Criar Nova Aula"}),y.jsx(Dn,{className:"text-neutral-400",children:m?`Adicionando uma nova aula ao curso: ${E?.title}`:"Selecione um curso primeiro para criar uma aula."})]}),y.jsxs("div",{className:"py-4 space-y-4",children:[y.jsx($t,{value:t,onChange:S=>n(S.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Ttulo da aula"}),y.jsx($t,{value:r,onChange:S=>o(S.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Durao (ex: 15:30)"}),y.jsx("textarea",{value:l,onChange:S=>u(S.target.value),className:"w-full bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500 rounded-md px-3 py-2 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-green-600 focus:border-transparent",placeholder:"Descrio da aula",rows:3,required:!0})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>{e(!1),n(""),o(""),u("")},className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:f,className:"bg-green-600 hover:bg-green-700",disabled:!t.trim()||!r.trim()||!l.trim()||!m,children:"Criar Aula"})]})]})]})}function qI(i){const e=R.useRef({value:i,previous:i});return R.useMemo(()=>(e.current.value!==i&&(e.current.previous=e.current.value,e.current.value=i),e.current.previous),[i])}function Ib(i){const[e,t]=R.useState(void 0);return fi(()=>{if(i){t({width:i.offsetWidth,height:i.offsetHeight});const n=new ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const o=r[0];let l,u;if("borderBoxSize"in o){const f=o.borderBoxSize,d=Array.isArray(f)?f[0]:f;l=d.inlineSize,u=d.blockSize}else l=i.offsetWidth,u=i.offsetHeight;t({width:l,height:u})});return n.observe(i,{box:"border-box"}),()=>n.unobserve(i)}else t(void 0)},[i]),e}var Xu="Checkbox",[XI]=Ji(Xu),[WI,rg]=XI(Xu);function QI(i){const{__scopeCheckbox:e,checked:t,children:n,defaultChecked:r,disabled:o,form:l,name:u,onCheckedChange:f,required:d,value:m="on",internal_do_not_use_render:g}=i,[p,E]=Ku({prop:t,defaultProp:r??!1,onChange:f,caller:Xu}),[S,b]=R.useState(null),[T,A]=R.useState(null),_=R.useRef(!1),w=S?!!l||!!S.closest("form"):!0,D={checked:p,disabled:o,setChecked:E,control:S,setControl:b,name:u,form:l,value:m,hasConsumerStoppedPropagationRef:_,required:d,defaultChecked:Ki(r)?!1:r,isFormControl:w,bubbleInput:T,setBubbleInput:A};return y.jsx(WI,{scope:e,...D,children:ZI(g)?g(D):n})}var Nb="CheckboxTrigger",Ob=R.forwardRef(({__scopeCheckbox:i,onKeyDown:e,onClick:t,...n},r)=>{const{control:o,value:l,disabled:u,checked:f,required:d,setControl:m,setChecked:g,hasConsumerStoppedPropagationRef:p,isFormControl:E,bubbleInput:S}=rg(Nb,i),b=yt(r,m),T=R.useRef(f);return R.useEffect(()=>{const A=o?.form;if(A){const _=()=>g(T.current);return A.addEventListener("reset",_),()=>A.removeEventListener("reset",_)}},[o,g]),y.jsx(ct.button,{type:"button",role:"checkbox","aria-checked":Ki(f)?"mixed":f,"aria-required":d,"data-state":Bb(f),"data-disabled":u?"":void 0,disabled:u,value:l,...n,ref:b,onKeyDown:we(e,A=>{A.key==="Enter"&&A.preventDefault()}),onClick:we(t,A=>{g(_=>Ki(_)?!0:!_),S&&E&&(p.current=A.isPropagationStopped(),p.current||A.stopPropagation())})})});Ob.displayName=Nb;var Mb=R.forwardRef((i,e)=>{const{__scopeCheckbox:t,name:n,checked:r,defaultChecked:o,required:l,disabled:u,value:f,onCheckedChange:d,form:m,...g}=i;return y.jsx(QI,{__scopeCheckbox:t,checked:r,defaultChecked:o,disabled:u,required:l,onCheckedChange:d,name:n,form:m,value:f,internal_do_not_use_render:({isFormControl:p})=>y.jsxs(y.Fragment,{children:[y.jsx(Ob,{...g,ref:e,__scopeCheckbox:t}),p&&y.jsx(Fb,{__scopeCheckbox:t})]})})});Mb.displayName=Xu;var kb="CheckboxIndicator",Pb=R.forwardRef((i,e)=>{const{__scopeCheckbox:t,forceMount:n,...r}=i,o=rg(kb,t);return y.jsx(os,{present:n||Ki(o.checked)||o.checked===!0,children:y.jsx(ct.span,{"data-state":Bb(o.checked),"data-disabled":o.disabled?"":void 0,...r,ref:e,style:{pointerEvents:"none",...i.style}})})});Pb.displayName=kb;var Ub="CheckboxBubbleInput",Fb=R.forwardRef(({__scopeCheckbox:i,...e},t)=>{const{control:n,hasConsumerStoppedPropagationRef:r,checked:o,defaultChecked:l,required:u,disabled:f,name:d,value:m,form:g,bubbleInput:p,setBubbleInput:E}=rg(Ub,i),S=yt(t,E),b=qI(o),T=Ib(n);R.useEffect(()=>{const _=p;if(!_)return;const w=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(w,"checked").set,B=!r.current;if(b!==o&&O){const N=new Event("click",{bubbles:B});_.indeterminate=Ki(o),O.call(_,Ki(o)?!1:o),_.dispatchEvent(N)}},[p,b,o,r]);const A=R.useRef(Ki(o)?!1:o);return y.jsx(ct.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??A.current,required:u,disabled:f,name:d,value:m,form:g,...e,tabIndex:-1,ref:S,style:{...e.style,...T,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Fb.displayName=Ub;function ZI(i){return typeof i=="function"}function Ki(i){return i==="indeterminate"}function Bb(i){return Ki(i)?"indeterminate":i?"checked":"unchecked"}function JI({className:i,...e}){return y.jsx(Mb,{"data-slot":"checkbox",className:vt("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",i),...e,children:y.jsx(Pb,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:y.jsx(__,{className:"size-3.5"})})})}function eN({isOpen:i,onOpenChange:e,onVideoSelect:t,currentVideoUrl:n,videoPath:r}){const[o,l]=R.useState(null),[u,f]=R.useState(!1),[d,m]=R.useState(!1),[g,p]=R.useState(0),[E,S]=R.useState(null),[b,T]=R.useState(0),A=R.useRef(null);R.useEffect(()=>{let k;return d&&E&&(k=setInterval(()=>{const F=Math.floor((Date.now()-E)/1e3);T(F)},1e3)),()=>{k&&clearInterval(k)}},[d,E]);const _=k=>{const F=Math.floor(k/60),H=k%60;return`${F.toString().padStart(2,"0")}:${H.toString().padStart(2,"0")}`},w=k=>{k&&k.type.startsWith("video/")?l(k):alert("Por favor, selecione um arquivo de vdeo vlido.")},D=k=>{const F=k.target.files[0];F&&w(F)},O=k=>{k.preventDefault(),k.stopPropagation(),k.type==="dragenter"||k.type==="dragover"?f(!0):k.type==="dragleave"&&f(!1)},B=k=>{k.preventDefault(),k.stopPropagation(),f(!1),k.dataTransfer.files&&k.dataTransfer.files[0]&&w(k.dataTransfer.files[0])},N=async()=>{if(o)try{m(!0),p(0),S(Date.now()),T(0);const k=await It.uploadVideo(o,H=>{p(H)},r);p(100);const F=k?.Result?.url||URL.createObjectURL(o);t({file:o,url:F,name:o.name,size:o.size,type:o.type}),setTimeout(()=>{l(null),p(0),S(null),T(0),e(!1)},500)}catch(k){console.error("Erro ao fazer upload do vdeo:",k),alert("Erro ao fazer upload do vdeo. Tente novamente."),p(0),S(null),T(0)}finally{m(!1)}},U=k=>{if(k===0)return"0 Bytes";const F=1024,H=["Bytes","KB","MB","GB"],ne=Math.floor(Math.log(k)/Math.log(F));return parseFloat((k/Math.pow(F,ne)).toFixed(2))+" "+H[ne]};return y.jsx(Cn,{open:i,onOpenChange:e,children:y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white max-w-2xl",children:[y.jsxs(_n,{children:[y.jsx(wn,{children:"Upload de Vdeo"}),y.jsx(Dn,{className:"text-neutral-400",children:"Selecione um arquivo de vdeo para esta aula."})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${u?"border-green-500 bg-green-500/10":"border-neutral-700 hover:border-neutral-600"}`,onDragEnter:O,onDragLeave:O,onDragOver:O,onDrop:B,children:[y.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[y.jsx(BS,{className:"h-12 w-12 text-neutral-400"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-lg font-medium text-white",children:"Arraste e solte o vdeo aqui"}),y.jsx("p",{className:"text-sm text-neutral-400 mt-1",children:"ou clique para selecionar da galeria"})]}),y.jsxs(Ce,{onClick:()=>A.current?.click(),className:"border border-neutral-700 text-white hover:bg-neutral-800",children:[y.jsx(ox,{className:"h-4 w-4 mr-2"}),"Selecionar Vdeo"]})]}),y.jsx("input",{ref:A,type:"file",accept:"video/*",onChange:D,className:"hidden"})]}),o&&y.jsxs("div",{className:"bg-neutral-900/50 rounded-lg p-4",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsxs("div",{className:"flex items-center space-x-3",children:[y.jsx(ox,{className:"h-8 w-8 text-green-400"}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm font-medium text-white truncate max-w-xs",children:o.name}),y.jsx("p",{className:"text-xs text-neutral-400",children:U(o.size)})]})]}),!d&&y.jsx(Ce,{variant:"ghost",size:"sm",onClick:()=>l(null),className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",children:y.jsx(Vu,{className:"h-4 w-4"})})]}),d&&y.jsxs("div",{className:"mt-4 space-y-2",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-sm text-neutral-400",children:g>=90?"Processando...":"Fazendo upload..."}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsxs("span",{className:"text-sm text-neutral-400",children:[g,"%"]}),y.jsxs("span",{className:"text-xs text-neutral-500",children:["(",_(b),")"]})]})]}),y.jsx(wb,{value:g,className:"h-2"})]}),!d&&y.jsx("div",{className:"mt-3",children:y.jsx("video",{src:URL.createObjectURL(o),className:"w-full rounded-lg bg-black",controls:!0,style:{maxHeight:"200px"}})})]}),n&&!o&&y.jsxs("div",{className:"bg-neutral-900/50 rounded-lg p-4",children:[y.jsx("p",{className:"text-sm text-neutral-400 mb-2",children:"Vdeo atual:"}),y.jsx("video",{src:n,className:"w-full rounded-lg bg-black",controls:!0,style:{maxHeight:"200px"}})]})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>{l(null),e(!1)},className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:N,className:"bg-green-600 hover:bg-green-700",disabled:!o||d,children:d?"Enviando...":"Fazer Upload"})]})]})})}function tN({isOpen:i,onOpenChange:e,lesson:t,onSaveLesson:n,categories:r}){const[o,l]=R.useState(""),[u,f]=R.useState(""),[d,m]=R.useState(""),[g,p]=R.useState(""),[E,S]=R.useState(!1),[b,T]=R.useState(!1);R.useEffect(()=>{t&&(l(t.title||""),f(t.duration||""),m(t.description||""),p(t.videoUrl||""),S(t.isPaid||!1))},[t]);const A=()=>{o.trim()&&u.trim()&&d.trim()&&(n({...t,title:o.trim(),duration:u.trim(),description:d.trim(),videoUrl:g,isPaid:E}),e(!1))},_=D=>{p(D.url)},w=()=>!t||!t.id?null:`l${t.id}`;return y.jsxs(y.Fragment,{children:[y.jsx(Cn,{open:i,onOpenChange:e,children:y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsx(wn,{children:"Editar Aula"}),y.jsx(Dn,{className:"text-neutral-400",children:"Modifique as informaes da aula."})]}),y.jsxs("div",{className:"py-4 space-y-4",children:[y.jsxs("div",{children:[y.jsx("label",{className:"text-sm font-medium text-white mb-2 block",children:"Ttulo da Aula"}),y.jsx($t,{value:o,onChange:D=>l(D.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Ttulo da aula"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"text-sm font-medium text-white mb-2 block",children:"Durao"}),y.jsx($t,{value:u,onChange:D=>f(D.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Durao (ex: 15:30)"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"text-sm font-medium text-white mb-2 block",children:"Descrio"}),y.jsx("textarea",{value:d,onChange:D=>m(D.target.value),className:"w-full bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500 rounded-md px-3 py-2 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent",placeholder:"Descrio da aula",rows:3,required:!0})]}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx(JI,{id:"isPaid",checked:E,onCheckedChange:S,className:"bg-neutral-900 border-neutral-700 data-[state=checked]:bg-green-600 data-[state=checked]:border-green-600"}),y.jsx("label",{htmlFor:"isPaid",className:"text-sm font-medium text-white cursor-pointer",children:"Aula Paga (Bloqueada)"})]}),y.jsxs("div",{children:[y.jsx("label",{className:"text-sm font-medium text-white mb-2 block",children:"Vdeo da Aula"}),y.jsxs("div",{className:"space-y-3",children:[g&&y.jsx("div",{className:"bg-neutral-900/50 rounded-lg p-3",children:y.jsx("video",{src:g,className:"w-full rounded-lg bg-black",controls:!0,style:{maxHeight:"150px"}})}),y.jsxs(Ce,{onClick:()=>T(!0),className:"w-full border border-neutral-700 text-white hover:bg-neutral-800",children:[y.jsx(BS,{className:"h-4 w-4 mr-2"}),g?"Trocar Vdeo":"Upload de Vdeo"]})]})]})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>e(!1),className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:A,className:"bg-green-600 hover:bg-green-700",disabled:!o.trim()||!u.trim()||!d.trim(),children:"Salvar Alteraes"})]})]})}),y.jsx(eN,{isOpen:b,onOpenChange:T,onVideoSelect:_,currentVideoUrl:g,videoPath:w()})]})}function nN({lesson:i,onEditLesson:e}){return y.jsx(Ce,{variant:"ghost",size:"sm",className:"text-neutral-400 hover:text-white hover:bg-neutral-700",onClick:t=>{t.stopPropagation(),e(i)},children:y.jsx(qi,{className:"h-3 w-3"})})}function sN({lesson:i,onEditLesson:e}){return y.jsxs(Ce,{variant:"ghost",size:"sm",className:"border border-neutral-700 hover:bg-neutral-900",onClick:()=>e(i),children:[y.jsx(qi,{className:"h-4 w-4 mr-2"}),"Editar Aula"]})}function iN({category:i,isExpanded:e,onToggle:t,onSelect:n,isSelected:r,expandedCourses:o,onCourseToggle:l,onCourseSelect:u,onLessonSelect:f,selected:d,onEditLesson:m,onDeleteCategory:g,onDeleteCourse:p,onDeleteLesson:E,onEditCategory:S,onEditCourse:b}){return y.jsxs("div",{className:"rounded-xl border border-neutral-800 bg-neutral-900/30",children:[y.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 px-3 py-3 hover:bg-neutral-800/30 transition-colors rounded-xl ${r?"bg-neutral-800/50":""}`,onClick:()=>{t(i.id),n({type:"category",categoryId:i.id,courseId:null,lessonId:null})},children:[y.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[y.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-green-600/20 shrink-0",children:y.jsx(fl,{className:"h-4 w-4 text-green-400"})}),y.jsxs("div",{className:"min-w-0 text-left",children:[y.jsx("div",{className:"text-sm font-semibold text-white truncate",children:i.name}),y.jsxs("div",{className:"text-xs text-neutral-400",children:[i.courses.length," curso",i.courses.length!==1?"s":""]})]})]}),y.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[y.jsx(Ce,{variant:"ghost",size:"sm",className:"text-neutral-400 hover:text-white hover:bg-neutral-700",onClick:T=>{T.stopPropagation(),S(i)},children:y.jsx(qi,{className:"h-4 w-4"})}),y.jsx(Ce,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",onClick:T=>{T.stopPropagation(),g(i.id)},children:y.jsx(Pa,{className:"h-4 w-4"})}),e?y.jsx(OS,{className:"h-4 w-4 text-neutral-400"}):y.jsx(MS,{className:"h-4 w-4 text-neutral-400"})]})]}),e&&y.jsx("div",{className:"px-3 pb-3 space-y-2 mt-2",children:i.courses.map(T=>y.jsx(rN,{course:T,category:i,isExpanded:o.has(T.id),onToggle:l,onSelect:u,isSelected:d.type==="course"&&d.courseId===T.id,onLessonSelect:f,selected:d,onEditLesson:m,onDeleteCourse:p,onDeleteLesson:E,onEditCourse:b},T.id))})]})}function rN({course:i,category:e,isExpanded:t,onToggle:n,onSelect:r,isSelected:o,onLessonSelect:l,selected:u,onEditLesson:f,onDeleteCourse:d,onDeleteLesson:m,onEditCourse:g}){return y.jsxs("div",{className:"rounded-lg border border-neutral-800 bg-neutral-950/40",children:[y.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 px-3 py-2 hover:bg-neutral-800/30 transition-colors rounded-lg ${o?"bg-neutral-800/50":""}`,onClick:()=>{n(i.id),r({type:"course",categoryId:e.id,courseId:i.id,lessonId:null})},children:[y.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[y.jsx(xu,{className:"h-4 w-4 text-green-400 shrink-0"}),y.jsxs("div",{className:"min-w-0 text-left",children:[y.jsx("div",{className:"text-sm font-medium text-white truncate",children:i.title}),y.jsxs("div",{className:"text-xs text-neutral-400",children:[i.lessons?.length||0," aula",(i.lessons?.length||0)!==1?"s":""]})]})]}),y.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[y.jsx(Ce,{variant:"ghost",size:"sm",className:"text-neutral-400 hover:text-white hover:bg-neutral-700",onClick:p=>{p.stopPropagation(),g(e.id,i)},children:y.jsx(qi,{className:"h-3 w-3"})}),y.jsx(Ce,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",onClick:p=>{p.stopPropagation(),d(e.id,i.id)},children:y.jsx(Pa,{className:"h-3 w-3"})}),t?y.jsx(OS,{className:"h-4 w-4 text-neutral-400"}):y.jsx(MS,{className:"h-4 w-4 text-neutral-400"})]})]}),t&&y.jsx("div",{className:"px-3 pb-3 space-y-2 mt-2",children:(i.lessons||[]).map(p=>y.jsx(aN,{lesson:p,onSelect:l,isSelected:u.type==="lesson"&&u.lessonId===p.id,category:e,course:i,onEditLesson:f,onDeleteLesson:m},p.id))})]})}function aN({lesson:i,onSelect:e,isSelected:t,category:n,course:r,onEditLesson:o,onDeleteLesson:l}){return y.jsxs("button",{type:"button",className:`w-full flex items-center justify-between gap-3 px-3 py-2 rounded-lg bg-neutral-800/20 hover:bg-neutral-800/40 transition-colors ${t?"bg-neutral-800/50":""}`,onClick:()=>e({type:"lesson",categoryId:n.id,courseId:r.id,lessonId:i.id}),children:[y.jsxs("div",{className:"flex items-center gap-3 min-w-0 text-left",children:[y.jsx(xu,{className:"h-3 w-3 text-neutral-400 shrink-0"}),y.jsxs("div",{className:"min-w-0",children:[y.jsx("div",{className:"text-sm font-medium text-white truncate",children:i.title}),y.jsx("div",{className:"text-xs text-neutral-400",children:i.duration})]})]}),y.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[y.jsx(nN,{lesson:i,onEditLesson:o}),y.jsx(Ce,{variant:"ghost",size:"sm",className:"text-red-400 hover:text-red-300 hover:bg-red-900/20",onClick:u=>{u.stopPropagation(),l(n.id,r.id,i.id)},children:y.jsx(Pa,{className:"h-3 w-3"})})]})]},i.id)}function oN({selectedData:i,selected:e,onEditLesson:t,onDeleteCategory:n,onDeleteCourse:r,onDeleteLesson:o,onEditCategory:l,onEditCourse:u,lessonDialogProps:f}){return y.jsxs("div",{className:"space-y-4",children:[!i.category&&y.jsx("div",{className:"rounded-xl border border-neutral-800 bg-neutral-900/30 p-4 text-sm text-neutral-400",children:"Selecione uma categoria, curso ou aula."}),i.category&&y.jsx("div",{className:"rounded-xl border border-neutral-800 bg-neutral-900/30 p-4",children:y.jsxs("div",{className:"flex items-start justify-between gap-4",children:[y.jsxs("div",{className:"min-w-0",children:[y.jsx("div",{className:"text-xs text-neutral-400",children:"Categoria"}),y.jsx("div",{className:"text-xl font-semibold text-white truncate",children:i.category.name}),y.jsxs("div",{className:"mt-2 text-sm text-neutral-400",children:[i.category.courses.length," curso",i.category.courses.length!==1?"s":""]})]}),y.jsxs("div",{className:"flex gap-2 shrink-0",children:[y.jsxs(Ce,{variant:"ghost",className:"border border-neutral-700 hover:bg-neutral-900",onClick:()=>{l(i.category)},children:[y.jsx(qi,{className:"h-4 w-4 mr-2"}),"Editar"]}),y.jsxs(Ce,{variant:"ghost",className:"border border-red-600/30 text-red-400 hover:bg-red-900/20 hover:text-red-300",onClick:()=>{n(i.category.id)},children:[y.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Excluir"]})]})]})}),i.course&&y.jsxs("div",{className:"rounded-xl border border-neutral-800 bg-neutral-900/30 p-4",children:[y.jsx("div",{className:"text-xs text-neutral-400",children:"Curso"}),y.jsx("div",{className:"text-xl font-semibold text-white",children:i.course.title}),y.jsxs("div",{className:"mt-2 text-sm text-neutral-400",children:[i.course.lessons.length," aula",i.course.lessons.length!==1?"s":""]}),y.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2",children:[y.jsxs(Ce,{variant:"ghost",className:"border border-neutral-700 hover:bg-neutral-900",onClick:()=>{u(e.categoryId,i.course)},children:[y.jsx(qi,{className:"h-4 w-4 mr-2"}),"Editar Curso"]}),y.jsx(Db,{...f}),y.jsxs(Ce,{variant:"ghost",className:"border border-red-600/30 text-red-400 hover:bg-red-900/20 hover:text-red-300",onClick:()=>{r(e.categoryId,i.course.id)},children:[y.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Excluir Curso"]})]})]}),i.lesson&&y.jsxs("div",{className:"rounded-xl border border-neutral-800 bg-neutral-900/30 p-4",children:[y.jsx("div",{className:"text-xs text-neutral-400",children:"Aula"}),y.jsx("div",{className:"text-xl font-semibold text-white",children:i.lesson.title}),y.jsxs("div",{className:"mt-2 text-sm text-neutral-400",children:["Durao: ",i.lesson.duration]}),y.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-2",children:[y.jsx(sN,{lesson:i.lesson,onEditLesson:t}),y.jsxs(Ce,{variant:"ghost",className:"border border-red-600/30 text-red-400 hover:bg-red-900/20 hover:text-red-300",onClick:()=>{o(e.categoryId,e.courseId,i.lesson.id)},children:[y.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Excluir Aula"]})]})]})]})}function lN({query:i,onQueryChange:e,categoryDialogProps:t,courseDialogProps:n,lessonDialogProps:r}){return y.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-3",children:[y.jsx("div",{className:"flex-1",children:y.jsx($t,{value:i,onChange:o=>e(o.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Buscar categoria, curso ou aula..."})}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[y.jsx(KI,{...t}),y.jsx(YI,{...n}),y.jsx(Db,{...r})]})]})}function cN({isOpen:i,onOpenChange:e,title:t,description:n,confirmText:r="Excluir",cancelText:o="Cancelar",onConfirm:l,variant:u="destructive"}){const[f,d]=R.useState(!1),m=async()=>{d(!0);try{await l(),e(!1)}finally{d(!1)}};return y.jsx(Cn,{open:i,onOpenChange:e,children:y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white max-w-md",children:[y.jsx(_n,{children:y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:`p-2 rounded-full ${u==="destructive"?"bg-red-600/20 text-red-400":"bg-blue-600/20 text-blue-400"}`,children:y.jsx(Ew,{className:"h-5 w-5"})}),y.jsx(wn,{className:"text-lg font-semibold",children:t})]})}),y.jsx(Dn,{className:"text-neutral-300",children:n}),y.jsxs(tr,{className:"gap-2",children:[y.jsx(Ce,{onClick:()=>e(!1),disabled:f,className:"border border-neutral-700 text-white hover:bg-neutral-800",children:o}),y.jsx(Ce,{variant:u,onClick:m,disabled:f,className:u==="destructive"?"bg-red-600 hover:bg-red-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white",children:f?"Excluindo...":r})]})]})})}function uN(){const[i,e]=R.useState({isOpen:!1,title:"",description:"",onConfirm:null,confirmText:"Excluir",cancelText:"Cancelar",variant:"destructive"}),t=o=>{e({isOpen:!0,title:o.title||"Confirmar excluso",description:o.description||"Tem certeza que deseja continuar?",onConfirm:o.onConfirm||(()=>{}),confirmText:o.confirmText||"Excluir",cancelText:o.cancelText||"Cancelar",variant:o.variant||"destructive"})},n=()=>{e(o=>({...o,isOpen:!1}))};return{showConfirmDialog:t,hideDialog:n,ConfirmDialogComponent:()=>y.jsx(cN,{isOpen:i.isOpen,onOpenChange:n,title:i.title,description:i.description,confirmText:i.confirmText,cancelText:i.cancelText,onConfirm:i.onConfirm,variant:i.variant})}}function dN({isOpen:i,onOpenChange:e,categoryName:t,onCategoryNameChange:n,categoryDescription:r,onCategoryDescriptionChange:o,onUpdateCategory:l,isLoading:u=!1}){return y.jsx(Cn,{open:i,onOpenChange:e,children:y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2 rounded-full bg-blue-600/20 text-blue-400",children:y.jsx(qi,{className:"h-5 w-5"})}),y.jsx(wn,{children:"Editar Categoria"})]}),y.jsx(Dn,{className:"text-neutral-400",children:"Altere o nome da categoria. Esta ao ser aplicada imediatamente."})]}),y.jsxs("div",{className:"py-4 space-y-4",children:[y.jsx($t,{value:t,onChange:f=>n(f.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Nome da categoria",onKeyDown:f=>{f.key==="Enter"&&t.trim()&&l()},disabled:u}),y.jsx("textarea",{value:r,onChange:f=>o(f.target.value),className:"w-full bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500 rounded-md px-3 py-2 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent",placeholder:"Descrio da categoria",rows:3,disabled:u,required:!0})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>e(!1),disabled:u,className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:l,disabled:!t.trim()||!r.trim()||u,className:"bg-blue-600 hover:bg-blue-700",children:u?"Salvando...":"Salvar Alteraes"})]})]})})}function fN({isOpen:i,onOpenChange:e,courseTitle:t,onCourseTitleChange:n,courseDescription:r,onCourseDescriptionChange:o,onUpdateCourse:l,categoryName:u,isLoading:f=!1}){return y.jsx(Cn,{open:i,onOpenChange:e,children:y.jsxs(Ln,{className:"bg-neutral-950 border-neutral-800 text-white",children:[y.jsxs(_n,{children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"p-2 rounded-full bg-blue-600/20 text-blue-400",children:y.jsx(qi,{className:"h-5 w-5"})}),y.jsx(wn,{children:"Editar Curso"})]}),y.jsx(Dn,{className:"text-neutral-400",children:u?`Alterando o ttulo do curso na categoria: ${u}`:"Alterando o ttulo do curso."})]}),y.jsxs("div",{className:"py-4 space-y-4",children:[y.jsx($t,{value:t,onChange:d=>n(d.target.value),className:"bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500",placeholder:"Ttulo do curso",onKeyDown:d=>{d.key==="Enter"&&t.trim()&&l()},disabled:f}),y.jsx("textarea",{value:r,onChange:d=>o(d.target.value),className:"w-full bg-neutral-900 border-neutral-700 text-white placeholder:text-neutral-500 rounded-md px-3 py-2 text-sm resize-none h-20 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent",placeholder:"Descrio do curso",rows:3,disabled:f,required:!0})]}),y.jsxs(tr,{children:[y.jsx(Ce,{onClick:()=>e(!1),disabled:f,className:"border border-neutral-700 text-white hover:bg-neutral-800",children:"Cancelar"}),y.jsx(Ce,{onClick:l,disabled:!t.trim()||!r.trim()||f,className:"bg-blue-600 hover:bg-blue-700",children:f?"Salvando...":"Salvar Alteraes"})]})]})})}function hN(){const[i,e]=R.useState(new Set),[t,n]=R.useState(new Set),[r,o]=R.useState({type:"category",categoryId:null,courseId:null,lessonId:null}),[l,u]=R.useState(""),[f,d]=R.useState(!1),[m,g]=R.useState(""),[p,E]=R.useState(""),[S,b]=R.useState(!1),[T,A]=R.useState(""),[_,w]=R.useState(""),[D,O]=R.useState(!1),[B,N]=R.useState(""),[U,k]=R.useState(""),[F,H]=R.useState(""),[ne,J]=R.useState(null),[le,de]=R.useState(!1),[P,K]=R.useState([]),[j,W]=R.useState(!0),[he,M]=R.useState(null),[G,te]=R.useState({}),[V,se]=R.useState({}),[ce,fe]=R.useState({}),[ve,Ae]=R.useState({}),[Qe,Ze]=R.useState(null),[Lt,Tt]=R.useState(!1),[Se,Ie]=R.useState(""),[Le,Ye]=R.useState(""),[qe,$e]=R.useState(null),[nt,Gt]=R.useState(!1),[xt,cn]=R.useState(""),[Je,Jt]=R.useState(""),{showConfirmDialog:Ot,ConfirmDialogComponent:fn}=uN();R.useEffect(()=>{(async()=>{try{W(!0);const ke=(await It.getCategories())?.Result?.categories||[];K(ke),M(null)}catch(Re){M(Re.message),console.error("Erro ao buscar categorias:",Re),K([])}finally{W(!1)}})()},[]);const us=async me=>{const Re=new Set(i);if(!Re.has(me)){if(Re.add(me),e(Re),!V[me])try{te(_t=>({..._t,[me]:!0}));const it=(await It.getCoursesByCategory(me))?.Result?.courses||[];se(_t=>({..._t,[me]:it}))}catch(Xe){console.error("Erro ao buscar cursos:",Xe)}finally{te(Xe=>({...Xe,[me]:!1}))}}else Re.delete(me),e(Re)},Gs=async me=>{const Re=new Set(t);if(!Re.has(me)){if(Re.add(me),n(Re),!ve[me])try{fe(_t=>({..._t,[me]:!0}));const it=(await It.getLessonsByCourse(me))?.Result?.lessons||[];Ae(_t=>({..._t,[me]:it}))}catch(Xe){console.error("Erro ao buscar aulas:",Xe)}finally{fe(Xe=>({...Xe,[me]:!1}))}}else Re.delete(me),n(Re)},bs=R.useMemo(()=>{const me=l.trim().toLowerCase();return me?P.map(Re=>{const ke=(V[Re.id]||[]).map(_t=>({..._t,lessons:ve[_t.id]||[]})),Xe=Re.name.toLowerCase().includes(me),it=ke.map(_t=>{const Ur=_t.title.toLowerCase().includes(me),Fr=_t.lessons.filter(Ja=>Ja.title.toLowerCase().includes(me));return Ur?_t:Fr.length>0?{..._t,lessons:Fr}:null}).filter(Boolean);return Xe?{...Re,courses:ke}:it.length>0?{...Re,courses:it}:null}).filter(Boolean):P.map(Re=>({...Re,courses:(V[Re.id]||[]).map(ke=>({...ke,lessons:ve[ke.id]||[]}))}))},[l,P,V,ve]),ds=R.useMemo(()=>{if(r.type==="category")return{category:P.find(Re=>Re.id===r.categoryId)||null,course:null,lesson:null};if(r.type==="course"){const me=P.find(Xe=>Xe.id===r.categoryId)||null,ke=(V[r.categoryId]||[]).map(Xe=>({...Xe,lessons:ve[Xe.id]||[]})).find(Xe=>Xe.id===r.courseId)||null;return{category:me,course:ke,lesson:null}}if(r.type==="lesson"){const me=P.find(it=>it.id===r.categoryId)||null,ke=(V[r.categoryId]||[]).map(it=>({...it,lessons:ve[it.id]||[]})).find(it=>it.id===r.courseId)||null,Xe=ke?.lessons?.find(it=>it.id===r.lessonId)||null;return{category:me,course:ke,lesson:Xe}}return{category:null,course:null,lesson:null}},[r,P,V,ve]),Za=async()=>{if(m.trim()&&p.trim())try{const me=await It.createCategory(m.trim(),p.trim()),ke=(await It.getCategories())?.Result?.categories||[];K(ke),g(""),E(""),d(!1)}catch(me){console.error("Erro ao criar categoria:",me)}},hn=async()=>{if(T.trim()&&_.trim()&&r.categoryId)try{await It.createCourse(r.categoryId,T.trim(),_.trim());const Re=(await It.getCoursesByCategory(r.categoryId))?.Result?.courses||[];se(ke=>({...ke,[r.categoryId]:Re})),A(""),w(""),b(!1),e(new Set([...i,r.categoryId]))}catch(me){console.error("Erro ao criar curso:",me)}},zt=async()=>{if(B.trim()&&U.trim()&&F.trim()&&r.categoryId&&r.courseId)try{await It.createLesson(r.courseId,B.trim(),U.trim(),F.trim());const Re=(await It.getLessonsByCourse(r.courseId))?.Result?.lessons||[];Ae(ke=>({...ke,[r.courseId]:Re})),N(""),k(""),H(""),O(!1),e(new Set([...i,r.categoryId])),n(new Set([...t,r.courseId]))}catch(me){console.error("Erro ao criar aula:",me)}},Nn=me=>{J(me),de(!0)},mn=async me=>{try{await It.updateLesson(me.id,me.title,me.duration,me.description,me.isPaid);const ke=(await It.getLessonsByCourse(r.courseId))?.Result?.lessons||[];Ae(Xe=>({...Xe,[r.courseId]:ke})),J(null)}catch(Re){console.error("Erro ao atualizar aula:",Re)}},xl=me=>{Ze(me),Ie(me.name||""),Ye(me.description||""),Tt(!0)},ad=async()=>{if(Qe&&Se.trim()&&Le.trim())try{await It.updateCategory(Qe.id,Se.trim(),Le.trim());const Re=(await It.getCategories())?.Result?.categories||[];K(Re),Tt(!1),Ze(null),Ie(""),Ye("")}catch(me){console.error("Erro ao atualizar categoria:",me)}},El=(me,Re)=>{P.find(ke=>ke.id===me),$e({...Re,categoryId:me}),cn(Re.title||""),Jt(Re.description||""),Gt(!0)},kr=async()=>{if(qe&&xt.trim()&&Je.trim())try{await It.updateCourse(qe.id,xt.trim(),Je.trim());const Re=(await It.getCoursesByCategory(qe.categoryId))?.Result?.courses||[];se(ke=>({...ke,[qe.categoryId]:Re})),Gt(!1),$e(null),cn(""),Jt("")}catch(me){console.error("Erro ao atualizar curso:",me)}},nr=me=>{const Re=P.find(ke=>ke.id===me);Ot({title:"Excluir Categoria",description:`Tem certeza que deseja excluir a categoria "${Re?.name}" e todo o seu contedo? Esta ao no pode ser desfeita.`,confirmText:"Excluir Categoria",onConfirm:async()=>{try{await It.deleteCategory(me);const Xe=(await It.getCategories())?.Result?.categories||[];K(Xe),r.type==="category"&&r.categoryId===me&&o({type:"category",categoryId:null,courseId:null,lessonId:null})}catch(ke){console.error("Erro ao excluir categoria:",ke)}}})},sr=(me,Re)=>{P.find(Xe=>Xe.id===me);const ke=V[me]?.find(Xe=>Xe.id===Re);Ot({title:"Excluir Curso",description:`Tem certeza que deseja excluir o curso "${ke?.title}" e todas as suas aulas? Esta ao no pode ser desfeita.`,confirmText:"Excluir Curso",onConfirm:async()=>{try{await It.deleteCourse(Re);const it=(await It.getCoursesByCategory(me))?.Result?.courses||[];se(_t=>({..._t,[me]:it})),r.type==="course"&&r.courseId===Re&&o({type:"category",categoryId:null,courseId:null,lessonId:null})}catch(Xe){console.error("Erro ao excluir curso:",Xe)}}})},Ts=(me,Re,ke)=>{P.find(it=>it.id===me),V[me]?.find(it=>it.id===Re);const Xe=ve[Re]?.find(it=>it.id===ke);Ot({title:"Excluir Aula",description:`Tem certeza que deseja excluir a aula "${Xe?.title}"? Esta ao no pode ser desfeita.`,confirmText:"Excluir Aula",onConfirm:async()=>{try{await It.deleteLesson(ke);const _t=(await It.getLessonsByCourse(Re))?.Result?.lessons||[];Ae(Ur=>({...Ur,[Re]:_t})),r.type==="lesson"&&r.lessonId===ke&&o({type:"course",categoryId:me,courseId:Re,lessonId:null})}catch(it){console.error("Erro ao excluir aula:",it)}}})},Pr={isOpen:f,onOpenChange:d,categoryName:m,onCategoryNameChange:g,categoryDescription:p,onCategoryDescriptionChange:E,onCreateCategory:Za},ir={isOpen:S,onOpenChange:b,courseTitle:T,onCourseTitleChange:A,courseDescription:_,onCourseDescriptionChange:w,onCreateCourse:hn,selectedCategoryId:r.categoryId,categories:P},Sl={isOpen:D,onOpenChange:O,lessonTitle:B,onLessonTitleChange:N,lessonDuration:U,onLessonDurationChange:k,lessonDescription:F,onLessonDescriptionChange:H,onCreateLesson:zt,selectedCategoryId:r.categoryId,selectedCourseId:r.courseId,categories:P};return y.jsxs("div",{className:"w-full space-y-4",children:[y.jsx(lN,{query:l,onQueryChange:u,categoryDialogProps:Pr,courseDialogProps:ir,lessonDialogProps:Sl}),y.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-5 gap-4",children:[y.jsxs(is,{className:"xl:col-span-2 bg-neutral-950 border-neutral-800 text-white shadow-2xl",children:[y.jsxs(wr,{className:"pb-4",children:[y.jsx(Dr,{className:"text-lg font-semibold",children:"Estrutura"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Categoria  Curso  Aula"})]}),y.jsxs(vs,{className:"space-y-3",children:[j&&y.jsx("div",{className:"text-sm text-neutral-400",children:"Carregando categorias..."}),he&&y.jsxs("div",{className:"text-sm text-red-400",children:["Erro: ",he]}),!j&&!he&&bs.length===0&&y.jsx("div",{className:"text-sm text-neutral-400",children:"Nenhuma categoria encontrada."}),!j&&!he&&bs.map(me=>y.jsx(iN,{category:me,isExpanded:i.has(me.id),onToggle:us,onSelect:o,isSelected:r.type==="category"&&r.categoryId===me.id,expandedCourses:t,onCourseToggle:Gs,onCourseSelect:o,onLessonSelect:o,selected:r,onEditLesson:Nn,onDeleteCategory:nr,onDeleteCourse:sr,onDeleteLesson:Ts,onEditCategory:xl,onEditCourse:El,loadingCourses:G,loadingLessons:ce},me.id))]})]}),y.jsxs(is,{className:"xl:col-span-3 bg-neutral-950 border-neutral-800 text-white shadow-2xl",children:[y.jsxs(wr,{className:"pb-4",children:[y.jsx(Dr,{className:"text-lg font-semibold",children:"Detalhes"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Selecione um item na estrutura para editar"})]}),y.jsx(vs,{children:y.jsx(oN,{selectedData:ds,selected:r,onEditLesson:Nn,onDeleteCategory:nr,onDeleteCourse:sr,onDeleteLesson:Ts,onEditCategory:xl,onEditCourse:El,lessonDialogProps:Sl})})]})]}),y.jsx(tN,{isOpen:le,onOpenChange:me=>{de(me),me||J(null)},lesson:ne,onSaveLesson:mn,categories:P}),y.jsx(dN,{isOpen:Lt,onOpenChange:Tt,categoryName:Se,onCategoryNameChange:Ie,categoryDescription:Le,onCategoryDescriptionChange:Ye,onUpdateCategory:ad}),y.jsx(fN,{isOpen:nt,onOpenChange:Gt,courseTitle:xt,onCourseTitleChange:cn,courseDescription:Je,onCourseDescriptionChange:Jt,onUpdateCourse:kr,categoryName:qe?P.find(me=>me.id===qe.categoryId)?.name:""}),y.jsx(fn,{})]})}function mN({open:i,onOpenChange:e}){return y.jsx(Cn,{open:i,onOpenChange:e,children:y.jsx(Ln,{className:"bg-neutral-950 border-neutral-800 text-white !w-[85vw] !h-[85vh] !max-w-none !max-h-none !m-0 !rounded-lg !overflow-hidden !p-0 !top-[50%] !left-[50%] !translate-x-[-50%] !translate-y-[-50%]",children:y.jsxs("div",{className:"flex flex-col h-full",children:[y.jsxs(_n,{className:"px-4 sm:px-6 py-4 border-b border-neutral-800 shrink-0",children:[y.jsx(wn,{className:"text-xl sm:text-2xl font-bold text-white",children:"Dashboard Administrativo"}),y.jsx(Dn,{className:"text-neutral-400",children:"Gerencie categorias, cursos e aulas da plataforma"})]}),y.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4",children:y.jsx(hN,{})})]})})})}const Mh=768;function jb(){const[i,e]=R.useState(void 0);return R.useEffect(()=>{const t=window.matchMedia(`(max-width: ${Mh-1}px)`),n=()=>{e(window.innerWidth<Mh)};return t.addEventListener("change",n),e(window.innerWidth<Mh),()=>t.removeEventListener("change",n)},[]),!!i}const $b="/assets/logo-C1HrDeE4.png";function gN({isOpen:i,setIsOpen:e}){const t=jb(),[n,r]=R.useState("home"),[o,l]=R.useState(!1),[u,f]=R.useState(""),[d,m]=R.useState(!1),[g,p]=R.useState(!1);R.useEffect(()=>{const b=()=>{const _=uI();if(l(_),_){const w=dI(),D=fI();f(w||""),m(D)}else f(""),m(!1)};b();const T=setInterval(b,3e4),A=()=>{b()};return window.addEventListener("login-success",A),()=>{clearInterval(T),window.removeEventListener("login-success",A)}},[]);const E=()=>{Oa(),l(!1),f(""),m(!1),r("home")},S=!t||i;return y.jsxs(y.Fragment,{children:[t&&i&&y.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>e(!1)}),y.jsx("aside",{className:`
          fixed lg:relative z-50
          flex h-dvh w-80 flex-col bg-neutral-950 text-white
          transition-transform duration-300 ease-in-out
          ${S?"translate-x-0":"-translate-x-full"}
        `,children:y.jsxs("div",{className:"relative m-4 flex h-[calc(100%-2rem)] flex-col overflow-hidden rounded-3xl border border-neutral-800 bg-neutral-950 shadow-2xl shadow-black/70",children:[!t&&y.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-px bg-linear-to-b from-green-500/70 to-emerald-400/40"}),y.jsxs("div",{className:"flex items-center justify-between px-5 pt-5",children:[y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("img",{src:$b,alt:"Ring0X Logo",className:"h-11 w-11 rounded-xl object-cover"}),y.jsx("span",{className:"text-xl font-semibold tracking-wide text-green-400",children:"RING0X"})]}),t&&y.jsx(Ce,{variant:"ghost",size:"icon",onClick:()=>e(!1),className:"text-neutral-400 hover:bg-neutral-800 hover:text-white",children:y.jsx(Vu,{className:"h-5 w-5"})})]}),y.jsx("div",{className:"px-5 pt-4",children:y.jsx(Yo,{className:"bg-white/10"})}),y.jsx(h_,{className:"flex-1 min-h-0 px-3 py-3 flex flex-col",children:y.jsxs("div",{className:"flex flex-col",children:[y.jsxs(Ce,{variant:"ghost",className:`group relative h-14 w-full justify-start gap-3 rounded-2xl px-4 text-base text-white hover:bg-neutral-800 ${n==="home"?"bg-neutral-800":""}`,onClick:()=>{r("home");const b=document.querySelector("main");b&&b.scrollTo({top:0,behavior:"smooth"}),t&&e(!1)},children:[y.jsx("span",{className:`absolute left-0 top-1/2 h-10 w-1 -translate-y-1/2 rounded-r-full ${n==="home"?"bg-green-500":"bg-transparent"}`}),y.jsx("span",{className:`flex h-10 w-10 items-center justify-center rounded-xl ${n==="home"?"bg-green-500/20 text-green-400":"bg-neutral-800 text-neutral-400 group-hover:text-white"}`,children:y.jsx(j_,{className:"h-5 w-5"})}),y.jsx("span",{className:"font-medium",children:"Home"})]}),y.jsx("div",{className:"px-4",children:y.jsx(Yo,{className:"bg-white/10"})}),o&&y.jsx(HI,{children:y.jsxs(Ce,{variant:"ghost",className:`group relative h-14 w-full justify-start gap-3 rounded-2xl px-4 text-base text-white hover:bg-neutral-800 ${n==="meus-cursos"?"bg-neutral-800":""}`,onClick:()=>r("meus-cursos"),children:[y.jsx("span",{className:`absolute left-0 top-1/2 h-10 w-1 -translate-y-1/2 rounded-r-full ${n==="meus-cursos"?"bg-green-500":"bg-transparent"}`}),y.jsx("span",{className:`flex h-10 w-10 items-center justify-center rounded-xl ${n==="meus-cursos"?"bg-green-500/20 text-green-400":"bg-neutral-800 text-neutral-400 group-hover:text-white"}`,children:y.jsx(kS,{className:"h-5 w-5"})}),y.jsx("span",{className:"font-medium",children:"Meus Cursos"})]})}),o&&y.jsx("div",{className:"px-4",children:y.jsx(Yo,{className:"bg-white/10"})}),d&&y.jsxs(y.Fragment,{children:[y.jsxs(Ce,{variant:"ghost",className:`group relative h-14 w-full justify-start gap-3 rounded-2xl px-4 text-base text-white hover:bg-neutral-800 ${n==="dashboard"?"bg-neutral-800":""}`,onClick:()=>{r("dashboard"),p(!0)},children:[y.jsx("span",{className:`absolute left-0 top-1/2 h-10 w-1 -translate-y-1/2 rounded-r-full ${n==="dashboard"?"bg-green-500":"bg-transparent"}`}),y.jsx("span",{className:`flex h-10 w-10 items-center justify-center rounded-xl ${n==="dashboard"?"bg-green-500/20 text-green-400":"bg-neutral-800 text-neutral-400 group-hover:text-white"}`,children:y.jsx(G_,{className:"h-5 w-5"})}),y.jsx("span",{className:"font-medium",children:"Dashboard"})]}),y.jsx(mN,{open:g,onOpenChange:p})]}),d&&y.jsx("div",{className:"px-4",children:y.jsx(Yo,{className:"bg-white/10"})}),y.jsxs(Ce,{variant:"ghost",className:`group relative h-14 w-full justify-start gap-3 rounded-2xl px-4 text-base font-medium text-white hover:bg-neutral-800 ${n==="cursos"?"bg-neutral-800":""}`,onClick:()=>{r("cursos"),setTimeout(()=>{let b=document.querySelector("[data-cursos-card]");b||(b=Array.from(document.querySelectorAll("h1, h2, h3")).find(T=>T.textContent.includes("Cursos"))?.closest('.card, [class*="Card"]')),b||(b=Array.from(document.querySelectorAll("*")).find(T=>T.textContent.includes("Cursos")&&T.classList.contains("bg-neutral-950"))),b&&b.scrollIntoView({behavior:"smooth",block:"start"}),t&&e(!1)},t?300:0)},children:[y.jsx("span",{className:`absolute left-0 top-1/2 h-10 w-1 -translate-y-1/2 rounded-r-full ${n==="cursos"?"bg-green-500":"bg-transparent"}`}),y.jsx("span",{className:`flex h-10 w-10 items-center justify-center rounded-xl ${n==="cursos"?"bg-green-500/20 text-green-400":"bg-neutral-800 text-neutral-400 group-hover:text-white"}`,children:y.jsx(fl,{className:"h-5 w-5"})}),y.jsx("span",{className:"font-medium",children:"Cursos"})]})]})}),y.jsx("div",{className:"px-5 pb-4",children:y.jsx(Yo,{className:"bg-white/10"})}),y.jsx("div",{className:"flex flex-col gap-3 px-5 pb-5 shrink-0",children:o?y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex items-center gap-3 p-3 bg-neutral-800/50 rounded-xl",children:[y.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-green-600/20",children:y.jsx(Aw,{className:"h-4 w-4 text-green-400"})}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("div",{className:"text-sm font-medium text-white truncate",children:u}),y.jsx("div",{className:"text-xs text-neutral-400",children:"Logado"})]})]}),y.jsxs(Ce,{onClick:E,className:"w-full bg-red-600/20 border border-red-600/30 text-red-400 hover:bg-red-600/30 hover:text-red-300",children:[y.jsx(Q_,{className:"h-4 w-4 mr-2"}),"Sair"]})]}):y.jsxs(y.Fragment,{children:[y.jsx(mI,{}),y.jsx(gI,{}),y.jsx("div",{className:"hidden",children:y.jsx(II,{})})]})})]})})]})}function pN(){return y.jsx(is,{className:"bg-neutral-950 border-neutral-800 text-white shadow-2xl",children:y.jsxs(wr,{className:"text-center space-y-6",children:[y.jsx("div",{className:"flex justify-center mb-4 sm:mb-6",children:y.jsx("div",{className:"p-3 sm:p-4 bg-neutral-900 rounded-full",children:y.jsx("img",{src:$b,alt:"Ring0X Logo",className:"h-12 w-12 sm:h-16 sm:w-16"})})}),y.jsxs(Dr,{className:"text-3xl sm:text-4xl lg:text-5xl font-bold text-white leading-tight",children:["Domine a Arte da",y.jsx("span",{className:"text-green-400 block",children:"Engenharia Reversa"})]}),y.jsx(Tb,{className:"text-lg sm:text-xl text-neutral-300 max-w-3xl mx-auto leading-relaxed px-4",children:"Torne-se um especialista em Game Hacking e aprenda a decodificar, modificar e entender os sistemas mais complexos. Do bsico ao avanado, prepare-se para o mundo real da engenharia reversa."})]})})}function vN(){const i=[{icon:k_,title:"Anlise de Binrios",description:"Desvende o funcionamento interno de executveis e jogos"},{icon:PS,title:"Anti-Cheat Bypass",description:"Aprenda a contornar sistemas de proteo modernos"},{icon:US,title:"Memory Hacking",description:"Manipule memria em tempo real e modifique comportamentos"},{icon:gw,title:"Cursos Atualizados",description:"Novos mdulos e atualizaes frequentes para acompanhar o cenrio"}];return y.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:i.map((e,t)=>y.jsxs("div",{className:"text-center space-y-3 p-4 sm:p-6 bg-neutral-900/50 rounded-lg border border-neutral-800",children:[y.jsx("div",{className:"flex justify-center",children:y.jsx(e.icon,{className:"h-8 w-8 sm:h-10 sm:w-10 text-green-400"})}),y.jsx("h3",{className:"font-bold text-base sm:text-lg text-white",children:e.title}),y.jsx("p",{className:"text-neutral-400 text-xs sm:text-sm",children:e.description})]},t))})}function yN(){return y.jsx("div",{className:"bg-linear-to-r from-green-600/20 to-emerald-600/20 rounded-lg p-4 sm:p-6 lg:p-8 border border-green-800/50",children:y.jsxs("div",{className:"text-center space-y-4",children:[y.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 sm:gap-6 text-neutral-300",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(FS,{className:"h-4 w-4 sm:h-5 sm:w-5 text-yellow-400"}),y.jsx("span",{className:"font-semibold text-sm sm:text-base",children:"+5.000 Hackers Formados"})]}),y.jsx("div",{className:"hidden sm:block w-px h-6 bg-neutral-600"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(US,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-400"}),y.jsx("span",{className:"font-semibold text-sm sm:text-base",children:"Projetos Prticos"})]}),y.jsx("div",{className:"hidden sm:block w-px h-6 bg-neutral-600"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(PS,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-400"}),y.jsx("span",{className:"font-semibold text-sm sm:text-base",children:"Comunidade Ativa"})]})]}),y.jsx("p",{className:"text-neutral-400 italic text-sm sm:text-base px-4",children:'"A melhor plataforma para quem quer entrar no mundo da engenharia reversa aplicada a games"'})]})})}function xN(){const[i,e]=R.useState({hours:23,minutes:59,seconds:59});R.useEffect(()=>{const n=setInterval(()=>{e(r=>{const{hours:o,minutes:l,seconds:u}=r;return u>0?{...r,seconds:u-1}:l>0?{hours:o,minutes:l-1,seconds:59}:o>0?{hours:o-1,minutes:59,seconds:59}:{hours:23,minutes:59,seconds:59}})},1e3);return()=>clearInterval(n)},[]);const t=n=>n.toString().padStart(2,"0");return y.jsxs(is,{className:"bg-gradient-to-br from-green-900/20 to-emerald-900/20 border-green-600/30 text-white shadow-2xl relative overflow-hidden",children:[y.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-green-500/10 rounded-full blur-3xl"}),y.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-emerald-500/10 rounded-full blur-2xl"}),y.jsxs(wr,{className:"relative z-10 text-center space-y-4",children:[y.jsx("div",{className:"flex justify-center",children:y.jsx("div",{className:"p-3 bg-green-600/20 rounded-full border border-green-600/50",children:y.jsx(FS,{className:"h-8 w-8 text-green-400"})})}),y.jsx(Dr,{className:"text-2xl sm:text-3xl font-bold text-white",children:"Oferta Limitada: Acesso Vitalcio"}),y.jsxs("div",{className:"bg-red-600/20 border border-red-600/30 rounded-lg p-3 space-y-2",children:[y.jsxs("div",{className:"flex items-center justify-center gap-2 text-red-400 font-semibold",children:[y.jsx(Eu,{className:"h-4 w-4 text-white"}),y.jsx("span",{className:"text-sm text-white",children:"OFERTA EXPIRA EM:"})]}),y.jsxs("div",{className:"flex justify-center gap-2 sm:gap-4",children:[y.jsxs("div",{className:"bg-neutral-900/50 border border-red-600/20 rounded px-3 py-2 text-center",children:[y.jsx("div",{className:"text-xl sm:text-2xl font-bold text-white",children:t(i.hours)}),y.jsx("div",{className:"text-xs text-neutral-400",children:"HORAS"})]}),y.jsxs("div",{className:"bg-neutral-900/50 border border-red-600/20 rounded px-3 py-2 text-center",children:[y.jsx("div",{className:"text-xl sm:text-2xl font-bold text-white",children:t(i.minutes)}),y.jsx("div",{className:"text-xs text-neutral-400",children:"MIN"})]}),y.jsxs("div",{className:"bg-neutral-900/50 border border-red-600/20 rounded px-3 py-2 text-center",children:[y.jsx("div",{className:"text-xl sm:text-2xl font-bold text-white",children:t(i.seconds)}),y.jsx("div",{className:"text-xs text-neutral-400",children:"SEG"})]})]})]}),y.jsx("p",{className:"text-neutral-300 text-lg",children:"Transforme sua carreira com acesso ilimitado a todos os cursos"})]}),y.jsxs(vs,{className:"relative z-10 space-y-6",children:[y.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"flex justify-center",children:y.jsx(Eu,{className:"h-6 w-6 text-green-400"})}),y.jsx("h4",{className:"font-semibold text-white",children:"Acesso Vitalcio"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Sem mensalidades ou renovaes"})]}),y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"flex justify-center",children:y.jsx(Cw,{className:"h-6 w-6 text-green-400"})}),y.jsx("h4",{className:"font-semibold text-white",children:"Comunidade Exclusiva"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Acesso vitalcio ao Discord"})]}),y.jsxs("div",{className:"text-center space-y-2",children:[y.jsx("div",{className:"flex justify-center",children:y.jsx(Iw,{className:"h-6 w-6 text-green-400"})}),y.jsx("h4",{className:"font-semibold text-white",children:"Atualizaes Gratuitas"}),y.jsx("p",{className:"text-sm text-neutral-400",children:"Novos cursos sem custo adicional"})]})]}),y.jsxs("div",{className:"flex items-center justify-center gap-6 text-sm text-neutral-400",children:[y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),y.jsx("span",{children:"Garantia de 7 dias"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),y.jsx("span",{children:"+2.000 alunos"})]}),y.jsxs("div",{className:"flex items-center gap-1",children:[y.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),y.jsx("span",{children:"Certificado"})]})]})]})]})}function Tx(i){const e=EN(i),t=R.forwardRef((n,r)=>{const{children:o,...l}=n,u=R.Children.toArray(o),f=u.find(bN);if(f){const d=f.props.children,m=u.map(g=>g===f?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:g);return y.jsx(e,{...l,ref:r,children:R.isValidElement(d)?R.cloneElement(d,void 0,m):null})}return y.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${i}.Slot`,t}function EN(i){const e=R.forwardRef((t,n)=>{const{children:r,...o}=t;if(R.isValidElement(r)){const l=AN(r),u=TN(o,r.props);return r.type!==R.Fragment&&(u.ref=n?Or(n,l):l),R.cloneElement(r,u)}return R.Children.count(r)>1?R.Children.only(null):null});return e.displayName=`${i}.SlotClone`,e}var SN=Symbol("radix.slottable");function bN(i){return R.isValidElement(i)&&typeof i.type=="function"&&"__radixId"in i.type&&i.type.__radixId===SN}function TN(i,e){const t={...e};for(const n in e){const r=i[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...i,...t}}function AN(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}function ag(i){const e=i+"CollectionProvider",[t,n]=Ji(e),[r,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),l=b=>{const{scope:T,children:A}=b,_=Gi.useRef(null),w=Gi.useRef(new Map).current;return y.jsx(r,{scope:T,itemMap:w,collectionRef:_,children:A})};l.displayName=e;const u=i+"CollectionSlot",f=Tx(u),d=Gi.forwardRef((b,T)=>{const{scope:A,children:_}=b,w=o(u,A),D=yt(T,w.collectionRef);return y.jsx(f,{ref:D,children:_})});d.displayName=u;const m=i+"CollectionItemSlot",g="data-radix-collection-item",p=Tx(m),E=Gi.forwardRef((b,T)=>{const{scope:A,children:_,...w}=b,D=Gi.useRef(null),O=yt(T,D),B=o(m,A);return Gi.useEffect(()=>(B.itemMap.set(D,{ref:D,...w}),()=>{B.itemMap.delete(D)})),y.jsx(p,{[g]:"",ref:O,children:_})});E.displayName=m;function S(b){const T=o(i+"CollectionConsumer",b);return Gi.useCallback(()=>{const _=T.collectionRef.current;if(!_)return[];const w=Array.from(_.querySelectorAll(`[${g}]`));return Array.from(T.itemMap.values()).sort((B,N)=>w.indexOf(B.ref.current)-w.indexOf(N.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:l,Slot:d,ItemSlot:E},S,n]}const RN=["top","right","bottom","left"],Xi=Math.min,zn=Math.max,Au=Math.round,$c=Math.floor,Ps=i=>({x:i,y:i}),CN={left:"right",right:"left",bottom:"top",top:"bottom"},LN={start:"end",end:"start"};function fm(i,e,t){return zn(i,Xi(e,t))}function hi(i,e){return typeof i=="function"?i(e):i}function mi(i){return i.split("-")[0]}function Xa(i){return i.split("-")[1]}function og(i){return i==="x"?"y":"x"}function lg(i){return i==="y"?"height":"width"}const _N=new Set(["top","bottom"]);function Os(i){return _N.has(mi(i))?"y":"x"}function cg(i){return og(Os(i))}function wN(i,e,t){t===void 0&&(t=!1);const n=Xa(i),r=cg(i),o=lg(r);let l=r==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(l=Ru(l)),[l,Ru(l)]}function DN(i){const e=Ru(i);return[hm(i),e,hm(e)]}function hm(i){return i.replace(/start|end/g,e=>LN[e])}const Ax=["left","right"],Rx=["right","left"],IN=["top","bottom"],NN=["bottom","top"];function ON(i,e,t){switch(i){case"top":case"bottom":return t?e?Rx:Ax:e?Ax:Rx;case"left":case"right":return e?IN:NN;default:return[]}}function MN(i,e,t,n){const r=Xa(i);let o=ON(mi(i),t==="start",n);return r&&(o=o.map(l=>l+"-"+r),e&&(o=o.concat(o.map(hm)))),o}function Ru(i){return i.replace(/left|right|bottom|top/g,e=>CN[e])}function kN(i){return{top:0,right:0,bottom:0,left:0,...i}}function Gb(i){return typeof i!="number"?kN(i):{top:i,right:i,bottom:i,left:i}}function Cu(i){const{x:e,y:t,width:n,height:r}=i;return{width:n,height:r,top:t,left:e,right:e+n,bottom:t+r,x:e,y:t}}function Cx(i,e,t){let{reference:n,floating:r}=i;const o=Os(e),l=cg(e),u=lg(l),f=mi(e),d=o==="y",m=n.x+n.width/2-r.width/2,g=n.y+n.height/2-r.height/2,p=n[u]/2-r[u]/2;let E;switch(f){case"top":E={x:m,y:n.y-r.height};break;case"bottom":E={x:m,y:n.y+n.height};break;case"right":E={x:n.x+n.width,y:g};break;case"left":E={x:n.x-r.width,y:g};break;default:E={x:n.x,y:n.y}}switch(Xa(e)){case"start":E[l]-=p*(t&&d?-1:1);break;case"end":E[l]+=p*(t&&d?-1:1);break}return E}const PN=async(i,e,t)=>{const{placement:n="bottom",strategy:r="absolute",middleware:o=[],platform:l}=t,u=o.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(e));let d=await l.getElementRects({reference:i,floating:e,strategy:r}),{x:m,y:g}=Cx(d,n,f),p=n,E={},S=0;for(let b=0;b<u.length;b++){const{name:T,fn:A}=u[b],{x:_,y:w,data:D,reset:O}=await A({x:m,y:g,initialPlacement:n,placement:p,strategy:r,middlewareData:E,rects:d,platform:l,elements:{reference:i,floating:e}});m=_??m,g=w??g,E={...E,[T]:{...E[T],...D}},O&&S<=50&&(S++,typeof O=="object"&&(O.placement&&(p=O.placement),O.rects&&(d=O.rects===!0?await l.getElementRects({reference:i,floating:e,strategy:r}):O.rects),{x:m,y:g}=Cx(d,p,f)),b=-1)}return{x:m,y:g,placement:p,strategy:r,middlewareData:E}};async function tl(i,e){var t;e===void 0&&(e={});const{x:n,y:r,platform:o,rects:l,elements:u,strategy:f}=i,{boundary:d="clippingAncestors",rootBoundary:m="viewport",elementContext:g="floating",altBoundary:p=!1,padding:E=0}=hi(e,i),S=Gb(E),T=u[p?g==="floating"?"reference":"floating":g],A=Cu(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(T)))==null||t?T:T.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(u.floating)),boundary:d,rootBoundary:m,strategy:f})),_=g==="floating"?{x:n,y:r,width:l.floating.width,height:l.floating.height}:l.reference,w=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u.floating)),D=await(o.isElement==null?void 0:o.isElement(w))?await(o.getScale==null?void 0:o.getScale(w))||{x:1,y:1}:{x:1,y:1},O=Cu(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:_,offsetParent:w,strategy:f}):_);return{top:(A.top-O.top+S.top)/D.y,bottom:(O.bottom-A.bottom+S.bottom)/D.y,left:(A.left-O.left+S.left)/D.x,right:(O.right-A.right+S.right)/D.x}}const UN=i=>({name:"arrow",options:i,async fn(e){const{x:t,y:n,placement:r,rects:o,platform:l,elements:u,middlewareData:f}=e,{element:d,padding:m=0}=hi(i,e)||{};if(d==null)return{};const g=Gb(m),p={x:t,y:n},E=cg(r),S=lg(E),b=await l.getDimensions(d),T=E==="y",A=T?"top":"left",_=T?"bottom":"right",w=T?"clientHeight":"clientWidth",D=o.reference[S]+o.reference[E]-p[E]-o.floating[S],O=p[E]-o.reference[E],B=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d));let N=B?B[w]:0;(!N||!await(l.isElement==null?void 0:l.isElement(B)))&&(N=u.floating[w]||o.floating[S]);const U=D/2-O/2,k=N/2-b[S]/2-1,F=Xi(g[A],k),H=Xi(g[_],k),ne=F,J=N-b[S]-H,le=N/2-b[S]/2+U,de=fm(ne,le,J),P=!f.arrow&&Xa(r)!=null&&le!==de&&o.reference[S]/2-(le<ne?F:H)-b[S]/2<0,K=P?le<ne?le-ne:le-J:0;return{[E]:p[E]+K,data:{[E]:de,centerOffset:le-de-K,...P&&{alignmentOffset:K}},reset:P}}}),FN=function(i){return i===void 0&&(i={}),{name:"flip",options:i,async fn(e){var t,n;const{placement:r,middlewareData:o,rects:l,initialPlacement:u,platform:f,elements:d}=e,{mainAxis:m=!0,crossAxis:g=!0,fallbackPlacements:p,fallbackStrategy:E="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:b=!0,...T}=hi(i,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const A=mi(r),_=Os(u),w=mi(u)===u,D=await(f.isRTL==null?void 0:f.isRTL(d.floating)),O=p||(w||!b?[Ru(u)]:DN(u)),B=S!=="none";!p&&B&&O.push(...MN(u,b,S,D));const N=[u,...O],U=await tl(e,T),k=[];let F=((n=o.flip)==null?void 0:n.overflows)||[];if(m&&k.push(U[A]),g){const le=wN(r,l,D);k.push(U[le[0]],U[le[1]])}if(F=[...F,{placement:r,overflows:k}],!k.every(le=>le<=0)){var H,ne;const le=(((H=o.flip)==null?void 0:H.index)||0)+1,de=N[le];if(de&&(!(g==="alignment"?_!==Os(de):!1)||F.every(j=>Os(j.placement)===_?j.overflows[0]>0:!0)))return{data:{index:le,overflows:F},reset:{placement:de}};let P=(ne=F.filter(K=>K.overflows[0]<=0).sort((K,j)=>K.overflows[1]-j.overflows[1])[0])==null?void 0:ne.placement;if(!P)switch(E){case"bestFit":{var J;const K=(J=F.filter(j=>{if(B){const W=Os(j.placement);return W===_||W==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(W=>W>0).reduce((W,he)=>W+he,0)]).sort((j,W)=>j[1]-W[1])[0])==null?void 0:J[0];K&&(P=K);break}case"initialPlacement":P=u;break}if(r!==P)return{reset:{placement:P}}}return{}}}};function Lx(i,e){return{top:i.top-e.height,right:i.right-e.width,bottom:i.bottom-e.height,left:i.left-e.width}}function _x(i){return RN.some(e=>i[e]>=0)}const BN=function(i){return i===void 0&&(i={}),{name:"hide",options:i,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...r}=hi(i,e);switch(n){case"referenceHidden":{const o=await tl(e,{...r,elementContext:"reference"}),l=Lx(o,t.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:_x(l)}}}case"escaped":{const o=await tl(e,{...r,altBoundary:!0}),l=Lx(o,t.floating);return{data:{escapedOffsets:l,escaped:_x(l)}}}default:return{}}}}},zb=new Set(["left","top"]);async function jN(i,e){const{placement:t,platform:n,elements:r}=i,o=await(n.isRTL==null?void 0:n.isRTL(r.floating)),l=mi(t),u=Xa(t),f=Os(t)==="y",d=zb.has(l)?-1:1,m=o&&f?-1:1,g=hi(e,i);let{mainAxis:p,crossAxis:E,alignmentAxis:S}=typeof g=="number"?{mainAxis:g,crossAxis:0,alignmentAxis:null}:{mainAxis:g.mainAxis||0,crossAxis:g.crossAxis||0,alignmentAxis:g.alignmentAxis};return u&&typeof S=="number"&&(E=u==="end"?S*-1:S),f?{x:E*m,y:p*d}:{x:p*d,y:E*m}}const $N=function(i){return i===void 0&&(i=0),{name:"offset",options:i,async fn(e){var t,n;const{x:r,y:o,placement:l,middlewareData:u}=e,f=await jN(e,i);return l===((t=u.offset)==null?void 0:t.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:r+f.x,y:o+f.y,data:{...f,placement:l}}}}},GN=function(i){return i===void 0&&(i={}),{name:"shift",options:i,async fn(e){const{x:t,y:n,placement:r}=e,{mainAxis:o=!0,crossAxis:l=!1,limiter:u={fn:T=>{let{x:A,y:_}=T;return{x:A,y:_}}},...f}=hi(i,e),d={x:t,y:n},m=await tl(e,f),g=Os(mi(r)),p=og(g);let E=d[p],S=d[g];if(o){const T=p==="y"?"top":"left",A=p==="y"?"bottom":"right",_=E+m[T],w=E-m[A];E=fm(_,E,w)}if(l){const T=g==="y"?"top":"left",A=g==="y"?"bottom":"right",_=S+m[T],w=S-m[A];S=fm(_,S,w)}const b=u.fn({...e,[p]:E,[g]:S});return{...b,data:{x:b.x-t,y:b.y-n,enabled:{[p]:o,[g]:l}}}}}},zN=function(i){return i===void 0&&(i={}),{options:i,fn(e){const{x:t,y:n,placement:r,rects:o,middlewareData:l}=e,{offset:u=0,mainAxis:f=!0,crossAxis:d=!0}=hi(i,e),m={x:t,y:n},g=Os(r),p=og(g);let E=m[p],S=m[g];const b=hi(u,e),T=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(f){const w=p==="y"?"height":"width",D=o.reference[p]-o.floating[w]+T.mainAxis,O=o.reference[p]+o.reference[w]-T.mainAxis;E<D?E=D:E>O&&(E=O)}if(d){var A,_;const w=p==="y"?"width":"height",D=zb.has(mi(r)),O=o.reference[g]-o.floating[w]+(D&&((A=l.offset)==null?void 0:A[g])||0)+(D?0:T.crossAxis),B=o.reference[g]+o.reference[w]+(D?0:((_=l.offset)==null?void 0:_[g])||0)-(D?T.crossAxis:0);S<O?S=O:S>B&&(S=B)}return{[p]:E,[g]:S}}}},HN=function(i){return i===void 0&&(i={}),{name:"size",options:i,async fn(e){var t,n;const{placement:r,rects:o,platform:l,elements:u}=e,{apply:f=()=>{},...d}=hi(i,e),m=await tl(e,d),g=mi(r),p=Xa(r),E=Os(r)==="y",{width:S,height:b}=o.floating;let T,A;g==="top"||g==="bottom"?(T=g,A=p===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(A=g,T=p==="end"?"top":"bottom");const _=b-m.top-m.bottom,w=S-m.left-m.right,D=Xi(b-m[T],_),O=Xi(S-m[A],w),B=!e.middlewareData.shift;let N=D,U=O;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(U=w),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(N=_),B&&!p){const F=zn(m.left,0),H=zn(m.right,0),ne=zn(m.top,0),J=zn(m.bottom,0);E?U=S-2*(F!==0||H!==0?F+H:zn(m.left,m.right)):N=b-2*(ne!==0||J!==0?ne+J:zn(m.top,m.bottom))}await f({...e,availableWidth:U,availableHeight:N});const k=await l.getDimensions(u.floating);return S!==k.width||b!==k.height?{reset:{rects:!0}}:{}}}};function Wu(){return typeof window<"u"}function Wa(i){return Hb(i)?(i.nodeName||"").toLowerCase():"#document"}function Vn(i){var e;return(i==null||(e=i.ownerDocument)==null?void 0:e.defaultView)||window}function $s(i){var e;return(e=(Hb(i)?i.ownerDocument:i.document)||window.document)==null?void 0:e.documentElement}function Hb(i){return Wu()?i instanceof Node||i instanceof Vn(i).Node:!1}function xs(i){return Wu()?i instanceof Element||i instanceof Vn(i).Element:!1}function Us(i){return Wu()?i instanceof HTMLElement||i instanceof Vn(i).HTMLElement:!1}function wx(i){return!Wu()||typeof ShadowRoot>"u"?!1:i instanceof ShadowRoot||i instanceof Vn(i).ShadowRoot}const VN=new Set(["inline","contents"]);function ml(i){const{overflow:e,overflowX:t,overflowY:n,display:r}=Es(i);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!VN.has(r)}const KN=new Set(["table","td","th"]);function YN(i){return KN.has(Wa(i))}const qN=[":popover-open",":modal"];function Qu(i){return qN.some(e=>{try{return i.matches(e)}catch{return!1}})}const XN=["transform","translate","scale","rotate","perspective"],WN=["transform","translate","scale","rotate","perspective","filter"],QN=["paint","layout","strict","content"];function ug(i){const e=dg(),t=xs(i)?Es(i):i;return XN.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||WN.some(n=>(t.willChange||"").includes(n))||QN.some(n=>(t.contain||"").includes(n))}function ZN(i){let e=Wi(i);for(;Us(e)&&!Ha(e);){if(ug(e))return e;if(Qu(e))return null;e=Wi(e)}return null}function dg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const JN=new Set(["html","body","#document"]);function Ha(i){return JN.has(Wa(i))}function Es(i){return Vn(i).getComputedStyle(i)}function Zu(i){return xs(i)?{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}:{scrollLeft:i.scrollX,scrollTop:i.scrollY}}function Wi(i){if(Wa(i)==="html")return i;const e=i.assignedSlot||i.parentNode||wx(i)&&i.host||$s(i);return wx(e)?e.host:e}function Vb(i){const e=Wi(i);return Ha(e)?i.ownerDocument?i.ownerDocument.body:i.body:Us(e)&&ml(e)?e:Vb(e)}function nl(i,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const r=Vb(i),o=r===((n=i.ownerDocument)==null?void 0:n.body),l=Vn(r);if(o){const u=mm(l);return e.concat(l,l.visualViewport||[],ml(r)?r:[],u&&t?nl(u):[])}return e.concat(r,nl(r,[],t))}function mm(i){return i.parent&&Object.getPrototypeOf(i.parent)?i.frameElement:null}function Kb(i){const e=Es(i);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const r=Us(i),o=r?i.offsetWidth:t,l=r?i.offsetHeight:n,u=Au(t)!==o||Au(n)!==l;return u&&(t=o,n=l),{width:t,height:n,$:u}}function fg(i){return xs(i)?i:i.contextElement}function Fa(i){const e=fg(i);if(!Us(e))return Ps(1);const t=e.getBoundingClientRect(),{width:n,height:r,$:o}=Kb(e);let l=(o?Au(t.width):t.width)/n,u=(o?Au(t.height):t.height)/r;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const eO=Ps(0);function Yb(i){const e=Vn(i);return!dg()||!e.visualViewport?eO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function tO(i,e,t){return e===void 0&&(e=!1),!t||e&&t!==Vn(i)?!1:e}function Ir(i,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const r=i.getBoundingClientRect(),o=fg(i);let l=Ps(1);e&&(n?xs(n)&&(l=Fa(n)):l=Fa(i));const u=tO(o,t,n)?Yb(o):Ps(0);let f=(r.left+u.x)/l.x,d=(r.top+u.y)/l.y,m=r.width/l.x,g=r.height/l.y;if(o){const p=Vn(o),E=n&&xs(n)?Vn(n):n;let S=p,b=mm(S);for(;b&&n&&E!==S;){const T=Fa(b),A=b.getBoundingClientRect(),_=Es(b),w=A.left+(b.clientLeft+parseFloat(_.paddingLeft))*T.x,D=A.top+(b.clientTop+parseFloat(_.paddingTop))*T.y;f*=T.x,d*=T.y,m*=T.x,g*=T.y,f+=w,d+=D,S=Vn(b),b=mm(S)}}return Cu({width:m,height:g,x:f,y:d})}function Ju(i,e){const t=Zu(i).scrollLeft;return e?e.left+t:Ir($s(i)).left+t}function qb(i,e){const t=i.getBoundingClientRect(),n=t.left+e.scrollLeft-Ju(i,t),r=t.top+e.scrollTop;return{x:n,y:r}}function nO(i){let{elements:e,rect:t,offsetParent:n,strategy:r}=i;const o=r==="fixed",l=$s(n),u=e?Qu(e.floating):!1;if(n===l||u&&o)return t;let f={scrollLeft:0,scrollTop:0},d=Ps(1);const m=Ps(0),g=Us(n);if((g||!g&&!o)&&((Wa(n)!=="body"||ml(l))&&(f=Zu(n)),Us(n))){const E=Ir(n);d=Fa(n),m.x=E.x+n.clientLeft,m.y=E.y+n.clientTop}const p=l&&!g&&!o?qb(l,f):Ps(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-f.scrollLeft*d.x+m.x+p.x,y:t.y*d.y-f.scrollTop*d.y+m.y+p.y}}function sO(i){return Array.from(i.getClientRects())}function iO(i){const e=$s(i),t=Zu(i),n=i.ownerDocument.body,r=zn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),o=zn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-t.scrollLeft+Ju(i);const u=-t.scrollTop;return Es(n).direction==="rtl"&&(l+=zn(e.clientWidth,n.clientWidth)-r),{width:r,height:o,x:l,y:u}}const Dx=25;function rO(i,e){const t=Vn(i),n=$s(i),r=t.visualViewport;let o=n.clientWidth,l=n.clientHeight,u=0,f=0;if(r){o=r.width,l=r.height;const m=dg();(!m||m&&e==="fixed")&&(u=r.offsetLeft,f=r.offsetTop)}const d=Ju(n);if(d<=0){const m=n.ownerDocument,g=m.body,p=getComputedStyle(g),E=m.compatMode==="CSS1Compat"&&parseFloat(p.marginLeft)+parseFloat(p.marginRight)||0,S=Math.abs(n.clientWidth-g.clientWidth-E);S<=Dx&&(o-=S)}else d<=Dx&&(o+=d);return{width:o,height:l,x:u,y:f}}const aO=new Set(["absolute","fixed"]);function oO(i,e){const t=Ir(i,!0,e==="fixed"),n=t.top+i.clientTop,r=t.left+i.clientLeft,o=Us(i)?Fa(i):Ps(1),l=i.clientWidth*o.x,u=i.clientHeight*o.y,f=r*o.x,d=n*o.y;return{width:l,height:u,x:f,y:d}}function Ix(i,e,t){let n;if(e==="viewport")n=rO(i,t);else if(e==="document")n=iO($s(i));else if(xs(e))n=oO(e,t);else{const r=Yb(i);n={x:e.x-r.x,y:e.y-r.y,width:e.width,height:e.height}}return Cu(n)}function Xb(i,e){const t=Wi(i);return t===e||!xs(t)||Ha(t)?!1:Es(t).position==="fixed"||Xb(t,e)}function lO(i,e){const t=e.get(i);if(t)return t;let n=nl(i,[],!1).filter(u=>xs(u)&&Wa(u)!=="body"),r=null;const o=Es(i).position==="fixed";let l=o?Wi(i):i;for(;xs(l)&&!Ha(l);){const u=Es(l),f=ug(l);!f&&u.position==="fixed"&&(r=null),(o?!f&&!r:!f&&u.position==="static"&&!!r&&aO.has(r.position)||ml(l)&&!f&&Xb(i,l))?n=n.filter(m=>m!==l):r=u,l=Wi(l)}return e.set(i,n),n}function cO(i){let{element:e,boundary:t,rootBoundary:n,strategy:r}=i;const l=[...t==="clippingAncestors"?Qu(e)?[]:lO(e,this._c):[].concat(t),n],u=l[0],f=l.reduce((d,m)=>{const g=Ix(e,m,r);return d.top=zn(g.top,d.top),d.right=Xi(g.right,d.right),d.bottom=Xi(g.bottom,d.bottom),d.left=zn(g.left,d.left),d},Ix(e,u,r));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function uO(i){const{width:e,height:t}=Kb(i);return{width:e,height:t}}function dO(i,e,t){const n=Us(e),r=$s(e),o=t==="fixed",l=Ir(i,!0,o,e);let u={scrollLeft:0,scrollTop:0};const f=Ps(0);function d(){f.x=Ju(r)}if(n||!n&&!o)if((Wa(e)!=="body"||ml(r))&&(u=Zu(e)),n){const E=Ir(e,!0,o,e);f.x=E.x+e.clientLeft,f.y=E.y+e.clientTop}else r&&d();o&&!n&&r&&d();const m=r&&!n&&!o?qb(r,u):Ps(0),g=l.left+u.scrollLeft-f.x-m.x,p=l.top+u.scrollTop-f.y-m.y;return{x:g,y:p,width:l.width,height:l.height}}function kh(i){return Es(i).position==="static"}function Nx(i,e){if(!Us(i)||Es(i).position==="fixed")return null;if(e)return e(i);let t=i.offsetParent;return $s(i)===t&&(t=t.ownerDocument.body),t}function Wb(i,e){const t=Vn(i);if(Qu(i))return t;if(!Us(i)){let r=Wi(i);for(;r&&!Ha(r);){if(xs(r)&&!kh(r))return r;r=Wi(r)}return t}let n=Nx(i,e);for(;n&&YN(n)&&kh(n);)n=Nx(n,e);return n&&Ha(n)&&kh(n)&&!ug(n)?t:n||ZN(i)||t}const fO=async function(i){const e=this.getOffsetParent||Wb,t=this.getDimensions,n=await t(i.floating);return{reference:dO(i.reference,await e(i.floating),i.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function hO(i){return Es(i).direction==="rtl"}const mO={convertOffsetParentRelativeRectToViewportRelativeRect:nO,getDocumentElement:$s,getClippingRect:cO,getOffsetParent:Wb,getElementRects:fO,getClientRects:sO,getDimensions:uO,getScale:Fa,isElement:xs,isRTL:hO};function Qb(i,e){return i.x===e.x&&i.y===e.y&&i.width===e.width&&i.height===e.height}function gO(i,e){let t=null,n;const r=$s(i);function o(){var u;clearTimeout(n),(u=t)==null||u.disconnect(),t=null}function l(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),o();const d=i.getBoundingClientRect(),{left:m,top:g,width:p,height:E}=d;if(u||e(),!p||!E)return;const S=$c(g),b=$c(r.clientWidth-(m+p)),T=$c(r.clientHeight-(g+E)),A=$c(m),w={rootMargin:-S+"px "+-b+"px "+-T+"px "+-A+"px",threshold:zn(0,Xi(1,f))||1};let D=!0;function O(B){const N=B[0].intersectionRatio;if(N!==f){if(!D)return l();N?l(!1,N):n=setTimeout(()=>{l(!1,1e-7)},1e3)}N===1&&!Qb(d,i.getBoundingClientRect())&&l(),D=!1}try{t=new IntersectionObserver(O,{...w,root:r.ownerDocument})}catch{t=new IntersectionObserver(O,w)}t.observe(i)}return l(!0),o}function pO(i,e,t,n){n===void 0&&(n={});const{ancestorScroll:r=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,d=fg(i),m=r||o?[...d?nl(d):[],...nl(e)]:[];m.forEach(A=>{r&&A.addEventListener("scroll",t,{passive:!0}),o&&A.addEventListener("resize",t)});const g=d&&u?gO(d,t):null;let p=-1,E=null;l&&(E=new ResizeObserver(A=>{let[_]=A;_&&_.target===d&&E&&(E.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var w;(w=E)==null||w.observe(e)})),t()}),d&&!f&&E.observe(d),E.observe(e));let S,b=f?Ir(i):null;f&&T();function T(){const A=Ir(i);b&&!Qb(b,A)&&t(),b=A,S=requestAnimationFrame(T)}return t(),()=>{var A;m.forEach(_=>{r&&_.removeEventListener("scroll",t),o&&_.removeEventListener("resize",t)}),g?.(),(A=E)==null||A.disconnect(),E=null,f&&cancelAnimationFrame(S)}}const vO=$N,yO=GN,xO=FN,EO=HN,SO=BN,Ox=UN,bO=zN,TO=(i,e,t)=>{const n=new Map,r={platform:mO,...t},o={...r.platform,_c:n};return PN(i,e,{...r,platform:o})};var AO=typeof document<"u",RO=function(){},au=AO?R.useLayoutEffect:RO;function Lu(i,e){if(i===e)return!0;if(typeof i!=typeof e)return!1;if(typeof i=="function"&&i.toString()===e.toString())return!0;let t,n,r;if(i&&e&&typeof i=="object"){if(Array.isArray(i)){if(t=i.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Lu(i[n],e[n]))return!1;return!0}if(r=Object.keys(i),t=r.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,r[n]))return!1;for(n=t;n--!==0;){const o=r[n];if(!(o==="_owner"&&i.$$typeof)&&!Lu(i[o],e[o]))return!1}return!0}return i!==i&&e!==e}function Zb(i){return typeof window>"u"?1:(i.ownerDocument.defaultView||window).devicePixelRatio||1}function Mx(i,e){const t=Zb(i);return Math.round(e*t)/t}function Ph(i){const e=R.useRef(i);return au(()=>{e.current=i}),e}function CO(i){i===void 0&&(i={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:r,elements:{reference:o,floating:l}={},transform:u=!0,whileElementsMounted:f,open:d}=i,[m,g]=R.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[p,E]=R.useState(n);Lu(p,n)||E(n);const[S,b]=R.useState(null),[T,A]=R.useState(null),_=R.useCallback(j=>{j!==B.current&&(B.current=j,b(j))},[]),w=R.useCallback(j=>{j!==N.current&&(N.current=j,A(j))},[]),D=o||S,O=l||T,B=R.useRef(null),N=R.useRef(null),U=R.useRef(m),k=f!=null,F=Ph(f),H=Ph(r),ne=Ph(d),J=R.useCallback(()=>{if(!B.current||!N.current)return;const j={placement:e,strategy:t,middleware:p};H.current&&(j.platform=H.current),TO(B.current,N.current,j).then(W=>{const he={...W,isPositioned:ne.current!==!1};le.current&&!Lu(U.current,he)&&(U.current=he,Hm.flushSync(()=>{g(he)}))})},[p,e,t,H,ne]);au(()=>{d===!1&&U.current.isPositioned&&(U.current.isPositioned=!1,g(j=>({...j,isPositioned:!1})))},[d]);const le=R.useRef(!1);au(()=>(le.current=!0,()=>{le.current=!1}),[]),au(()=>{if(D&&(B.current=D),O&&(N.current=O),D&&O){if(F.current)return F.current(D,O,J);J()}},[D,O,J,F,k]);const de=R.useMemo(()=>({reference:B,floating:N,setReference:_,setFloating:w}),[_,w]),P=R.useMemo(()=>({reference:D,floating:O}),[D,O]),K=R.useMemo(()=>{const j={position:t,left:0,top:0};if(!P.floating)return j;const W=Mx(P.floating,m.x),he=Mx(P.floating,m.y);return u?{...j,transform:"translate("+W+"px, "+he+"px)",...Zb(P.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:W,top:he}},[t,u,P.floating,m.x,m.y]);return R.useMemo(()=>({...m,update:J,refs:de,elements:P,floatingStyles:K}),[m,J,de,P,K])}const LO=i=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:i,fn(t){const{element:n,padding:r}=typeof i=="function"?i(t):i;return n&&e(n)?n.current!=null?Ox({element:n.current,padding:r}).fn(t):{}:n?Ox({element:n,padding:r}).fn(t):{}}}},_O=(i,e)=>({...vO(i),options:[i,e]}),wO=(i,e)=>({...yO(i),options:[i,e]}),DO=(i,e)=>({...bO(i),options:[i,e]}),IO=(i,e)=>({...xO(i),options:[i,e]}),NO=(i,e)=>({...EO(i),options:[i,e]}),OO=(i,e)=>({...SO(i),options:[i,e]}),MO=(i,e)=>({...LO(i),options:[i,e]});var kO="Arrow",Jb=R.forwardRef((i,e)=>{const{children:t,width:n=10,height:r=5,...o}=i;return y.jsx(ct.svg,{...o,ref:e,width:n,height:r,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:i.asChild?t:y.jsx("polygon",{points:"0,0 30,0 15,10"})})});Jb.displayName=kO;var PO=Jb,hg="Popper",[eT,tT]=Ji(hg),[UO,nT]=eT(hg),sT=i=>{const{__scopePopper:e,children:t}=i,[n,r]=R.useState(null);return y.jsx(UO,{scope:e,anchor:n,onAnchorChange:r,children:t})};sT.displayName=hg;var iT="PopperAnchor",rT=R.forwardRef((i,e)=>{const{__scopePopper:t,virtualRef:n,...r}=i,o=nT(iT,t),l=R.useRef(null),u=yt(e,l),f=R.useRef(null);return R.useEffect(()=>{const d=f.current;f.current=n?.current||l.current,d!==f.current&&o.onAnchorChange(f.current)}),n?null:y.jsx(ct.div,{...r,ref:u})});rT.displayName=iT;var mg="PopperContent",[FO,BO]=eT(mg),aT=R.forwardRef((i,e)=>{const{__scopePopper:t,side:n="bottom",sideOffset:r=0,align:o="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:d=[],collisionPadding:m=0,sticky:g="partial",hideWhenDetached:p=!1,updatePositionStrategy:E="optimized",onPlaced:S,...b}=i,T=nT(mg,t),[A,_]=R.useState(null),w=yt(e,fe=>_(fe)),[D,O]=R.useState(null),B=Ib(D),N=B?.width??0,U=B?.height??0,k=n+(o!=="center"?"-"+o:""),F=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},H=Array.isArray(d)?d:[d],ne=H.length>0,J={padding:F,boundary:H.filter($O),altBoundary:ne},{refs:le,floatingStyles:de,placement:P,isPositioned:K,middlewareData:j}=CO({strategy:"fixed",placement:k,whileElementsMounted:(...fe)=>pO(...fe,{animationFrame:E==="always"}),elements:{reference:T.anchor},middleware:[_O({mainAxis:r+U,alignmentAxis:l}),f&&wO({mainAxis:!0,crossAxis:!1,limiter:g==="partial"?DO():void 0,...J}),f&&IO({...J}),NO({...J,apply:({elements:fe,rects:ve,availableWidth:Ae,availableHeight:Qe})=>{const{width:Ze,height:Lt}=ve.reference,Tt=fe.floating.style;Tt.setProperty("--radix-popper-available-width",`${Ae}px`),Tt.setProperty("--radix-popper-available-height",`${Qe}px`),Tt.setProperty("--radix-popper-anchor-width",`${Ze}px`),Tt.setProperty("--radix-popper-anchor-height",`${Lt}px`)}}),D&&MO({element:D,padding:u}),GO({arrowWidth:N,arrowHeight:U}),p&&OO({strategy:"referenceHidden",...J})]}),[W,he]=cT(P),M=dn(S);fi(()=>{K&&M?.()},[K,M]);const G=j.arrow?.x,te=j.arrow?.y,V=j.arrow?.centerOffset!==0,[se,ce]=R.useState();return fi(()=>{A&&ce(window.getComputedStyle(A).zIndex)},[A]),y.jsx("div",{ref:le.setFloating,"data-radix-popper-content-wrapper":"",style:{...de,transform:K?de.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:se,"--radix-popper-transform-origin":[j.transformOrigin?.x,j.transformOrigin?.y].join(" "),...j.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:i.dir,children:y.jsx(FO,{scope:t,placedSide:W,onArrowChange:O,arrowX:G,arrowY:te,shouldHideArrow:V,children:y.jsx(ct.div,{"data-side":W,"data-align":he,...b,ref:w,style:{...b.style,animation:K?void 0:"none"}})})})});aT.displayName=mg;var oT="PopperArrow",jO={top:"bottom",right:"left",bottom:"top",left:"right"},lT=R.forwardRef(function(e,t){const{__scopePopper:n,...r}=e,o=BO(oT,n),l=jO[o.placedSide];return y.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:y.jsx(PO,{...r,ref:t,style:{...r.style,display:"block"}})})});lT.displayName=oT;function $O(i){return i!==null}var GO=i=>({name:"transformOrigin",options:i,fn(e){const{placement:t,rects:n,middlewareData:r}=e,l=r.arrow?.centerOffset!==0,u=l?0:i.arrowWidth,f=l?0:i.arrowHeight,[d,m]=cT(t),g={start:"0%",center:"50%",end:"100%"}[m],p=(r.arrow?.x??0)+u/2,E=(r.arrow?.y??0)+f/2;let S="",b="";return d==="bottom"?(S=l?g:`${p}px`,b=`${-f}px`):d==="top"?(S=l?g:`${p}px`,b=`${n.floating.height+f}px`):d==="right"?(S=`${-f}px`,b=l?g:`${E}px`):d==="left"&&(S=`${n.floating.width+f}px`,b=l?g:`${E}px`),{data:{x:S,y:b}}}});function cT(i){const[e,t="center"]=i.split("-");return[e,t]}var zO=sT,HO=rT,VO=aT,KO=lT,Uh="rovingFocusGroup.onEntryFocus",YO={bubbles:!1,cancelable:!0},gl="RovingFocusGroup",[gm,uT,qO]=ag(gl),[XO,ed]=Ji(gl,[qO]),[WO,QO]=XO(gl),dT=R.forwardRef((i,e)=>y.jsx(gm.Provider,{scope:i.__scopeRovingFocusGroup,children:y.jsx(gm.Slot,{scope:i.__scopeRovingFocusGroup,children:y.jsx(ZO,{...i,ref:e})})}));dT.displayName=gl;var ZO=R.forwardRef((i,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:r=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:d,preventScrollOnEntryFocus:m=!1,...g}=i,p=R.useRef(null),E=yt(e,p),S=Gu(o),[b,T]=Ku({prop:l,defaultProp:u??null,onChange:f,caller:gl}),[A,_]=R.useState(!1),w=dn(d),D=uT(t),O=R.useRef(!1),[B,N]=R.useState(0);return R.useEffect(()=>{const U=p.current;if(U)return U.addEventListener(Uh,w),()=>U.removeEventListener(Uh,w)},[w]),y.jsx(WO,{scope:t,orientation:n,dir:S,loop:r,currentTabStopId:b,onItemFocus:R.useCallback(U=>T(U),[T]),onItemShiftTab:R.useCallback(()=>_(!0),[]),onFocusableItemAdd:R.useCallback(()=>N(U=>U+1),[]),onFocusableItemRemove:R.useCallback(()=>N(U=>U-1),[]),children:y.jsx(ct.div,{tabIndex:A||B===0?-1:0,"data-orientation":n,...g,ref:E,style:{outline:"none",...i.style},onMouseDown:we(i.onMouseDown,()=>{O.current=!0}),onFocus:we(i.onFocus,U=>{const k=!O.current;if(U.target===U.currentTarget&&k&&!A){const F=new CustomEvent(Uh,YO);if(U.currentTarget.dispatchEvent(F),!F.defaultPrevented){const H=D().filter(P=>P.focusable),ne=H.find(P=>P.active),J=H.find(P=>P.id===b),de=[ne,J,...H].filter(Boolean).map(P=>P.ref.current);mT(de,m)}}O.current=!1}),onBlur:we(i.onBlur,()=>_(!1))})})}),fT="RovingFocusGroupItem",hT=R.forwardRef((i,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:r=!1,tabStopId:o,children:l,...u}=i,f=Cr(),d=o||f,m=QO(fT,t),g=m.currentTabStopId===d,p=uT(t),{onFocusableItemAdd:E,onFocusableItemRemove:S,currentTabStopId:b}=m;return R.useEffect(()=>{if(n)return E(),()=>S()},[n,E,S]),y.jsx(gm.ItemSlot,{scope:t,id:d,focusable:n,active:r,children:y.jsx(ct.span,{tabIndex:g?0:-1,"data-orientation":m.orientation,...u,ref:e,onMouseDown:we(i.onMouseDown,T=>{n?m.onItemFocus(d):T.preventDefault()}),onFocus:we(i.onFocus,()=>m.onItemFocus(d)),onKeyDown:we(i.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){m.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const A=tM(T,m.orientation,m.dir);if(A!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let w=p().filter(D=>D.focusable).map(D=>D.ref.current);if(A==="last")w.reverse();else if(A==="prev"||A==="next"){A==="prev"&&w.reverse();const D=w.indexOf(T.currentTarget);w=m.loop?nM(w,D+1):w.slice(D+1)}setTimeout(()=>mT(w))}}),children:typeof l=="function"?l({isCurrentTabStop:g,hasTabStop:b!=null}):l})})});hT.displayName=fT;var JO={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function eM(i,e){return e!=="rtl"?i:i==="ArrowLeft"?"ArrowRight":i==="ArrowRight"?"ArrowLeft":i}function tM(i,e,t){const n=eM(i.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return JO[n]}function mT(i,e=!1){const t=document.activeElement;for(const n of i)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function nM(i,e){return i.map((t,n)=>i[(e+n)%i.length])}var gT=dT,pT=hT;function sM(i){const e=iM(i),t=R.forwardRef((n,r)=>{const{children:o,...l}=n,u=R.Children.toArray(o),f=u.find(aM);if(f){const d=f.props.children,m=u.map(g=>g===f?R.Children.count(d)>1?R.Children.only(null):R.isValidElement(d)?d.props.children:null:g);return y.jsx(e,{...l,ref:r,children:R.isValidElement(d)?R.cloneElement(d,void 0,m):null})}return y.jsx(e,{...l,ref:r,children:o})});return t.displayName=`${i}.Slot`,t}function iM(i){const e=R.forwardRef((t,n)=>{const{children:r,...o}=t;if(R.isValidElement(r)){const l=lM(r),u=oM(o,r.props);return r.type!==R.Fragment&&(u.ref=n?Or(n,l):l),R.cloneElement(r,u)}return R.Children.count(r)>1?R.Children.only(null):null});return e.displayName=`${i}.SlotClone`,e}var rM=Symbol("radix.slottable");function aM(i){return R.isValidElement(i)&&typeof i.type=="function"&&"__radixId"in i.type&&i.type.__radixId===rM}function oM(i,e){const t={...e};for(const n in e){const r=i[n],o=e[n];/^on[A-Z]/.test(n)?r&&o?t[n]=(...u)=>{const f=o(...u);return r(...u),f}:r&&(t[n]=r):n==="style"?t[n]={...r,...o}:n==="className"&&(t[n]=[r,o].filter(Boolean).join(" "))}return{...i,...t}}function lM(i){let e=Object.getOwnPropertyDescriptor(i.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?i.ref:(e=Object.getOwnPropertyDescriptor(i,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?i.props.ref:i.props.ref||i.ref)}var pm=["Enter"," "],cM=["ArrowDown","PageUp","Home"],vT=["ArrowUp","PageDown","End"],uM=[...cM,...vT],dM={ltr:[...pm,"ArrowRight"],rtl:[...pm,"ArrowLeft"]},fM={ltr:["ArrowLeft"],rtl:["ArrowRight"]},pl="Menu",[sl,hM,mM]=ag(pl),[Mr,gM]=Ji(pl,[mM,tT,ed]),td=tT(),yT=ed(),[pM,Qa]=Mr(pl),[vM,vl]=Mr(pl),xT=i=>{const{__scopeMenu:e,open:t=!1,children:n,dir:r,onOpenChange:o,modal:l=!0}=i,u=td(e),[f,d]=R.useState(null),m=R.useRef(!1),g=dn(o),p=Gu(r);return R.useEffect(()=>{const E=()=>{m.current=!0,document.addEventListener("pointerdown",S,{capture:!0,once:!0}),document.addEventListener("pointermove",S,{capture:!0,once:!0})},S=()=>m.current=!1;return document.addEventListener("keydown",E,{capture:!0}),()=>{document.removeEventListener("keydown",E,{capture:!0}),document.removeEventListener("pointerdown",S,{capture:!0}),document.removeEventListener("pointermove",S,{capture:!0})}},[]),y.jsx(zO,{...u,children:y.jsx(pM,{scope:e,open:t,onOpenChange:g,content:f,onContentChange:d,children:y.jsx(vM,{scope:e,onClose:R.useCallback(()=>g(!1),[g]),isUsingKeyboardRef:m,dir:p,modal:l,children:n})})})};xT.displayName=pl;var yM="MenuAnchor",gg=R.forwardRef((i,e)=>{const{__scopeMenu:t,...n}=i,r=td(t);return y.jsx(HO,{...r,...n,ref:e})});gg.displayName=yM;var xM="MenuPortal",[$B,ET]=Mr(xM,{forceMount:void 0}),rs="MenuContent",[EM,pg]=Mr(rs),ST=R.forwardRef((i,e)=>{const t=ET(rs,i.__scopeMenu),{forceMount:n=t.forceMount,...r}=i,o=Qa(rs,i.__scopeMenu),l=vl(rs,i.__scopeMenu);return y.jsx(sl.Provider,{scope:i.__scopeMenu,children:y.jsx(os,{present:n||o.open,children:y.jsx(sl.Slot,{scope:i.__scopeMenu,children:l.modal?y.jsx(SM,{...r,ref:e}):y.jsx(bM,{...r,ref:e})})})})}),SM=R.forwardRef((i,e)=>{const t=Qa(rs,i.__scopeMenu),n=R.useRef(null),r=yt(e,n);return R.useEffect(()=>{const o=n.current;if(o)return JS(o)},[]),y.jsx(vg,{...i,ref:r,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:we(i.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),bM=R.forwardRef((i,e)=>{const t=Qa(rs,i.__scopeMenu);return y.jsx(vg,{...i,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),TM=sM("MenuContent.ScrollLock"),vg=R.forwardRef((i,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:r,onOpenAutoFocus:o,onCloseAutoFocus:l,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:p,onDismiss:E,disableOutsideScroll:S,...b}=i,T=Qa(rs,t),A=vl(rs,t),_=td(t),w=yT(t),D=hM(t),[O,B]=R.useState(null),N=R.useRef(null),U=yt(e,N,T.onContentChange),k=R.useRef(0),F=R.useRef(""),H=R.useRef(0),ne=R.useRef(null),J=R.useRef("right"),le=R.useRef(0),de=S?Qm:R.Fragment,P=S?{as:TM,allowPinchZoom:!0}:void 0,K=W=>{const he=F.current+W,M=D().filter(fe=>!fe.disabled),G=document.activeElement,te=M.find(fe=>fe.ref.current===G)?.textValue,V=M.map(fe=>fe.textValue),se=kM(V,he,te),ce=M.find(fe=>fe.textValue===se)?.ref.current;(function fe(ve){F.current=ve,window.clearTimeout(k.current),ve!==""&&(k.current=window.setTimeout(()=>fe(""),1e3))})(he),ce&&setTimeout(()=>ce.focus())};R.useEffect(()=>()=>window.clearTimeout(k.current),[]),HS();const j=R.useCallback(W=>J.current===ne.current?.side&&UM(W,ne.current?.area),[]);return y.jsx(EM,{scope:t,searchRef:F,onItemEnter:R.useCallback(W=>{j(W)&&W.preventDefault()},[j]),onItemLeave:R.useCallback(W=>{j(W)||(N.current?.focus(),B(null))},[j]),onTriggerLeave:R.useCallback(W=>{j(W)&&W.preventDefault()},[j]),pointerGraceTimerRef:H,onPointerGraceIntentChange:R.useCallback(W=>{ne.current=W},[]),children:y.jsx(de,{...P,children:y.jsx(Wm,{asChild:!0,trapped:r,onMountAutoFocus:we(o,W=>{W.preventDefault(),N.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:y.jsx(Xm,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:d,onPointerDownOutside:m,onFocusOutside:g,onInteractOutside:p,onDismiss:E,children:y.jsx(gT,{asChild:!0,...w,dir:A.dir,orientation:"vertical",loop:n,currentTabStopId:O,onCurrentTabStopIdChange:B,onEntryFocus:we(f,W=>{A.isUsingKeyboardRef.current||W.preventDefault()}),preventScrollOnEntryFocus:!0,children:y.jsx(VO,{role:"menu","aria-orientation":"vertical","data-state":UT(T.open),"data-radix-menu-content":"",dir:A.dir,..._,...b,ref:U,style:{outline:"none",...b.style},onKeyDown:we(b.onKeyDown,W=>{const M=W.target.closest("[data-radix-menu-content]")===W.currentTarget,G=W.ctrlKey||W.altKey||W.metaKey,te=W.key.length===1;M&&(W.key==="Tab"&&W.preventDefault(),!G&&te&&K(W.key));const V=N.current;if(W.target!==V||!uM.includes(W.key))return;W.preventDefault();const ce=D().filter(fe=>!fe.disabled).map(fe=>fe.ref.current);vT.includes(W.key)&&ce.reverse(),OM(ce)}),onBlur:we(i.onBlur,W=>{W.currentTarget.contains(W.target)||(window.clearTimeout(k.current),F.current="")}),onPointerMove:we(i.onPointerMove,il(W=>{const he=W.target,M=le.current!==W.clientX;if(W.currentTarget.contains(he)&&M){const G=W.clientX>le.current?"right":"left";J.current=G,le.current=W.clientX}}))})})})})})})});ST.displayName=rs;var AM="MenuGroup",yg=R.forwardRef((i,e)=>{const{__scopeMenu:t,...n}=i;return y.jsx(ct.div,{role:"group",...n,ref:e})});yg.displayName=AM;var RM="MenuLabel",bT=R.forwardRef((i,e)=>{const{__scopeMenu:t,...n}=i;return y.jsx(ct.div,{...n,ref:e})});bT.displayName=RM;var _u="MenuItem",kx="menu.itemSelect",nd=R.forwardRef((i,e)=>{const{disabled:t=!1,onSelect:n,...r}=i,o=R.useRef(null),l=vl(_u,i.__scopeMenu),u=pg(_u,i.__scopeMenu),f=yt(e,o),d=R.useRef(!1),m=()=>{const g=o.current;if(!t&&g){const p=new CustomEvent(kx,{bubbles:!0,cancelable:!0});g.addEventListener(kx,E=>n?.(E),{once:!0}),vS(g,p),p.defaultPrevented?d.current=!1:l.onClose()}};return y.jsx(TT,{...r,ref:f,disabled:t,onClick:we(i.onClick,m),onPointerDown:g=>{i.onPointerDown?.(g),d.current=!0},onPointerUp:we(i.onPointerUp,g=>{d.current||g.currentTarget?.click()}),onKeyDown:we(i.onKeyDown,g=>{const p=u.searchRef.current!=="";t||p&&g.key===" "||pm.includes(g.key)&&(g.currentTarget.click(),g.preventDefault())})})});nd.displayName=_u;var TT=R.forwardRef((i,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:r,...o}=i,l=pg(_u,t),u=yT(t),f=R.useRef(null),d=yt(e,f),[m,g]=R.useState(!1),[p,E]=R.useState("");return R.useEffect(()=>{const S=f.current;S&&E((S.textContent??"").trim())},[o.children]),y.jsx(sl.ItemSlot,{scope:t,disabled:n,textValue:r??p,children:y.jsx(pT,{asChild:!0,...u,focusable:!n,children:y.jsx(ct.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:d,onPointerMove:we(i.onPointerMove,il(S=>{n?l.onItemLeave(S):(l.onItemEnter(S),S.defaultPrevented||S.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:we(i.onPointerLeave,il(S=>l.onItemLeave(S))),onFocus:we(i.onFocus,()=>g(!0)),onBlur:we(i.onBlur,()=>g(!1))})})})}),CM="MenuCheckboxItem",AT=R.forwardRef((i,e)=>{const{checked:t=!1,onCheckedChange:n,...r}=i;return y.jsx(wT,{scope:i.__scopeMenu,checked:t,children:y.jsx(nd,{role:"menuitemcheckbox","aria-checked":wu(t)?"mixed":t,...r,ref:e,"data-state":Eg(t),onSelect:we(r.onSelect,()=>n?.(wu(t)?!0:!t),{checkForDefaultPrevented:!1})})})});AT.displayName=CM;var RT="MenuRadioGroup",[LM,_M]=Mr(RT,{value:void 0,onValueChange:()=>{}}),CT=R.forwardRef((i,e)=>{const{value:t,onValueChange:n,...r}=i,o=dn(n);return y.jsx(LM,{scope:i.__scopeMenu,value:t,onValueChange:o,children:y.jsx(yg,{...r,ref:e})})});CT.displayName=RT;var LT="MenuRadioItem",_T=R.forwardRef((i,e)=>{const{value:t,...n}=i,r=_M(LT,i.__scopeMenu),o=t===r.value;return y.jsx(wT,{scope:i.__scopeMenu,checked:o,children:y.jsx(nd,{role:"menuitemradio","aria-checked":o,...n,ref:e,"data-state":Eg(o),onSelect:we(n.onSelect,()=>r.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});_T.displayName=LT;var xg="MenuItemIndicator",[wT,wM]=Mr(xg,{checked:!1}),DT=R.forwardRef((i,e)=>{const{__scopeMenu:t,forceMount:n,...r}=i,o=wM(xg,t);return y.jsx(os,{present:n||wu(o.checked)||o.checked===!0,children:y.jsx(ct.span,{...r,ref:e,"data-state":Eg(o.checked)})})});DT.displayName=xg;var DM="MenuSeparator",IT=R.forwardRef((i,e)=>{const{__scopeMenu:t,...n}=i;return y.jsx(ct.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});IT.displayName=DM;var IM="MenuArrow",NT=R.forwardRef((i,e)=>{const{__scopeMenu:t,...n}=i,r=td(t);return y.jsx(KO,{...r,...n,ref:e})});NT.displayName=IM;var NM="MenuSub",[GB,OT]=Mr(NM),Wo="MenuSubTrigger",MT=R.forwardRef((i,e)=>{const t=Qa(Wo,i.__scopeMenu),n=vl(Wo,i.__scopeMenu),r=OT(Wo,i.__scopeMenu),o=pg(Wo,i.__scopeMenu),l=R.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=o,d={__scopeMenu:i.__scopeMenu},m=R.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return R.useEffect(()=>m,[m]),R.useEffect(()=>{const g=u.current;return()=>{window.clearTimeout(g),f(null)}},[u,f]),y.jsx(gg,{asChild:!0,...d,children:y.jsx(TT,{id:r.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":r.contentId,"data-state":UT(t.open),...i,ref:Or(e,r.onTriggerChange),onClick:g=>{i.onClick?.(g),!(i.disabled||g.defaultPrevented)&&(g.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:we(i.onPointerMove,il(g=>{o.onItemEnter(g),!g.defaultPrevented&&!i.disabled&&!t.open&&!l.current&&(o.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{t.onOpenChange(!0),m()},100))})),onPointerLeave:we(i.onPointerLeave,il(g=>{m();const p=t.content?.getBoundingClientRect();if(p){const E=t.content?.dataset.side,S=E==="right",b=S?-5:5,T=p[S?"left":"right"],A=p[S?"right":"left"];o.onPointerGraceIntentChange({area:[{x:g.clientX+b,y:g.clientY},{x:T,y:p.top},{x:A,y:p.top},{x:A,y:p.bottom},{x:T,y:p.bottom}],side:E}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(g),g.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:we(i.onKeyDown,g=>{const p=o.searchRef.current!=="";i.disabled||p&&g.key===" "||dM[n.dir].includes(g.key)&&(t.onOpenChange(!0),t.content?.focus(),g.preventDefault())})})})});MT.displayName=Wo;var kT="MenuSubContent",PT=R.forwardRef((i,e)=>{const t=ET(rs,i.__scopeMenu),{forceMount:n=t.forceMount,...r}=i,o=Qa(rs,i.__scopeMenu),l=vl(rs,i.__scopeMenu),u=OT(kT,i.__scopeMenu),f=R.useRef(null),d=yt(e,f);return y.jsx(sl.Provider,{scope:i.__scopeMenu,children:y.jsx(os,{present:n||o.open,children:y.jsx(sl.Slot,{scope:i.__scopeMenu,children:y.jsx(vg,{id:u.contentId,"aria-labelledby":u.triggerId,...r,ref:d,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{l.isUsingKeyboardRef.current&&f.current?.focus(),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:we(i.onFocusOutside,m=>{m.target!==u.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:we(i.onEscapeKeyDown,m=>{l.onClose(),m.preventDefault()}),onKeyDown:we(i.onKeyDown,m=>{const g=m.currentTarget.contains(m.target),p=fM[l.dir].includes(m.key);g&&p&&(o.onOpenChange(!1),u.trigger?.focus(),m.preventDefault())})})})})})});PT.displayName=kT;function UT(i){return i?"open":"closed"}function wu(i){return i==="indeterminate"}function Eg(i){return wu(i)?"indeterminate":i?"checked":"unchecked"}function OM(i){const e=document.activeElement;for(const t of i)if(t===e||(t.focus(),document.activeElement!==e))return}function MM(i,e){return i.map((t,n)=>i[(e+n)%i.length])}function kM(i,e,t){const r=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,o=t?i.indexOf(t):-1;let l=MM(i,Math.max(o,0));r.length===1&&(l=l.filter(d=>d!==t));const f=l.find(d=>d.toLowerCase().startsWith(r.toLowerCase()));return f!==t?f:void 0}function PM(i,e){const{x:t,y:n}=i;let r=!1;for(let o=0,l=e.length-1;o<e.length;l=o++){const u=e[o],f=e[l],d=u.x,m=u.y,g=f.x,p=f.y;m>n!=p>n&&t<(g-d)*(n-m)/(p-m)+d&&(r=!r)}return r}function UM(i,e){if(!e)return!1;const t={x:i.clientX,y:i.clientY};return PM(t,e)}function il(i){return e=>e.pointerType==="mouse"?i(e):void 0}var FM=xT,BM=gg,jM=ST,$M=yg,GM=bT,zM=nd,HM=AT,VM=CT,KM=_T,YM=DT,qM=IT,XM=NT,WM=MT,QM=PT,yl="Menubar",[vm,ZM,JM]=ag(yl),[FT]=Ji(yl,[JM,ed]),In=gM(),BT=ed(),[ek,Sg]=FT(yl),jT=R.forwardRef((i,e)=>{const{__scopeMenubar:t,value:n,onValueChange:r,defaultValue:o,loop:l=!0,dir:u,...f}=i,d=Gu(u),m=BT(t),[g,p]=Ku({prop:n,onChange:r,defaultProp:o??"",caller:yl}),[E,S]=R.useState(null);return y.jsx(ek,{scope:t,value:g,onMenuOpen:R.useCallback(b=>{p(b),S(b)},[p]),onMenuClose:R.useCallback(()=>p(""),[p]),onMenuToggle:R.useCallback(b=>{p(T=>T?"":b),S(b)},[p]),dir:d,loop:l,children:y.jsx(vm.Provider,{scope:t,children:y.jsx(vm.Slot,{scope:t,children:y.jsx(gT,{asChild:!0,...m,orientation:"horizontal",loop:l,dir:d,currentTabStopId:E,onCurrentTabStopIdChange:S,children:y.jsx(ct.div,{role:"menubar",...f,ref:e})})})})})});jT.displayName=yl;var bg="MenubarMenu",[tk,$T]=FT(bg),GT=i=>{const{__scopeMenubar:e,value:t,...n}=i,r=Cr(),o=t||r||"LEGACY_REACT_AUTO_VALUE",l=Sg(bg,e),u=In(e),f=R.useRef(null),d=R.useRef(!1),m=l.value===o;return R.useEffect(()=>{m||(d.current=!1)},[m]),y.jsx(tk,{scope:e,value:o,triggerId:Cr(),triggerRef:f,contentId:Cr(),wasKeyboardTriggerOpenRef:d,children:y.jsx(FM,{...u,open:m,onOpenChange:g=>{g||l.onMenuClose()},modal:!1,dir:l.dir,...n})})};GT.displayName=bg;var ym="MenubarTrigger",zT=R.forwardRef((i,e)=>{const{__scopeMenubar:t,disabled:n=!1,...r}=i,o=BT(t),l=In(t),u=Sg(ym,t),f=$T(ym,t),d=R.useRef(null),m=yt(e,d,f.triggerRef),[g,p]=R.useState(!1),E=u.value===f.value;return y.jsx(vm.ItemSlot,{scope:t,value:f.value,disabled:n,children:y.jsx(pT,{asChild:!0,...o,focusable:!n,tabStopId:f.value,children:y.jsx(BM,{asChild:!0,...l,children:y.jsx(ct.button,{type:"button",role:"menuitem",id:f.triggerId,"aria-haspopup":"menu","aria-expanded":E,"aria-controls":E?f.contentId:void 0,"data-highlighted":g?"":void 0,"data-state":E?"open":"closed","data-disabled":n?"":void 0,disabled:n,...r,ref:m,onPointerDown:we(i.onPointerDown,S=>{!n&&S.button===0&&S.ctrlKey===!1&&(u.onMenuOpen(f.value),E||S.preventDefault())}),onPointerEnter:we(i.onPointerEnter,()=>{u.value&&!E&&(u.onMenuOpen(f.value),d.current?.focus())}),onKeyDown:we(i.onKeyDown,S=>{n||(["Enter"," "].includes(S.key)&&u.onMenuToggle(f.value),S.key==="ArrowDown"&&u.onMenuOpen(f.value),["Enter"," ","ArrowDown"].includes(S.key)&&(f.wasKeyboardTriggerOpenRef.current=!0,S.preventDefault()))}),onFocus:we(i.onFocus,()=>p(!0)),onBlur:we(i.onBlur,()=>p(!1))})})})})});zT.displayName=ym;var xm="MenubarContent",nk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,align:n="start",...r}=i,o=In(t),l=Sg(xm,t),u=$T(xm,t),f=ZM(t),d=R.useRef(!1);return y.jsx(jM,{id:u.contentId,"aria-labelledby":u.triggerId,"data-radix-menubar-content":"",...o,...r,ref:e,align:n,onCloseAutoFocus:we(i.onCloseAutoFocus,m=>{!l.value&&!d.current&&u.triggerRef.current?.focus(),d.current=!1,m.preventDefault()}),onFocusOutside:we(i.onFocusOutside,m=>{const g=m.target;f().some(E=>E.ref.current?.contains(g))&&m.preventDefault()}),onInteractOutside:we(i.onInteractOutside,()=>{d.current=!0}),onEntryFocus:m=>{u.wasKeyboardTriggerOpenRef.current||m.preventDefault()},onKeyDown:we(i.onKeyDown,m=>{if(["ArrowRight","ArrowLeft"].includes(m.key)){const g=m.target,p=g.hasAttribute("data-radix-menubar-subtrigger"),E=g.closest("[data-radix-menubar-content]")!==m.currentTarget,b=(l.dir==="rtl"?"ArrowRight":"ArrowLeft")===m.key;if(!b&&p||E&&b)return;let _=f().filter(O=>!O.disabled).map(O=>O.value);b&&_.reverse();const w=_.indexOf(u.value);_=l.loop?Rk(_,w+1):_.slice(w+1);const[D]=_;D&&l.onMenuOpen(D)}},{checkForDefaultPrevented:!1}),style:{...i.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});nk.displayName=xm;var sk="MenubarGroup",ik=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx($M,{...r,...n,ref:e})});ik.displayName=sk;var rk="MenubarLabel",ak=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(GM,{...r,...n,ref:e})});ak.displayName=rk;var ok="MenubarItem",lk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(zM,{...r,...n,ref:e})});lk.displayName=ok;var ck="MenubarCheckboxItem",uk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(HM,{...r,...n,ref:e})});uk.displayName=ck;var dk="MenubarRadioGroup",fk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(VM,{...r,...n,ref:e})});fk.displayName=dk;var hk="MenubarRadioItem",mk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(KM,{...r,...n,ref:e})});mk.displayName=hk;var gk="MenubarItemIndicator",pk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(YM,{...r,...n,ref:e})});pk.displayName=gk;var vk="MenubarSeparator",yk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(qM,{...r,...n,ref:e})});yk.displayName=vk;var xk="MenubarArrow",Ek=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(XM,{...r,...n,ref:e})});Ek.displayName=xk;var Sk="MenubarSubTrigger",bk=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(WM,{"data-radix-menubar-subtrigger":"",...r,...n,ref:e})});bk.displayName=Sk;var Tk="MenubarSubContent",Ak=R.forwardRef((i,e)=>{const{__scopeMenubar:t,...n}=i,r=In(t);return y.jsx(QM,{...r,"data-radix-menubar-content":"",...n,ref:e,style:{...i.style,"--radix-menubar-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-menubar-content-available-width":"var(--radix-popper-available-width)","--radix-menubar-content-available-height":"var(--radix-popper-available-height)","--radix-menubar-trigger-width":"var(--radix-popper-anchor-width)","--radix-menubar-trigger-height":"var(--radix-popper-anchor-height)"}})});Ak.displayName=Tk;function Rk(i,e){return i.map((t,n)=>i[(e+n)%i.length])}var Ck=jT,Lk=GT,_k=zT;function wk({className:i,...e}){return y.jsx(Ck,{"data-slot":"menubar",className:vt("bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs",i),...e})}function Dk({...i}){return y.jsx(Lk,{"data-slot":"menubar-menu",...i})}function Ik({className:i,...e}){return y.jsx(_k,{"data-slot":"menubar-trigger",className:vt("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none",i),...e})}const Fh=async(i,e={})=>{const t=hl();if(!t)throw new Error("Token de autenticao no encontrado");const n={"Content-Type":"application/json",Authorization:`Bearer ${t}`,...e.headers},r=await fetch(i,{...e,headers:n});if(!r.ok){const o=await r.json().catch(()=>({}));throw new Error(o.message||`HTTP error! status: ${r.status}`)}return r.json()},Du={getCategories:async()=>await Fh(Rt.CATEGORIES,{method:"GET"}),getCoursesByCategory:async i=>await Fh(`${Rt.COURSES_BY_CATEGORY}?categoryId=${i}`,{method:"GET"}),getLessonsByCourse:async i=>await Fh(`${Rt.LESSONS_BY_COURSE}?courseId=${i}`,{method:"GET"}),getSignedUrl:async i=>{const e=hl();if(!e)throw new Error("Token de autenticao no encontrado");const t=`${Rt.GET_SIGNED_URL}?lessonId=${i}`;console.log("Fazendo requisio para:",t);const n=await fetch(t,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(!n.ok){const r=await n.json().catch(()=>({}));throw new Error(r.message||`HTTP error! status: ${n.status}`)}return await n.text()}},ge=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},Nk=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=Ok},Ok=Number.MAX_SAFE_INTEGER||9007199254740991;let Te=(function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i})({}),X=(function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",i.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",i.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.ASSET_LIST_LOAD_ERROR="assetListLoadError",i.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",i.ASSET_LIST_PARSING_ERROR="assetListParsingError",i.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.ATTACH_MEDIA_ERROR="attachMediaError",i.UNKNOWN="unknown",i})({}),L=(function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.MEDIA_ENDED="hlsMediaEnded",i.STALL_RESOLVED="hlsStallResolved",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFERED_TO_END="hlsBufferedToEnd",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i.ASSET_LIST_LOADING="hlsAssetListLoading",i.ASSET_LIST_LOADED="hlsAssetListLoaded",i.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",i.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",i.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",i.INTERSTITIAL_STARTED="hlsInterstitialStarted",i.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",i.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",i.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",i.INTERSTITIAL_ENDED="hlsInterstitialEnded",i.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",i.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",i.EVENT_CUE_ENTER="hlsEventCueEnter",i})({});var Ge={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},pe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class _a{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){const n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class Mk{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new _a(e),this.fast_=new _a(t),this.defaultTTFB_=r,this.ttfb_=new _a(e)}update(e,t){const{slow_:n,fast_:r,ttfb_:o}=this;n.halfLife!==e&&(this.slow_=new _a(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new _a(t,r.getEstimate(),r.getTotalWeight())),o.halfLife!==e&&(this.ttfb_=new _a(e,o.getEstimate(),o.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const n=8*t,r=e/1e3,o=n/r;this.fast_.sample(r,o),this.slow_.sample(r,o)}sampleTTFB(e){const t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function kk(i,e,t){return(e=Uk(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function ht(){return ht=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},ht.apply(null,arguments)}function Px(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function ot(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Px(Object(t),!0).forEach(function(n){kk(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Px(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function Pk(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Uk(i){var e=Pk(i,"string");return typeof e=="symbol"?e:e+""}class cs{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=Hi,this.debug=t.debug.bind(null,n),this.log=t.log.bind(null,n),this.warn=t.warn.bind(null,n),this.info=t.info.bind(null,n),this.error=t.error.bind(null,n)}}const Hi=function(){},Fk={trace:Hi,debug:Hi,log:Hi,warn:Hi,info:Hi,error:Hi};function Em(){return ht({},Fk)}function Bk(i,e){const t=self.console[i];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${i}] >`):Hi}function Ux(i,e,t){return e[i]?e[i].bind(e):Bk(i,t)}const Sm=Em();function jk(i,e,t){const n=Em();if(typeof console=="object"&&i===!0||typeof i=="object"){const r=["debug","log","info","warn","error"];r.forEach(o=>{n[o]=Ux(o,i,t)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Em()}r.forEach(o=>{Sm[o]=Ux(o,i)})}else ht(Sm,n);return n}const lt=Sm;function Qi(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function $k(i){return typeof self<"u"&&i===self.ManagedMediaSource}function HT(i,e){const t=Object.keys(i),n=Object.keys(e),r=t.length,o=n.length;return!r||!o||r===o&&!t.some(l=>n.indexOf(l)===-1)}function Kn(i,e=!1){if(typeof TextDecoder<"u"){const d=new TextDecoder("utf-8").decode(i);if(e){const m=d.indexOf("\0");return m!==-1?d.substring(0,m):d}return d.replace(/\0/g,"")}const t=i.length;let n,r,o,l="",u=0;for(;u<t;){if(n=i[u++],n===0&&e)return l;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(n);break;case 12:case 13:r=i[u++],l+=String.fromCharCode((n&31)<<6|r&63);break;case 14:r=i[u++],o=i[u++],l+=String.fromCharCode((n&15)<<12|(r&63)<<6|(o&63)<<0);break}}return l}function on(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function VT(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function Gk(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Bh={exports:{}},Fx;function zk(){return Fx||(Fx=1,(function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,o=/(?:\/|^)\.(?=\/)/g,l=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(f,d,m){if(m=m||{},f=f.trim(),d=d.trim(),!d){if(!m.alwaysNormalize)return f;var g=u.parseURL(f);if(!g)throw new Error("Error trying to parse base URL.");return g.path=u.normalizePath(g.path),u.buildURLFromParts(g)}var p=u.parseURL(d);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return m.alwaysNormalize?(p.path=u.normalizePath(p.path),u.buildURLFromParts(p)):d;var E=u.parseURL(f);if(!E)throw new Error("Error trying to parse base URL.");if(!E.netLoc&&E.path&&E.path[0]!=="/"){var S=r.exec(E.path);E.netLoc=S[1],E.path=S[2]}E.netLoc&&!E.path&&(E.path="/");var b={scheme:E.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(b.netLoc=E.netLoc,p.path[0]!=="/"))if(!p.path)b.path=E.path,p.params||(b.params=E.params,p.query||(b.query=E.query));else{var T=E.path,A=T.substring(0,T.lastIndexOf("/")+1)+p.path;b.path=u.normalizePath(A)}return b.path===null&&(b.path=m.alwaysNormalize?u.normalizePath(p.path):p.path),u.buildURLFromParts(b)},parseURL:function(f){var d=n.exec(f);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(f){for(f=f.split("").reverse().join("").replace(o,"");f.length!==(f=f.replace(l,"")).length;);return f.split("").reverse().join("")},buildURLFromParts:function(f){return f.scheme+f.netLoc+f.path+f.params+f.query+f.fragment}};i.exports=u})()})(Bh)),Bh.exports}var Tg=zk();class Ag{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var gt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class KT{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,Vk(this,"stats")}setByteRange(e,t){const n=e.split("@",2);let r;n.length===1?r=t?.byteRangeEndOffset||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[gt.AUDIO]:null,[gt.VIDEO]:null,[gt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new Ag),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Tg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[gt.AUDIO]=null,e[gt.VIDEO]=null,e[gt.AUDIOVIDEO]=null}}function Pt(i){return i.sn!=="initSegment"}class jh extends KT{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],t=this.byteRange[1];if(ge(e)&&ge(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:t}=this;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const n=Object.keys(t);if(n.length===1){const r=this._decryptdata=t[n[0]]||null;r&&(this._decryptdata=r.getDecryptData(this.sn,t))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=ge(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var t;const n=Object.keys(this.levelkeys),r=n.length;if(r>1||r===1&&(t=this.levelkeys[n[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!ge(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Pt(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const t=this.levelkeys;if(t){var n;const r=t[e];r&&!((n=this._decryptdata)!=null&&n.keyId)&&(this._decryptdata=r.getDecryptData(this.sn,t))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,o,l=!1){const{elementaryStreams:u}=this,f=u[e];if(!f){u[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:o,partial:l};return}f.startPTS=Math.min(f.startPTS,t),f.endPTS=Math.max(f.endPTS,n),f.startDTS=Math.min(f.startDTS,r),f.endDTS=Math.max(f.endDTS,o)}}class Hk extends KT{constructor(e,t,n,r,o){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const l=e.enumeratedString("BYTERANGE");l&&this.setByteRange(l,o),o&&(this.fragOffset=o.fragOffset+o.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function YT(i,e){const t=Object.getPrototypeOf(i);if(t){const n=Object.getOwnPropertyDescriptor(t,e);return n||YT(t,e)}}function Vk(i,e){const t=YT(i,e);t&&(t.enumerable=!0,Object.defineProperty(i,e,t))}const Bx=Math.pow(2,32)-1,Kk=[].push,qT={video:1,audio:2,id3:3,text:4};function qt(i){return String.fromCharCode.apply(null,i)}function XT(i,e){const t=i[e]<<8|i[e+1];return t<0?65536+t:t}function Ne(i,e){const t=WT(i,e);return t<0?4294967296+t:t}function jx(i,e){let t=Ne(i,e);return t*=Math.pow(2,32),t+=Ne(i,e+4),t}function WT(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function Yk(i){const e=i.byteLength;for(let t=0;t<e;){const n=Ne(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function Be(i,e){const t=[];if(!e.length)return t;const n=i.byteLength;for(let r=0;r<n;){const o=Ne(i,r),l=qt(i.subarray(r+4,r+8)),u=o>1?r+o:n;if(l===e[0])if(e.length===1)t.push(i.subarray(r+8,u));else{const f=Be(i.subarray(r+8,u),e.slice(1));f.length&&Kk.apply(t,f)}r=u}return t}function qk(i){const e=[],t=i[0];let n=8;const r=Ne(i,n);n+=4;let o=0,l=0;t===0?(o=Ne(i,n),l=Ne(i,n+4),n+=8):(o=jx(i,n),l=jx(i,n+8),n+=16),n+=2;let u=i.length+l;const f=XT(i,n);n+=2;for(let d=0;d<f;d++){let m=n;const g=Ne(i,m);m+=4;const p=g&2147483647;if((g&2147483648)>>>31===1)return lt.warn("SIDX has hierarchical references (not supported)"),null;const S=Ne(i,m);m+=4,e.push({referenceSize:p,subsegmentDuration:S,info:{duration:S/r,start:u,end:u+p-1}}),u+=p,m+=4,n=m}return{earliestPresentationTime:o,timescale:r,version:t,referencesCount:f,references:e}}function QT(i){const e=[],t=Be(i,["moov","trak"]);for(let r=0;r<t.length;r++){const o=t[r],l=Be(o,["tkhd"])[0];if(l){let u=l[0];const f=Ne(l,u===0?12:20),d=Be(o,["mdia","mdhd"])[0];if(d){u=d[0];const m=Ne(d,u===0?12:20),g=Be(o,["mdia","hdlr"])[0];if(g){const p=qt(g.subarray(8,12)),E={soun:gt.AUDIO,vide:gt.VIDEO}[p],S=Be(o,["mdia","minf","stbl","stsd"])[0],b=Xk(S);E?(e[f]={timescale:m,type:E,stsd:b},e[E]=ot({timescale:m,id:f},b)):e[f]={timescale:m,type:p,stsd:b}}}}}return Be(i,["moov","mvex","trex"]).forEach(r=>{const o=Ne(r,4),l=e[o];l&&(l.default={duration:Ne(r,12),flags:Ne(r,20)})}),e}function Xk(i){const e=i.subarray(8),t=e.subarray(86),n=qt(e.subarray(4,8));let r=n,o;const l=n==="enca"||n==="encv";if(l){const d=Be(e,[n])[0].subarray(n==="enca"?28:78);Be(d,["sinf"]).forEach(g=>{const p=Be(g,["schm"])[0];if(p){const E=qt(p.subarray(4,8));if(E==="cbcs"||E==="cenc"){const S=Be(g,["frma"])[0];S&&(r=qt(S))}}})}const u=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const f=Be(t,["avcC"])[0];f&&f.length>3&&(r+="."+zc(f[1])+zc(f[2])+zc(f[3]),o=Gc(u==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const f=Be(e,[n])[0],d=Be(f.subarray(28),["esds"])[0];if(d&&d.length>7){let m=4;if(d[m++]!==3)break;m=$h(d,m),m+=2;const g=d[m++];if(g&128&&(m+=2),g&64&&(m+=d[m++]),d[m++]!==4)break;m=$h(d,m);const p=d[m++];if(p===64)r+="."+zc(p);else break;if(m+=12,d[m++]!==5)break;m=$h(d,m);const E=d[m++];let S=(E&248)>>3;S===31&&(S+=1+((E&7)<<3)+((d[m]&224)>>5)),r+="."+S}break}case"hvc1":case"hev1":{const f=Be(t,["hvcC"])[0];if(f&&f.length>12){const d=f[1],m=["","A","B","C"][d>>6],g=d&31,p=Ne(f,2),E=(d&32)>>5?"H":"L",S=f[12],b=f.subarray(6,12);r+="."+m+g,r+="."+Wk(p).toString(16).toUpperCase(),r+="."+E+S;let T="";for(let A=b.length;A--;){const _=b[A];(_||T)&&(T="."+_.toString(16).toUpperCase()+T)}r+=T}o=Gc(u=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=Gc(r,t)||r;break}case"vp09":{const f=Be(t,["vpcC"])[0];if(f&&f.length>6){const d=f[4],m=f[5],g=f[6]>>4&15;r+="."+Ds(d)+"."+Ds(m)+"."+Ds(g)}break}case"av01":{const f=Be(t,["av1C"])[0];if(f&&f.length>2){const d=f[1]>>>5,m=f[1]&31,g=f[2]>>>7?"H":"M",p=(f[2]&64)>>6,E=(f[2]&32)>>5,S=d===2&&p?E?12:10:p?10:8,b=(f[2]&16)>>4,T=(f[2]&8)>>3,A=(f[2]&4)>>2,_=f[2]&3;r+="."+d+"."+Ds(m)+g+"."+Ds(S)+"."+b+"."+T+A+_+"."+Ds(1)+"."+Ds(1)+"."+Ds(1)+"."+0,o=Gc("dav1",t)}break}}return{codec:r,encrypted:l,supplemental:o}}function Gc(i,e){const t=Be(e,["dvvC"]),n=t.length?t[0]:Be(e,["dvcC"])[0];if(n){const r=n[2]>>1&127,o=n[2]<<5&32|n[3]>>3&31;return i+"."+Ds(r)+"."+Ds(o)}}function Wk(i){let e=0;for(let t=0;t<32;t++)e|=(i>>t&1)<<31-t;return e>>>0}function $h(i,e){const t=e+5;for(;i[e++]&128&&e<t;);return e}function zc(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function Ds(i){return(i<10?"0":"")+i}function Qk(i,e){if(!i||!e)return;const t=e.keyId;t&&e.isCommonEncryption&&ZT(i,(n,r)=>{const o=n.subarray(8,24);o.some(l=>l!==0)||(lt.log(`[eme] Patching keyId in 'enc${r?"a":"v"}>sinf>>tenc' box: ${on(o)} -> ${on(t)}`),n.set(t,8))})}function Zk(i){const e=[];return ZT(i,t=>e.push(t.subarray(8,24))),e}function ZT(i,e){Be(i,["moov","trak"]).forEach(n=>{const r=Be(n,["mdia","minf","stbl","stsd"])[0];if(!r)return;const o=r.subarray(8);let l=Be(o,["enca"]);const u=l.length>0;u||(l=Be(o,["encv"])),l.forEach(f=>{const d=u?f.subarray(28):f.subarray(78);Be(d,["sinf"]).forEach(g=>{const p=JT(g);p&&e(p,u)})})})}function JT(i){const e=Be(i,["schm"])[0];if(e){const t=qt(e.subarray(4,8));if(t==="cbcs"||t==="cenc"){const n=Be(i,["schi","tenc"])[0];if(n)return n}}}function Jk(i,e,t){const n={},r=Be(i,["moof","traf"]);for(let o=0;o<r.length;o++){const l=r[o],u=Be(l,["tfhd"])[0],f=Ne(u,4),d=e[f];if(!d)continue;n[f]||(n[f]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type});const m=n[f],g=Be(l,["tfdt"])[0];if(g){const w=g[0];let D=Ne(g,4);w===1&&(D===Bx?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(D*=Bx+1,D+=Ne(g,8))),ge(D)&&(!ge(m.start)||D<m.start)&&(m.start=D)}const p=d.default,E=Ne(u,0)|p?.flags;let S=p?.duration||0;E&8&&(E&2?S=Ne(u,12):S=Ne(u,8));const b=Be(l,["trun"]);let T=m.start||0,A=0,_=S;for(let w=0;w<b.length;w++){const D=b[w],O=Ne(D,4),B=m.sampleCount;m.sampleCount+=O;const N=D[3]&1,U=D[3]&4,k=D[2]&1,F=D[2]&2,H=D[2]&4,ne=D[2]&8;let J=8,le=O;for(N&&(J+=4),U&&O&&(!(D[J+1]&1)&&m.keyFrameIndex===void 0&&(m.keyFrameIndex=B),J+=4,k?(_=Ne(D,J),J+=4):_=S,F&&(J+=4),ne&&(J+=4),T+=_,A+=_,le--);le--;)k?(_=Ne(D,J),J+=4):_=S,F&&(J+=4),H&&(D[J+1]&1||m.keyFrameIndex===void 0&&(m.keyFrameIndex=m.sampleCount-(le+1),m.keyFrameStart=T),J+=4),ne&&(J+=4),T+=_,A+=_;!A&&S&&(A+=S*O)}m.duration+=A}if(!Object.keys(n).some(o=>n[o].duration)){let o=1/0,l=0;const u=Be(i,["sidx"]);for(let f=0;f<u.length;f++){const d=qk(u[f]);if(d!=null&&d.references){o=Math.min(o,d.earliestPresentationTime/d.timescale);const m=d.references.reduce((g,p)=>g+p.info.duration||0,0);l=Math.max(l,m+d.earliestPresentationTime/d.timescale)}}l&&ge(l)&&Object.keys(n).forEach(f=>{n[f].duration||(n[f].duration=l*n[f].timescale-n[f].start)})}return n}function eP(i){const e={valid:null,remainder:null},t=Be(i,["moof"]);if(t.length<2)return e.remainder=i,e;const n=t[t.length-1];return e.valid=i.slice(0,n.byteOffset-8),e.remainder=i.slice(n.byteOffset-8),e}function as(i,e){const t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function $x(i,e){const t=[],n=e.samples,r=e.timescale,o=e.id;let l=!1;return Be(n,["moof"]).map(f=>{const d=f.byteOffset-8;Be(f,["traf"]).map(g=>{const p=Be(g,["tfdt"]).map(E=>{const S=E[0];let b=Ne(E,4);return S===1&&(b*=Math.pow(2,32),b+=Ne(E,8)),b/r})[0];return p!==void 0&&(i=p),Be(g,["tfhd"]).map(E=>{const S=Ne(E,4),b=Ne(E,0)&16777215,T=(b&1)!==0,A=(b&2)!==0,_=(b&8)!==0;let w=0;const D=(b&16)!==0;let O=0;const B=(b&32)!==0;let N=8;S===o&&(T&&(N+=8),A&&(N+=4),_&&(w=Ne(E,N),N+=4),D&&(O=Ne(E,N),N+=4),B&&(N+=4),e.type==="video"&&(l=sd(e.codec)),Be(g,["trun"]).map(U=>{const k=U[0],F=Ne(U,0)&16777215,H=(F&1)!==0;let ne=0;const J=(F&4)!==0,le=(F&256)!==0;let de=0;const P=(F&512)!==0;let K=0;const j=(F&1024)!==0,W=(F&2048)!==0;let he=0;const M=Ne(U,4);let G=8;H&&(ne=Ne(U,G),G+=4),J&&(G+=4);let te=ne+d;for(let V=0;V<M;V++){if(le?(de=Ne(U,G),G+=4):de=w,P?(K=Ne(U,G),G+=4):K=O,j&&(G+=4),W&&(k===0?he=Ne(U,G):he=WT(U,G),G+=4),e.type===gt.VIDEO){let se=0;for(;se<K;){const ce=Ne(n,te);if(te+=4,tP(l,n[te])){const fe=n.subarray(te,te+ce);Rg(fe,l?2:1,i+he/r,t)}te+=ce,se+=ce+4}}i+=de/r}}))})})}),t}function sd(i){if(!i)return!1;const e=i.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function tP(i,e){if(i){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Rg(i,e,t,n){const r=eA(i);let o=0;o+=e;let l=0,u=0,f=0;for(;o<r.length;){l=0;do{if(o>=r.length)break;f=r[o++],l+=f}while(f===255);u=0;do{if(o>=r.length)break;f=r[o++],u+=f}while(f===255);const d=r.length-o;let m=o;if(u<d)o+=u;else if(u>d){lt.error(`Malformed SEI payload. ${u} is too small, only ${d} bytes left to parse.`);break}if(l===4){if(r[m++]===181){const p=XT(r,m);if(m+=2,p===49){const E=Ne(r,m);if(m+=4,E===1195456820){const S=r[m++];if(S===3){const b=r[m++],T=31&b,A=64&b,_=A?2+T*3:0,w=new Uint8Array(_);if(A){w[0]=b;for(let D=1;D<_;D++)w[D]=r[m++]}n.push({type:S,payloadType:l,pts:t,bytes:w})}}}}}else if(l===5&&u>16){const g=[];for(let S=0;S<16;S++){const b=r[m++].toString(16);g.push(b.length==1?"0"+b:b),(S===3||S===5||S===7||S===9)&&g.push("-")}const p=u-16,E=new Uint8Array(p);for(let S=0;S<p;S++)E[S]=r[m++];n.push({payloadType:l,pts:t,uuid:g.join(""),userData:Kn(E),userDataBytes:E})}}}function eA(i){const e=i.byteLength,t=[];let n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;const r=e-t.length,o=new Uint8Array(r);let l=0;for(n=0;n<r;l++,n++)l===t[0]&&(l++,t.shift()),o[n]=i[l];return o}function nP(i){const e=i[0];let t="",n="",r=0,o=0,l=0,u=0,f=0,d=0;if(e===0){for(;qt(i.subarray(d,d+1))!=="\0";)t+=qt(i.subarray(d,d+1)),d+=1;for(t+=qt(i.subarray(d,d+1)),d+=1;qt(i.subarray(d,d+1))!=="\0";)n+=qt(i.subarray(d,d+1)),d+=1;n+=qt(i.subarray(d,d+1)),d+=1,r=Ne(i,12),o=Ne(i,16),u=Ne(i,20),f=Ne(i,24),d=28}else if(e===1){d+=4,r=Ne(i,d),d+=4;const g=Ne(i,d);d+=4;const p=Ne(i,d);for(d+=4,l=2**32*g+p,Nk(l)||(l=Number.MAX_SAFE_INTEGER,lt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),u=Ne(i,d),d+=4,f=Ne(i,d),d+=4;qt(i.subarray(d,d+1))!=="\0";)t+=qt(i.subarray(d,d+1)),d+=1;for(t+=qt(i.subarray(d,d+1)),d+=1;qt(i.subarray(d,d+1))!=="\0";)n+=qt(i.subarray(d,d+1)),d+=1;n+=qt(i.subarray(d,d+1)),d+=1}const m=i.subarray(d,i.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:l,presentationTimeDelta:o,eventDuration:u,id:f,payload:m}}function sP(i,...e){const t=e.length;let n=8,r=t;for(;r--;)n+=e[r].byteLength;const o=new Uint8Array(n);for(o[0]=n>>24&255,o[1]=n>>16&255,o[2]=n>>8&255,o[3]=n&255,o.set(i,4),r=0,n=8;r<t;r++)o.set(e[r],n),n+=e[r].byteLength;return o}function iP(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,r;n=0,r=new Uint8Array;let o;n>0?(o=new Uint8Array(4),e.length>0&&new DataView(o.buffer).setUint32(0,e.length,!1)):o=new Uint8Array;const l=new Uint8Array(4);return t.byteLength>0&&new DataView(l.buffer).setUint32(0,t.byteLength,!1),sP([112,115,115,104],new Uint8Array([n,0,0,0]),i,o,r,l,t)}function rP(i){const e=[];if(i instanceof ArrayBuffer){const t=i.byteLength;let n=0;for(;n+32<t;){const r=new DataView(i,n),o=aP(r);e.push(o),n+=o.size}}return e}function aP(i){const e=i.getUint32(0),t=i.byteOffset,n=i.byteLength;if(n<e)return{offset:t,size:n};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};const o=i.getUint32(8)>>>24;if(o!==0&&o!==1)return{offset:t,size:e};const l=i.buffer,u=on(new Uint8Array(l,t+12,16));let f=null,d=null,m=0;if(o===0)m=28;else{const p=i.getUint32(28);if(!p||n<32+p*16)return{offset:t,size:e};f=[];for(let E=0;E<p;E++)f.push(new Uint8Array(l,t+32+E*16,16));m=32+p*16}if(!m)return{offset:t,size:e};const g=i.getUint32(m);return e-32<g?{offset:t,size:e}:(d=new Uint8Array(l,t+m+4,g),{version:o,systemId:u,kids:f,data:d,offset:t,size:e})}const tA=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Va={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Cg(i,e){const t=Va[e];return!!t&&!!t[i.slice(0,4)]}function rl(i,e,t=!0){return!i.split(",").some(n=>!Lg(n,e,t))}function Lg(i,e,t=!0){var n;const r=Qi(t);return(n=r?.isTypeSupported(al(i,e)))!=null?n:!1}function al(i,e){return`${e}/mp4;codecs=${i}`}function Gx(i){if(i){const e=i.substring(0,4);return Va.video[e]}return 2}function Iu(i){const e=tA();return i.split(",").reduce((t,n)=>{const o=e&&sd(n)?9:Va.video[n];return o?(o*2+t)/(t?3:2):(Va.audio[n]+t)/(t?2:1)},0)}const Gh={};function oP(i,e=!0){if(Gh[i])return Gh[i];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[i];for(let r=0;r<t.length;r++){var n;if(Lg(t[r],"audio",e))return Gh[i]=t[r],t[r];if(t[r]==="mp3"&&(n=Qi(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return i}const lP=/flac|opus|mp4a\.40\.34/i;function Nu(i,e=!0){return i.replace(lP,t=>oP(t.toLowerCase(),e))}function cP(i,e){const t=[];if(i){const n=i.split(",");for(let r=0;r<n.length;r++)Cg(n[r],"video")||t.push(n[r])}return e&&t.push(e),t.join(",")}function ou(i,e){if(i&&(i.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(i)!==-1)&&(zx(i,"audio")||zx(i,"video")))return i;if(e){const t=e.split(",");if(t.length>1){if(i){for(let n=t.length;n--;)if(t[n].substring(0,4)===i.substring(0,4))return t[n]}return t[0]}}return e||i}function zx(i,e){return Cg(i,e)&&Lg(i,e)}function uP(i){const e=i.split(",");for(let t=0;t<e.length;t++){const n=e[t].split(".");n.length>2&&n[0]==="avc1"&&(e[t]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return e.join(",")}function dP(i){if(i.startsWith("av01.")){const e=i.split("."),t=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=t[n-4];return e.join(".")}return i}function Hx(i){const e=Qi(i)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function bm(i){return i.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const fP={supported:!0,powerEfficient:!0,smooth:!0},hP={supported:!1,smooth:!1,powerEfficient:!1},nA={supported:!0,configurations:[],decodingInfoResults:[fP]};function sA(i,e){return{supported:!1,configurations:e,decodingInfoResults:[hP],error:i}}function mP(i,e,t,n,r,o){const l=i.videoCodec,u=i.audioCodec?i.audioGroups:null,f=o?.audioCodec,d=o?.channels,m=d?parseInt(d):f?1/0:2;let g=null;if(u!=null&&u.length)try{u.length===1&&u[0]?g=e.groups[u[0]].channels:g=u.reduce((p,E)=>{if(E){const S=e.groups[E];if(!S)throw new Error(`Audio track group ${E} not found`);Object.keys(S.channels).forEach(b=>{p[b]=(p[b]||0)+S.channels[b]})}return p},{2:0})}catch{return!0}return l!==void 0&&(l.split(",").some(p=>sd(p))||i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(r,8e6))||!!g&&ge(m)&&Object.keys(g).some(p=>parseInt(p)>m)}function iA(i,e,t,n={}){const r=i.videoCodec;if(!r&&!i.audioCodec||!t)return Promise.resolve(nA);const o=[],l=gP(i),u=l.length,f=pP(i,e,u>0),d=f.length;for(let m=u||1*d||1;m--;){const g={type:"media-source"};if(u&&(g.video=l[m%u]),d){g.audio=f[m%d];const p=g.audio.bitrate;g.video&&p&&(g.video.bitrate-=p)}o.push(g)}if(r){const m=navigator.userAgent;if(r.split(",").some(g=>sd(g))&&tA())return Promise.resolve(sA(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${m})`),o))}return Promise.all(o.map(m=>{const g=yP(m);return n[g]||(n[g]=t.decodingInfo(m))})).then(m=>({supported:!m.some(g=>!g.supported),configurations:o,decodingInfoResults:m})).catch(m=>({supported:!1,configurations:o,decodingInfoResults:[],error:m}))}function gP(i){var e;const t=(e=i.videoCodec)==null?void 0:e.split(","),n=rA(i),r=i.width||640,o=i.height||480,l=i.frameRate||30,u=i.videoRange.toLowerCase();return t?t.map(f=>{const d={contentType:al(dP(f),"video"),width:r,height:o,bitrate:n,framerate:l};return u!=="sdr"&&(d.transferFunction=u),d}):[]}function pP(i,e,t){var n;const r=(n=i.audioCodec)==null?void 0:n.split(","),o=rA(i);return r&&i.audioGroups?i.audioGroups.reduce((l,u)=>{var f;const d=u?(f=e.groups[u])==null?void 0:f.tracks:null;return d?d.reduce((m,g)=>{if(g.groupId===u){const p=parseFloat(g.channels||"");r.forEach(E=>{const S={contentType:al(E,"audio"),bitrate:t?vP(E,o):o};p&&(S.channels=""+p),m.push(S)})}return m},l):l},[]):[]}function vP(i,e){if(e<=1)return 1;let t=128e3;return i==="ec-3"?t=768e3:i==="ac-3"&&(t=64e4),Math.min(e/2,t)}function rA(i){return Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)/1e3)*1e3||1}function yP(i){let e="";const{audio:t,video:n}=i;if(n){const r=bm(n.contentType);e+=`${r}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(t){const r=bm(t.contentType);e+=`${n?"_":""}${r}_c${t.channels}`}return e}const Tm=["NONE","TYPE-0","TYPE-1",null];function xP(i){return Tm.indexOf(i)>-1}const Ou=["SDR","PQ","HLG"];function EP(i){return!!i&&Ou.indexOf(i)>-1}var lu={No:"",Yes:"YES",v2:"v2"};function Vx(i){const{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,r=n<e/2;return e&&r?t?lu.v2:lu.Yes:lu.No}class Kx{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class ol{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const n=(t=e.supplemental)==null?void 0:t.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return Yx(this._audioGroups,e)}hasSubtitleGroup(e){return Yx(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function Yx(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function SP(){if(typeof matchMedia=="function"){const i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function bP(i,e){let t=!1,n=[];if(i&&(t=i!=="SDR",n=[i]),e){n=e.allowedVideoRanges||Ou.slice(0);const r=n.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:r&&SP(),t||(n=["SDR"])}return{preferHDR:t,allowedVideoRanges:n}}const TP=i=>{const e=new WeakSet;return(t,n)=>{if(i&&(n=i(t,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},pt=(i,e)=>JSON.stringify(i,TP(e));function AP(i,e,t,n,r){const o=Object.keys(i),l=n?.channels,u=n?.audioCodec,f=r?.videoCodec,d=l&&parseInt(l)===2;let m=!1,g=!1,p=1/0,E=1/0,S=1/0,b=1/0,T=0,A=[];const{preferHDR:_,allowedVideoRanges:w}=bP(e,r);for(let U=o.length;U--;){const k=i[o[U]];m||(m=k.channels[2]>0),p=Math.min(p,k.minHeight),E=Math.min(E,k.minFramerate),S=Math.min(S,k.minBitrate),w.filter(H=>k.videoRanges[H]>0).length>0&&(g=!0)}p=ge(p)?p:0,E=ge(E)?E:0;const D=Math.max(1080,p),O=Math.max(30,E);S=ge(S)?S:t,t=Math.max(S,t),g||(e=void 0);const B=o.length>1;return{codecSet:o.reduce((U,k)=>{const F=i[k];if(k===U)return U;if(A=g?w.filter(H=>F.videoRanges[H]>0):[],B){if(F.minBitrate>t)return _s(k,`min bitrate of ${F.minBitrate} > current estimate of ${t}`),U;if(!F.hasDefaultAudio)return _s(k,"no renditions with default or auto-select sound found"),U;if(u&&k.indexOf(u.substring(0,4))%5!==0)return _s(k,`audio codec preference "${u}" not found`),U;if(l&&!d){if(!F.channels[l])return _s(k,`no renditions with ${l} channel sound found (channels options: ${Object.keys(F.channels)})`),U}else if((!u||d)&&m&&F.channels[2]===0)return _s(k,"no renditions with stereo sound found"),U;if(F.minHeight>D)return _s(k,`min resolution of ${F.minHeight} > maximum of ${D}`),U;if(F.minFramerate>O)return _s(k,`min framerate of ${F.minFramerate} > maximum of ${O}`),U;if(!A.some(H=>F.videoRanges[H]>0))return _s(k,`no variants with VIDEO-RANGE of ${pt(A)} found`),U;if(f&&k.indexOf(f.substring(0,4))%5!==0)return _s(k,`video codec preference "${f}" not found`),U;if(F.maxScore<T)return _s(k,`max score of ${F.maxScore} < selected max of ${T}`),U}return U&&(Iu(k)>=Iu(U)||F.fragmentError>i[U].fragmentError)?U:(b=F.minIndex,T=F.maxScore,k)},void 0),videoRanges:A,preferHDR:_,minFramerate:E,minBitrate:S,minIndex:b}}function _s(i,e){lt.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function aA(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);const r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function RP(i,e,t,n){return i.slice(t,n+1).reduce((r,o,l)=>{if(!o.codecSet)return r;const u=o.audioGroups;let f=r[o.codecSet];f||(r[o.codecSet]=f={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:l,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!u,fragmentError:0}),f.minBitrate=Math.min(f.minBitrate,o.bitrate);const d=Math.min(o.height,o.width);return f.minHeight=Math.min(f.minHeight,d),f.minFramerate=Math.min(f.minFramerate,o.frameRate),f.minIndex=Math.min(f.minIndex,l),f.maxScore=Math.max(f.maxScore,o.score),f.fragmentError+=o.fragmentError,f.videoRanges[o.videoRange]=(f.videoRanges[o.videoRange]||0)+1,u&&u.forEach(m=>{if(!m)return;const g=e.groups[m];g&&(f.hasDefaultAudio=f.hasDefaultAudio||e.hasDefaultAudio?g.hasDefault:g.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(g.channels).forEach(p=>{f.channels[p]=(f.channels[p]||0)+g.channels[p]}))}),r},{})}function qx(i){if(!i)return i;const{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:o}=i;return{lang:e,assocLang:t,characteristics:n,channels:r,audioCodec:o}}function Ms(i,e,t){if("attrs"in i){const n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){const r=e[n];if(Lr(i,r,t))return n}return-1}function Lr(i,e,t){const{groupId:n,name:r,lang:o,assocLang:l,default:u}=i,f=i.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(o===void 0||CP(o,e.lang))&&(o===void 0||e.assocLang===l)&&(u===void 0||e.default===u)&&(f===void 0||e.forced===f)&&(!("characteristics"in i)||LP(i.characteristics||"",e.characteristics))&&(t===void 0||t(i,e))}function CP(i,e="--"){return i.length===e.length?i===e:i.startsWith(e)||e.startsWith(i)}function LP(i,e=""){const t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function Rr(i,e){const{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function _P(i,e,t,n,r){const o=e[n],u=e.reduce((p,E,S)=>{const b=E.uri;return(p[b]||(p[b]=[])).push(S),p},{})[o.uri];u.length>1&&(n=Math.max.apply(Math,u));const f=o.videoRange,d=o.frameRate,m=o.codecSet.substring(0,4),g=Xx(e,n,p=>{if(p.videoRange!==f||p.frameRate!==d||p.codecSet.substring(0,4)!==m)return!1;const E=p.audioGroups,S=t.filter(b=>!E||E.indexOf(b.groupId)!==-1);return Ms(i,S,r)>-1});return g>-1?g:Xx(e,n,p=>{const E=p.audioGroups,S=t.filter(b=>!E||E.indexOf(b.groupId)!==-1);return Ms(i,S,r)>-1})}function Xx(i,e,t){for(let n=e;n>-1;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}function Mu(i,e){var t;return!!i&&i!==((t=e.loadLevelObj)==null?void 0:t.uri)}class wP extends cs{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var n;const{fragCurrent:r,partCurrent:o,hls:l}=this,{autoLevelEnabled:u,media:f}=l;if(!r||!f)return;const d=performance.now(),m=o?o.stats:r.stats,g=o?o.duration:r.duration,p=d-m.loading.start,E=l.minAutoLevel,S=r.level,b=this._nextAutoLevel;if(m.aborted||m.loaded&&m.loaded===m.total||S<=E){this.clearTimer(),this._nextAutoLevel=-1;return}if(!u)return;const T=b>-1&&b!==S,A=!!t||T;if(!A&&(f.paused||!f.playbackRate||!f.readyState))return;const _=l.mainForwardBufferInfo;if(!A&&_===null)return;const w=this.bwEstimator.getEstimateTTFB(),D=Math.abs(f.playbackRate);if(p<=Math.max(w,1e3*(g/(D*2))))return;const O=_?_.len/D:0,B=m.loading.first?m.loading.first-m.loading.start:-1,N=m.loaded&&B>-1,U=this.getBwEstimate(),k=l.levels,F=k[S],H=Math.max(m.loaded,Math.round(g*(r.bitrate||F.averageBitrate)/8));let ne=N?p-B:p;ne<1&&N&&(ne=Math.min(p,m.loaded*8/U));const J=N?m.loaded*1e3/ne:0,le=w/1e3,de=J?(H-m.loaded)/J:H*8/U+le;if(de<=O)return;const P=J?J*8:U,K=((n=t?.details||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,j=this.hls.config.abrBandWidthUpFactor;let W=Number.POSITIVE_INFINITY,he;for(he=S-1;he>E;he--){const V=k[he].maxBitrate,se=!k[he].details||K;if(W=this.getTimeToLoadFrag(le,P,g*V,se),W<Math.min(O,g+le))break}if(W>=de||W>g*10)return;N?this.bwEstimator.sample(p-Math.min(w,B),m.loaded):this.bwEstimator.sampleTTFB(p);const M=k[he].maxBitrate;this.getBwEstimate()*j>M&&this.resetEstimator(M);const G=this.findBestLevel(M,E,he,0,O,1,1);G>-1&&(he=G),this.warn(`Fragment ${r.sn}${o?" part "+o.index:""} of level ${S} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${O.toFixed(3)} s
      Estimated load time for current fragment: ${de.toFixed(3)} s
      Estimated load time for down switch fragment: ${W.toFixed(3)} s
      TTFB estimate: ${B|0} ms
      Current BW estimate: ${ge(U)?U|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${he} @ ${M|0} bps`),l.nextLoadLevel=l.nextAutoLevel=he,this.clearTimer();const te=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===he&&he>0){const V=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${he>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${V.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,he>E){let se=this.findBestLevel(this.hls.levels[E].bitrate,E,he,0,V,1,1);se===-1&&(se=E),this.hls.nextLoadLevel=this.hls.nextAutoLevel=se,this.resetEstimator(this.hls.levels[se].bitrate)}}};T||de>W*2?te():this.timer=self.setInterval(te,W*1e3),l.trigger(L.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:o,stats:m})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new Mk(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(L.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case X.FRAG_LOAD_TIMEOUT:{const n=t.frag,{fragCurrent:r,partCurrent:o}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){const l=performance.now(),u=o?o.stats:n.stats,f=l-u.loading.start,d=u.loading.first?u.loading.first-u.loading.start:-1;if(u.loaded&&d>-1){const g=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(f-Math.min(g,d),u.loaded)}else this.bwEstimator.sampleTTFB(f)}break}}}getTimeToLoadFrag(e,t,n,r){const o=e+n/t,l=r?e+this.lastLevelLoadSec:0;return o+l}onLevelLoaded(e,t){const n=this.hls.config,{loading:r}=t.stats,o=r.end-r.first;ge(o)&&(this.lastLevelLoadSec=o/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:n}){const r=n?n.stats:t.stats;if(t.type===pe.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const o=n?n.duration:t.duration,l=this.hls.levels[t.level],u=(l.loaded?l.loaded.bytes:0)+r.loaded,f=(l.loaded?l.loaded.duration:0)+o;l.loaded={bytes:u,duration:f},l.realBitrate=Math.round(8*u/f)}if(t.bitrateTest){const o={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(L.FRAG_BUFFERED,o),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:n,part:r}=t,o=r!=null&&r.stats.loaded?r.stats:n.stats;if(o.aborted||this.ignoreFragment(n))return;const l=o.parsing.end-o.loading.start-Math.min(o.loading.first-o.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(l,o.loaded),o.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=l/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==pe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,o=this.findBestLevel(n,t,e,0,r,1,1);if(o>-1)return o;const l=this.hls.firstLevel,u=Math.min(Math.max(l,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${l} clamped to ${u}`),u}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const o=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const l=this.hls.levels;if(l.length>Math.max(e,o)&&l[e].loadError<=l[o].loadError)return e}return this._nextAutoLevel=o,this.nextAutoLevelKey=this.getAutoLevelKey(),o}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:r,config:o,minAutoLevel:l}=n,u=t?t.duration:e?e.duration:0,f=this.getBwEstimate(),d=this.getStarvationDelay();let m=o.abrBandWidthFactor,g=o.abrBandWidthUpFactor;if(d){const T=this.findBestLevel(f,l,r,d,0,m,g);if(T>=0)return this.rebufferNotice=-1,T}let p=u?Math.min(u,o.maxStarvationDelay):o.maxStarvationDelay;if(!d){const T=this.bitrateTestDelay;T&&(p=(u?Math.min(u,o.maxLoadingDelay):o.maxLoadingDelay)-T,this.info(`bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),m=g=1)}const E=this.findBestLevel(f,l,r,d,p,m,g);if(this.rebufferNotice!==E&&(this.rebufferNotice=E,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${E}`)),E>-1)return E;const S=n.levels[l],b=n.loadLevelObj;return b&&S?.bitrate<b.bitrate?l:n.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,o,l,u){var f;const d=r+o,m=this.lastLoadedFragLevel,g=m===-1?this.hls.firstLevel:m,{fragCurrent:p,partCurrent:E}=this,{levels:S,allAudioTracks:b,loadLevel:T,config:A}=this.hls;if(S.length===1)return 0;const _=S[g],w=!!((f=this.hls.latestLevelDetails)!=null&&f.live),D=T===-1||m===-1;let O,B="SDR",N=_?.frameRate||0;const{audioPreference:U,videoPreference:k}=A,F=this.audioTracksByGroup||(this.audioTracksByGroup=aA(b));let H=-1;if(D){if(this.firstSelection!==-1)return this.firstSelection;const P=this.codecTiers||(this.codecTiers=RP(S,F,t,n)),K=AP(P,B,e,U,k),{codecSet:j,videoRanges:W,minFramerate:he,minBitrate:M,minIndex:G,preferHDR:te}=K;H=G,O=j,B=te?W[W.length-1]:W[0],N=he,e=Math.max(e,M),this.log(`picked start tier ${pt(K)}`)}else O=_?.codecSet,B=_?.videoRange;const ne=E?E.duration:p?p.duration:0,J=this.bwEstimator.getEstimateTTFB()/1e3,le=[];for(let P=n;P>=t;P--){var de;const K=S[P],j=P>g;if(!K)continue;if(A.useMediaCapabilities&&!K.supportedResult&&!K.supportedPromise){const se=navigator.mediaCapabilities;typeof se?.decodingInfo=="function"&&mP(K,F,B,N,e,U)?(K.supportedPromise=iA(K,F,se,this.supportedCache),K.supportedPromise.then(ce=>{if(!this.hls)return;K.supportedResult=ce;const fe=this.hls.levels,ve=fe.indexOf(K);ce.error?this.warn(`MediaCapabilities decodingInfo error: "${ce.error}" for level ${ve} ${pt(ce)}`):ce.supported?ce.decodingInfoResults.some(Ae=>Ae.smooth===!1||Ae.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${ve} not smooth or powerEfficient: ${pt(ce)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${ve} ${pt(ce)}`),ve>-1&&fe.length>1&&(this.log(`Removing unsupported level ${ve}`),this.hls.removeLevel(ve),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(ce=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${ce}`)})):K.supportedResult=nA}if((O&&K.codecSet!==O||B&&K.videoRange!==B||j&&N>K.frameRate||!j&&N>0&&N<K.frameRate||(de=K.supportedResult)!=null&&(de=de.decodingInfoResults)!=null&&de.some(se=>se.smooth===!1))&&(!D||P!==H)){le.push(P);continue}const W=K.details,he=(E?W?.partTarget:W?.averagetargetduration)||ne;let M;j?M=u*e:M=l*e;const G=ne&&r>=ne*2&&o===0?K.averageBitrate:K.maxBitrate,te=this.getTimeToLoadFrag(J,M,G*he,W===void 0);if(M>=G&&(P===m||K.loadError===0&&K.fragmentError===0)&&(te<=J||!ge(te)||w&&!this.bitrateTestDelay||te<d)){const se=this.forcedAutoLevel;return P!==T&&(se===-1||se!==T)&&(le.length&&this.trace(`Skipped level(s) ${le.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${S[le[0]].codecs}" ${S[le[0]].videoRange}; not compatible with "${O}" ${B}`),this.info(`switch candidate:${g}->${P} adjustedbw(${Math.round(M)})-bitrate=${Math.round(M-G)} ttfb:${J.toFixed(1)} avgDuration:${he.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${te.toFixed(1)} firstSelection:${D} codecSet:${K.codecSet} videoRange:${K.videoRange} hls.loadLevel:${T}`)),D&&(this.firstSelection=P),P}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),t)}}const oA={search:function(i,e){let t=0,n=i.length-1,r=null,o=null;for(;t<=n;){r=(t+n)/2|0,o=i[r];const l=e(o);if(l>0)t=r+1;else if(l<0)n=r-1;else return o}return null}};function DP(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!ge(e))return null;const n=i[0].programDateTime;if(e<(n||0))return null;const r=i[i.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let o=0;o<i.length;++o){const l=i[o];if(NP(e,t,l))return l}return null}function Nr(i,e,t=0,n=0,r=.005){let o=null;if(i){o=e[1+i.sn-e[0].sn]||null;const u=i.endDTS-t;u>0&&u<15e-7&&(t+=15e-7),o&&i.level!==o.level&&o.end<=i.end&&(o=e[2+i.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(o=e[0]);if(o&&((!i||i.level===o.level)&&Wx(t,n,o)===0||IP(o,i,Math.min(r,n))))return o;const l=oA.search(e,Wx.bind(null,t,n));return l&&(l!==i||!o)?l:o}function IP(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((r,o)=>(o[0]==="INF"&&(r+=parseFloat(o[1])),r),t);return i.start<=n}return!1}function Wx(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function NP(i,e,t){const n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function lA(i,e,t){if(i&&i.startCC<=e&&i.endCC>=e){let n=i.fragments;const{fragmentHint:r}=i;r&&(n=n.concat(r));let o;return oA.search(n,l=>l.cc<e?1:l.cc>e?-1:(o=l,l.end<=t?1:l.start>t?-1:0)),o||null}return null}function ku(i){switch(i.details){case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_TIMEOUT:case X.LEVEL_LOAD_TIMEOUT:case X.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function cA(i){return i.details.startsWith("key")}function uA(i){return cA(i)&&!!i.frag&&!i.frag.decryptdata}function Qx(i,e){const t=ku(e);return i.default[`${t?"timeout":"error"}Retry`]}function _g(i,e){const t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function Zx(i){return ot(ot({},i),{errorRetry:null,timeoutRetry:null})}function Pu(i,e,t,n){if(!i)return!1;const r=n?.code,o=e<i.maxNumRetry&&(OP(r)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,o):o}function OP(i){return Am(i)||!!i&&(i<400||i>499)}function Am(i){return i===0&&navigator.onLine===!1}var an={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},$n={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class MP extends cs{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.ERROR,this.onError,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.ERROR,this.onError,this),e.off(L.ERROR,this.onErrorOut,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===pe.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const t=this.hls,n=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||n===-1?t.loadLevel:n}variantHasKey(e,t){if(e){var n;if((n=e.details)!=null&&n.hasKey(t))return!0;const r=e.audioGroups;if(r)return this.hls.allAudioTracks.filter(l=>r.indexOf(l.groupId)>=0).some(l=>{var u;return(u=l.details)==null?void 0:u.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var n;if(t.fatal)return;const r=this.hls,o=t.context;switch(t.details){case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case X.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction=Ba();return}case X.FRAG_GAP:case X.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=an.SendAlternateToPenaltyBox;return}case X.LEVEL_EMPTY_ERROR:case X.LEVEL_PARSING_ERROR:{var l;const f=t.parent===pe.MAIN?t.level:r.loadLevel;t.details===X.LEVEL_EMPTY_ERROR&&((l=t.context)!=null&&(l=l.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,f):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,f))}return;case X.LEVEL_LOAD_ERROR:case X.LEVEL_LOAD_TIMEOUT:typeof o?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case X.AUDIO_TRACK_LOAD_ERROR:case X.AUDIO_TRACK_LOAD_TIMEOUT:case X.SUBTITLE_LOAD_ERROR:case X.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const f=r.loadLevelObj;if(f&&(o.type===Ge.AUDIO_TRACK&&f.hasAudioGroup(o.groupId)||o.type===Ge.SUBTITLE_TRACK&&f.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=an.SendAlternateToPenaltyBox,t.errorAction.flags=$n.MoveAllAlternatesMatchingHost;return}}return;case X.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:an.SendAlternateToPenaltyBox,flags:$n.MoveAllAlternatesMatchingHDCP};return;case X.KEY_SYSTEM_SESSION_UPDATE_FAILED:case X.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case X.KEY_SYSTEM_NO_SESSION:t.errorAction={action:an.SendAlternateToPenaltyBox,flags:$n.MoveAllAlternatesMatchingKey};return;case X.BUFFER_ADD_CODEC_ERROR:case X.REMUX_ALLOC_ERROR:case X.BUFFER_APPEND_ERROR:if(!t.errorAction){var u;t.errorAction=this.getLevelSwitchAction(t,(u=t.level)!=null?u:r.loadLevel)}return;case X.INTERNAL_EXCEPTION:case X.BUFFER_APPENDING_ERROR:case X.BUFFER_FULL_ERROR:case X.LEVEL_SWITCH_ERROR:case X.BUFFER_STALLED_ERROR:case X.BUFFER_SEEK_OVER_HOLE:case X.BUFFER_NUDGE_ON_STALL:t.errorAction=Ba();return}t.type===Te.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Ba())}getPlaylistRetryOrSwitchAction(e,t){const n=this.hls,r=Qx(n.config.playlistLoadPolicy,e),o=this.playlistError++;if(Pu(r,o,ku(e),e.response))return{action:an.RetryRequest,flags:$n.None,retryConfig:r,retryCount:o};const u=this.getLevelSwitchAction(e,t);return r&&(u.retryConfig=r,u.retryCount=o),u}getFragRetryOrSwitchAction(e){const t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:o,keyLoadPolicy:l}=t.config,u=Qx(cA(e)?l:o,e),f=t.levels.reduce((m,g)=>m+g.fragmentError,0);if(r&&(e.details!==X.FRAG_GAP&&r.fragmentError++,!uA(e)&&Pu(u,f,ku(e),e.response)))return{action:an.RetryRequest,flags:$n.None,retryConfig:u,retryCount:f};const d=this.getLevelSwitchAction(e,n);return u&&(d.retryConfig=u,d.retryCount=f),d}getLevelSwitchAction(e,t){const n=this.hls;t==null&&(t=n.loadLevel);const r=this.hls.levels[t];if(r){var o,l;const d=e.details;r.loadError++,d===X.BUFFER_APPEND_ERROR&&r.fragmentError++;let m=-1;const{levels:g,loadLevel:p,minAutoLevel:E,maxAutoLevel:S}=n;!n.autoLevelEnabled&&!n.config.preserveManualLevelOnError&&(n.loadLevel=-1);const b=(o=e.frag)==null?void 0:o.type,A=(b===pe.AUDIO&&d===X.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(d===X.BUFFER_ADD_CODEC_ERROR||d===X.BUFFER_APPEND_ERROR))&&g.some(({audioCodec:B})=>r.audioCodec!==B),w=e.sourceBufferName==="video"&&(d===X.BUFFER_ADD_CODEC_ERROR||d===X.BUFFER_APPEND_ERROR)&&g.some(({codecSet:B,audioCodec:N})=>r.codecSet!==B&&r.audioCodec===N),{type:D,groupId:O}=(l=e.context)!=null?l:{};for(let B=g.length;B--;){const N=(B+p)%g.length;if(N!==p&&N>=E&&N<=S&&g[N].loadError===0){var u,f;const U=g[N];if(d===X.FRAG_GAP&&b===pe.MAIN&&e.frag){const k=g[N].details;if(k){const F=Nr(e.frag,k.fragments,e.frag.start);if(F!=null&&F.gap)continue}}else{if(D===Ge.AUDIO_TRACK&&U.hasAudioGroup(O)||D===Ge.SUBTITLE_TRACK&&U.hasSubtitleGroup(O))continue;if(b===pe.AUDIO&&(u=r.audioGroups)!=null&&u.some(k=>U.hasAudioGroup(k))||b===pe.SUBTITLE&&(f=r.subtitleGroups)!=null&&f.some(k=>U.hasSubtitleGroup(k))||A&&r.audioCodec===U.audioCodec||w&&r.codecSet===U.codecSet||!A&&r.codecSet!==U.codecSet)continue}m=N;break}}if(m>-1&&n.loadLevel!==m)return e.levelRetry=!0,this.playlistError=0,{action:an.SendAlternateToPenaltyBox,flags:$n.None,nextAutoLevel:m}}return{action:an.SendAlternateToPenaltyBox,flags:$n.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case an.DoNothing:break;case an.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==X.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,n=e.errorAction;if(!n)return;const{flags:r}=n,o=n.nextAutoLevel;switch(r){case $n.None:this.switchLevel(e,o);break;case $n.MoveAllAlternatesMatchingHDCP:{const f=this.getVariantLevelIndex(e.frag),d=t.levels[f],m=d?.attrs["HDCP-LEVEL"];if(n.hdcpLevel=m,m==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(m){t.maxHdcpLevel=Tm[Tm.indexOf(m)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case $n.MoveAllAlternatesMatchingKey:{const f=e.decryptdata;if(f){const d=this.hls.levels,m=d.length;for(let p=m;p--;)if(this.variantHasKey(d[p],f)){var l,u;this.log(`Banned key found in level ${p} (${d[p].bitrate}bps) or audio group "${(l=d[p].audioGroups)==null?void 0:l.join(",")}" (${(u=e.frag)==null?void 0:u.type} fragment) ${on(f.keyId||[])}`),d[p].fragmentError++,d[p].loadError++,this.log(`Removing level ${p} with key error (${e.error})`),this.hls.removeLevel(p)}const g=e.frag;if(this.hls.levels.length<m)n.resolved=!0;else if(g&&g.type!==pe.MAIN){const p=g.decryptdata;p&&!f.matches(p)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===X.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=bm(e.mimeType),r=this.hls.levels;for(let o=r.length;o--;)r[o][`${e.sourceBufferName}Codec`]===n&&(this.log(`Removing level ${o} for ${e.details} ("${n}" not supported)`),this.hls.removeLevel(o))}}}function Ba(i){const e={action:an.DoNothing,flags:$n.None};return i&&(e.resolved=!0),e}var Xt={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class kP{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const n=this.activePartLists[t];if(n)for(let r=n.length;r--;){const o=n[r];if(!o)break;if(o.start<=e&&e<=o.end&&o.loaded)return o}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,n){const{fragments:r}=this,o=Object.keys(r);for(let l=o.length;l--;){const u=r[o[l]];if(u?.body.type===t&&(!n||u.buffered)){const f=u.body;if(f.start<=e&&e<=f.end)return f}}return null}detectEvictedFragments(e,t,n,r,o){this.timeRanges&&(this.timeRanges[e]=t);const l=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(u=>{const f=this.fragments[u];if(!f||l>=f.body.sn)return;if(!f.buffered&&(!f.loaded||o)){f.body.type===n&&this.removeFragment(f.body);return}const d=f.range[e];if(d){if(d.time.length===0){this.removeFragment(f.body);return}d.time.some(m=>{const g=!this.isTimeBuffered(m.startPTS,m.endPTS,t);return g&&this.removeFragment(f.body),g})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const n=e.frag,r=wa(n),o=this.fragments[r];if(!o||o.buffered&&n.gap)return;const l=!n.relurl;Object.keys(t).forEach(u=>{const f=n.elementaryStreams[u];if(!f)return;const d=t[u],m=l||f.partial===!0;o.range[u]=this.getBufferedTimes(n,e.part,m,d)}),o.loaded=null,Object.keys(o.range).length?(this.bufferedEnd(o,n),Hc(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}bufferedEnd(e,t){e.buffered=!0,(e.body.endList=t.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,t){const n=this.activePartLists[t];n&&(this.activePartLists[t]=Jx(n,r=>r.fragment.sn>=e))}fragBuffered(e,t){const n=wa(e);let r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,this.bufferedEnd(r,e))}getBufferedTimes(e,t,n,r){const o={time:[],partial:n},l=e.start,u=e.end,f=e.minEndPTS||u,d=e.maxStartPTS||l;for(let m=0;m<r.length;m++){const g=r.start(m)-this.bufferPadding,p=r.end(m)+this.bufferPadding;if(d>=g&&f<=p){o.time.push({startPTS:Math.max(l,r.start(m)),endPTS:Math.min(u,r.end(m))});break}else if(l<p&&u>g){const E=Math.max(l,r.start(m)),S=Math.min(u,r.end(m));S>E&&(o.partial=!0,o.time.push({startPTS:E,endPTS:S}))}else if(u<=g)break}return o}getPartialFragment(e){let t=null,n,r,o,l=0;const{bufferPadding:u,fragments:f}=this;return Object.keys(f).forEach(d=>{const m=f[d];m&&Hc(m)&&(r=m.body.start-u,o=m.body.end+u,e>=r&&e<=o&&(n=Math.min(e-r,o-e),l<=n&&(t=m.body,l=n)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||Hc(t))}getState(e){const t=wa(e),n=this.fragments[t];return n?n.buffered?Hc(n)?Xt.PARTIAL:Xt.OK:Xt.APPENDING:Xt.NOT_LOADED}isTimeBuffered(e,t,n){let r,o;for(let l=0;l<n.length;l++){if(r=n.start(l)-this.bufferPadding,o=n.end(l)+this.bufferPadding,e>=r&&t<=o)return!0;if(t<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const n=t.frag,r=t.part?null:t,o=wa(n);this.fragments[o]={body:n,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:n,part:r,timeRanges:o,type:l}=t;if(n.sn==="initSegment")return;const u=n.type;if(r){let d=this.activePartLists[u];d||(this.activePartLists[u]=d=[]),d.push(r)}this.timeRanges=o;const f=o[l];this.detectEvictedFragments(l,f,u,r)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=wa(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,n=Object.keys(t);if(!e)return n.length>0;for(let r=n.length;r--;){const o=t[n[r]];if(o?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,o){r&&!this.hasGaps||Object.keys(this.fragments).forEach(l=>{const u=this.fragments[l];if(!u)return;const f=u.body;f.type!==n||r&&!f.gap||f.start<t&&f.end>e&&(u.buffered||o)&&this.removeFragment(f)})}removeFragment(e){const t=wa(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const r=e.sn;this.activePartLists[e.type]=Jx(n,o=>o.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(n=>n.clearElementaryStreamInfo())}}function Hc(i){var e,t,n;return i.buffered&&!!(i.body.gap||(e=i.range.video)!=null&&e.partial||(t=i.range.audio)!=null&&t.partial||(n=i.range.audiovideo)!=null&&n.partial)}function wa(i){return`${i.type}_${i.level}_${i.sn}`}function Jx(i,e){return i.filter(t=>{const n=e(t);return n||t.clearElementaryStreamInfo(),n})}var Zi={cbc:0,ctr:1};class PP{constructor(e,t,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=n}decrypt(e,t){switch(this.aesMode){case Zi.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Zi.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function UP(i){const e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?i.slice(0,e-t):i}class FP{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){const e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],o=n[1],l=n[2],u=n[3],f=this.invSubMix,d=f[0],m=f[1],g=f[2],p=f[3],E=new Uint32Array(256);let S=0,b=0,T=0;for(T=0;T<256;T++)T<128?E[T]=T<<1:E[T]=T<<1^283;for(T=0;T<256;T++){let A=b^b<<1^b<<2^b<<3^b<<4;A=A>>>8^A&255^99,e[S]=A,t[A]=S;const _=E[S],w=E[_],D=E[w];let O=E[A]*257^A*16843008;r[S]=O<<24|O>>>8,o[S]=O<<16|O>>>16,l[S]=O<<8|O>>>24,u[S]=O,O=D*16843009^w*65537^_*257^S*16843008,d[A]=O<<24|O>>>8,m[A]=O<<16|O>>>16,g[A]=O<<8|O>>>24,p[A]=O,S?(S=_^E[E[E[D^_]]],b^=E[E[b]]):S=b=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;const o=this.keySize=t.length;if(o!==4&&o!==6&&o!==8)throw new Error("Invalid aes key size="+o);const l=this.ksRows=(o+6+1)*4;let u,f;const d=this.keySchedule=new Uint32Array(l),m=this.invKeySchedule=new Uint32Array(l),g=this.sBox,p=this.rcon,E=this.invSubMix,S=E[0],b=E[1],T=E[2],A=E[3];let _,w;for(u=0;u<l;u++){if(u<o){_=d[u]=t[u];continue}w=_,u%o===0?(w=w<<8|w>>>24,w=g[w>>>24]<<24|g[w>>>16&255]<<16|g[w>>>8&255]<<8|g[w&255],w^=p[u/o|0]<<24):o>6&&u%o===4&&(w=g[w>>>24]<<24|g[w>>>16&255]<<16|g[w>>>8&255]<<8|g[w&255]),d[u]=_=(d[u-o]^w)>>>0}for(f=0;f<l;f++)u=l-f,f&3?w=d[u]:w=d[u-4],f<4||u<=4?m[f]=w:m[f]=S[g[w>>>24]]^b[g[w>>>16&255]]^T[g[w>>>8&255]]^A[g[w&255]],m[f]=m[f]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){const r=this.keySize+6,o=this.invKeySchedule,l=this.invSBox,u=this.invSubMix,f=u[0],d=u[1],m=u[2],g=u[3],p=this.uint8ArrayToUint32Array_(n);let E=p[0],S=p[1],b=p[2],T=p[3];const A=new Int32Array(e),_=new Int32Array(A.length);let w,D,O,B,N,U,k,F,H,ne,J,le,de,P;const K=this.networkToHostOrderSwap;for(;t<A.length;){for(H=K(A[t]),ne=K(A[t+1]),J=K(A[t+2]),le=K(A[t+3]),N=H^o[0],U=le^o[1],k=J^o[2],F=ne^o[3],de=4,P=1;P<r;P++)w=f[N>>>24]^d[U>>16&255]^m[k>>8&255]^g[F&255]^o[de],D=f[U>>>24]^d[k>>16&255]^m[F>>8&255]^g[N&255]^o[de+1],O=f[k>>>24]^d[F>>16&255]^m[N>>8&255]^g[U&255]^o[de+2],B=f[F>>>24]^d[N>>16&255]^m[U>>8&255]^g[k&255]^o[de+3],N=w,U=D,k=O,F=B,de=de+4;w=l[N>>>24]<<24^l[U>>16&255]<<16^l[k>>8&255]<<8^l[F&255]^o[de],D=l[U>>>24]<<24^l[k>>16&255]<<16^l[F>>8&255]<<8^l[N&255]^o[de+1],O=l[k>>>24]<<24^l[F>>16&255]<<16^l[N>>8&255]<<8^l[U&255]^o[de+2],B=l[F>>>24]<<24^l[N>>16&255]<<16^l[U>>8&255]<<8^l[k&255]^o[de+3],_[t]=K(w^E),_[t+1]=K(B^S),_[t+2]=K(O^b),_[t+3]=K(D^T),E=H,S=ne,b=J,T=le,t=t+4}return _.buffer}}class BP{constructor(e,t,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=n}expandKey(){const e=jP(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function jP(i){switch(i){case Zi.cbc:return"AES-CBC";case Zi.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${i}`)}}const $P=16;class wg{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?UP(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n,r){return this.useSoftware?new Promise((o,l)=>{const u=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(u,t,n,r);const f=this.flush();f?o(f.buffer):l(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n,r)}softwareDecrypt(e,t,n,r){const{currentIV:o,currentResult:l,remainderData:u}=this;if(r!==Zi.cbc||t.byteLength!==16)return lt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),u&&(e=as(u,e),this.remainderData=null);const f=this.getValidChunk(e);if(!f.length)return null;o&&(n=o);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new FP),d.expandKey(t);const m=l;return this.currentResult=d.decrypt(f.buffer,0,n),this.currentIV=f.slice(-16).buffer,m||null}webCryptoDecrypt(e,t,n,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n,r));this.key=t,this.fastAesKey=new BP(this.subtle,t,r)}return this.fastAesKey.expandKey().then(o=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new PP(this.subtle,new Uint8Array(n),r).decrypt(e.buffer,o)):Promise.reject(new Error("web crypto not initialized"))).catch(o=>(lt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${o.name}: ${o.message}`),this.onWebCryptoError(e,t,n,r)))}onWebCryptoError(e,t,n,r){const o=this.enableSoftwareAES;if(o){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n,r);const l=this.flush();if(l)return l.buffer}throw new Error("WebCrypto"+(o?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const n=e.length-e.length%$P;return n!==e.length&&(t=e.slice(0,n),this.remainderData=e.slice(n)),t}logOnce(e){this.logEnabled&&(lt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const eE=Math.pow(2,17);class GP{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const n=e.url;if(!n)return Promise.reject(new ui({type:Te.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,o=r.fLoader,l=r.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(S=>S[0]==="GAP")){f(nE(e));return}else e.gap=!1;const d=this.loader=o?new o(r):new l(r),m=tE(e);e.loader=d;const g=Zx(r.fragLoadPolicy.default),p={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:eE};e.stats=d.stats;const E={onSuccess:(S,b,T,A)=>{this.resetLoader(e,d);let _=S.data;T.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(_.slice(0,16)),_=_.slice(16)),u({frag:e,part:null,payload:_,networkDetails:A})},onError:(S,b,T,A)=>{this.resetLoader(e,d),f(new ui({type:Te.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:ot({url:n,data:void 0},S),error:new Error(`HTTP Error ${S.code} ${S.text}`),networkDetails:T,stats:A}))},onAbort:(S,b,T)=>{this.resetLoader(e,d),f(new ui({type:Te.NETWORK_ERROR,details:X.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:T,stats:S}))},onTimeout:(S,b,T)=>{this.resetLoader(e,d),f(new ui({type:Te.NETWORK_ERROR,details:X.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:T,stats:S}))}};t&&(E.onProgress=(S,b,T,A)=>t({frag:e,part:null,payload:T,networkDetails:A})),d.load(m,p,E)})}loadPart(e,t,n){this.abort();const r=this.config,o=r.fLoader,l=r.loader;return new Promise((u,f)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){f(nE(e,t));return}const d=this.loader=o?new o(r):new l(r),m=tE(e,t);e.loader=d;const g=Zx(r.fragLoadPolicy.default),p={loadPolicy:g,timeout:g.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:eE};t.stats=d.stats,d.load(m,p,{onSuccess:(E,S,b,T)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:E.data,networkDetails:T};n(A),u(A)},onError:(E,S,b,T)=>{this.resetLoader(e,d),f(new ui({type:Te.NETWORK_ERROR,details:X.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:ot({url:m.url,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:b,stats:T}))},onAbort:(E,S,b)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),f(new ui({type:Te.NETWORK_ERROR,details:X.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:b,stats:E}))},onTimeout:(E,S,b)=>{this.resetLoader(e,d),f(new ui({type:Te.NETWORK_ERROR,details:X.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:b,stats:E}))}})})}updateStatsFromPart(e,t){const n=e.stats,r=t.stats,o=r.total;if(n.loaded+=r.loaded,o){const f=Math.round(e.duration/t.duration),d=Math.min(Math.round(n.loaded/o),f),g=(f-d)*Math.round(n.loaded/d);n.total=n.loaded+g}else n.total=Math.max(n.loaded,n.total);const l=n.loading,u=r.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function tE(i,e=null){const t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if(ge(r)&&ge(o)){var l;let u=r,f=o;if(i.sn==="initSegment"&&zP((l=i.decryptdata)==null?void 0:l.method)){const d=o-r;d%16&&(f=o+(16-d%16)),r!==0&&(n.resetIV=!0,u=r-16)}n.rangeStart=u,n.rangeEnd=f}return n}function nE(i,e){const t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:Te.MEDIA_ERROR,details:X.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new ui(n)}function zP(i){return i==="AES-128"||i==="AES-256"}class ui extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class dA extends cs{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class Dg{constructor(e,t,n,r=0,o=-1,l=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=Vc(),this.buffering={audio:Vc(),video:Vc(),audiovideo:Vc()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=o,this.partial=l}}function Vc(){return{start:0,executeStart:0,executeEnd:0,end:0}}const sE={length:0,start:()=>0,end:()=>0};class Oe{static isBuffered(e,t){if(e){const n=Oe.getBuffered(e);for(let r=n.length;r--;)if(t>=n.start(r)&&t<=n.end(r))return!0}return!1}static bufferedRanges(e){if(e){const t=Oe.getBuffered(e);return Oe.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}static bufferInfo(e,t,n){if(e){const r=Oe.bufferedRanges(e);if(r.length)return Oe.bufferedInfo(r,t,n)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.length>1&&e.sort((m,g)=>m.start-g.start||g.end-m.end);let r=-1,o=[];if(n)for(let m=0;m<e.length;m++){t>=e[m].start&&t<=e[m].end&&(r=m);const g=o.length;if(g){const p=o[g-1].end;e[m].start-p<n?e[m].end>p&&(o[g-1].end=e[m].end):o.push(e[m])}else o.push(e[m])}else o=e;let l=0,u,f=t,d=t;for(let m=0;m<o.length;m++){const g=o[m].start,p=o[m].end;if(r===-1&&t>=g&&t<=p&&(r=m),t+n>=g&&t<p)f=g,d=p,l=d-t;else if(t+n<g){u=g;break}}return{len:l,start:f||0,end:d||0,nextStart:u,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||sE}catch(t){return lt.log("failed to get media.buffered",t),sE}}}const fA=/\{\$([a-zA-Z0-9-_]+)\}/g;function iE(i){return fA.test(i)}function Rm(i,e){if(i.variableList!==null||i.hasVariableRefs){const t=i.variableList;return e.replace(fA,n=>{const r=n.substring(2,n.length-1),o=t?.[r];return o===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):o})}return e}function rE(i,e,t){let n=i.variableList;n||(i.variableList=n={});let r,o;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const l=new self.URL(t).searchParams;if(l.has(r))o=l.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(l){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${l.message}`))}}else r=e.NAME,o=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=o||""}function HP(i,e,t){const n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const VP=/^(\d+)x(\d+)$/,aE=/(.+?)=(".*?"|.*?)(?:,|$)/g;class At{constructor(e,t){typeof e=="string"&&(e=At.parseAttrList(e,t)),ht(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((r,o)=>(r[o.toLowerCase()]=!0,r),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=VP.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let n;const r={};for(aE.lastIndex=0;(n=aE.exec(e))!==null;){const l=n[1].trim();let u=n[2];const f=u.indexOf('"')===0&&u.lastIndexOf('"')===u.length-1;let d=!1;if(f)u=u.slice(1,-1);else switch(l){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":d=!0}if(t&&(f||d))u=Rm(t,u);else if(!d&&!f)switch(l){case"CLOSED-CAPTIONS":if(u==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":lt.warn(`${e}: attribute ${l} is missing quotes`)}r[l]=u}return r}}const KP="com.apple.hls.interstitial";function YP(i){return i!=="ID"&&i!=="CLASS"&&i!=="CUE"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function qP(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"||i==="SCTE35-CMD"}class hA{constructor(e,t,n=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(r=t?.tagOrder)!=null?r:n,t){const o=t.attr;for(const l in o)if(Object.prototype.hasOwnProperty.call(e,l)&&e[l]!==o[l]){lt.warn(`DATERANGE tag attribute: "${l}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=l;break}e=ht(new At({}),o,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const o=t?.endDate||new Date(this.attr["END-DATE"]);ge(o.getTime())&&(this._endDate=o)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(lt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(ge(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===KP}get isValid(){return!!this.id&&!this._badValueForSameId&&ge(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const XP=10;class WP{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let n=t.decryptdata;return n||(t.setKeyFormat(e.keyFormat),n=t.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return this.fragments.length?ge(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||XP}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let n=e.length;n--;)if(e[n].index>t)return e[n].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Uu(i,e){return i.length===e.length?!i.some((t,n)=>t!==e[n]):!1}function oE(i,e){return!i&&!e?!0:!i||!e?!1:Uu(i,e)}function ja(i){return i==="AES-128"||i==="AES-256"||i==="AES-256-CTR"}function Ig(i){switch(i){case"AES-128":case"AES-256":return Zi.cbc;case"AES-256-CTR":return Zi.ctr;default:throw new Error(`invalid full segment method ${i}`)}}function Ng(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function Cm(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}function QP(i){const e=Cm(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function mA(i){const e=function(n,r,o){const l=n[r];n[r]=n[o],n[o]=l};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function gA(i){const e=i.split(":");let t=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){const o=r[0]==="base64",l=r[1];o?(n.splice(-1,1),t=Ng(l)):t=QP(l)}}return t}const Fu=typeof self<"u"?self:void 0;var Ct={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},ln={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function cu(i){switch(i){case ln.FAIRPLAY:return Ct.FAIRPLAY;case ln.PLAYREADY:return Ct.PLAYREADY;case ln.WIDEVINE:return Ct.WIDEVINE;case ln.CLEARKEY:return Ct.CLEARKEY}}function zh(i){switch(i){case Ct.FAIRPLAY:return ln.FAIRPLAY;case Ct.PLAYREADY:return ln.PLAYREADY;case Ct.WIDEVINE:return ln.WIDEVINE;case Ct.CLEARKEY:return ln.CLEARKEY}}function Qo(i){const{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Ct.FAIRPLAY,Ct.WIDEVINE,Ct.PLAYREADY,Ct.CLEARKEY].filter(r=>!!e[r]):[];return!n[Ct.WIDEVINE]&&t&&n.push(Ct.WIDEVINE),n}const pA=(function(i){return Fu!=null&&(i=Fu.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null})();function ZP(i,e,t,n){let r;switch(i){case Ct.FAIRPLAY:r=["cenc","sinf"];break;case Ct.WIDEVINE:case Ct.PLAYREADY:r=["cenc"];break;case Ct.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return JP(r,e,t,n)}function JP(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(o=>({contentType:`audio/mp4; codecs=${o}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(o=>({contentType:`video/mp4; codecs=${o}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function e2(i){var e;return!!i&&(i.sessionType==="persistent-license"||!!((e=i.sessionTypes)!=null&&e.some(t=>t==="persistent-license")))}function vA(i){const e=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),n=t.substring(t.indexOf("<"),t.length),l=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(l){const u=l.childNodes[0]?l.childNodes[0].nodeValue:l.getAttribute("VALUE");if(u){const f=Ng(u).subarray(0,16);return mA(f),f}}return null}let Da={};class Yi{static clearKeyUriToKeyIdMap(){Da={}}static setKeyIdForUri(e,t){Da[e]=t}static addKeyIdForUri(e){const t=Object.keys(Da).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,t),Da[e]=n,n}constructor(e,t,n,r=[1],o=null,l){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=o,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!ja(e),l!=null&&l.startsWith("0x")&&(this.keyId=new Uint8Array(VT(l)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&Uu(e.keyFormatVersions,this.keyFormatVersions)&&oE(e.iv,this.iv)&&oE(e.keyId,this.keyId)}isSupported(){if(this.method){if(ja(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case ln.FAIRPLAY:case ln.WIDEVINE:case ln.PLAYREADY:case ln.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,t){if(!this.encrypted||!this.uri)return null;if(ja(this.method)){let o=this.iv;return o||(typeof e!="number"&&(lt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),o=n2(e)),new Yi(this.method,this.uri,"identity",this.keyFormatVersions,o)}if(this.keyId){const o=Da[this.uri];if(o&&!Uu(this.keyId,o)&&Yi.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=gA(this.uri);if(n)switch(this.keyFormat){case ln.WIDEVINE:if(this.pssh=n,!this.keyId){const o=rP(n.buffer);if(o.length){var r;const l=o[0];this.keyId=(r=l.kids)!=null&&r.length?l.kids[0]:null}}this.keyId||(this.keyId=lE(t));break;case ln.PLAYREADY:{const o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=iP(o,null,n),this.keyId=vA(n);break}default:{let o=n.subarray(0,16);if(o.length!==16){const l=new Uint8Array(16);l.set(o,16-o.length),o=l}this.keyId=o;break}}if(!this.keyId||this.keyId.byteLength!==16){let o;o=t2(t),o||(o=lE(t),o||(o=Da[this.uri])),o&&(this.keyId=o,Yi.setKeyIdForUri(this.uri,o))}return this}}function t2(i){const e=i?.[ln.WIDEVINE];return e?e.keyId:null}function lE(i){const e=i?.[ln.PLAYREADY];if(e){const t=gA(e.uri);if(t)return vA(t)}return null}function n2(i){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}const cE=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,uE=/#EXT-X-MEDIA:(.*)/g,s2=/^#EXT(?:INF|-X-TARGETDURATION):/m,Hh=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),i2=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class ks{static findGroup(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(r.id===t)return r}}static resolve(e,t){return Tg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return s2.test(e)}static parseMasterPlaylist(e,t){const n=iE(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},o=[];if(cE.lastIndex=0,!e.startsWith("#EXTM3U"))return r.playlistParsingError=new Error("no EXTM3U delimiter"),r;let l;for(;(l=cE.exec(e))!=null;)if(l[1]){var u;const d=new At(l[1],r),m=Rm(r,l[2]),g={attrs:d,bitrate:d.decimalInteger("BANDWIDTH")||d.decimalInteger("AVERAGE-BANDWIDTH"),name:d.NAME,url:ks.resolve(m,t)},p=d.decimalResolution("RESOLUTION");p&&(g.width=p.width,g.height=p.height),hE(d.CODECS,g);const E=d["SUPPLEMENTAL-CODECS"];E&&(g.supplemental={},hE(E,g.supplemental)),(u=g.unknownCodecs)!=null&&u.length||o.push(g),r.levels.push(g)}else if(l[3]){const d=l[3],m=l[4];switch(d){case"SESSION-DATA":{const g=new At(m,r),p=g["DATA-ID"];p&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[p]=g);break}case"SESSION-KEY":{const g=dE(m,t,r);g.encrypted&&g.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(g)):lt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${m}"`);break}case"DEFINE":{{const g=new At(m,r);rE(r,g,t)}break}case"CONTENT-STEERING":{const g=new At(m,r);r.contentSteering={uri:ks.resolve(g["SERVER-URI"],t),pathwayId:g["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=fE(m);break}}}const f=o.length>0&&o.length<r.levels.length;return r.levels=f?o:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r;const o={},l=n.levels,u={AUDIO:l.map(d=>({id:d.attrs.AUDIO,audioCodec:d.audioCodec})),SUBTITLES:l.map(d=>({id:d.attrs.SUBTITLES,textCodec:d.textCodec})),"CLOSED-CAPTIONS":[]};let f=0;for(uE.lastIndex=0;(r=uE.exec(e))!==null;){const d=new At(r[1],n),m=d.TYPE;if(m){const g=u[m],p=o[m]||[];o[m]=p;const E=d.LANGUAGE,S=d["ASSOC-LANGUAGE"],b=d.CHANNELS,T=d.CHARACTERISTICS,A=d["INSTREAM-ID"],_={attrs:d,bitrate:0,id:f++,groupId:d["GROUP-ID"]||"",name:d.NAME||E||"",type:m,default:d.bool("DEFAULT"),autoselect:d.bool("AUTOSELECT"),forced:d.bool("FORCED"),lang:E,url:d.URI?ks.resolve(d.URI,t):""};if(S&&(_.assocLang=S),b&&(_.channels=b),T&&(_.characteristics=T),A&&(_.instreamId=A),g!=null&&g.length){const w=ks.findGroup(g,_.groupId)||g[0];mE(_,w,"audioCodec"),mE(_,w,"textCodec")}p.push(_)}}return o}static parseLevelPlaylist(e,t,n,r,o,l){var u;const f={url:t},d=new WP(t),m=d.fragments,g=[];let p=null,E=0,S=0,b=0,T=0,A=0,_=null,w=new jh(r,f),D,O,B,N=-1,U=!1,k=null,F;if(Hh.lastIndex=0,d.m3u8=e,d.hasVariableRefs=iE(e),((u=Hh.exec(e))==null?void 0:u[0])!=="#EXTM3U")return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;(D=Hh.exec(e))!==null;){U&&(U=!1,w=new jh(r,f),w.playlistOffset=b,w.setStart(b),w.sn=E,w.cc=T,A&&(w.bitrate=A),w.level=n,p&&(w.initSegment=p,p.rawProgramDateTime&&(w.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),k&&(w.setByteRange(k),k=null)));const le=D[1];if(le){w.duration=parseFloat(le);const de=(" "+D[2]).slice(1);w.title=de||null,w.tagList.push(de?["INF",le,de]:["INF",le])}else if(D[3]){if(ge(w.duration)){w.playlistOffset=b,w.setStart(b),B&&pE(w,B,d),w.sn=E,w.level=n,w.cc=T,m.push(w);const de=(" "+D[3]).slice(1);w.relurl=Rm(d,de),Lm(w,_,g),_=w,b+=w.duration,E++,S=0,U=!0}}else{if(D=D[0].match(i2),!D){lt.warn("No matches on slow regex match for level playlist!");continue}for(O=1;O<D.length&&D[O]===void 0;O++);const de=(" "+D[O]).slice(1),P=(" "+D[O+1]).slice(1),K=D[O+2]?(" "+D[O+2]).slice(1):null;switch(de){case"BYTERANGE":_?w.setByteRange(P,_):w.setByteRange(P);break;case"PROGRAM-DATE-TIME":w.rawProgramDateTime=P,w.tagList.push(["PROGRAM-DATE-TIME",P]),N===-1&&(N=m.length);break;case"PLAYLIST-TYPE":d.type&&li(d,de,D),d.type=P.toUpperCase();break;case"MEDIA-SEQUENCE":d.startSN!==0?li(d,de,D):m.length>0&&vE(d,de,D),E=d.startSN=parseInt(P);break;case"SKIP":{d.skippedSegments&&li(d,de,D);const j=new At(P,d),W=j.decimalInteger("SKIPPED-SEGMENTS");if(ge(W)){d.skippedSegments+=W;for(let M=W;M--;)m.push(null);E+=W}const he=j.enumeratedString("RECENTLY-REMOVED-DATERANGES");he&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(he.split("	")));break}case"TARGETDURATION":d.targetduration!==0&&li(d,de,D),d.targetduration=Math.max(parseInt(P),1);break;case"VERSION":d.version!==null&&li(d,de,D),d.version=parseInt(P);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||li(d,de,D),d.live=!1;break;case"#":(P||K)&&w.tagList.push(K?[P,K]:[P]);break;case"DISCONTINUITY":T++,w.tagList.push(["DIS"]);break;case"GAP":w.gap=!0,w.tagList.push([de]);break;case"BITRATE":w.tagList.push([de,P]),A=parseInt(P)*1e3,ge(A)?w.bitrate=A:A=0;break;case"DATERANGE":{const j=new At(P,d),W=new hA(j,d.dateRanges[j.ID],d.dateRangeTagCount);d.dateRangeTagCount++,W.isValid||d.skippedSegments?d.dateRanges[W.id]=W:lt.warn(`Ignoring invalid DATERANGE tag: "${P}"`),w.tagList.push(["EXT-X-DATERANGE",P]);break}case"DEFINE":{{const j=new At(P,d);"IMPORT"in j?HP(d,j,l):rE(d,j,t)}break}case"DISCONTINUITY-SEQUENCE":d.startCC!==0?li(d,de,D):m.length>0&&vE(d,de,D),d.startCC=T=parseInt(P);break;case"KEY":{const j=dE(P,t,d);if(j.isSupported()){if(j.method==="NONE"){B=void 0;break}B||(B={});const W=B[j.keyFormat];W!=null&&W.matches(j)||(W&&(B=ht({},B)),B[j.keyFormat]=j)}else lt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${P}"`);break}case"START":d.startTimeOffset=fE(P);break;case"MAP":{const j=new At(P,d);if(w.duration){const W=new jh(r,f);gE(W,j,n,B),p=W,w.initSegment=p,p.rawProgramDateTime&&!w.rawProgramDateTime&&(w.rawProgramDateTime=p.rawProgramDateTime)}else{const W=w.byteRangeEndOffset;if(W){const he=w.byteRangeStartOffset;k=`${W-he}@${he}`}else k=null;gE(w,j,n,B),p=w,U=!0}p.cc=T;break}case"SERVER-CONTROL":{F&&li(d,de,D),F=new At(P),d.canBlockReload=F.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=F.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&F.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=F.optionalFloat("PART-HOLD-BACK",0),d.holdBack=F.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{d.partTarget&&li(d,de,D);const j=new At(P);d.partTarget=j.decimalFloatingPoint("PART-TARGET");break}case"PART":{let j=d.partList;j||(j=d.partList=[]);const W=S>0?j[j.length-1]:void 0,he=S++,M=new At(P,d),G=new Hk(M,w,f,he,W);j.push(G),w.duration+=G.duration;break}case"PRELOAD-HINT":{const j=new At(P,d);d.preloadHint=j;break}case"RENDITION-REPORT":{const j=new At(P,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(j);break}default:lt.warn(`line parsed but not handled: ${D}`);break}}}_&&!_.relurl?(m.pop(),b-=_.duration,d.partList&&(d.fragmentHint=_)):d.partList&&(Lm(w,_,g),w.cc=T,d.fragmentHint=w,B&&pE(w,B,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));const H=m.length,ne=m[0],J=m[H-1];if(b+=d.skippedSegments*d.targetduration,b>0&&H&&J){d.averagetargetduration=b/H;const le=J.sn;d.endSN=le!=="initSegment"?le:0,d.live||(J.endList=!0),N>0&&(a2(m,N),ne&&g.unshift(ne))}return d.fragmentHint&&(b+=d.fragmentHint.duration),d.totalduration=b,g.length&&d.dateRangeTagCount&&ne&&yA(g,d),d.endCC=T,d}}function yA(i,e){let t=i.length;if(!t)if(e.hasProgramDateTime){const u=e.fragments[e.fragments.length-1];i.push(u),t++}else return;const n=i[t-1],r=e.live?1/0:e.totalduration,o=Object.keys(e.dateRanges);for(let u=o.length;u--;){const f=e.dateRanges[o[u]],d=f.startDate.getTime();f.tagAnchor=n.ref;for(let m=t;m--;){var l;if(((l=i[m])==null?void 0:l.sn)<e.startSN)break;const g=r2(e,d,i,m,r);if(g!==-1){f.tagAnchor=e.fragments[g].ref;break}}}}function r2(i,e,t,n,r){const o=t[n];if(o){const u=o.programDateTime;if(e>=u||n===0){var l;const f=(((l=t[n+1])==null?void 0:l.start)||r)-o.start;if(e<=u+f*1e3){const d=t[n].sn-i.startSN;if(d<0)return-1;const m=i.fragments;if(m.length>t.length){const p=(t[n+1]||m[m.length-1]).sn-i.startSN;for(let E=p;E>d;E--){const S=m[E].programDateTime;if(e>=S&&e<S+m[E].duration*1e3)return E}}return d}}}return-1}function dE(i,e,t){var n,r;const o=new At(i,t),l=(n=o.METHOD)!=null?n:"",u=o.URI,f=o.hexadecimalInteger("IV"),d=o.KEYFORMATVERSIONS,m=(r=o.KEYFORMAT)!=null?r:"identity";u&&o.IV&&!f&&lt.error(`Invalid IV: ${o.IV}`);const g=u?ks.resolve(u,e):"",p=(d||"1").split("/").map(Number).filter(Number.isFinite);return new Yi(l,g,m,p,f,o.KEYID)}function fE(i){const t=new At(i).decimalFloatingPoint("TIME-OFFSET");return ge(t)?t:null}function hE(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const r=t.filter(o=>Cg(o,n));r.length&&(e[`${n}Codec`]=r.map(o=>o.split("/")[0]).join(","),t=t.filter(o=>r.indexOf(o)===-1))}),e.unknownCodecs=t}function mE(i,e,t){const n=e[t];n&&(i[t]=n)}function a2(i,e){let t=i[e];for(let n=e;n--;){const r=i[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function Lm(i,e,t){i.rawProgramDateTime?t.push(i):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime)}function gE(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function pE(i,e,t){i.levelkeys=e;const{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}function li(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function vE(i,e,t){i.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Vh(i,e){const t=e.startPTS;if(ge(t)){let n=0,r;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&r.setDuration(n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.setStart(i.start+(i.minEndPTS-i.start)):e.setStart(i.start+i.duration):e.setStart(Math.max(i.start-e.duration,0))}function xA(i,e,t,n,r,o,l){n-t<=0&&(l.warn("Fragment should have a positive duration",e),n=t+e.duration,o=r+e.duration);let f=t,d=n;const m=e.startPTS,g=e.endPTS;if(ge(m)){const A=Math.abs(m-t);i&&A>i.totalduration?l.warn(`media timestamps and playlist times differ by ${A}s for level ${e.level} ${i.url}`):ge(e.deltaPTS)?e.deltaPTS=Math.max(A,e.deltaPTS):e.deltaPTS=A,f=Math.max(t,m),t=Math.min(t,m),r=e.startDTS!==void 0?Math.min(r,e.startDTS):r,d=Math.min(n,g),n=Math.max(n,g),o=e.endDTS!==void 0?Math.max(o,e.endDTS):o}const p=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(n-e.start),e.startPTS=t,e.maxStartPTS=f,e.startDTS=r,e.endPTS=n,e.minEndPTS=d,e.endDTS=o;const E=e.sn;if(!i||E<i.startSN||E>i.endSN)return 0;let S;const b=E-i.startSN,T=i.fragments;for(T[b]=e,S=b;S>0;S--)Vh(T[S],T[S-1]);for(S=b;S<T.length-1;S++)Vh(T[S],T[S+1]);return i.fragmentHint&&Vh(T[T.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,p}function o2(i,e,t){if(i===e)return;let n=null;const r=i.fragments;for(let m=r.length-1;m>=0;m--){const g=r[m].initSegment;if(g){n=g;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let o;u2(i,e,(m,g,p,E)=>{if((!e.startCC||e.skippedSegments)&&g.cc!==m.cc){const S=m.cc-g.cc;for(let b=p;b<E.length;b++)E[b].cc+=S;e.endCC=E[E.length-1].cc}ge(m.startPTS)&&ge(m.endPTS)&&(g.setStart(g.startPTS=m.startPTS),g.startDTS=m.startDTS,g.maxStartPTS=m.maxStartPTS,g.endPTS=m.endPTS,g.endDTS=m.endDTS,g.minEndPTS=m.minEndPTS,g.setDuration(m.endPTS-m.startPTS),g.duration&&(o=g),e.PTSKnown=e.alignedSliding=!0),m.hasStreams&&(g.elementaryStreams=m.elementaryStreams),g.loader=m.loader,m.hasStats&&(g.stats=m.stats),m.initSegment&&(g.initSegment=m.initSegment,n=m.initSegment)});const l=e.fragments,u=e.fragmentHint?l.concat(e.fragmentHint):l;if(n&&u.forEach(m=>{var g;m&&(!m.initSegment||m.initSegment.relurl===((g=n)==null?void 0:g.relurl))&&(m.initSegment=n)}),e.skippedSegments){if(e.deltaUpdateFailed=l.some(m=>!m),e.deltaUpdateFailed){t.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let m=e.skippedSegments;m--;)l.shift();e.startSN=l[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=l2(i.dateRanges,e,t));const m=i.fragments.filter(g=>g.rawProgramDateTime);if(i.hasProgramDateTime&&!e.hasProgramDateTime)for(let g=1;g<u.length;g++)u[g].programDateTime===null&&Lm(u[g],u[g-1],m);yA(m,e)}e.endCC=l[l.length-1].cc}if(!e.startCC){var f;const m=bA(i,e.startSN-1);e.startCC=(f=m?.cc)!=null?f:l[0].cc}c2(i.partList,e.partList,(m,g)=>{g.elementaryStreams=m.elementaryStreams,g.stats=m.stats}),o?xA(e,o,o.startPTS,o.endPTS,o.startDTS,o.endDTS,t):EA(i,e),l.length&&(e.totalduration=e.edge-l[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;const d=e.advancedDateTime;if(e.advanced&&d){const m=e.edge;e.driftStart||(e.driftStartTime=d,e.driftStart=m),e.driftEndTime=d,e.driftEnd=m}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=i.requestScheduled)}function l2(i,e,t){const{dateRanges:n,recentlyRemovedDateranges:r}=e,o=ht({},i);r&&r.forEach(f=>{delete o[f]});const u=Object.keys(o).length;return u?(Object.keys(n).forEach(f=>{const d=o[f],m=new hA(n[f].attr,d);m.isValid?(o[f]=m,d||(m.tagOrder+=u)):t.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${pt(n[f].attr)}"`)}),o):n}function c2(i,e,t){if(i&&e){let n=0;for(let r=0,o=i.length;r<=o;r++){const l=i[r],u=e[r+n];l&&u&&l.index===u.index&&l.fragment.sn===u.fragment.sn?t(l,u):n--}}}function u2(i,e,t){const n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,o=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,l=e.startSN-i.startSN,u=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,f=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let d=r;d<=o;d++){const m=f[l+d];let g=u[d];if(n&&!g&&m&&(g=e.fragments[d]=m),m&&g){t(m,g,d,u);const p=m.relurl,E=g.relurl;if(p&&d2(p,E)){e.playlistParsingError=yE(`media sequence mismatch ${g.sn}:`,i,e,m,g);return}else if(m.cc!==g.cc){e.playlistParsingError=yE(`discontinuity sequence mismatch (${m.cc}!=${g.cc})`,i,e,m,g);return}}}}function yE(i,e,t,n,r){return new Error(`${i} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function EA(i,e,t=!0){const n=e.startSN+e.skippedSegments-i.startSN,r=i.fragments,o=n>=0;let l=0;if(o&&n<r.length)l=r[n].start;else if(o&&e.startSN===i.endSN+1)l=i.fragmentEnd;else if(o&&t)l=i.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)l=i.fragmentStart;else return;_m(e,l)}function _m(i,e){if(e){const t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].addStart(e);i.fragmentHint&&i.fragmentHint.addStart(e)}}function SA(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){const n=i.fragments;if(n.length&&t*4>e){const o=n[n.length-1].duration*1e3;o<t&&(t=o)}}else t/=2;return Math.round(t)}function bA(i,e,t){if(!i)return null;let n=i.fragments[e-i.startSN];return n||(n=i.fragmentHint,n&&n.sn===e)?n:e<i.startSN&&t&&t.sn===e?t:null}function xE(i,e,t){return i?TA(i.partList,e,t):null}function TA(i,e,t){if(i)for(let n=i.length;n--;){const r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function AA(i){i.forEach((e,t)=>{var n;(n=e.details)==null||n.fragments.forEach(r=>{r.level=t,r.initSegment&&(r.initSegment.level=t)})})}function d2(i,e){return i!==e&&e?EE(i)!==EE(e):!1}function EE(i){return i.replace(/\?[^?]*$/,"")}function Zo(i,e){for(let n=0,r=i.length;n<r;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function f2(i,e){return!!(i&&e.startCC<i.endCC&&e.endCC>i.startCC)}function SE(i,e){const t=i.start+e;i.startPTS=t,i.setStart(t),i.endPTS=t+i.duration}function RA(i,e){const t=e.fragments;for(let n=0,r=t.length;n<r;n++)SE(t[n],i);e.fragmentHint&&SE(e.fragmentHint,i),e.alignedSliding=!0}function h2(i,e){i&&(CA(e,i),e.alignedSliding||Bu(e,i),!e.alignedSliding&&!e.skippedSegments&&EA(i,e,!1))}function CA(i,e){if(!f2(e,i))return;const t=Math.min(e.endCC,i.endCC),n=Zo(e.fragments,t),r=Zo(i.fragments,t);if(!n||!r)return;lt.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const o=n.start-r.start;RA(o,i)}function Bu(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;const t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,o;const l=Math.min(e.endCC,i.endCC);e.startCC<l&&i.startCC<l&&(r=Zo(n,l),o=Zo(t,l)),(!r||!o)&&(r=n[Math.floor(n.length/2)],o=Zo(t,r.cc)||t[Math.floor(t.length/2)]);const u=r.programDateTime,f=o.programDateTime;if(!u||!f)return;const d=(f-u)/1e3-(o.start-r.start);RA(d,i)}function pn(i,e,t){Rn(i,e,t),i.addEventListener(e,t)}function Rn(i,e,t){i.removeEventListener(e,t)}const m2={toString:function(i){let e="";const t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},ae={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Og extends dA{constructor(e,t,n,r,o){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=ae.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:l,fragCurrent:u,media:f,mediaBuffer:d,state:m}=this,g=f?f.currentTime:0,p=Oe.bufferInfo(d||f,g,l.maxBufferHole),E=!p.len;if(this.log(`Media seeking to ${ge(g)?g.toFixed(3):g}, state: ${m}, ${E?"out of":"in"} buffer`),this.state===ae.ENDED)this.resetLoadingState();else if(u){const S=l.maxFragLookUpTolerance,b=u.start-S,T=u.start+u.duration+S;if(E||T<p.start||b>p.end){const A=g>T;(g<b||A)&&(A&&u.loader&&(this.log(`Cancelling fragment load for seek (sn: ${u.sn})`),u.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(f){this.fragmentTracker.removeFragmentsInRange(g,1/0,this.playlistType,!0);const S=this.lastCurrentTime;if(g>S&&(this.lastCurrentTime=g),!this.loadingParts){const b=Math.max(p.end,g),T=this.shouldLoadParts(this.getLevelDetails(),b);T&&(this.log(`LL-Part loading ON after seeking to ${g.toFixed(2)} with buffer @${b.toFixed(2)}`),this.loadingParts=T)}}this.hls.hasEnoughToStart||(this.log(`Setting ${E?"startPosition":"nextLoadPosition"} to ${g} for seek without enough to start`),this.nextLoadPosition=g,E&&(this.startPosition=g)),E&&this.state===ae.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=o,this.hls=e,this.fragmentLoader=new GP(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new wg(e.config)}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===ae.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=ae.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const n=e.end||0,r=this.config.timelineOffset||0;if(n<=r)return!1;const o=e.buffered;this.config.maxBufferHole&&o&&o.length>1&&(e=Oe.bufferedInfo(o,e.start,0));const l=e.nextStart;if(l&&l>r&&l<t.edge||this.media.currentTime<e.start)return!1;const f=t.partList;if(f!=null&&f.length){const m=f[f.length-1];return Oe.isBuffered(this.media,m.start+m.duration/2)}const d=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(d)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const n=this.media=this.mediaBuffer=t.media;pn(n,"seeking",this.onMediaSeeking),pn(n,"ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===ae.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Rn(r,"seeking",this.onMediaSeeking),Rn(r,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=ae.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this.startFragRequested=!0,this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){const r=o=>{const l=o.frag;if(this.fragContextChanged(l)){this.warn(`${l.type} sn: ${l.sn}${o.part?" part: "+o.part.index:""} of ${this.fragInfo(l,!1,o.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(l);return}l.stats.chunkCount++,this._handleFragmentLoadProgress(o)};this._doFragLoad(e,t,n,r).then(o=>{if(!o)return;const l=this.state,u=o.frag;if(this.fragContextChanged(u)){(l===ae.FRAG_LOADING||!this.fragCurrent&&l===ae.PARSING)&&(this.fragmentTracker.removeFragment(u),this.state=ae.IDLE);return}"payload"in o&&(this.log(`Loaded ${u.type} sn: ${u.sn} of ${this.playlistLabel()} ${u.level}`),this.hls.trigger(L.FRAG_LOADED,o)),this._handleFragmentLoadComplete(o)}).catch(o=>{this.state===ae.STOPPED||this.state===ae.ERROR||(this.warn(`Frag error: ${o?.message||o}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:n}=this;if(n.getState(e)===Xt.APPENDING){const o=e.type,l=this.getFwdBufferInfo(this.mediaBuffer,o),u=Math.max(e.duration,l?l.len:this.config.maxBufferLength),f=this.backtrackFragment;((f?e.sn-f.sn:0)===1||this.reduceMaxBufferLength(u,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===Xt.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,n=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:n};this.hls.trigger(L.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{const r=n?.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:r}=this,{frag:o,payload:l}=n,u=o.decryptdata;if(l&&l.byteLength>0&&u!=null&&u.key&&u.iv&&ja(u.method)){const f=self.performance.now();return this.decrypter.decrypt(new Uint8Array(l),u.key.buffer,u.iv.buffer,Ig(u.method)).catch(d=>{throw r.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_DECRYPT_ERROR,fatal:!1,error:d,reason:d.message,frag:o}),d}).then(d=>{const m=self.performance.now();return r.trigger(L.FRAG_DECRYPTED,{frag:o,payload:d,stats:{tstart:f,tdecrypt:m}}),n.payload=d,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===ae.STOPPED||this.state===ae.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==ae.STOPPED&&(this.state=ae.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,t){var n,r;const o=e.tracks;if(o&&!t.encrypted&&((n=o.audio)!=null&&n.encrypted||(r=o.video)!=null&&r.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const l=this.media,u=new Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${l?"attached mediaKeys: "+l.mediaKeys:"detached"})`);return this.warn(u.message),!l||l.mediaKeys?!1:(this.hls.trigger(L.ERROR,{type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_KEYS,fatal:!1,error:u,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${n?m2.toString(Oe.getBuffered(n)):"(detached)"})`),Pt(e)){var r;if(e.type!==pe.SUBTITLE){const l=e.elementaryStreams;if(!Object.keys(l).some(u=>!!l[u])){this.state=ae.IDLE;return}}const o=(r=this.levels)==null?void 0:r[e.level];o!=null&&o.fragmentError&&(this.log(`Resetting level fragment error count of ${o.fragmentError} on frag buffered`),o.fragmentError=0)}this.state=ae.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:n,part:r,partsLoaded:o}=e,l=!o||o.length===0||o.some(f=>!f),u=new Dg(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!l);t.flush(u)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var o;this.fragCurrent=e;const l=t.details;if(!this.levels||!l)throw new Error(`frag load aborted, missing level${l?"":" detail"}s`);let u=null;if(e.encrypted&&!((o=e.decryptdata)!=null&&o.key)){if(this.log(`Loading key for ${e.sn} of [${l.startSN}-${l.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=ae.KEY_LOADING,this.fragCurrent=e,u=this.keyLoader.load(e).then(p=>{if(!this.fragContextChanged(p.frag))return this.hls.trigger(L.KEY_LOADED,p),this.state===ae.KEY_LOADING&&(this.state=ae.IDLE),p}),this.hls.trigger(L.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(u=this.keyLoader.loadClear(e,l.encryptedFragments,this.startFragRequested),u&&this.log("[eme] blocking frag load until media-keys acquired"));const f=this.fragPrevious;if(Pt(e)&&(!f||e.sn!==f.sn)){const p=this.shouldLoadParts(t.details,e.end);p!==this.loadingParts&&(this.log(`LL-Part loading ${p?"ON":"OFF"} loading sn ${f?.sn}->${e.sn}`),this.loadingParts=p)}if(n=Math.max(e.start,n||0),this.loadingParts&&Pt(e)){const p=l.partList;if(p&&r){n>l.fragmentEnd&&l.fragmentHint&&(e=l.fragmentHint);const E=this.getNextPart(p,e,n);if(E>-1){const S=p[E];e=this.fragCurrent=S.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${S.index} (${E}/${p.length-1}) of ${this.fragInfo(e,!1,S)}) cc: ${e.cc} [${l.startSN}-${l.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=S.start+S.duration,this.state=ae.FRAG_LOADING;let b;return u?b=u.then(T=>!T||this.fragContextChanged(T.frag)?null:this.doFragPartsLoad(e,S,t,r)).catch(T=>this.handleFragLoadError(T)):b=this.doFragPartsLoad(e,S,t,r).catch(T=>this.handleFragLoadError(T)),this.hls.trigger(L.FRAG_LOADING,{frag:e,part:S,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):b}else if(!e.url||this.loadedEndOfParts(p,n))return Promise.resolve(null)}}if(Pt(e)&&this.loadingParts){var d;this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(d=l.partList)==null?void 0:d.filter(p=>p.loaded).map(p=>`[${p.start}-${p.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+l.startSN+"-"+l.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),ge(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=ae.FRAG_LOADING;const m=this.config.progressive&&e.type!==pe.SUBTITLE;let g;return m&&u?g=u.then(p=>!p||this.fragContextChanged(p.frag)?null:this.fragmentLoader.load(e,r)).catch(p=>this.handleFragLoadError(p)):g=Promise.all([this.fragmentLoader.load(e,m?r:void 0),u]).then(([p])=>(!m&&r&&r(p),p)).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(L.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):g}doFragPartsLoad(e,t,n,r){return new Promise((o,l)=>{var u;const f=[],d=(u=n.details)==null?void 0:u.partList,m=g=>{this.fragmentLoader.loadPart(e,g,r).then(p=>{f[g.index]=p;const E=p.part;this.hls.trigger(L.FRAG_LOADED,p);const S=xE(n.details,e.sn,g.index+1)||TA(d,e.sn,g.index+1);if(S)m(S);else return o({frag:e,part:E,partsLoaded:f})}).catch(l)};m(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;t.frag&&t.details===X.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Te.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger(L.ERROR,t)}else this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==ae.PARSING){!this.fragCurrent&&this.state!==ae.STOPPED&&this.state!==ae.ERROR&&(this.state=ae.IDLE);return}const{frag:n,part:r,level:o}=t,l=self.performance.now();n.stats.parsing.end=l,r&&(r.stats.parsing.end=l);const u=this.getLevelDetails(),d=u&&n.sn>u.endSN||this.shouldLoadParts(u,n.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=d),this.updateLevelTiming(n,r,o,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const o=e.partList[0];if(o.fragment.type===pe.SUBTITLE)return!1;const l=o.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(t>=l){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>o.start-o.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:n}=this,{level:r,sn:o,part:l}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${o} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const u=t[r],f=u.details,d=l>-1?xE(f,o,l):null,m=d?d.fragment:bA(f,o,n);return m?(n&&n!==m&&(m.stats=n.stats),{frag:m,part:d,level:u}):null}bufferFragmentData(e,t,n,r,o){if(this.state!==ae.PARSING)return;const{data1:l,data2:u}=e;let f=l;if(u&&(f=as(l,u)),!f.length)return;const d=this.initPTS[t.cc],m=d?-d.baseTime/d.timescale:void 0,g={type:e.type,frag:t,part:n,chunkMeta:r,offset:m,parent:t.type,data:f};if(this.hls.trigger(L.BUFFER_APPENDING,g),e.dropped&&e.independent&&!n){if(o)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Oe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const n=t.currentTime,r=Oe.bufferInfo(t,n,0),o=e.duration,l=Math.min(this.config.maxFragLookUpTolerance*2,o*.25),u=Math.max(Math.min(e.start-l,r.end-l),n+l);e.start-u>l&&this.flushMainBuffer(u,e.start)}getFwdBufferInfo(e,t){var n;const r=this.getLoadPosition();if(!ge(r))return null;const l=this.lastCurrentTime>r||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,l)}getFwdBufferInfoAtPos(e,t,n,r){const o=Oe.bufferInfo(e,t,r);if(o.len===0&&o.nextStart!==void 0){const l=this.fragmentTracker.getBufferedFrag(t,n);if(l&&(o.nextStart<=l.end||l.gap)){const u=Math.max(Math.min(o.nextStart,l.end)-t,r);return Oe.bufferInfo(e,t,u)}}return o}getMaxBufferLength(e){const{config:t}=this;let n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),o=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return o>=r?(n.maxMaxBufferLength=o,this.warn(`Reduce max buffer length to ${o}s`),!0):!1}getAppendedFrag(e,t=pe.MAIN){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){const n=t.fragments,r=n.length;if(!r)return null;const{config:o}=this,l=n[0].start,u=o.lowLatencyMode&&!!t.partList;let f=null;if(t.live){const g=o.initialLiveManifestSize;if(r<g)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${g})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<l){var d;u&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),f=this.getInitialLiveFragment(t);const p=this.hls.startPosition,E=this.hls.liveSyncPosition,S=f?(p!==-1&&p>=l?p:E)||f.start:e;this.log(`Setting startPosition to ${S} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${E} frag.start: ${(d=f)==null?void 0:d.start}`),this.startPosition=this.nextLoadPosition=S}}else e<=l&&(f=n[0]);if(!f){const g=this.loadingParts?t.partEnd:t.fragmentEnd;f=this.getFragmentAtPosition(e,g,t)}let m=this.filterReplacedPrimary(f,t);if(!m&&f){const g=f.sn-t.startSN;m=this.filterReplacedPrimary(n[g+1]||null,t)}return this.mapToInitFragWhenRequired(m)}isLoopLoading(e,t){const n=this.fragmentTracker.getState(e);return(n===Xt.OK||n===Xt.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,o){let l=null;if(e.gap&&(l=this.getNextFragment(this.nextLoadPosition,t),l&&!l.gap&&n.nextStart)){const u=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r,0);if(u!==null&&n.len+u.len>=o){const f=l.sn;return this.loopSn!==f&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${f}`),this.loopSn=f),null}}return this.loopSn=void 0,l}get primaryPrefetch(){if(bE(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(bE(this.config)&&e.type!==pe.SUBTITLE){const n=this.hls.interstitialsManager,r=n?.bufferingItem;if(r){const l=r.event;if(l){if(l.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&t?.live===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const o=n?.playerQueue;if(o)for(let l=o.length;l--;){const u=o[l].interstitial;if(u.appendInPlace&&e.start>=u.startTime&&e.end<=u.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,o=!1,l=!0;for(let u=0,f=e.length;u<f;u++){const d=e[u];if(l=l&&!d.independent,r>-1&&n<d.start)break;const m=d.loaded;m?r=-1:(o||(d.independent||l)&&d.fragment===t)&&(d.fragment!==t&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${d.start}`),r=u),o=m}return r}loadedEndOfParts(e,t){let n;for(let r=e.length;r--;){if(n=e[r],!n.loaded)return!1;if(t>n.start)return!0}return!1}getInitialLiveFragment(e){const t=e.fragments,n=this.fragPrevious;let r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=DP(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const o=n.sn+1;if(o>=e.startSN&&o<=e.endSN){const l=t[o-e.startSN];n.cc===l.cc&&(r=l,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=lA(e,n.cc,n.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const o=this.hls.liveSyncPosition;o!==null&&(r=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){const{config:r}=this;let{fragPrevious:o}=this,{fragments:l,endSN:u}=n;const{fragmentHint:f}=n,{maxFragLookUpTolerance:d}=r,m=n.partList,g=!!(this.loadingParts&&m!=null&&m.length&&f);g&&!this.bitrateTest&&m[m.length-1].fragment.sn===f.sn&&(l=l.concat(f),u=f.sn);let p;if(e<t){var E;const b=e<this.lastCurrentTime||e>t-d||(E=this.media)!=null&&E.paused||!this.startFragRequested?0:d;p=Nr(o,l,e,b)}else p=l[l.length-1];if(p){const S=p.sn-n.startSN,b=this.fragmentTracker.getState(p);if((b===Xt.OK||b===Xt.PARTIAL&&p.gap)&&(o=p),o&&p.sn===o.sn&&(!g||m[0].fragment.sn>p.sn||!n.live)&&p.level===o.level){const A=l[S+1];p.sn<u&&this.fragmentTracker.getState(A)!==Xt.OK?p=A:p=null}}return p}alignPlaylists(e,t,n){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const o=e.fragmentStart,l=!t,u=e.alignedSliding&&ge(o);if(l||!u&&!o){h2(n,e);const f=e.fragmentStart;return this.log(`Live playlist sliding: ${f.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),f}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;n<t&&(n=-1);const r=this.timelineOffset;if(n===-1){const o=this.startTimeOffset!==null,l=o?this.startTimeOffset:e.startTimeOffset;l!==null&&ge(l)?(n=t+l,l<0&&(n+=e.edge),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${l} found in ${o?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+r}this.nextLoadPosition=n+r}getLoadPosition(){var e;const{media:t}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?n=t.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Pt(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==ae.FRAG_LOADING_WAITING_RETRY)&&(this.state=ae.IDLE)}onFragmentOrKeyLoadError(e,t){var n;if(t.chunkMeta&&!t.frag){const A=this.getCurrentContext(t.chunkMeta);A&&(t.frag=A.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var o;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(o=this.fragCurrent)==null?void 0:o.url}`);return}const l=t.details===X.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(r,!0);const u=t.errorAction;if(!u){this.state=ae.ERROR;return}const{action:f,flags:d,retryCount:m=0,retryConfig:g}=u,p=!!g,E=p&&f===an.RetryRequest,S=p&&!u.resolved&&d===$n.MoveAllAlternatesMatchingHost,b=(n=this.hls.latestLevelDetails)==null?void 0:n.live;if(!E&&S&&Pt(r)&&!r.endList&&b&&!uA(t))this.resetFragmentErrors(e),this.treatAsGap(r),u.resolved=!0;else if((E||S)&&m<g.maxNumRetry){var T;const A=Am((T=t.response)==null?void 0:T.code),_=_g(g,m);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+_,this.state=ae.FRAG_LOADING_WAITING_RETRY,u.resolved=!0,A){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${m+1}/${g.maxNumRetry} in ${_}ms`)}else if(g)if(this.resetFragmentErrors(e),m<g.maxNumRetry)!l&&f!==an.RemoveAlternatePermanently&&(u.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${m})`);return}else f===an.SendAlternateToPenaltyBox?this.state=ae.WAITING_LEVEL:this.state=ae.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),t=this.retryDate,n=t===1/0;(!t||e>=t||n&&!Am(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=ae.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===ae.PARSING||this.state===ae.PARSED){const t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),o=r&&r.len>.5;o&&this.reduceMaxBufferLength(r.len,t?.duration||10);const l=!o;return l&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),l}return!1}resetFragmentErrors(e){e===pe.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==ae.STOPPED&&(this.state=ae.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;const r=Oe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===ae.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==ae.STOPPED&&(this.state=ae.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){const o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((f,d)=>{const m=e.elementaryStreams[d];if(m){const g=m.endPTS-m.startPTS;if(g<=0)return this.warn(`Could not parse fragment ${e.sn} ${d} duration reliably (${g})`),f||!1;const p=r?0:xA(o,e,m.startPTS,m.endPTS,m.startDTS,m.endDTS,this);return this.hls.trigger(L.LEVEL_PTS_UPDATED,{details:o,level:n,drift:p,type:d,frag:e,start:m.startPTS,end:m.endPTS}),!0}return f},!1)){var u;const f=((u=this.transmuxer)==null?void 0:u.error)===null;if((n.fragmentError===0||f&&(n.fragmentError<2||e.endList))&&this.treatAsGap(e,n),f){const d=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(d.message),this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,error:d,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=ae.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(L.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===pe.MAIN?"level":"track"}fragInfo(e,t=!0,n){var r,o;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((r=t&&!n?e.startPTS:(n||e).start)!=null?r:NaN).toFixed(3)}-${((o=t&&!n?e.endPTS:(n||e).end)!=null?o:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function bE(i){return!!i.interstitialsController&&i.enableInterstitialPlayback!==!1}class LA{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let n;if(e.length)e.length===1?n=e[0]:n=g2(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function g2(i,e){const t=new Uint8Array(e);let n=0;for(let r=0;r<i.length;r++){const o=i[r];t.set(o,n),n+=o.length}return t}var Kh={exports:{}},TE;function p2(){return TE||(TE=1,(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(f,d,m){this.fn=f,this.context=d,this.once=m||!1}function o(f,d,m,g,p){if(typeof m!="function")throw new TypeError("The listener must be a function");var E=new r(m,g||f,p),S=t?t+d:d;return f._events[S]?f._events[S].fn?f._events[S]=[f._events[S],E]:f._events[S].push(E):(f._events[S]=E,f._eventsCount++),f}function l(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var d=[],m,g;if(this._eventsCount===0)return d;for(g in m=this._events)e.call(m,g)&&d.push(t?g.slice(1):g);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},u.prototype.listeners=function(d){var m=t?t+d:d,g=this._events[m];if(!g)return[];if(g.fn)return[g.fn];for(var p=0,E=g.length,S=new Array(E);p<E;p++)S[p]=g[p].fn;return S},u.prototype.listenerCount=function(d){var m=t?t+d:d,g=this._events[m];return g?g.fn?1:g.length:0},u.prototype.emit=function(d,m,g,p,E,S){var b=t?t+d:d;if(!this._events[b])return!1;var T=this._events[b],A=arguments.length,_,w;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,m),!0;case 3:return T.fn.call(T.context,m,g),!0;case 4:return T.fn.call(T.context,m,g,p),!0;case 5:return T.fn.call(T.context,m,g,p,E),!0;case 6:return T.fn.call(T.context,m,g,p,E,S),!0}for(w=1,_=new Array(A-1);w<A;w++)_[w-1]=arguments[w];T.fn.apply(T.context,_)}else{var D=T.length,O;for(w=0;w<D;w++)switch(T[w].once&&this.removeListener(d,T[w].fn,void 0,!0),A){case 1:T[w].fn.call(T[w].context);break;case 2:T[w].fn.call(T[w].context,m);break;case 3:T[w].fn.call(T[w].context,m,g);break;case 4:T[w].fn.call(T[w].context,m,g,p);break;default:if(!_)for(O=1,_=new Array(A-1);O<A;O++)_[O-1]=arguments[O];T[w].fn.apply(T[w].context,_)}}return!0},u.prototype.on=function(d,m,g){return o(this,d,m,g,!1)},u.prototype.once=function(d,m,g){return o(this,d,m,g,!0)},u.prototype.removeListener=function(d,m,g,p){var E=t?t+d:d;if(!this._events[E])return this;if(!m)return l(this,E),this;var S=this._events[E];if(S.fn)S.fn===m&&(!p||S.once)&&(!g||S.context===g)&&l(this,E);else{for(var b=0,T=[],A=S.length;b<A;b++)(S[b].fn!==m||p&&!S[b].once||g&&S[b].context!==g)&&T.push(S[b]);T.length?this._events[E]=T.length===1?T[0]:T:l(this,E)}return this},u.prototype.removeAllListeners=function(d){var m;return d?(m=t?t+d:d,this._events[m]&&l(this,m)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,i.exports=u})(Kh)),Kh.exports}var v2=p2(),Mg=Gk(v2);const ll="1.6.15",Ka={};function y2(){return typeof __HLS_WORKER_BUNDLE__=="function"}function x2(){const i=Ka[ll];if(i)return i.clientCount++,i;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return Ka[ll]=r,r}function E2(i){const e=Ka[i];if(e)return e.clientCount++,e;const t=new self.URL(i,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Ka[i]=r,r}function S2(i){const e=Ka[i||ll];if(e&&e.clientCount--===1){const{worker:n,objectURL:r}=e;delete Ka[i||ll],r&&self.URL.revokeObjectURL(r),n.terminate()}}function _A(i,e){return e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function kg(i,e){return e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128}function id(i,e){let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t}function cl(i,e){const t=e;let n=0;for(;kg(i,e);){n+=10;const r=id(i,e+6);n+=r,_A(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)}function b2(i,e,t,n){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],o=e[t+2],l=o>>2&15;if(l>12){const E=new Error(`invalid ADTS sampling index:${l}`);i.emit(L.ERROR,L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!0,error:E,reason:E.message});return}const u=(o>>6&3)+1,f=e[t+3]>>6&3|(o&1)<<2,d="mp4a.40."+u,m=r[l];let g=l;(u===5||u===29)&&(g-=3);const p=[u<<3|(g&14)>>1,(g&1)<<7|f<<3];return lt.log(`manifest codec:${n}, parsed codec:${d}, channels:${f}, rate:${m} (ADTS object type:${u} sampling index:${l})`),{config:p,samplerate:m,channelCount:f,codec:d,parsedCodec:d,manifestCodec:n}}function wA(i,e){return i[e]===255&&(i[e+1]&246)===240}function DA(i,e){return i[e+1]&1?7:9}function Pg(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function T2(i,e){return e+5<i.length}function ju(i,e){return e+1<i.length&&wA(i,e)}function A2(i,e){return T2(i,e)&&wA(i,e)&&Pg(i,e)<=i.length-e}function R2(i,e){if(ju(i,e)){const t=DA(i,e);if(e+t>=i.length)return!1;const n=Pg(i,e);if(n<=t)return!1;const r=e+n;return r===i.length||ju(i,r)}return!1}function IA(i,e,t,n,r){if(!i.samplerate){const o=b2(e,t,n,r);if(!o)return;ht(i,o)}}function NA(i){return 1024*9e4/i}function C2(i,e){const t=DA(i,e);if(e+t<=i.length){const n=Pg(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function OA(i,e,t,n,r){const o=NA(i.samplerate),l=n+r*o,u=C2(e,t);let f;if(u){const{frameLength:g,headerLength:p}=u,E=p+g,S=Math.max(0,t+E-e.length);S?(f=new Uint8Array(E-p),f.set(e.subarray(t+p,e.length),0)):f=e.subarray(t+p,t+E);const b={unit:f,pts:l};return S||i.samples.push(b),{sample:b,length:E,missing:S}}const d=e.length-t;return f=new Uint8Array(d),f.set(e.subarray(t,e.length),0),{sample:{unit:f,pts:l},length:d,missing:-1}}function L2(i,e){return kg(i,e)&&id(i,e+6)+10<=i.length-e}function _2(i){return i instanceof ArrayBuffer?i:i.byteOffset==0&&i.byteLength==i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer}function Yh(i,e=0,t=1/0){return w2(i,e,t,Uint8Array)}function w2(i,e,t,n){const r=D2(i);let o=1;"BYTES_PER_ELEMENT"in n&&(o=n.BYTES_PER_ELEMENT);const l=I2(i)?i.byteOffset:0,u=(l+i.byteLength)/o,f=(l+e)/o,d=Math.floor(Math.max(0,Math.min(f,u))),m=Math.floor(Math.min(d+Math.max(t,0),u));return new n(r,d,m-d)}function D2(i){return i instanceof ArrayBuffer?i:i.buffer}function I2(i){return i&&i.buffer instanceof ArrayBuffer&&i.byteLength!==void 0&&i.byteOffset!==void 0}function N2(i){const e={key:i.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(i.size<2)return;if(i.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const n=i.data.subarray(1).indexOf(0);if(n===-1)return;const r=Kn(Yh(i.data,1,n)),o=i.data[2+n],l=i.data.subarray(3+n).indexOf(0);if(l===-1)return;const u=Kn(Yh(i.data,3+n,l));let f;return r==="-->"?f=Kn(Yh(i.data,4+n+l)):f=_2(i.data.subarray(4+n+l)),e.mimeType=r,e.pictureType=o,e.description=u,e.data=f,e}function O2(i){if(i.size<2)return;const e=Kn(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}}function M2(i){if(i.size<2)return;if(i.type==="TXXX"){let t=1;const n=Kn(i.data.subarray(t),!0);t+=n.length+1;const r=Kn(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=Kn(i.data.subarray(1));return{key:i.type,info:"",data:e}}function k2(i){if(i.type==="WXXX"){if(i.size<2)return;let t=1;const n=Kn(i.data.subarray(t),!0);t+=n.length+1;const r=Kn(i.data.subarray(t));return{key:i.type,info:n,data:r}}const e=Kn(i.data);return{key:i.type,info:"",data:e}}function P2(i){return i.type==="PRIV"?O2(i):i.type[0]==="W"?k2(i):i.type==="APIC"?N2(i):M2(i)}function U2(i){const e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=id(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}}const Kc=10,F2=10;function MA(i){let e=0;const t=[];for(;kg(i,e);){const n=id(i,e+6);i[e+5]>>6&1&&(e+=Kc),e+=Kc;const r=e+n;for(;e+F2<r;){const o=U2(i.subarray(e)),l=P2(o);l&&t.push(l),e+=o.size+Kc}_A(i,e)&&(e+=Kc)}return t}function kA(i){return i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp"}function B2(i){if(i.data.byteLength===8){const e=new Uint8Array(i.data),t=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}}function Ug(i){const e=MA(i);for(let t=0;t<e.length;t++){const n=e[t];if(kA(n))return B2(n)}}let Hn=(function(i){return i.audioId3="org.id3",i.dateRange="com.apple.quicktime.HLS",i.emsg="https://aomedia.org/emsg/ID3",i.misbklv="urn:misb:KLV:bin:1910.1",i})({});function Is(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Fg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=as(this.cachedData,e),this.cachedData=null);let n=cl(e,0),r=n?n.length:0,o;const l=this._audioTrack,u=this._id3Track,f=n?Ug(n):void 0,d=e.length;for((this.basePTS===null||this.frameIndex===0&&ge(f))&&(this.basePTS=j2(f,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Hn.audioId3,duration:Number.POSITIVE_INFINITY});r<d;){if(this.canParse(e,r)){const m=this.appendFrame(l,e,r);m?(this.frameIndex++,this.lastPTS=m.sample.pts,r+=m.length,o=r):r=d}else L2(e,r)?(n=cl(e,r),u.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Hn.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,o=r):r++;if(r===d&&o!==d){const m=e.slice(o);this.cachedData?this.cachedData=as(this.cachedData,m):this.cachedData=m}}return{audioTrack:l,videoTrack:Is(),id3Track:u,textTrack:Is()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Is(),id3Track:this._id3Track,textTrack:Is()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const j2=(i,e,t)=>{if(ge(i))return i*90;const n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};let Yc=null;const $2=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],G2=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],z2=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],H2=[0,1,1,4];function PA(i,e,t,n,r){if(t+24>e.length)return;const o=UA(e,t);if(o&&t+o.frameLength<=e.length){const l=o.samplesPerFrame*9e4/o.sampleRate,u=n+r*l,f={unit:e.subarray(t,t+o.frameLength),pts:u,dts:u};return i.config=[],i.channelCount=o.channelCount,i.samplerate=o.sampleRate,i.samples.push(f),{sample:f,length:o.frameLength,missing:0}}}function UA(i,e){const t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,o=i[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&o!==3){const l=i[e+2]>>1&1,u=i[e+3]>>6,f=t===3?3-n:n===3?3:4,d=$2[f*14+r-1]*1e3,g=G2[(t===3?0:t===2?1:2)*3+o],p=u===3?1:2,E=z2[t][n],S=H2[n],b=E*8*S,T=Math.floor(E*d/g+l)*S;if(Yc===null){const w=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Yc=w?parseInt(w[1]):0}return Yc&&Yc<=87&&n===2&&d>=224e3&&u===0&&(i[e+3]=i[e+3]|128),{sampleRate:g,channelCount:p,frameLength:T,samplesPerFrame:b}}}function Bg(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function FA(i,e){return e+1<i.length&&Bg(i,e)}function V2(i,e){return Bg(i,e)&&4<=i.length-e}function BA(i,e){if(e+1<i.length&&Bg(i,e)){const n=UA(i,e);let r=4;n!=null&&n.frameLength&&(r=n.frameLength);const o=e+r;return o===i.length||FA(i,o)}return!1}class K2 extends Fg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const n=cl(e,0);let r=n?.length||0;if(BA(e,r))return!1;for(let o=e.length;r<o;r++)if(R2(e,r))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return A2(e,t)}appendFrame(e,t,n){IA(e,this.observer,t,n,e.manifestCodec);const r=OA(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const jA=(i,e)=>{let t=0,n=5;e+=n;const r=new Uint32Array(1),o=new Uint32Array(1),l=new Uint8Array(1);for(;n>0;){l[0]=i[e];const u=Math.min(n,8),f=8-u;o[0]=4278190080>>>24+f<<f,r[0]=(l[0]&o[0])>>f,t=t?t<<u|r[0]:r[0],e+=1,n-=u}return t};class Y2 extends Fg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){const r=$A(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=cl(e,0);if(!t)return!1;const n=t.length;return e[n]===11&&e[n+1]===119&&Ug(t)!==void 0&&jA(e,n)<16}}function $A(i,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const o=e[t+4]>>6;if(o>=3)return-1;const u=[48e3,44100,32e3][o],f=e[t+4]&63,m=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][f*3+o]*2;if(t+m>e.length)return-1;const g=e[t+6]>>5;let p=0;g===2?p+=2:(g&1&&g!==1&&(p+=2),g&4&&(p+=2));const E=(e[t+6]<<8|e[t+7])>>12-p&1,b=[2,1,2,3,3,4,4,5][g]+E,T=e[t+5]>>3,A=e[t+5]&7,_=new Uint8Array([o<<6|T<<1|A>>2,(A&3)<<6|g<<3|E<<2|f>>4,f<<4&224]),w=1536/u*9e4,D=n+r*w,O=e.subarray(t,t+m);return i.config=_,i.channelCount=b,i.samplerate=u,i.samples.push({unit:O,pts:D}),m}class q2 extends Fg{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=cl(e,0);let n=t?.length||0;if(t&&e[n]===11&&e[n+1]===119&&Ug(t)!==void 0&&jA(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(BA(e,n))return lt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return V2(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return PA(e,t,n,this.basePTS,this.frameIndex)}}const X2=/\/emsg[-/]ID3/i;class W2{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){const o=this.videoTrack=Is("video",1),l=this.audioTrack=Is("audio",1),u=this.txtTrack=Is("text",1);if(this.id3Track=Is("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const f=QT(e);if(f.video){const{id:d,timescale:m,codec:g,supplemental:p}=f.video;o.id=d,o.timescale=u.timescale=m,o.codec=g,o.supplemental=p}if(f.audio){const{id:d,timescale:m,codec:g}=f.audio;l.id=d,l.timescale=m,l.codec=g}u.id=qT.text,o.sampleDuration=0,o.duration=l.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return Yk(e)}demux(e,t){this.timeOffset=t;let n=e;const r=this.videoTrack,o=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=as(this.remainderData,e));const u=eP(n);this.remainderData=u.remainder,r.samples=u.valid||new Uint8Array}else r.samples=n;const l=this.extractID3Track(r,t);return o.samples=$x(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:l,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return n.samples=$x(e,t),{videoTrack:t,audioTrack:Is(),id3Track:r,textTrack:Is()}}extractID3Track(e,t){const n=this.id3Track;if(e.samples.length){const r=Be(e.samples,["emsg"]);r&&r.forEach(o=>{const l=nP(o);if(X2.test(l.schemeIdUri)){const u=AE(l,t);let f=l.eventDuration===4294967295?Number.POSITIVE_INFINITY:l.eventDuration/l.timeScale;f<=.001&&(f=Number.POSITIVE_INFINITY);const d=l.payload;n.samples.push({data:d,len:d.byteLength,dts:u,pts:u,type:Hn.emsg,duration:f})}else if(this.config.enableEmsgKLVMetadata&&l.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const u=AE(l,t);n.samples.push({data:l.payload,len:l.payload.byteLength,dts:u,pts:u,type:Hn.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function AE(i,e){return ge(i.presentationTime)?i.presentationTime/i.timeScale:e+i.presentationTimeDelta/i.timeScale}class Q2{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new wg(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Zi.cbc)}decryptAacSample(e,t,n){const r=e[t].unit;if(r.length<=16)return;const o=r.subarray(16,r.length-r.length%16),l=o.buffer.slice(o.byteOffset,o.byteOffset+o.length);this.decryptBuffer(l).then(u=>{const f=new Uint8Array(u);r.set(f,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)}).catch(n)}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t);let r=0;for(let o=32;o<e.length-16;o+=160,r+=16)n.set(e.subarray(o,o+16),r);return n}getAvcDecryptedUnit(e,t){const n=new Uint8Array(t);let r=0;for(let o=32;o<e.length-16;o+=160,r+=16)e.set(n.subarray(r,r+16),o);return e}decryptAvcSample(e,t,n,r,o){const l=eA(o.data),u=this.getAvcEncryptedData(l);this.decryptBuffer(u.buffer).then(f=>{o.data=this.getAvcDecryptedUnit(l,f),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)}).catch(r)}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}const o=e[t].units;for(;!(n>=o.length);n++){const l=o[n];if(!(l.data.length<=48||l.type!==1&&l.type!==5)&&(this.decryptAvcSample(e,t,n,r,l),!this.decrypter.isSync()))return}}}}class GA{constructor(){this.VideoSample=null}createVideoSample(e,t,n){return{key:e,frame:!1,pts:t,dts:n,units:[],length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){const o=n.units;r=o[o.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const n=t.samples,r=n.length;if(r){const o=n[r-1];e.pts=o.pts,e.dts=o.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,n){const r=t.byteLength;let o=e.naluState||0;const l=o,u=[];let f=0,d,m,g,p=-1,E=0;for(o===-1&&(p=0,E=this.getNALuType(t,0),o=0,f=1);f<r;){if(d=t[f++],!o){o=d?0:1;continue}if(o===1){o=d?0:2;continue}if(!d)o=3;else if(d===1){if(m=f-o-1,p>=0){const S={data:t.subarray(p,m),type:E};u.push(S)}else{const S=this.getLastNalUnit(e.samples);S&&(l&&f<=4-l&&S.state&&(S.data=S.data.subarray(0,S.data.byteLength-l)),m>0&&(S.data=as(S.data,t.subarray(0,m)),S.state=0))}f<r?(g=this.getNALuType(t,f),p=f,E=g,o=0):o=-1}else o=0}if(p>=0&&o>=0){const S={data:t.subarray(p,r),type:E,state:o};u.push(S)}if(u.length===0){const S=this.getLastNalUnit(e.samples);S&&(S.data=as(S.data,t))}return e.naluState=o,u}}class Jo{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),o=Math.min(4,t);if(o===0)throw new Error("no bytes available");r.set(e.subarray(n,n+o)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=o*8,this.bytesAvailable-=o}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const n=this.word>>>32-t;if(e>32&&lt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Z2 extends GA{parsePES(e,t,n,r){const o=this.parseNALu(e,n.data,r);let l=this.VideoSample,u,f=!1;n.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.forEach(d=>{var m,g;switch(d.type){case 1:{let b=!1;u=!0;const T=d.data;if(f&&T.length>4){const A=this.readSliceType(T);(A===2||A===4||A===7||A===9)&&(b=!0)}if(b){var p;(p=l)!=null&&p.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.frame=!0,l.key=b;break}case 5:u=!0,(m=l)!=null&&m.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 6:{u=!0,Rg(d.data,1,n.pts,t.samples);break}case 7:{var E,S;u=!0,f=!0;const b=d.data,T=this.readSPS(b);if(!e.sps||e.width!==T.width||e.height!==T.height||((E=e.pixelRatio)==null?void 0:E[0])!==T.pixelRatio[0]||((S=e.pixelRatio)==null?void 0:S[1])!==T.pixelRatio[1]){e.width=T.width,e.height=T.height,e.pixelRatio=T.pixelRatio,e.sps=[b];const A=b.subarray(1,4);let _="avc1.";for(let w=0;w<3;w++){let D=A[w].toString(16);D.length<2&&(D="0"+D),_+=D}e.codec=_}break}case 8:u=!0,e.pps=[d.data];break;case 9:u=!0,e.audFound=!0,(g=l)!=null&&g.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:u=!0;break;default:u=!1;break}l&&u&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new Jo(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let n=8,r=8,o;for(let l=0;l<e;l++)r!==0&&(o=t.readEG(),r=(n+o+256)%256),n=r===0?n:r}readSPS(e){const t=new Jo(e);let n=0,r=0,o=0,l=0,u,f,d;const m=t.readUByte.bind(t),g=t.readBits.bind(t),p=t.readUEG.bind(t),E=t.readBoolean.bind(t),S=t.skipBits.bind(t),b=t.skipEG.bind(t),T=t.skipUEG.bind(t),A=this.skipScalingList.bind(this);m();const _=m();if(g(5),S(3),m(),T(),_===100||_===110||_===122||_===244||_===44||_===83||_===86||_===118||_===128){const U=p();if(U===3&&S(1),T(),T(),S(1),E())for(f=U!==3?8:12,d=0;d<f;d++)E()&&(d<6?A(16,t):A(64,t))}T();const w=p();if(w===0)p();else if(w===1)for(S(1),b(),b(),u=p(),d=0;d<u;d++)b();T(),S(1);const D=p(),O=p(),B=g(1);B===0&&S(1),S(1),E()&&(n=p(),r=p(),o=p(),l=p());let N=[1,1];if(E()&&E())switch(m()){case 1:N=[1,1];break;case 2:N=[12,11];break;case 3:N=[10,11];break;case 4:N=[16,11];break;case 5:N=[40,33];break;case 6:N=[24,11];break;case 7:N=[20,11];break;case 8:N=[32,11];break;case 9:N=[80,33];break;case 10:N=[18,11];break;case 11:N=[15,11];break;case 12:N=[64,33];break;case 13:N=[160,99];break;case 14:N=[4,3];break;case 15:N=[3,2];break;case 16:N=[2,1];break;case 255:{N=[m()<<8|m(),m()<<8|m()];break}}return{width:Math.ceil((D+1)*16-n*2-r*2),height:(2-B)*(O+1)*16-(B?2:4)*(o+l),pixelRatio:N}}}class J2 extends GA{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,n,r){const o=this.parseNALu(e,n.data,r);let l=this.VideoSample,u,f=!1;n.data=null,l&&o.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),o.forEach(d=>{var m,g;switch(d.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),l.frame=!0,u=!0;break;case 16:case 17:case 18:case 21:if(u=!0,f){var p;(p=l)!=null&&p.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null)}l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:u=!0,(m=l)!=null&&m.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0,l.frame=!0;break;case 39:u=!0,Rg(d.data,2,n.pts,t.samples);break;case 32:u=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=ht(e.params,this.readVPS(d.data)),this.initVPS=d.data),e.vps=[d.data];break;case 33:if(u=!0,f=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],d.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const E=this.readSPS(d.data);e.width=E.width,e.height=E.height,e.pixelRatio=E.pixelRatio,e.codec=E.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const S in E.params)e.params[S]=E.params[S]}this.pushParameterSet(e.sps,d.data,e.vps),l||(l=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),l.key=!0;break;case 34:if(u=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const E=this.readPPS(d.data);for(const S in E)e.params[S]=E[S]}this.pushParameterSet(e.pps,d.data,e.vps)}break;case 35:u=!0,e.audFound=!0,(g=l)!=null&&g.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:u=!1;break}l&&u&&l.units.push(d)}),r&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}pushParameterSet(e,t,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let n=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(t[n]=e[r],n++);return new Uint8Array(t.buffer,0,n)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Jo(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const n=t.readBits(3),r=t.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:r}}readSPS(e){const t=new Jo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const n=t.readBits(3);t.readBoolean();const r=t.readBits(2),o=t.readBoolean(),l=t.readBits(5),u=t.readUByte(),f=t.readUByte(),d=t.readUByte(),m=t.readUByte(),g=t.readUByte(),p=t.readUByte(),E=t.readUByte(),S=t.readUByte(),b=t.readUByte(),T=t.readUByte(),A=t.readUByte(),_=[],w=[];for(let Le=0;Le<n;Le++)_.push(t.readBoolean()),w.push(t.readBoolean());if(n>0)for(let Le=n;Le<8;Le++)t.readBits(2);for(let Le=0;Le<n;Le++)_[Le]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),w[Le]&&t.readUByte();t.readUEG();const D=t.readUEG();D==3&&t.skipBits(1);const O=t.readUEG(),B=t.readUEG(),N=t.readBoolean();let U=0,k=0,F=0,H=0;N&&(U+=t.readUEG(),k+=t.readUEG(),F+=t.readUEG(),H+=t.readUEG());const ne=t.readUEG(),J=t.readUEG(),le=t.readUEG(),de=t.readBoolean();for(let Le=de?0:n;Le<=n;Le++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Ye=0;Ye<4;Ye++)for(let qe=0;qe<(Ye===3?2:6);qe++)if(!t.readBoolean())t.readUEG();else{const nt=Math.min(64,1<<4+(Ye<<1));Ye>1&&t.readEG();for(let Gt=0;Gt<nt;Gt++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const j=t.readUEG();let W=0;for(let Le=0;Le<j;Le++){let Ye=!1;if(Le!==0&&(Ye=t.readBoolean()),Ye){Le===j&&t.readUEG(),t.readBoolean(),t.readUEG();let qe=0;for(let $e=0;$e<=W;$e++){const nt=t.readBoolean();let Gt=!1;nt||(Gt=t.readBoolean()),(nt||Gt)&&qe++}W=qe}else{const qe=t.readUEG(),$e=t.readUEG();W=qe+$e;for(let nt=0;nt<qe;nt++)t.readUEG(),t.readBoolean();for(let nt=0;nt<$e;nt++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const Le=t.readUEG();for(let Ye=0;Ye<Le;Ye++){for(let qe=0;qe<le+4;qe++)t.readBits(1);t.readBits(1)}}let M=0,G=1,te=1,V=!0,se=1,ce=0;t.readBoolean(),t.readBoolean();let fe=!1;if(t.readBoolean()){if(t.readBoolean()){const xt=t.readUByte(),cn=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],Je=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];xt>0&&xt<16?(G=cn[xt-1],te=Je[xt-1]):xt===255&&(G=t.readBits(16),te=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),fe=t.readBoolean(),fe&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(se=t.readBits(32),ce=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const Je=t.readBoolean(),Jt=t.readBoolean();let Ot=!1;(Je||Jt)&&(Ot=t.readBoolean(),Ot&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),Ot&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let fn=0;fn<=n;fn++){V=t.readBoolean();const us=V||t.readBoolean();let Gs=!1;us?t.readEG():Gs=t.readBoolean();const bs=Gs?1:t.readUEG()+1;if(Je)for(let ds=0;ds<bs;ds++)t.readUEG(),t.readUEG(),Ot&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Jt)for(let ds=0;ds<bs;ds++)t.readUEG(),t.readUEG(),Ot&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),M=t.readUEG())}let Ae=O,Qe=B;if(N){let Le=1,Ye=1;D===1?Le=Ye=2:D==2&&(Le=2),Ae=O-Le*k-Le*U,Qe=B-Ye*H-Ye*F}const Ze=r?["A","B","C"][r]:"",Lt=u<<24|f<<16|d<<8|m;let Tt=0;for(let Le=0;Le<32;Le++)Tt=(Tt|(Lt>>Le&1)<<31-Le)>>>0;let Se=Tt.toString(16);return l===1&&Se==="2"&&(Se="6"),{codecString:`hvc1.${Ze}${l}.${Se}.${o?"H":"L"}${A}.B0`,params:{general_tier_flag:o,general_profile_idc:l,general_profile_space:r,general_profile_compatibility_flags:[u,f,d,m],general_constraint_indicator_flags:[g,p,E,S,b,T],general_level_idc:A,bit_depth:ne+8,bit_depth_luma_minus8:ne,bit_depth_chroma_minus8:J,min_spatial_segmentation_idc:M,chroma_format_idc:D,frame_rate:{fixed:V,fps:ce/se}},width:Ae,height:Qe,pixelRatio:[G,te]}}readPPS(e){const t=new Jo(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),o=t.readBoolean();let l=1;return o&&r?l=0:o?l=3:r&&(l=2),{parallelismType:l}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Zt=188;class Vi{constructor(e,t,n,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.logger=r,this.videoParser=null}static probe(e,t){const n=Vi.syncOffset(e);return n>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const t=e.length;let n=Math.min(Zt*5,t-Zt)+1,r=0;for(;r<n;){let o=!1,l=-1,u=0;for(let f=r;f<t;f+=Zt)if(e[f]===71&&(t-f===Zt||e[f+Zt]===71)){if(u++,l===-1&&(l=f,l!==0&&(n=Math.min(l+Zt*99,e.length-Zt)+1)),o||(o=wm(e,f)===0),o&&u>1&&(l===0&&u>2||f+Zt>n))return l}else{if(u)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:qT[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Vi.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=Vi.createTrack("audio",r),this._id3Track=Vi.createTrack("id3"),this._txtTrack=Vi.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let o;const l=this._videoTrack,u=this._audioTrack,f=this._id3Track,d=this._txtTrack;let m=l.pid,g=l.pesData,p=u.pid,E=f.pid,S=u.pesData,b=f.pesData,T=null,A=this.pmtParsed,_=this._pmtId,w=e.length;if(this.remainderData&&(e=as(this.remainderData,e),w=e.length,this.remainderData=null),w<Zt&&!r)return this.remainderData=e,{audioTrack:u,videoTrack:l,id3Track:f,textTrack:d};const D=Math.max(0,Vi.syncOffset(e));w-=(w-D)%Zt,w<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,w,e.buffer.byteLength-w));let O=0;for(let N=D;N<w;N+=Zt)if(e[N]===71){const U=!!(e[N+1]&64),k=wm(e,N),F=(e[N+3]&48)>>4;let H;if(F>1){if(H=N+5+e[N+4],H===N+Zt)continue}else H=N+4;switch(k){case m:U&&(g&&(o=Ia(g,this.logger))&&(this.readyVideoParser(l.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(l,d,o,!1)),g={data:[],size:0}),g&&(g.data.push(e.subarray(H,N+Zt)),g.size+=N+Zt-H);break;case p:if(U){if(S&&(o=Ia(S,this.logger)))switch(u.segmentCodec){case"aac":this.parseAACPES(u,o);break;case"mp3":this.parseMPEGPES(u,o);break;case"ac3":this.parseAC3PES(u,o);break}S={data:[],size:0}}S&&(S.data.push(e.subarray(H,N+Zt)),S.size+=N+Zt-H);break;case E:U&&(b&&(o=Ia(b,this.logger))&&this.parseID3PES(f,o),b={data:[],size:0}),b&&(b.data.push(e.subarray(H,N+Zt)),b.size+=N+Zt-H);break;case 0:U&&(H+=e[H]+1),_=this._pmtId=eU(e,H);break;case _:{U&&(H+=e[H]+1);const ne=tU(e,H,this.typeSupported,n,this.observer,this.logger);m=ne.videoPid,m>0&&(l.pid=m,l.segmentCodec=ne.segmentVideoCodec),p=ne.audioPid,p>0&&(u.pid=p,u.segmentCodec=ne.segmentAudioCodec),E=ne.id3Pid,E>0&&(f.pid=E),T!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${N} after unknown PID '${T}'. Backtracking to sync byte @${D} to parse all TS packets.`),T=null,N=D-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:T=k;break}}else O++;O>0&&Dm(this.observer,new Error(`Found ${O} TS packet/s that do not start with 0x47`),void 0,this.logger),l.pesData=g,u.pesData=S,f.pesData=b;const B={audioTrack:u,videoTrack:l,id3Track:f,textTrack:d};return r&&this.extractRemainingSamples(B),B}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:n,id3Track:r,textTrack:o}=e,l=n.pesData,u=t.pesData,f=r.pesData;let d;if(l&&(d=Ia(l,this.logger))?(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(n,o,d,!0),n.pesData=null)):n.pesData=l,u&&(d=Ia(u,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d);break}t.pesData=null}else u!=null&&u.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=u;f&&(d=Ia(f,this.logger))?(this.parseID3PES(r,d),r.pesData=null):r.pesData=f}demuxSampleAes(e,t,n){const r=this.demux(e,n,!0,!this.config.progressive),o=this.sampleAes=new Q2(this.observer,this.config,t);return this.decrypt(r,o)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new Z2:e==="hevc"&&(this.videoParser=new J2))}decrypt(e,t){return new Promise(n=>{const{audioTrack:r,videoTrack:o}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{o.samples?t.decryptAvcSamples(o.samples,0,0,()=>{n(e)}):n(e)}):o.samples&&t.decryptAvcSamples(o.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let n=0;const r=this.aacOverFlow;let o=t.data;if(r){this.aacOverFlow=null;const g=r.missing,p=r.sample.unit.byteLength;if(g===-1)o=as(r.sample.unit,o);else{const E=p-g;r.sample.unit.set(o.subarray(0,g),E),e.samples.push(r.sample),n=r.missing}}let l,u;for(l=n,u=o.length;l<u-1&&!ju(o,l);l++);if(l!==n){let g;const p=l<u-1;if(p?g=`AAC PES did not start with ADTS header,offset:${l}`:g="No ADTS header found in AAC PES",Dm(this.observer,new Error(g),p,this.logger),!p)return}IA(e,this.observer,o,l,this.audioCodec);let f;if(t.pts!==void 0)f=t.pts;else if(r){const g=NA(e.samplerate);f=r.sample.pts+g}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let d=0,m;for(;l<u;)if(m=OA(e,o,l,f,d),l+=m.length,m.missing){this.aacOverFlow=m;break}else for(d++;l<u-1&&!ju(o,l);l++);}parseMPEGPES(e,t){const n=t.data,r=n.length;let o=0,l=0;const u=t.pts;if(u===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;l<r;)if(FA(n,l)){const f=PA(e,n,l,u,o);if(f)l+=f.length,o++;else break}else l++}parseAC3PES(e,t){{const n=t.data,r=t.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const o=n.length;let l=0,u=0,f;for(;u<o&&(f=$A(e,n,u,r,l++))>0;)u+=f}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=ht({},t,{type:this._videoTrack?Hn.emsg:Hn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function wm(i,e){return((i[e+1]&31)<<8)+i[e+2]}function eU(i,e){return(i[e+10]&31)<<8|i[e+11]}function tU(i,e,t,n,r,o){const l={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},u=(i[e+1]&15)<<8|i[e+2],f=e+3+u-4,d=(i[e+10]&15)<<8|i[e+11];for(e+=12+d;e<f;){const m=wm(i,e),g=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){qh("ADTS AAC",o);break}case 15:l.audioPid===-1&&(l.audioPid=m);break;case 21:l.id3Pid===-1&&(l.id3Pid=m);break;case 219:if(!n){qh("H.264",o);break}case 27:l.videoPid===-1&&(l.videoPid=m);break;case 3:case 4:!t.mpeg&&!t.mp3?o.log("MPEG audio found, not supported in this browser"):l.audioPid===-1&&(l.audioPid=m,l.segmentAudioCodec="mp3");break;case 193:if(!n){qh("AC-3",o);break}case 129:t.ac3?l.audioPid===-1&&(l.audioPid=m,l.segmentAudioCodec="ac3"):o.log("AC-3 audio found, not supported in this browser");break;case 6:if(l.audioPid===-1&&g>0){let p=e+5,E=g;for(;E>2;){i[p]===106&&(t.ac3!==!0?o.log("AC-3 audio found, not supported in this browser for now"):(l.audioPid=m,l.segmentAudioCodec="ac3"));const b=i[p+1]+2;p+=b,E-=b}}break;case 194:case 135:return Dm(r,new Error("Unsupported EC-3 in M2TS found"),void 0,o),l;case 36:l.videoPid===-1&&(l.videoPid=m,l.segmentVideoCodec="hevc",o.log("HEVC in M2TS found"));break}e+=g+5}return l}function Dm(i,e,t,n){n.warn(`parsing error: ${e.message}`),i.emit(L.ERROR,L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function qh(i,e){e.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function Ia(i,e){let t=0,n,r,o,l,u;const f=i.data;if(!i||i.size===0)return null;for(;f[0].length<19&&f.length>1;)f[0]=as(f[0],f[1]),f.splice(1,1);if(n=f[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(r=(n[4]<<8)+n[5],r&&r>i.size-6)return null;const m=n[7];m&192&&(l=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,m&64?(u=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,l-u>60*9e4&&(e.warn(`${Math.round((l-u)/9e4)}s delta between PTS and DTS, align them`),l=u)):u=l),o=n[8];let g=o+9;if(i.size<=g)return null;i.size-=g;const p=new Uint8Array(i.size);for(let E=0,S=f.length;E<S;E++){n=f[E];let b=n.byteLength;if(g)if(g>b){g-=b;continue}else n=n.subarray(g),b-=g,g=0;p.set(n,t),t+=b}return r&&(r-=o+3),{data:p,pts:l,dts:u,len:r}}return null}class nU{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const ji=Math.pow(2,32)-1;class q{static init(){q.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in q.types)q.types.hasOwnProperty(e)&&(q.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);q.HDLR_TYPES={video:t,audio:n};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);q.STTS=q.STSC=q.STCO=o,q.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),q.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),q.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),q.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const l=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);q.FTYP=q.box(q.types.ftyp,l,f,l,u),q.DINF=q.box(q.types.dinf,q.box(q.types.dref,r))}static box(e,...t){let n=8,r=t.length;const o=r;for(;r--;)n+=t[r].byteLength;const l=new Uint8Array(n);for(l[0]=n>>24&255,l[1]=n>>16&255,l[2]=n>>8&255,l[3]=n&255,l.set(e,4),r=0,n=8;r<o;r++)l.set(t[r],n),n+=t[r].byteLength;return l}static hdlr(e){return q.box(q.types.hdlr,q.HDLR_TYPES[e])}static mdat(e){return q.box(q.types.mdat,e)}static mdhd(e,t){t*=e;const n=Math.floor(t/(ji+1)),r=Math.floor(t%(ji+1));return q.box(q.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return q.box(q.types.mdia,q.mdhd(e.timescale||0,e.duration||0),q.hdlr(e.type),q.minf(e))}static mfhd(e){return q.box(q.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?q.box(q.types.minf,q.box(q.types.smhd,q.SMHD),q.DINF,q.stbl(e)):q.box(q.types.minf,q.box(q.types.vmhd,q.VMHD),q.DINF,q.stbl(e))}static moof(e,t,n){return q.box(q.types.moof,q.mfhd(e),q.traf(n,t))}static moov(e){let t=e.length;const n=[];for(;t--;)n[t]=q.trak(e[t]);return q.box.apply(null,[q.types.moov,q.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(q.mvex(e)))}static mvex(e){let t=e.length;const n=[];for(;t--;)n[t]=q.trex(e[t]);return q.box.apply(null,[q.types.mvex,...n])}static mvhd(e,t){t*=e;const n=Math.floor(t/(ji+1)),r=Math.floor(t%(ji+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return q.box(q.types.mvhd,o)}static sdtp(e){const t=e.samples||[],n=new Uint8Array(4+t.length);let r,o;for(r=0;r<t.length;r++)o=t[r].flags,n[r+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return q.box(q.types.sdtp,n)}static stbl(e){return q.box(q.types.stbl,q.stsd(e),q.box(q.types.stts,q.STTS),q.box(q.types.stsc,q.STSC),q.box(q.types.stsz,q.STSZ),q.box(q.types.stco,q.STCO))}static avc1(e){let t=[],n=[],r,o,l;for(r=0;r<e.sps.length;r++)o=e.sps[r],l=o.byteLength,t.push(l>>>8&255),t.push(l&255),t=t.concat(Array.prototype.slice.call(o));for(r=0;r<e.pps.length;r++)o=e.pps[r],l=o.byteLength,n.push(l>>>8&255),n.push(l&255),n=n.concat(Array.prototype.slice.call(o));const u=q.box(q.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(n))),f=e.width,d=e.height,m=e.pixelRatio[0],g=e.pixelRatio[1];return q.box(q.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,q.box(q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),q.box(q.types.pasp,new Uint8Array([m>>24,m>>16&255,m>>8&255,m&255,g>>24,g>>16&255,g>>8&255,g&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return q.box(q.types.mp4a,q.audioStsd(e),q.box(q.types.esds,q.esds(e)))}static mp3(e){return q.box(q.types[".mp3"],q.audioStsd(e))}static ac3(e){return q.box(q.types["ac-3"],q.audioStsd(e),q.box(q.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return q.box(q.types.stsd,q.STSD,q.mp4a(e));if(t==="ac3"&&e.config)return q.box(q.types.stsd,q.STSD,q.ac3(e));if(t==="mp3"&&e.codec==="mp3")return q.box(q.types.stsd,q.STSD,q.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return q.box(q.types.stsd,q.STSD,q.avc1(e));if(t==="hevc"&&e.vps)return q.box(q.types.stsd,q.STSD,q.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,n=(e.duration||0)*(e.timescale||0),r=e.width||0,o=e.height||0,l=Math.floor(n/(ji+1)),u=Math.floor(n%(ji+1));return q.box(q.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,o>>8&255,o&255,0,0]))}static traf(e,t){const n=q.sdtp(e),r=e.id,o=Math.floor(t/(ji+1)),l=Math.floor(t%(ji+1));return q.box(q.types.traf,q.box(q.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),q.box(q.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,l>>24,l>>16&255,l>>8&255,l&255])),q.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,q.box(q.types.trak,q.tkhd(e),q.mdia(e))}static trex(e){const t=e.id;return q.box(q.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const n=e.samples||[],r=n.length,o=12+16*r,l=new Uint8Array(o);let u,f,d,m,g,p;for(t+=8+o,l.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),u=0;u<r;u++)f=n[u],d=f.duration,m=f.size,g=f.flags,p=f.cts,l.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,m>>>24&255,m>>>16&255,m>>>8&255,m&255,g.isLeading<<2|g.dependsOn,g.isDependedOn<<6|g.hasRedundancy<<4|g.paddingValue<<1|g.isNonSync,g.degradPrio&61440,g.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*u);return q.box(q.types.trun,l)}static initSegment(e){q.types||q.init();const t=q.moov(e);return as(q.FTYP,t)}static hvc1(e){const t=e.params,n=[e.vps,e.sps,e.pps],r=4,o=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),r-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),n.length]);let l=o.length;for(let S=0;S<n.length;S+=1){l+=3;for(let b=0;b<n[S].length;b+=1)l+=2+n[S][b].length}const u=new Uint8Array(l);u.set(o,0),l=o.length;const f=n.length-1;for(let S=0;S<n.length;S+=1){u.set(new Uint8Array([32+S|(S===f?128:0),0,n[S].length]),l),l+=3;for(let b=0;b<n[S].length;b+=1)u.set(new Uint8Array([n[S][b].length>>8,n[S][b].length&255]),l),l+=2,u.set(n[S][b],l),l+=n[S][b].length}const d=q.box(q.types.hvcC,u),m=e.width,g=e.height,p=e.pixelRatio[0],E=e.pixelRatio[1];return q.box(q.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,m>>8&255,m&255,g>>8&255,g&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,q.box(q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),q.box(q.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,E>>24,E>>16&255,E>>8&255,E&255])))}}q.types=void 0;q.HDLR_TYPES=void 0;q.STTS=void 0;q.STSC=void 0;q.STCO=void 0;q.STSZ=void 0;q.VMHD=void 0;q.SMHD=void 0;q.STSD=void 0;q.FTYP=void 0;q.DINF=void 0;const zA=9e4;function jg(i,e,t=1,n=!1){const r=i*e*t;return n?Math.round(r):r}function sU(i,e,t=1,n=!1){return jg(i,e,1/t,n)}function Xo(i,e=!1){return jg(i,1e3,1/zA,e)}function iU(i,e=1){return jg(i,zA,1/e)}function RE(i){const{baseTime:e,timescale:t,trackId:n}=i;return`${e/t} (${e}/${t}) trackId: ${n}`}const rU=10*1e3,aU=1024,oU=1152,lU=1536;let Na=null,Xh=null;function CE(i,e,t,n){return{duration:e,size:t,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:i?2:1,isNonSync:i?0:1}}}class uu extends cs{constructor(e,t,n,r){if(super("mp4-remuxer",r),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,Na===null){const l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Na=l?parseInt(l[1]):0}if(Xh===null){const o=navigator.userAgent.match(/Safari\/(\d+)/i);Xh=o?parseInt(o[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const t=this._initPTS;(!t||!e||e.trackId!==t.trackId||e.baseTime!==t.baseTime||e.timescale!==t.timescale)&&this.log(`Reset initPTS: ${t&&RE(t)} > ${e&&RE(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const n=e[0].pts,r=e.reduce((o,l)=>{let u=l.pts,f=u-o;return f<-4294967296&&(t=!0,u=Gn(u,n),f=u-o),f>0?o:u},n);return t&&this.debug("PTS rollover detected"),r}remux(e,t,n,r,o,l,u,f){let d,m,g,p,E,S,b=o,T=o;const A=e.pid>-1,_=t.pid>-1,w=t.samples.length,D=e.samples.length>0,O=u&&w>0||w>1;if((!A||D)&&(!_||O)||this.ISGenerated||u){if(this.ISGenerated){var N,U,k,F;const le=this.videoTrackConfig;(le&&(t.width!==le.width||t.height!==le.height||((N=t.pixelRatio)==null?void 0:N[0])!==((U=le.pixelRatio)==null?void 0:U[0])||((k=t.pixelRatio)==null?void 0:k[1])!==((F=le.pixelRatio)==null?void 0:F[1]))||!le&&O||this.nextAudioTs===null&&D)&&this.resetInitSegment()}this.ISGenerated||(g=this.generateIS(e,t,o,l));const H=this.isVideoContiguous;let ne=-1,J;if(O&&(ne=cU(t.samples),!H&&this.config.forceKeyFrameOnDiscontinuity))if(S=!0,ne>0){this.warn(`Dropped ${ne} out of ${w} video samples due to a missing keyframe`);const le=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(ne),t.dropped+=ne,T+=(t.samples[0].pts-le)/t.inputTimeScale,J=T}else ne===-1&&(this.warn(`No keyframe found out of ${w} video samples`),S=!1);if(this.ISGenerated){if(D&&O){const le=this.getVideoStartPts(t.samples),P=(Gn(e.samples[0].pts,le)-le)/t.inputTimeScale;b+=Math.max(0,P),T+=Math.max(0,-P)}if(D){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),g=this.generateIS(e,t,o,l)),m=this.remuxAudio(e,b,this.isAudioContiguous,l,_||O||f===pe.AUDIO?T:void 0),O){const le=m?m.endPTS-m.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),g=this.generateIS(e,t,o,l)),d=this.remuxVideo(t,T,H,le)}}else O&&(d=this.remuxVideo(t,T,H,0));d&&(d.firstKeyFrame=ne,d.independent=ne!==-1,d.firstKeyFramePTS=J)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(E=HA(n,o,this._initPTS,this._initDTS)),r.samples.length&&(p=VA(r,o,this._initPTS))),{audio:m,video:d,initSegment:g,independent:S,text:p,id3:E}}computeInitPts(e,t,n,r){const o=Math.round(n*t);let l=Gn(e,o);if(l<o+t)for(this.log(`Adjusting PTS for rollover in timeline near ${(o-l)/t} ${r}`);l<o+t;)l+=8589934592;return l-o}generateIS(e,t,n,r){const o=e.samples,l=t.samples,u=this.typeSupported,f={},d=this._initPTS;let m=!d||r,g="audio/mp4",p,E,S,b=-1;if(m&&(p=E=1/0),e.config&&o.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(g="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}f.audio={id:"audio",container:g,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&u.mpeg?new Uint8Array(0):q.initSegment([e]),metadata:{channelCount:e.channelCount}},m&&(b=e.id,S=e.inputTimeScale,!d||S!==d.timescale?p=E=this.computeInitPts(o[0].pts,S,n,"audio"):m=!1)}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,f.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:q.initSegment([t]),metadata:{width:t.width,height:t.height}},m)if(b=t.id,S=t.inputTimeScale,!d||S!==d.timescale){const T=this.getVideoStartPts(l),A=Gn(l[0].dts,T),_=this.computeInitPts(A,S,n,"video"),w=this.computeInitPts(T,S,n,"video");E=Math.min(E,_),p=Math.min(p,w)}else m=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(f).length)return this.ISGenerated=!0,m?(d&&this.warn(`Timestamps at playlist time: ${r?"":"~"}${n} ${p/S} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${p/S} (${p}/${S}) trackId: ${b}`),this._initPTS={baseTime:p,timescale:S,trackId:b},this._initDTS={baseTime:E,timescale:S,trackId:b}):p=S=void 0,{tracks:f,initPTS:p,timescale:S,trackId:b}}remuxVideo(e,t,n,r){const o=e.inputTimeScale,l=e.samples,u=[],f=l.length,d=this._initPTS,m=d.baseTime*o/d.timescale;let g=this.nextVideoTs,p=8,E=this.videoSampleDuration,S,b,T=Number.POSITIVE_INFINITY,A=Number.NEGATIVE_INFINITY,_=!1;if(!n||g===null){const M=m+t*o,G=l[0].pts-Gn(l[0].dts,l[0].pts);Na&&g!==null&&Math.abs(M-G-(g+m))<15e3?n=!0:g=M-G-m}const w=g+m;for(let M=0;M<f;M++){const G=l[M];G.pts=Gn(G.pts,w),G.dts=Gn(G.dts,w),G.dts<l[M>0?M-1:M].dts&&(_=!0)}_&&l.sort(function(M,G){const te=M.dts-G.dts,V=M.pts-G.pts;return te||V}),S=l[0].dts,b=l[l.length-1].dts;const D=b-S,O=D?Math.round(D/(f-1)):E||e.inputTimeScale/30;if(n){const M=S-w,G=M>O,te=M<-1;if((G||te)&&(G?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Xo(M,!0)} ms (${M}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Xo(-M,!0)} ms (${M}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!te||w>=l[0].pts||Na)){S=w;const V=l[0].pts-M;if(G)l[0].dts=S,l[0].pts=V;else{let se=!0;for(let ce=0;ce<l.length&&!(l[ce].dts>V&&se);ce++){const fe=l[ce].pts;if(l[ce].dts-=M,l[ce].pts-=M,ce<l.length-1){const ve=l[ce+1].pts,Ae=l[ce].pts,Qe=ve<=Ae,Ze=ve<=fe;se=Qe==Ze}}}this.log(`Video: Initial PTS/DTS adjusted: ${Xo(V,!0)}/${Xo(S,!0)}, delta: ${Xo(M,!0)} ms`)}}S=Math.max(0,S);let B=0,N=0,U=S;for(let M=0;M<f;M++){const G=l[M],te=G.units,V=te.length;let se=0;for(let ce=0;ce<V;ce++)se+=te[ce].data.length;N+=se,B+=V,G.length=se,G.dts<U?(G.dts=U,U+=O/4|0||1):U=G.dts,T=Math.min(G.pts,T),A=Math.max(G.pts,A)}b=l[f-1].dts;const k=N+4*B+8;let F;try{F=new Uint8Array(k)}catch(M){this.observer.emit(L.ERROR,L.ERROR,{type:Te.MUX_ERROR,details:X.REMUX_ALLOC_ERROR,fatal:!1,error:M,bytes:k,reason:`fail allocating video mdat ${k}`});return}const H=new DataView(F.buffer);H.setUint32(0,k),F.set(q.types.mdat,4);let ne=!1,J=Number.POSITIVE_INFINITY,le=Number.POSITIVE_INFINITY,de=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let M=0;M<f;M++){const G=l[M],te=G.units;let V=0;for(let fe=0,ve=te.length;fe<ve;fe++){const Ae=te[fe],Qe=Ae.data,Ze=Ae.data.byteLength;H.setUint32(p,Ze),p+=4,F.set(Qe,p),p+=Ze,V+=4+Ze}let se;if(M<f-1)E=l[M+1].dts-G.dts,se=l[M+1].pts-G.pts;else{const fe=this.config,ve=M>0?G.dts-l[M-1].dts:O;if(se=M>0?G.pts-l[M-1].pts:O,fe.stretchShortVideoTrack&&this.nextAudioTs!==null){const Ae=Math.floor(fe.maxBufferHole*o),Qe=(r?T+r*o:this.nextAudioTs+m)-G.pts;Qe>Ae?(E=Qe-ve,E<0?E=ve:ne=!0,this.log(`It is approximately ${Qe/90} ms to the next segment; using duration ${E/90} ms for the last video frame.`)):E=ve}else E=ve}const ce=Math.round(G.pts-G.dts);J=Math.min(J,E),de=Math.max(de,E),le=Math.min(le,se),P=Math.max(P,se),u.push(CE(G.key,E,V,ce))}if(u.length){if(Na){if(Na<70){const M=u[0].flags;M.dependsOn=2,M.isNonSync=0}}else if(Xh&&P-le<de-J&&O/de<.025&&u[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let M=S;for(let G=0,te=u.length;G<te;G++){const V=M+u[G].duration,se=M+u[G].cts;if(G<te-1){const ce=V+u[G+1].cts;u[G].duration=ce-se}else u[G].duration=G?u[G-1].duration:O;u[G].cts=0,M=V}}}E=ne||!E?O:E;const K=b+E;this.nextVideoTs=g=K-m,this.videoSampleDuration=E,this.isVideoContiguous=!0;const he={data1:q.moof(e.sequenceNumber++,S,ht(e,{samples:u})),data2:F,startPTS:(T-m)/o,endPTS:(A+E-m)/o,startDTS:(S-m)/o,endDTS:g/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,he}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return oU;case"ac3":return lU;default:return aU}}remuxAudio(e,t,n,r,o){const l=e.inputTimeScale,u=e.samplerate?e.samplerate:l,f=l/u,d=this.getSamplesPerFrame(e),m=d*f,g=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,E=[],S=o!==void 0;let b=e.samples,T=p?0:8,A=this.nextAudioTs||-1;const _=g.baseTime*l/g.timescale,w=_+t*l;if(this.isAudioContiguous=n=n||b.length&&A>0&&(r&&Math.abs(w-(A+_))<9e3||Math.abs(Gn(b[0].pts,w)-(A+_))<20*m),b.forEach(function(P){P.pts=Gn(P.pts,w)}),!n||A<0){const P=b.length;if(b=b.filter(K=>K.pts>=0),P!==b.length&&this.warn(`Removed ${b.length-P} of ${P} samples (initPTS ${_} / ${l})`),!b.length)return;o===0?A=0:r&&!S?A=Math.max(0,w-_):A=b[0].pts-_}if(e.segmentCodec==="aac"){const P=this.config.maxAudioFramesDrift;for(let K=0,j=A+_;K<b.length;K++){const W=b[K],he=W.pts,M=he-j,G=Math.abs(1e3*M/l);if(M<=-P*m&&S)K===0&&(this.warn(`Audio frame @ ${(he/l).toFixed(3)}s overlaps marker by ${Math.round(1e3*M/l)} ms.`),this.nextAudioTs=A=he-_,j=he);else if(M>=P*m&&G<rU&&S){let te=Math.round(M/m);for(j=he-te*m;j<0&&te&&m;)te--,j+=m;K===0&&(this.nextAudioTs=A=j-_),this.warn(`Injecting ${te} audio frames @ ${((j-_)/l).toFixed(3)}s due to ${Math.round(1e3*M/l)} ms gap.`);for(let V=0;V<te;V++){let se=nU.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);se||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),se=W.unit.subarray()),b.splice(K,0,{unit:se,pts:j}),j+=m,K++}}W.pts=j,j+=m}}let D=null,O=null,B,N=0,U=b.length;for(;U--;)N+=b[U].unit.byteLength;for(let P=0,K=b.length;P<K;P++){const j=b[P],W=j.unit;let he=j.pts;if(O!==null){const G=E[P-1];G.duration=Math.round((he-O)/f)}else if(n&&e.segmentCodec==="aac"&&(he=A+_),D=he,N>0){N+=T;try{B=new Uint8Array(N)}catch(G){this.observer.emit(L.ERROR,L.ERROR,{type:Te.MUX_ERROR,details:X.REMUX_ALLOC_ERROR,fatal:!1,error:G,bytes:N,reason:`fail allocating audio mdat ${N}`});return}p||(new DataView(B.buffer).setUint32(0,N),B.set(q.types.mdat,4))}else return;B.set(W,T);const M=W.byteLength;T+=M,E.push(CE(!0,d,M,0)),O=he}const k=E.length;if(!k)return;const F=E[E.length-1];A=O-_,this.nextAudioTs=A+f*F.duration;const H=p?new Uint8Array(0):q.moof(e.sequenceNumber++,D/f,ht({},e,{samples:E}));e.samples=[];const ne=(D-_)/l,J=this.nextAudioTs/l,de={data1:H,data2:B,startPTS:ne,endPTS:J,startDTS:ne,endDTS:J,type:"audio",hasAudio:!0,hasVideo:!1,nb:k};return this.isAudioContiguous=!0,de}}function Gn(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function cU(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function HA(i,e,t,n){const r=i.samples.length;if(!r)return;const o=i.inputTimeScale;for(let u=0;u<r;u++){const f=i.samples[u];f.pts=Gn(f.pts-t.baseTime*o/t.timescale,e*o)/o,f.dts=Gn(f.dts-n.baseTime*o/n.timescale,e*o)/o}const l=i.samples;return i.samples=[],{samples:l}}function VA(i,e,t){const n=i.samples.length;if(!n)return;const r=i.inputTimeScale;for(let l=0;l<n;l++){const u=i.samples[l];u.pts=Gn(u.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((l,u)=>l.pts-u.pts);const o=i.samples;return i.samples=[],{samples:o}}class uU extends cs{constructor(e,t,n,r){super("passthrough-remuxer",r),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(e,r),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:n,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:o,video:l}=this.initData=QT(e);if(t)Qk(e,t);else{const f=o||l;f!=null&&f.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${f.codec}")!`)}o&&(n=LE(o,gt.AUDIO,this)),l&&(r=LE(l,gt.VIDEO,this));const u={};o&&l?u.audiovideo={container:"video/mp4",codec:n+","+r,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:e,id:"main"}:o?u.audio={container:"audio/mp4",codec:n,encrypted:o.encrypted,initSegment:e,id:"audio"}:l?u.video={container:"video/mp4",codec:r,supplemental:l.supplemental,encrypted:l.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=u}remux(e,t,n,r,o,l){var u,f;let{initPTS:d,lastEndTime:m}=this;const g={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};ge(m)||(m=this.lastEndTime=o||0);const p=t.samples;if(!p.length)return g;const E={initPTS:void 0,timescale:void 0,trackId:void 0};let S=this.initData;if((u=S)!=null&&u.length||(this.generateInitSegment(p),S=this.initData),!((f=S)!=null&&f.length))return this.warn("Failed to generate initSegment."),g;this.emitInitSegment&&(E.tracks=this.initTracks,this.emitInitSegment=!1);const b=Jk(p,S,this),T=S.audio?b[S.audio.id]:null,A=S.video?b[S.video.id]:null,_=qc(A,1/0),w=qc(T,1/0),D=qc(A,0,!0),O=qc(T,0,!0);let B=o,N=0;const U=T&&(!A||!d&&w<_||d&&d.trackId===S.audio.id),k=U?T:A;if(k){const j=k.timescale,W=k.start-o*j,he=U?S.audio.id:S.video.id;B=k.start/j,N=U?O-w:D-_,(l||!d)&&(dU(d,B,o,N)||j!==d.timescale)&&(d&&this.warn(`Timestamps at playlist time: ${l?"":"~"}${o} ${W/j} != initPTS: ${d.baseTime/d.timescale} (${d.baseTime}/${d.timescale}) trackId: ${d.trackId}`),this.log(`Found initPTS at playlist time: ${o} offset: ${B-o} (${W}/${j}) trackId: ${he}`),d=null,E.initPTS=W,E.timescale=j,E.trackId=he)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${o}`);d?(E.initPTS=d.baseTime,E.timescale=d.timescale,E.trackId=d.trackId):((!E.timescale||E.trackId===void 0||E.initPTS===void 0)&&(this.warn("Could not set initPTS"),E.initPTS=B,E.timescale=1,E.trackId=-1),this.initPTS=d={baseTime:E.initPTS,timescale:E.timescale,trackId:E.trackId});const F=B-d.baseTime/d.timescale,H=F+N;N>0?this.lastEndTime=H:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const ne=!!S.audio,J=!!S.video;let le="";ne&&(le+="audio"),J&&(le+="video");const de=(S.audio?S.audio.encrypted:!1)||(S.video?S.video.encrypted:!1),P={data1:p,startPTS:F,startDTS:F,endPTS:H,endDTS:H,type:le,hasAudio:ne,hasVideo:J,nb:1,dropped:0,encrypted:de};g.audio=ne&&!J?P:void 0,g.video=J?P:void 0;const K=A?.sampleCount;if(K){const j=A.keyFrameIndex,W=j!==-1;P.nb=K,P.dropped=j===0||this.isVideoContiguous?0:W?j:K,P.independent=W,P.firstKeyFrame=j,W&&A.keyFrameStart&&(P.firstKeyFramePTS=(A.keyFrameStart-d.baseTime)/d.timescale),this.isVideoContiguous||(g.independent=W),this.isVideoContiguous||(this.isVideoContiguous=W),P.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${j}/${K} dropped: ${P.dropped} start: ${P.firstKeyFramePTS||"NA"}`)}return g.initSegment=E,g.id3=HA(n,o,d,d),r.samples.length&&(g.text=VA(r,o,d)),g}}function qc(i,e,t=!1){return i?.start!==void 0?(i.start+(t?i.duration:0))/i.timescale:e}function dU(i,e,t,n){if(i===null)return!0;const r=Math.max(n,1),o=e-i.baseTime/i.timescale;return Math.abs(o-t)>r}function LE(i,e,t){const n=i.codec;return n&&n.length>4?n:e===gt.AUDIO?n==="ec-3"||n==="ac-3"||n==="alac"?n:n==="fLaC"||n==="Opus"?Nu(n,!1):(t.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"):(t.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1")}let di;try{di=self.performance.now.bind(self.performance)}catch{di=Date.now}const du=[{demux:W2,remux:uU},{demux:Vi,remux:uu},{demux:K2,remux:uu},{demux:q2,remux:uu}];du.splice(2,0,{demux:Y2,remux:uu});class _E{constructor(e,t,n,r,o,l){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.id=o,this.logger=l}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){const o=n.transmuxing;o.executeStart=di();let l=new Uint8Array(e);const{currentTransmuxState:u,transmuxConfig:f}=this;r&&(this.currentTransmuxState=r);const{contiguous:d,discontinuity:m,trackSwitch:g,accurateTimeOffset:p,timeOffset:E,initSegmentChange:S}=r||u,{audioCodec:b,videoCodec:T,defaultInitPts:A,duration:_,initSegmentData:w}=f,D=fU(l,t);if(D&&ja(D.method)){const U=this.getDecrypter(),k=Ig(D.method);if(U.isSync()){let F=U.softwareDecrypt(l,D.key.buffer,D.iv.buffer,k);if(n.part>-1){const ne=U.flush();F=ne&&ne.buffer}if(!F)return o.executeEnd=di(),Wh(n);l=new Uint8Array(F)}else return this.asyncResult=!0,this.decryptionPromise=U.webCryptoDecrypt(l,D.key.buffer,D.iv.buffer,k).then(F=>{const H=this.push(F,null,n);return this.decryptionPromise=null,H}),this.decryptionPromise}const O=this.needsProbing(m,g);if(O){const U=this.configureTransmuxer(l);if(U)return this.logger.warn(`[transmuxer] ${U.message}`),this.observer.emit(L.ERROR,L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,fatal:!1,error:U,reason:U.message}),o.executeEnd=di(),Wh(n)}(m||g||S||O)&&this.resetInitSegment(w,b,T,_,t),(m||S||O)&&this.resetInitialTimestamp(A),d||this.resetContiguity();const B=this.transmux(l,D,E,p,n);this.asyncResult=ul(B);const N=this.currentTransmuxState;return N.contiguous=!0,N.discontinuity=!1,N.trackSwitch=!1,o.executeEnd=di(),B}flush(e){const t=e.transmuxing;t.executeStart=di();const{decrypter:n,currentTransmuxState:r,decryptionPromise:o}=this;if(o)return this.asyncResult=!0,o.then(()=>this.flush(e));const l=[],{timeOffset:u}=r;if(n){const g=n.flush();g&&l.push(this.push(g.buffer,null,e))}const{demuxer:f,remuxer:d}=this;if(!f||!d){t.executeEnd=di();const g=[Wh(e)];return this.asyncResult?Promise.resolve(g):g}const m=f.flush(u);return ul(m)?(this.asyncResult=!0,m.then(g=>(this.flushRemux(l,g,e),l))):(this.flushRemux(l,m,e),this.asyncResult?Promise.resolve(l):l)}flushRemux(e,t,n){const{audioTrack:r,videoTrack:o,id3Track:l,textTrack:u}=t,{accurateTimeOffset:f,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===pe.MAIN?"level":"track"} ${n.level}`);const m=this.remuxer.remux(r,o,l,u,d,f,!0,this.id);e.push({remuxResult:m,chunkMeta:n}),n.transmuxing.executeEnd=di()}resetInitialTimestamp(e){const{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,o){const{demuxer:l,remuxer:u}=this;!l||!u||(l.resetInitSegment(e,t,n,r),u.resetInitSegment(e,t,n,o))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,o){let l;return t&&t.method==="SAMPLE-AES"?l=this.transmuxSampleAes(e,t,n,r,o):l=this.transmuxUnencrypted(e,n,r,o),l}transmuxUnencrypted(e,t,n,r){const{audioTrack:o,videoTrack:l,id3Track:u,textTrack:f}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(o,l,u,f,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,o){return this.demuxer.demuxSampleAes(e,t,n).then(l=>({remuxResult:this.remuxer.remux(l.audioTrack,l.videoTrack,l.id3Track,l.textTrack,n,r,!1,this.id),chunkMeta:o}))}configureTransmuxer(e){const{config:t,observer:n,typeSupported:r}=this;let o;for(let g=0,p=du.length;g<p;g++){var l;if((l=du[g].demux)!=null&&l.probe(e,this.logger)){o=du[g];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const u=this.demuxer,f=this.remuxer,d=o.remux,m=o.demux;(!f||!(f instanceof d))&&(this.remuxer=new d(n,t,r,this.logger)),(!u||!(u instanceof m))&&(this.demuxer=new m(n,t,r,this.logger),this.probe=m.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new wg(this.config)),e}}function fU(i,e){let t=null;return i.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const Wh=i=>({remuxResult:{},chunkMeta:i});function ul(i){return"then"in i&&i.then instanceof Function}class hU{constructor(e,t,n,r,o){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=o||null}}class mU{constructor(e,t,n,r,o,l){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=o,this.initSegmentChange=l}}let wE=0;class KA{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=wE++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=f=>{const d=f.data,m=this.hls;if(!(!m||!(d!=null&&d.event)||d.instanceNo!==this.instanceNo))switch(d.event){case"init":{var g;const p=(g=this.workerContext)==null?void 0:g.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(d.data);break}case"flush":{this.onFlush(d.data);break}case"workerLog":{m.logger[d.data.logType]&&m.logger[d.data.logType](d.data.message);break}default:{d.data=d.data||{},d.data.frag=this.frag,d.data.part=this.part,d.data.id=this.id,m.trigger(d.event,d.data);break}}},this.onWorkerError=f=>{if(!this.hls)return;const d=new Error(`${f.message}  (${f.filename}:${f.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:d})};const o=e.config;this.hls=e,this.id=t,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;const l=(f,d)=>{d=d||{},d.frag=this.frag||void 0,f===L.ERROR&&(d=d,d.parent=this.id,d.part=this.part,this.error=d.error),this.hls.trigger(f,d)};this.observer=new Mg,this.observer.on(L.FRAG_DECRYPTED,l),this.observer.on(L.ERROR,l);const u=Hx(o.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const f=this.hls.logger;if(o.workerPath||y2()){try{o.workerPath?(f.log(`loading Web Worker ${o.workerPath} for "${t}"`),this.workerContext=E2(o.workerPath)):(f.log(`injecting Web Worker for "${t}"`),this.workerContext=x2());const{worker:m}=this.workerContext;m.addEventListener("message",this.onWorkerMessage),m.addEventListener("error",this.onWorkerError),m.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:u,id:t,config:pt(o)})}catch(m){f.warn(`Error setting up "${t}" Web Worker, fallback to inline`,m),this.terminateWorker(),this.error=null,this.transmuxer=new _E(this.observer,u,o,"",t,e.logger)}return}}this.transmuxer=new _E(this.observer,u,o,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=wE++;const t=this.hls.config,n=Hx(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:pt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),S2(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,n,r,o,l,u,f,d,m){var g,p;d.transmuxing.start=self.performance.now();const{instanceNo:E,transmuxer:S}=this,b=l?l.start:o.start,T=o.decryptdata,A=this.frag,_=!(A&&o.cc===A.cc),w=!(A&&d.level===A.level),D=A?d.sn-A.sn:-1,O=this.part?d.part-this.part.index:-1,B=D===0&&d.id>1&&d.id===A?.stats.chunkCount,N=!w&&(D===1||D===0&&(O===1||B&&O<=0)),U=self.performance.now();(w||D||o.stats.parsing.start===0)&&(o.stats.parsing.start=U),l&&(O||!N)&&(l.stats.parsing.start=U);const k=!(A&&((g=o.initSegment)==null?void 0:g.url)===((p=A.initSegment)==null?void 0:p.url)),F=new mU(_,N,f,w,b,k);if(!N||_||k){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${o.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===pe.MAIN?"level":"track"}: ${d.level} id: ${d.id}
        discontinuity: ${_}
        trackSwitch: ${w}
        contiguous: ${N}
        accurateTimeOffset: ${f}
        timeOffset: ${b}
        initSegmentChange: ${k}`);const H=new hU(n,r,t,u,m);this.configureTransmuxer(H)}if(this.frag=o,this.part=l,this.workerContext)this.workerContext.worker.postMessage({instanceNo:E,cmd:"demux",data:e,decryptdata:T,chunkMeta:d,state:F},e instanceof ArrayBuffer?[e]:[]);else if(S){const H=S.push(e,T,d,F);ul(H)?H.then(ne=>{this.handleTransmuxComplete(ne)}).catch(ne=>{this.transmuxerError(ne,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(H)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(n){const r=n.flush(e);ul(r)?r.then(o=>{this.handleFlushResult(o,e)}).catch(o=>{this.transmuxerError(o,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const DE=100;class gU extends Og{constructor(e,t,n){super(e,t,n,"audio-stream-controller",pe.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:o,trackId:l}){if(n===pe.MAIN){const u=t.cc,f=this.fragCurrent;if(this.initPTS[u]={baseTime:r,timescale:o,trackId:l},this.log(`InitPTS for cc: ${u} found from main: ${r/o} (${r}/${o}) trackId: ${l}`),this.mainAnchor=t,this.state===ae.WAITING_INIT_PTS){const d=this.waitingData;(!d&&!this.loadingParts||d&&d.frag.cc!==u)&&this.syncWithAnchor(t,d?.frag)}else!this.hls.hasEnoughToStart&&f&&f.cc!==u?(f.abortRequests(),this.syncWithAnchor(t,f)):this.state===ae.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var n;const r=((n=this.mainFragLoading)==null?void 0:n.frag)||null;if(t&&r?.cc===t.cc)return;const o=(r||e).cc,l=this.getLevelDetails(),u=this.getLoadPosition(),f=lA(l,o,u);f&&(this.log(`Syncing with main frag at ${f.start} cc ${f.cc}`),this.startFragRequested=!1,this.nextLoadPosition=f.start,this.resetLoadingState(),this.state===ae.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=ae.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(DE),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=ae.IDLE):this.state=ae.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ae.IDLE:this.doTickIdle();break;case ae.WAITING_TRACK:{const{levels:e,trackId:t}=this,n=e?.[t],r=n?.details;if(r&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(r))break;this.state=ae.WAITING_INIT_PTS}break}case ae.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case ae.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:t,part:n,cache:r,complete:o}=e,l=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=ae.FRAG_LOADING;const u=r.flush().buffer,f={frag:t,part:n,payload:u,networkDetails:null};this._handleFragmentLoadProgress(f),o&&super._handleFragmentLoadComplete(f)}else l&&l.cc!==e.frag.cc&&this.syncWithAnchor(l,e.frag)}else this.state=ae.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:n,media:r,trackId:o}=this,l=t.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!l.startFragPrefetch)||!(n!=null&&n[o]))return;const u=n[o],f=u.details;if(!f||this.waitForLive(u)||this.waitForCdnTuneIn(f)){this.state=ae.WAITING_TRACK,this.startFragRequested=!1;return}const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,gt.AUDIO,pe.AUDIO));const m=this.getFwdBufferInfo(d,pe.AUDIO);if(m===null)return;if(!this.switchingTrack&&this._streamEnded(m,f)){t.trigger(L.BUFFER_EOS,{type:"audio"}),this.state=ae.ENDED;return}const g=m.len,p=t.maxBufferLength,E=f.fragments,S=E[0].start,b=this.getLoadPosition(),T=this.flushing?b:m.end;if(this.switchingTrack&&r){const w=b;f.PTSKnown&&w<S&&(m.end>S||m.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=S+.05)}if(g>=p&&!this.switchingTrack&&T<E[E.length-1].start)return;let A=this.getNextFragment(T,f);if(A&&this.isLoopLoading(A,T)&&(A=this.getNextFragmentLoopLoading(A,f,m,pe.MAIN,p)),!A){this.bufferFlushed=!0;return}let _=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&_&&Pt(A)&&!A.endList&&(!f.live||!this.loadingParts&&T<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(_)===Xt.OK&&(this.mainFragLoading=_=null),_&&Pt(_))){if(A.start>_.end){const D=this.fragmentTracker.getFragAtPos(T,pe.MAIN);D&&D.end>_.end&&(_=D,this.mainFragLoading={frag:D,targetBufferTime:null})}if(A.start>_.end)return}this.loadFragment(A,u,T)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new ol(n))}onAudioTrackSwitching(e,t){const n=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==ae.STOPPED&&(this.setInterval(DE),this.state=ae.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(L.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,t){var n;const{levels:r}=this,{details:o,id:l,groupId:u,track:f}=t;if(!r){this.warn(`Audio tracks reset while loading track ${l} "${f.name}" of "${u}"`);return}const d=this.mainDetails;if(!d||o.endCC>d.endCC||d.expired){this.cachedTrackLoadedData=t,this.state!==ae.STOPPED&&(this.state=ae.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${f.name}" of "${u}" loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`);const m=r[l];let g=0;if(o.live||(n=m.details)!=null&&n.live){if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;if(m.details){var p;g=this.alignPlaylists(o,m.details,(p=this.levelLastLoaded)==null?void 0:p.details)}o.alignedSliding||(CA(o,d),o.alignedSliding||Bu(o,d),g=o.fragmentStart)}m.details=o,this.levelLastLoaded=m,this.startFragRequested||this.setStartPosition(d,g),this.hls.trigger(L.AUDIO_TRACK_UPDATED,{details:o,id:l,groupId:t.groupId}),this.state===ae.WAITING_TRACK&&!this.waitForCdnTuneIn(o)&&(this.state=ae.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:o}=e,{config:l,trackId:u,levels:f}=this;if(!f){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const d=f[u];if(!d){this.warn("Audio track is undefined on fragment load progress");return}const m=d.details;if(!m){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const g=l.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new KA(this.hls,pe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const E=this.initPTS[n.cc],S=(t=n.initSegment)==null?void 0:t.data;if(E!==void 0){const T=r?r.index:-1,A=T!==-1,_=new Dg(n.level,n.sn,n.stats.chunkCount,o.byteLength,T,A);p.push(o,S,g,"",n,r,m.totalduration,!1,_,E)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${m.startSN} ,${m.endSN}],track ${u}`);const{cache:b}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new LA,complete:!1};b.push(new Uint8Array(o)),this.state!==ae.STOPPED&&(this.state=ae.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===pe.MAIN&&Pt(t.frag)&&(this.mainFragLoading=t,this.state===ae.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:n,part:r}=t;if(n.type!==pe.AUDIO){!this.audioOnly&&n.type===pe.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Pt(n)){this.fragPrevious=n;const o=this.switchingTrack;o&&(this.bufferedTrack=o,this.switchingTrack=null,this.hls.trigger(L.AUDIO_TRACK_SWITCHED,ot({},o)))}this.fragBufferedComplete(n,r),this.media&&this.tick()}onError(e,t){var n;if(t.fatal){this.state=ae.ERROR;return}switch(t.details){case X.FRAG_GAP:case X.FRAG_PARSING_ERROR:case X.FRAG_DECRYPT_ERROR:case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(pe.AUDIO,t);break;case X.AUDIO_TRACK_LOAD_ERROR:case X.AUDIO_TRACK_LOAD_TIMEOUT:case X.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ae.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===Ge.AUDIO_TRACK&&(this.state=ae.IDLE);break;case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case X.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case X.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==gt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==gt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===ae.ENDED&&(this.state=ae.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,pe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const n="audio",{hls:r}=this,{remuxResult:o,chunkMeta:l}=e,u=this.getCurrentContext(l);if(!u){this.resetWhenMissingContext(l);return}const{frag:f,part:d,level:m}=u,{details:g}=m,{audio:p,text:E,id3:S,initSegment:b}=o;if(this.fragContextChanged(f)||!g){this.fragmentTracker.removeFragment(f);return}if(this.state=ae.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),b!=null&&b.tracks){const T=f.initSegment||f;if(this.unhandledEncryptionError(b,f))return;this._bufferInitSegment(m,b.tracks,T,l),r.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:n,tracks:b.tracks})}if(p){const{startPTS:T,endPTS:A,startDTS:_,endDTS:w}=p;d&&(d.elementaryStreams[gt.AUDIO]={startPTS:T,endPTS:A,startDTS:_,endDTS:w}),f.setElementaryStreamInfo(gt.AUDIO,T,A,_,w),this.bufferFragmentData(p,f,d,l)}if(S!=null&&(t=S.samples)!=null&&t.length){const T=ht({id:n,frag:f,details:g},S);r.trigger(L.FRAG_PARSING_METADATA,T)}if(E){const T=ht({id:n,frag:f,details:g},E);r.trigger(L.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(e,t,n,r){if(this.state!==ae.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const o=t.audio;o.id=pe.AUDIO;const l=e.audioCodec;this.log(`Init audio buffer, container:${o.container}, codecs[level/parsed]=[${l}/${o.codec}]`),l&&l.split(",").length===1&&(o.levelCodec=l),this.hls.trigger(L.BUFFER_CODECS,t);const u=o.initSegment;if(u!=null&&u.byteLength){const f={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:u};this.hls.trigger(L.BUFFER_APPENDING,f)}this.tickImmediate()}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===Xt.NOT_LOADED||r===Xt.PARTIAL){var o;if(!Pt(e))this._loadInitSegment(e,t);else if((o=t.details)!=null&&o.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=ae.WAITING_INIT_PTS;const l=this.mainDetails;l&&l.fragmentStart!==t.details.fragmentStart&&Bu(t.details,l)}else super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:n,assocLang:r,characteristics:o,audioCodec:l,channels:u}=this.bufferedTrack;Lr({name:t,lang:n,assocLang:r,characteristics:o,audioCodec:l,channels:u},e,Rr)||(Mu(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(L.AUDIO_TRACK_SWITCHED,ot({},e))}}class $g extends cs{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){const r=t?.renditionReports;if(r){let o=-1;for(let l=0;l<r.length;l++){const u=r[l];let f;try{f=new self.URL(u.URI,t.url).href}catch(d){this.warn(`Could not construct new URL for Rendition Report: ${d}`),f=u.URI||""}if(f===e){o=l;break}else f===e.substring(0,f.length)&&(o=l)}if(o!==-1){const l=r[o],u=parseInt(l["LAST-MSN"])||t.lastPartSn;let f=parseInt(l["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){const m=Math.min(t.age-t.partTarget,t.targetduration);f>=0&&m>t.partTarget&&(f+=1)}const d=n&&Vx(n);return new Kx(u,f>=0?f:void 0,d)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,t,n){const{details:r,stats:o}=t,l=self.performance.now(),u=o.loading.first?Math.max(0,l-o.loading.first):0;r.advancedDateTime=Date.now()-u;const f=this.hls.config.timelineOffset;if(f!==r.appliedTimelineOffset){const m=Math.max(f||0,0);r.appliedTimelineOffset=m,r.fragments.forEach(g=>{g.setStart(g.playlistOffset+m)})}if(r.live||n!=null&&n.live){const m="levelInfo"in t?t.levelInfo:t.track;if(r.reloaded(n),n&&r.fragments.length>0){o2(n,r,this);const _=r.playlistParsingError;if(_){this.warn(_);const w=this.hls;if(!w.config.ignorePlaylistParsingErrors){var d;const{networkDetails:D}=t;w.trigger(L.ERROR,{type:Te.NETWORK_ERROR,details:X.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:_,reason:_.message,level:t.level||void 0,parent:(d=r.fragments[0])==null?void 0:d.type,networkDetails:D,stats:o});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=o.loading.start);const g=this.hls.mainForwardBufferInfo,p=g?g.end-g.len:0,E=(r.edge-p)*1e3,S=SA(r,E);if(r.requestScheduled+S<l?r.requestScheduled=l:r.requestScheduled+=S,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let b,T,A;if(r.canBlockReload&&r.endSN&&r.advanced){const _=this.hls.config.lowLatencyMode,w=r.lastPartSn,D=r.endSN,O=r.lastPartIndex,B=O!==-1,N=w===D;B?N?(T=D+1,A=_?0:O):(T=w,A=_?O+1:r.maxPartIndex):T=D+1;const U=r.age,k=U+r.ageHeader;let F=Math.min(k-r.partTarget,r.targetduration*1.5);if(F>0){if(k>r.targetduration*3)this.log(`Playlist last advanced ${U.toFixed(2)}s ago. Omitting segment and part directives.`),T=void 0,A=void 0;else if(n!=null&&n.tuneInGoal&&k-r.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${F} with playlist age: ${r.age}`),F=0;else{const H=Math.floor(F/r.targetduration);if(T+=H,A!==void 0){const ne=Math.round(F%r.targetduration/r.partTarget);A+=ne}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${U.toFixed(2)}s goal: ${F} skip sn ${H} to part ${A}`)}r.tuneInGoal=F}if(b=this.getDeliveryDirectives(r,t.deliveryDirectives,T,A),_||!N){r.requestScheduled=l,this.loadingPlaylist(m,b);return}}else(r.canBlockReload||r.canSkipUntil)&&(b=this.getDeliveryDirectives(r,t.deliveryDirectives,T,A));b&&T!==void 0&&r.canBlockReload&&(r.requestScheduled=o.loading.first+Math.max(S-u*2,S/2)),this.scheduleLoading(m,b,r)}else this.clearTimer()}scheduleLoading(e,t,n){const r=n||e.details;if(!r){this.loadingPlaylist(e,t);return}const o=self.performance.now(),l=r.requestScheduled;if(o>=l){this.loadingPlaylist(e,t);return}const u=l-o;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(u)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),u)}getDeliveryDirectives(e,t,n,r){let o=Vx(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,o=lu.No),new Kx(n,r,o)}checkRetry(e){const t=e.details,n=ku(e),r=e.errorAction,{action:o,retryCount:l=0,retryConfig:u}=r||{},f=!!r&&!!u&&(o===an.RetryRequest||!r.resolved&&o===an.SendAlternateToPenaltyBox);if(f){var d;if(l>=u.maxNumRetry)return!1;if(n&&(d=e.context)!=null&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const m=_g(u,l);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),m),this.warn(`Retrying playlist loading ${l+1}/${u.maxNumRetry} after "${t}" in ${m}ms`)}e.levelRetry=!0,r.resolved=!0}return f}}function YA(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!dl(i[t].attrs,e[t].attrs))return!1;return!0}function dl(i,e,t){const n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>i[r]!==e[r])}function Im(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}class pU extends $g{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(L.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:n,groupId:r,details:o}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=t.details,this.log(`Audio track ${n} "${l.name}" lang:${l.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.audioGroups||null,r=this.groupIds;let o=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(u=>r?.indexOf(u)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const u=this.tracks.filter(p=>!n||n.indexOf(p.groupId)!==-1);if(u.length)this.selectDefaultTrack&&!u.some(p=>p.default)&&(this.selectDefaultTrack=!1),u.forEach((p,E)=>{p.id=E});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=u;const f=this.hls.config.audioPreference;if(!o&&f){const p=Ms(f,u,Rr);if(p>-1)o=u[p];else{const E=Ms(f,this.tracks);o=this.tracks[E]}}let d=this.findTrackId(o);d===-1&&o&&(d=this.findTrackId(null));const m={audioTracks:u};this.log(`Updating audio tracks, ${u.length} track(s) found in group(s): ${n?.join(",")}`),this.hls.trigger(L.AUDIO_TRACKS_UPDATED,m);const g=this.trackId;if(d!==-1&&g===-1)this.setAudioTrack(d);else if(u.length&&g===-1){var l;const p=new Error(`No audio track selected for current audio group-ID(s): ${(l=this.groupIds)==null?void 0:l.join(",")} track count: ${u.length}`);this.warn(p.message),this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const r=this.currentTrack;if(r&&Lr(e,r,Rr))return r;const o=Ms(e,this.tracksInGroup,Rr);if(o>-1){const l=this.tracksInGroup[o];return this.setAudioTrack(o),l}else if(r){let l=t.loadLevel;l===-1&&(l=t.firstAutoLevel);const u=_P(e,t.levels,n,l,Rr);if(u===-1)return null;t.nextLoadLevel=u}if(e.channels||e.audioCodec){const l=Ms(e,n);if(l>-1)return n[l]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e],o=r.details&&!r.details.live;if(e===this.trackId&&r===n&&o||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(L.AUDIO_TRACK_SWITCHING,ot({},r)),o))return;const l=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(l)}findTrackId(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||Lr(e,r,Rr)))return n}if(e){const{name:n,lang:r,assocLang:o,characteristics:l,audioCodec:u,channels:f}=e;for(let d=0;d<t.length;d++){const m=t[d];if(Lr({name:n,lang:r,assocLang:o,characteristics:l,audioCodec:u,channels:f},m,Rr))return d}for(let d=0;d<t.length;d++){const m=t[d];if(dl(e.attrs,m.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return d}for(let d=0;d<t.length;d++){const m=t[d];if(dl(e.attrs,m.attrs,["LANGUAGE"]))return d}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Mu(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,o=this.getUrlWithDirectives(e.url,t),l=e.details,u=l?.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${o}`),this.hls.trigger(L.AUDIO_TRACK_LOADING,{url:o,id:n,groupId:r,deliveryDirectives:t||null,track:e})}}class vU{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,n){if(this.queues===null||this.tracks===null)return;const r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const n={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const n={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const n=(t=e[0])==null?void 0:t.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(o){var n;if(r.onError(o),this.queues===null||this.tracks===null)return;const l=(n=this.tracks[e])==null?void 0:n.buffer;l!=null&&l.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,n;return(t=this.queues)!=null&&t[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const n=(t=this.tracks)==null?void 0:t[e],r=n?.buffer;return r?`SourceBuffer${r.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(n=>n.label).join(", "))||""}}const IE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,qA="HlsJsTrackRemovedError";class yU extends Error{constructor(e){super(e),this.name=qA}}class xU extends cs{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:r,mediaSource:o}=this;n&&this.log("Media source opened"),!(!r||!o)&&(o.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(L.MEDIA_ATTACHED,{media:r,mediaSource:o}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:r}=this;n!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=$k(Qi(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.BUFFER_RESET,this.onBufferReset,this),e.on(L.BUFFER_APPENDING,this.onBufferAppending,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.BUFFER_EOS,this.onBufferEos,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.FRAG_PARSED,this.onFragParsed,this),e.on(L.FRAG_CHANGED,this.onFragChanged,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.BUFFER_RESET,this.onBufferReset,this),e.off(L.BUFFER_APPENDING,this.onBufferAppending,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_EOS,this.onBufferEos,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.FRAG_PARSED,this.onFragParsed,this),e.off(L.FRAG_CHANGED,this.onFragChanged,this),e.off(L.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const n={};if(this.operationQueue){const o=this.isUpdating();o||this.operationQueue.removeBlockers();const l=this.isQueued();(o||l)&&this.warn(`Transfering MediaSource with${l?" operations in queue":""}${o?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===t?ht(n,r.tracks):this.sourceBuffers.forEach(o=>{const[l]=o;l&&(n[l]=ht({},this.tracks[l]),this.removeBuffer(l)),o[0]=o[1]=null}),{media:e,mediaSource:t,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var n;let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,t){const n=this.media=t.media;this.transferData=this.overrides=void 0;const r=Qi(this.appendSource);if(r){const o=!!t.mediaSource;(o||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const l=this.mediaSource=t.mediaSource||new r;if(this.assignMediaSource(l),o)this._objectUrl=n.src,this.attachTransferred();else{const u=this._objectUrl=self.URL.createObjectURL(l);if(this.appendSource)try{n.removeAttribute("src");const f=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||f&&l instanceof f,NE(n),EU(n,u),n.load()}catch{n.src=u}else n.src=u}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,n;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const n=this.tracks,r=t.tracks,o=r?Object.keys(r):null,l=o?o.length:0,u=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(r&&o&&l){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${pt(n,(f,d)=>f==="initSegment"?void 0:d)};
transfer tracks: ${pt(r,(f,d)=>f==="initSegment"?void 0:d)}}`),!HT(r,n)){t.mediaSource=null,t.tracks=void 0;const f=e.currentTime,d=this.details,m=Math.max(f,d?.fragments[0].start||0);if(m-f>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${f} -> ${m}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(n)}") start time: ${m} currentTime: ${f}`),this.onMediaDetaching(L.MEDIA_DETACHING,{}),this.onMediaAttaching(L.MEDIA_ATTACHING,t),e.currentTime=m;return}this.transferData=void 0,o.forEach(f=>{const d=f,m=r[d];if(m){const g=m.buffer;if(g){const p=this.fragmentTracker,E=m.id;if(p.hasFragments(E)||p.hasParts(E)){const T=Oe.getBuffered(g);p.detectEvictedFragments(d,T,E,null,!0)}const S=Qh(d),b=[d,g];this.sourceBuffers[S]=b,g.updating&&this.operationQueue&&this.operationQueue.prependBlocker(d),this.trackSourceBuffer(d,m)}}}),u(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),u()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const n=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:o,_objectUrl:l}=this;if(o){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([u])=>{u&&this.removeBuffer(u)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const u=o.readyState==="open";try{const f=o.sourceBuffers;for(let d=f.length;d--;)u&&f[d].abort(),o.removeSourceBuffer(f[d]);u&&o.endOfStream()}catch(f){this.warn(`onMediaDetaching: ${f.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}o.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("sourceended",this._onMediaSourceEnded),o.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.removeEventListener("startstreaming",this._onStartStreaming),o.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),n||(l&&self.URL.revokeObjectURL(l),this.mediaSrc===l?(r.removeAttribute("src"),this.appendSource&&NE(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(L.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const n=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),n)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(o){this.warn(`onBufferReset ${e}`,o)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Qh(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new vU(this.tracks)}onBufferCodecs(e,t){var n;const r=this.tracks,o=Object.keys(t);this.log(`BUFFER_CODECS: "${o}" (current SB count ${this.sourceBufferCount})`);const l="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),u=!l&&this.sourceBufferCount&&this.media&&o.some(f=>!r[f]);if(l||u){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${o}" SourceBuffers`);return}o.forEach(f=>{var d,m;const g=t[f],{id:p,codec:E,levelCodec:S,container:b,metadata:T,supplemental:A}=g;let _=r[f];const w=(d=this.transferData)==null||(d=d.tracks)==null?void 0:d[f],D=w!=null&&w.buffer?w:_,O=D?.pendingCodec||D?.codec,B=D?.levelCodec;_||(_=r[f]={buffer:void 0,listeners:[],codec:E,supplemental:A,container:b,levelCodec:S,metadata:T,id:p});const N=ou(O,B),U=N?.replace(IE,"$1");let k=ou(E,S);const F=(m=k)==null?void 0:m.replace(IE,"$1");k&&N&&U!==F&&(f.slice(0,5)==="audio"&&(k=Nu(k,this.appendSource)),this.log(`switching codec ${O} to ${k}`),k!==(_.pendingCodec||_.codec)&&(_.pendingCodec=k),_.container=b,this.appendChangeType(f,b,k))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&((n=t.audio)==null?void 0:n.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const n=this.tracks[t];return e[t]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,t,n){const r=`${t};codecs=${n}`,o={label:`change-type=${r}`,execute:()=>{const l=this.tracks[e];if(l){const u=l.buffer;u!=null&&u.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),u.changeType(r),l.codec=n,l.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn(`Failed to change ${e} SourceBuffer type`,l)}};this.append(o,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const n=e.start,r=n+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(n,pe.MAIN))==null?void 0:t.gap)===!0)return;const l={label:"block-audio",execute:()=>{var u;const f=this.tracks.video;(this.lastVideoAppendEnd>r||f!=null&&f.buffer&&Oe.isBuffered(f.buffer,r)||((u=this.fragmentTracker.getAppendedFrag(r,pe.MAIN))==null?void 0:u.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:u=>{this.warn("Error executing block-audio operation",u)}};this.blockedAudioAppend={op:l,frag:e},this.append(l,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:n}=this,{data:r,type:o,parent:l,frag:u,part:f,chunkMeta:d,offset:m}=t,g=d.buffering[o],{sn:p,cc:E}=u,S=self.performance.now();g.start=S;const b=u.stats.buffering,T=f?f.stats.buffering:null;b.start===0&&(b.start=S),T&&T.start===0&&(T.start=S);const A=n.audio;let _=!1;o==="audio"&&A?.container==="audio/mpeg"&&(_=!this.lastMpegAudioChunk||d.id===1||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const w=n.video,D=w?.buffer;if(D&&p!=="initSegment"){const N=f||u,U=this.blockedAudioAppend;if(o==="audio"&&l!=="main"&&!this.blockedAudioAppend&&!(w.ending||w.ended)){const F=N.start+N.duration*.05,H=D.buffered,ne=this.currentOp("video");!H.length&&!ne?this.blockAudio(N):!ne&&!Oe.isBuffered(D,F)&&this.lastVideoAppendEnd<F&&this.blockAudio(N)}else if(o==="video"){const k=N.end;if(U){const F=U.frag.start;(k>F||k<this.lastVideoAppendEnd||Oe.isBuffered(D,F))&&this.unblockAudio()}this.lastVideoAppendEnd=k}}const O=(f||u).start,B={label:`append-${o}`,execute:()=>{var N;g.executeStart=self.performance.now();const U=(N=this.tracks[o])==null?void 0:N.buffer;U&&(_?this.updateTimestampOffset(U,O,.1,o,p,E):m!==void 0&&ge(m)&&this.updateTimestampOffset(U,m,1e-6,o,p,E)),this.appendExecutor(r,o)},onStart:()=>{},onComplete:()=>{const N=self.performance.now();g.executeEnd=g.end=N,b.first===0&&(b.first=N),T&&T.first===0&&(T.first=N);const U={};this.sourceBuffers.forEach(([k,F])=>{k&&(U[k]=Oe.getBuffered(F))}),this.appendErrors[o]=0,o==="audio"||o==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(L.BUFFER_APPENDED,{type:o,frag:u,part:f,chunkMeta:d,parent:u.type,timeRanges:U})},onError:N=>{var U;const k={type:Te.MEDIA_ERROR,parent:u.type,details:X.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:u,part:f,chunkMeta:d,error:N,err:N,fatal:!1},F=(U=this.media)==null?void 0:U.error;if(N.code===DOMException.QUOTA_EXCEEDED_ERR||N.name=="QuotaExceededError"||"quota"in N)k.details=X.BUFFER_FULL_ERROR;else if(N.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!F)k.errorAction=Ba(!0);else if(N.name===qA&&this.sourceBufferCount===0)k.errorAction=Ba(!0);else{const H=++this.appendErrors[o];this.warn(`Failed ${H}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${o}" sourceBuffer (${F||"no media error"})`),(H>=this.hls.config.appendErrorMaxRetry||F)&&(k.fatal=!0)}this.hls.trigger(L.ERROR,k)}};this.log(`queuing "${o}" append sn: ${p}${f?" p: "+f.index:""} of ${u.type===pe.MAIN?"level":"track"} ${u.level} cc: ${E}`),this.append(B,o,this.isPending(this.tracks[o]))}getFlushOp(e,t,n){return this.log(`queuing "${e}" remove ${t}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(L.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${t}-${n} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,t){const{type:n,startOffset:r,endOffset:o}=t;n?this.append(this.getFlushOp(n,r,o),n):this.sourceBuffers.forEach(([l])=>{l&&this.append(this.getFlushOp(l,r,o),l)})}onFragParsed(e,t){const{frag:n,part:r}=t,o=[],l=r?r.elementaryStreams:n.elementaryStreams;l[gt.AUDIOVIDEO]?o.push("audiovideo"):(l[gt.AUDIO]&&o.push("audio"),l[gt.VIDEO]&&o.push("video"));const u=()=>{const f=self.performance.now();n.stats.buffering.end=f,r&&(r.stats.buffering.end=f);const d=r?r.stats:n.stats;this.hls.trigger(L.FRAG_BUFFERED,{frag:n,part:r,stats:d,id:n.type})};o.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(u,o).catch(f=>{this.warn(`Fragment buffered callback ${f}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var n;this.sourceBuffers.forEach(([l])=>{if(l){const u=this.tracks[l];(!t.type||t.type===l)&&(u.ending=!0,u.ended||(u.ended=!0,this.log(`${l} buffer reached EOS`)))}});const r=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([l])=>{var u;return l&&!((u=this.tracks[l])!=null&&u.ended)})?r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:l}=this;if(!l||l.readyState!=="open"){l&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${l.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),l.endOfStream(),this.hls.trigger(L.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(L.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===X.BUFFER_APPEND_ERROR&&t.frag){var n;const r=(n=t.errorAction)==null?void 0:n.nextAutoLevel;ge(r)&&r!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:n}=this;if(!n||t===null||!this.sourceBufferCount)return;const r=e.config,o=n.currentTime,l=t.levelTargetDuration,u=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(ge(u)&&u>=0){const d=Math.max(u,l),m=Math.floor(o/l)*l-d;this.flushBackBuffer(o,l,m)}const f=r.frontBufferFlushThreshold;if(ge(f)&&f>0){const d=Math.max(r.maxBufferLength,f),m=Math.max(d,l),g=Math.floor(o/l)*l+m;this.flushFrontBuffer(o,l,g)}}flushBackBuffer(e,t,n){this.sourceBuffers.forEach(([r,o])=>{if(o){const u=Oe.getBuffered(o);if(u.length>0&&n>u.start(0)){var l;this.hls.trigger(L.BACK_BUFFER_REACHED,{bufferEnd:n});const f=this.tracks[r];if((l=this.details)!=null&&l.live)this.hls.trigger(L.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(f!=null&&f.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:r})}}})}flushFrontBuffer(e,t,n){this.sourceBuffers.forEach(([r,o])=>{if(o){const l=Oe.getBuffered(o),u=l.length;if(u<2)return;const f=l.start(u-1),d=l.end(u-1);if(n>f||e>=f&&e<=d)return;this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:f,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:t,mediaSource:n}=this;if(!t||!this.media||n?.readyState!=="open")return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&n.setLiveSeekableRange){const d=Math.max(0,t.fragmentStart),m=Math.max(d,r);return{duration:1/0,start:d,end:m}}return{duration:1/0}}const o=(e=this.overrides)==null?void 0:e.duration;if(o)return ge(o)?{duration:o}:null;const l=this.media.duration,u=ge(n.duration)?n.duration:0;return r>u&&r>l||!ge(l)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:n}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(ge(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),t!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${n}.`),r.setLiveSeekableRange(t,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${pt(n)}`),this.tracksReady){var r;const o=(r=this.transferData)==null?void 0:r.tracks;o&&Object.keys(o).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,n])=>{if(t){const r=this.tracks[t];e[t]={buffer:n,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(L.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const o in e){const l=o,u=e[l];if(this.isPending(u)){const f=this.getTrackCodec(u,l),d=`${u.container};codecs=${f}`;u.codec=f,this.log(`creating sourceBuffer(${d})${this.currentOp(l)?" Queued":""} ${pt(u)}`);try{const m=n.addSourceBuffer(d),g=Qh(l),p=[l,m];t[g]=p,u.buffer=m}catch(m){var r;this.error(`error while trying to add sourceBuffer: ${m.message}`),this.shiftAndExecuteNext(l),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[l],this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:m,sourceBufferName:l,mimeType:d,parent:u.id});return}this.trackSourceBuffer(l,u)}}this.bufferCreated()}getTrackCodec(e,t){const n=e.supplemental;let r=e.codec;n&&(t==="video"||t==="audiovideo")&&rl(n,"video")&&(r=cP(r,n));const o=ou(r,e.levelCodec);return o?t.slice(0,5)==="audio"?Nu(o,this.appendSource):o:""}trackSourceBuffer(e,t){const n=t.buffer;if(!n)return;const r=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:r,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(o,l)=>{const u=l.removedRanges;u!=null&&u.length&&this.hls.trigger(L.BUFFER_FLUSHED,{type:o})})}get mediaSrc(){var e,t;const n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n?.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var n;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const o=this.currentOp(e);o&&o.onError(r)}updateTimestampOffset(e,t,n,r,o,l){const u=t-e.timestampOffset;Math.abs(u)>=n&&(this.log(`Updating ${r} SourceBuffer timestampOffset to ${t} (sn: ${o} cc: ${l})`),e.timestampOffset=t)}removeExecutor(e,t,n){const{media:r,mediaSource:o}=this,l=this.tracks[e],u=l?.buffer;if(!r||!o||!u){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const f=ge(r.duration)?r.duration:1/0,d=ge(o.duration)?o.duration:1/0,m=Math.max(0,t),g=Math.min(n,f,d);g>m&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${m},${g}] from the ${e} SourceBuffer`),u.remove(m,g)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const n=this.tracks[t],r=n?.buffer;if(!r)throw new yU(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,r=t.map(l=>this.appendBlocker(l));return t.length>1&&this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(l=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var n;const r=(n=this.tracks[t])==null?void 0:n.buffer;!r||r.updating||this.shiftAndExecuteNext(t)})}append(e,t,n){this.operationQueue&&this.operationQueue.append(e,t,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,n){const r=this.tracks[e];if(!r)return;const o=r.buffer;if(!o)return;const l=n.bind(this,e);r.listeners.push({event:t,listener:l}),o.addEventListener(t,l)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const n=t.buffer;n&&(t.listeners.forEach(r=>{n.removeEventListener(r.event,r.listener)}),t.listeners.length=0)}}function NE(i){const e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function EU(i,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}function Qh(i){return i==="audio"?1:0}class Gg{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.BUFFER_CODECS,this.onBufferCodecs,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(L.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&ge(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const n=t.filter((r,o)=>this.isLevelAllowed(r)&&o<=e);return this.clientRect=null,Gg.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;const r=(u,f)=>f?u.width!==f.width||u.height!==f.height:!0;let o=e.length-1;const l=Math.max(t,n);for(let u=0;u<e.length;u+=1){const f=e[u];if((f.width>=l||f.height>=l)&&r(f,e[u+1])){o=u;break}}return o}}const SU={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},An=SU,bU={HLS:"h"},TU=bU;class Fs{constructor(e,t){Array.isArray(e)&&(e=e.map(n=>n instanceof Fs?n:new Fs(n))),this.value=e,this.params=t}}const AU="Dict";function RU(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function CU(i,e,t,n){return new Error(`failed to ${i} "${RU(e)}" as ${t}`,{cause:n})}function Bs(i,e,t){return CU("serialize",i,e,t)}class XA{constructor(e){this.description=e}}const OE="Bare Item",LU="Boolean";function _U(i){if(typeof i!="boolean")throw Bs(i,LU);return i?"?1":"?0"}function wU(i){return btoa(String.fromCharCode(...i))}const DU="Byte Sequence";function IU(i){if(ArrayBuffer.isView(i)===!1)throw Bs(i,DU);return`:${wU(i)}:`}const NU="Integer";function OU(i){return i<-999999999999999||999999999999999<i}function WA(i){if(OU(i))throw Bs(i,NU);return i.toString()}function MU(i){return`@${WA(i.getTime()/1e3)}`}function QA(i,e){if(i<0)return-QA(-i,e);const t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){const r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}const kU="Decimal";function PU(i){const e=QA(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Bs(i,kU);const t=e.toString();return t.includes(".")?t:`${t}.0`}const UU="String",FU=/[\x00-\x1f\x7f]+/;function BU(i){if(FU.test(i))throw Bs(i,UU);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function jU(i){return i.description||i.toString().slice(7,-1)}const $U="Token";function ME(i){const e=jU(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Bs(e,$U);return e}function Nm(i){switch(typeof i){case"number":if(!ge(i))throw Bs(i,OE);return Number.isInteger(i)?WA(i):PU(i);case"string":return BU(i);case"symbol":return ME(i);case"boolean":return _U(i);case"object":if(i instanceof Date)return MU(i);if(i instanceof Uint8Array)return IU(i);if(i instanceof XA)return ME(i);default:throw Bs(i,OE)}}const GU="Key";function Om(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw Bs(i,GU);return i}function zg(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Om(e)}`:`;${Om(e)}=${Nm(t)}`).join("")}function ZA(i){return i instanceof Fs?`${Nm(i.value)}${zg(i.params)}`:Nm(i)}function zU(i){return`(${i.value.map(ZA).join(" ")})${zg(i.params)}`}function HU(i,e={whitespace:!0}){if(typeof i!="object"||i==null)throw Bs(i,AU);const t=i instanceof Map?i.entries():Object.entries(i),n=e?.whitespace?" ":"";return Array.from(t).map(([r,o])=>{o instanceof Fs||(o=new Fs(o));let l=Om(r);return o.value===!0?l+=zg(o.params):(l+="=",Array.isArray(o.value)?l+=zU(o):l+=ZA(o)),l}).join(`,${n}`)}function JA(i,e){return HU(i,e)}const ws="CMCD-Object",Nt="CMCD-Request",Tr="CMCD-Session",$i="CMCD-Status",VU={br:ws,ab:ws,d:ws,ot:ws,tb:ws,tpb:ws,lb:ws,tab:ws,lab:ws,url:ws,pb:Nt,bl:Nt,tbl:Nt,dl:Nt,ltc:Nt,mtp:Nt,nor:Nt,nrr:Nt,rc:Nt,sn:Nt,sta:Nt,su:Nt,ttfb:Nt,ttfbb:Nt,ttlb:Nt,cmsdd:Nt,cmsds:Nt,smrt:Nt,df:Nt,cs:Nt,ts:Nt,cid:Tr,pr:Tr,sf:Tr,sid:Tr,st:Tr,v:Tr,msd:Tr,bs:$i,bsd:$i,cdn:$i,rtp:$i,bg:$i,pt:$i,ec:$i,e:$i},KU={REQUEST:Nt};function YU(i){return Object.keys(i).reduce((e,t)=>{var n;return(n=i[t])===null||n===void 0||n.forEach(r=>e[r]=t),e},{})}function qU(i,e){const t={};if(!i)return t;const n=Object.keys(i),r=e?YU(e):{};return n.reduce((o,l)=>{var u;const f=VU[l]||r[l]||KU.REQUEST,d=(u=o[f])!==null&&u!==void 0?u:o[f]={};return d[l]=i[l],o},t)}function XU(i){return["ot","sf","st","e","sta"].includes(i)}function WU(i){return typeof i=="number"?ge(i):i!=null&&i!==""&&i!==!1}const e1="event";function QU(i,e){const t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;const r=t.pathname.split("/").slice(1),o=n.pathname.split("/").slice(1,-1);for(;r[0]===o[0];)r.shift(),o.shift();for(;o.length;)o.shift(),r.unshift("..");return r.join("/")+t.search+t.hash}const fu=i=>Math.round(i),Mm=(i,e)=>Array.isArray(i)?i.map(t=>Mm(t,e)):i instanceof Fs&&typeof i.value=="string"?new Fs(Mm(i.value,e),i.params):(e.baseUrl&&(i=QU(i,e.baseUrl)),e.version===1?encodeURIComponent(i):i),Xc=i=>fu(i/100)*100,ZU=(i,e)=>{let t=i;return e.version>=2&&(i instanceof Fs&&typeof i.value=="string"?t=new Fs([i]):typeof i=="string"&&(t=[i])),Mm(t,e)},JU={br:fu,d:fu,bl:Xc,dl:Xc,mtp:Xc,nor:ZU,rtp:Xc,tb:fu},t1="request",n1="response",Hg=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],eF=["e"],tF=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function rd(i){return tF.test(i)}function nF(i){return Hg.includes(i)||eF.includes(i)||rd(i)}const s1=["d","dl","nor","ot","rtp","su"];function sF(i){return Hg.includes(i)||s1.includes(i)||rd(i)}const iF=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function rF(i){return Hg.includes(i)||s1.includes(i)||iF.includes(i)||rd(i)}const aF=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function oF(i){return aF.includes(i)||rd(i)}const lF={[n1]:rF,[e1]:nF,[t1]:sF};function i1(i,e={}){const t={};if(i==null||typeof i!="object")return t;const n=e.version||i.v||1,r=e.reportingMode||t1,o=n===1?oF:lF[r];let l=Object.keys(i).filter(o);const u=e.filter;typeof u=="function"&&(l=l.filter(u));const f=r===n1||r===e1;f&&!l.includes("ts")&&l.push("ts"),n>1&&!l.includes("v")&&l.push("v");const d=ht({},JU,e.formatters),m={version:n,reportingMode:r,baseUrl:e.baseUrl};return l.sort().forEach(g=>{let p=i[g];const E=d[g];if(typeof E=="function"&&(p=E(p,m)),g==="v"){if(n===1)return;p=n}g=="pr"&&p===1||(f&&g==="ts"&&!ge(p)&&(p=Date.now()),WU(p)&&(XU(g)&&typeof p=="string"&&(p=new XA(p)),t[g]=p))}),t}function cF(i,e={}){const t={};if(!i)return t;const n=i1(i,e),r=qU(n,e?.customHeaderMap);return Object.entries(r).reduce((o,[l,u])=>{const f=JA(u,{whitespace:!1});return f&&(o[l]=f),o},t)}function uF(i,e,t){return ht(i,cF(e,t))}const dF="CMCD";function fF(i,e={}){return i?JA(i1(i,e),{whitespace:!1}):""}function hF(i,e={}){if(!i)return"";const t=fF(i,e);return encodeURIComponent(t)}function mF(i,e={}){if(!i)return"";const t=hF(i,e);return`${dF}=${t}`}const kE=/CMCD=[^&#]+/;function gF(i,e,t){const n=mF(e,t);if(!n)return i;if(kE.test(i))return i.replace(kE,n);const r=i.includes("?")?"&":"?";return`${i}${r}${n}`}class pF{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:An.MANIFEST,su:!this.initialized})}catch(o){this.hls.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=r=>{try{const{frag:o,part:l}=r,u=this.hls.levels[o.level],f=this.getObjectType(o),d={d:(l||o).duration*1e3,ot:f};(f===An.VIDEO||f===An.AUDIO||f==An.MUXED)&&(d.br=u.bitrate/1e3,d.tb=this.getTopBandwidth(f)/1e3,d.bl=this.getBufferLength(f));const m=l?this.getNextPart(l):this.getNextFrag(o);m!=null&&m.url&&m.url!==o.url&&(d.nor=m.url),this.apply(r,d)}catch(o){this.hls.logger.warn("Could not generate segment CMCD data.",o)}},this.hls=e;const t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHED,this.onMediaDetached,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHED,this.onMediaDetached,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:TU.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){ht(t,this.createData());const n=t.ot===An.INIT||t.ot===An.VIDEO||t.ot===An.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((l,u)=>(r.includes(u)&&(l[u]=t[u]),l),{}));const o={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),uF(e.headers,t,o)):e.url=gF(e.url,t,o)}getNextFrag(e){var t;const n=(t=this.hls.levels[e.level])==null?void 0:t.details;if(n){const r=e.sn-n.startSN;return n.fragments[r+1]}}getNextPart(e){var t;const{index:n,fragment:r}=e,o=(t=this.hls.levels[r.level])==null||(t=t.details)==null?void 0:t.partList;if(o){const{sn:l}=r;for(let u=o.length-1;u>=0;u--){const f=o[u];if(f.index===n&&f.fragment.sn===l)return o[u+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return An.TIMED_TEXT;if(e.sn==="initSegment")return An.INIT;if(t==="audio")return An.AUDIO;if(t==="main")return this.hls.audioTracks.length?An.VIDEO:An.MUXED}getTopBandwidth(e){let t=0,n;const r=this.hls;if(e===An.AUDIO)n=r.audioTracks;else{const o=r.maxAutoLevel,l=o>-1?o+1:r.levels.length;n=r.levels.slice(0,l)}return n.forEach(o=>{o.bitrate>t&&(t=o.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,n=e===An.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Oe.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new n(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,l,u){t(o),this.loader.load(o,l,u)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(o){this.loader=void 0,this.loader=new n(o)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(o,l,u){t(o),this.loader.load(o,l,u)}}}}const vF=3e5;class yF extends cs{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:n}=t;if(n?.action===an.SendAlternateToPenaltyBox&&n.flags===$n.MoveAllAlternatesMatchingHost){const r=this.levels;let o=this._pathwayPriority,l=this.pathwayId;if(t.context){const{groupId:u,pathwayId:f,type:d}=t.context;u&&r?l=this.getPathwayForGroupId(u,d,l):f&&(l=f)}l in this.penalizedPathways||(this.penalizedPathways[l]=performance.now()),!o&&r&&(o=this.pathways()),o&&o.length>1&&(this.updatePathwayPriority(o),n.resolved=this.pathwayId!==l),t.details===X.BUFFER_APPEND_ERROR&&!t.fatal?n.resolved=!0:n.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${l} levels: ${r&&r.length} priorities: ${pt(o)} penalized: ${pt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(o=>{r-n[o]>vF&&delete n[o]});for(let o=0;o<e.length;o++){const l=e[o];if(l in n)continue;if(l===this.pathwayId)return;const u=this.hls.nextLoadLevel,f=this.hls.levels[u];if(t=this.getLevelsForPathway(l),t.length>0){this.log(`Setting Pathway to "${l}"`),this.pathwayId=l,AA(t),this.hls.trigger(L.LEVELS_UPDATED,{levels:t});const d=this.hls.levels[u];f&&d&&this.levels&&(d.attrs["STABLE-VARIANT-ID"]!==f.attrs["STABLE-VARIANT-ID"]&&d.bitrate!==f.bitrate&&this.log(`Unstable Pathways change from bitrate ${f.bitrate} to ${d.bitrate}`),this.hls.nextLoadLevel=u);break}}}getPathwayForGroupId(e,t,n){const r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let o=0;o<r.length;o++)if(t===Ge.AUDIO_TRACK&&r[o].hasAudioGroup(e)||t===Ge.SUBTITLE_TRACK&&r[o].hasSubtitleGroup(e))return r[o].pathwayId;return n}clonePathways(e){const t=this.levels;if(!t)return;const n={},r={};e.forEach(o=>{const{ID:l,"BASE-ID":u,"URI-REPLACEMENT":f}=o;if(t.some(m=>m.pathwayId===l))return;const d=this.getLevelsForPathway(u).map(m=>{const g=new At(m.attrs);g["PATHWAY-ID"]=l;const p=g.AUDIO&&`${g.AUDIO}_clone_${l}`,E=g.SUBTITLES&&`${g.SUBTITLES}_clone_${l}`;p&&(n[g.AUDIO]=p,g.AUDIO=p),E&&(r[g.SUBTITLES]=E,g.SUBTITLES=E);const S=r1(m.uri,g["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",f),b=new ol({attrs:g,audioCodec:m.audioCodec,bitrate:m.bitrate,height:m.height,name:m.name,url:S,videoCodec:m.videoCodec,width:m.width});if(m.audioGroups)for(let T=1;T<m.audioGroups.length;T++)b.addGroupId("audio",`${m.audioGroups[T]}_clone_${l}`);if(m.subtitleGroups)for(let T=1;T<m.subtitleGroups.length;T++)b.addGroupId("text",`${m.subtitleGroups[T]}_clone_${l}`);return b});t.push(...d),PE(this.audioTracks,n,f,l),PE(this.subtitleTracks,r,f,l)})}loadSteeringManifest(e){const t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const m=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+m)}const o={responseType:"json",url:r.href},l=t.steeringManifestLoadPolicy.default,u=l.errorRetry||l.timeoutRetry||{},f={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:u.maxNumRetry||0,retryDelay:u.retryDelayMs||0,maxRetryDelay:u.maxRetryDelayMs||0},d={onSuccess:(m,g,p,E)=>{this.log(`Loaded steering manifest: "${r}"`);const S=m.data;if(S?.VERSION!==1){this.log(`Steering VERSION ${S.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=S.TTL;const{"RELOAD-URI":b,"PATHWAY-CLONES":T,"PATHWAY-PRIORITY":A}=S;if(b)try{this.uri=new self.URL(b,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${b}`);return}this.scheduleRefresh(this.uri||p.url),T&&this.clonePathways(T);const _={steeringManifest:S,url:r.toString()};this.hls.trigger(L.STEERING_MANIFEST_LOADED,_),A&&this.updatePathwayPriority(A)},onError:(m,g,p,E)=>{if(this.log(`Error loading steering manifest: ${m.code} ${m.text} (${g.url})`),this.stopLoad(),m.code===410){this.enabled=!1,this.log(`Steering manifest ${g.url} no longer available`);return}let S=this.timeToLoad*1e3;if(m.code===429){const b=this.loader;if(typeof b?.getResponseHeader=="function"){const T=b.getResponseHeader("Retry-After");T&&(S=parseFloat(T)*1e3)}this.log(`Steering manifest ${g.url} rate limited`);return}this.scheduleRefresh(this.uri||g.url,S)},onTimeout:(m,g,p)=>{this.log(`Timeout loading steering manifest (${g.url})`),this.scheduleRefresh(this.uri||g.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(o,f,d)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function PE(i,e,t,n){i&&Object.keys(e).forEach(r=>{const o=i.filter(l=>l.groupId===r).map(l=>{const u=ht({},l);return u.details=void 0,u.attrs=new At(u.attrs),u.url=u.attrs.URI=r1(l.url,l.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),u.groupId=u.attrs["GROUP-ID"]=e[r],u.attrs["PATHWAY-ID"]=n,u});i.push(...o)})}function r1(i,e,t,n){const{HOST:r,PARAMS:o,[t]:l}=n;let u;e&&(u=l?.[e],u&&(i=u));const f=new self.URL(i);return r&&!u&&(f.host=r),o&&Object.keys(o).sort().forEach(d=>{d&&f.searchParams.set(d,o[d])}),f.href}class $a extends cs{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=$a.CDMCleanupPromise?[$a.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{const{initDataType:n,initData:r}=t,o=`"${t.type}" event: init data type: "${n}"`;if(this.debug(o),r!==null){if(!this.keyFormatPromise){let l=Object.keys(this.keySystemAccessPromises);l.length||(l=Qo(this.config));const u=l.map(zh).filter(f=>!!f);this.keyFormatPromise=this.getKeyFormatPromise(u)}this.keyFormatPromise.then(l=>{const u=cu(l);if(n!=="sinf"||u!==Ct.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${n}" for selected key-system ${u}`);return}let f;try{const E=qt(new Uint8Array(r)),S=Ng(JSON.parse(E).sinf),b=JT(S);if(!b)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");f=new Uint8Array(b.subarray(8,24))}catch(E){this.warn(`${o} Failed to parse sinf: ${E}`);return}const d=on(f),{keyIdToKeySessionPromise:m,mediaKeySessions:g}=this;let p=m[d];for(let E=0;E<g.length;E++){const S=g[E],b=S.decryptdata;if(!b.keyId)continue;const T=on(b.keyId);if(Uu(f,b.keyId)||b.uri.replace(/-/g,"").indexOf(d)!==-1){if(p=m[T],!p)continue;if(b.pssh)break;delete m[T],b.pssh=new Uint8Array(r),b.keyId=f,p=m[d]=p.then(()=>this.generateRequestWithPreferredKeySession(S,n,r,"encrypted-event-key-match")),p.catch(A=>this.handleError(A));break}}p||this.handleError(new Error(`Key ID ${d} not encountered in playlist. Key-system sessions ${g.length}.`))}).catch(l=>this.handleError(l))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(L.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(L.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(L.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(L.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:n}=this.config,r=t?.[e];if(r)return r.licenseUrl;if(e===Ct.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,n=t?.[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,n=(l,u,f)=>!!l&&f.indexOf(l)===u,r=t.map(l=>l.audioCodec).filter(n),o=t.map(l=>l.videoCodec).filter(n);return r.length+o.length===0&&o.push("avc1.42e01e"),new Promise((l,u)=>{const f=d=>{const m=d.shift();this.getMediaKeysPromise(m,r,o).then(g=>l({keySystem:m,mediaKeys:g})).catch(g=>{d.length?f(d):g instanceof jn?u(g):u(new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_ACCESS,error:g,fatal:!0},g.message))})};f(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${n}`;return pA===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return n(e,t)}getMediaKeysPromise(e,t,n){var r;const o=ZP(e,t,n,this.config.drmSystemOptions||{});let l=this.keySystemAccessPromises[e],u=(r=l)==null?void 0:r.keySystemAccess;if(!u){this.log(`Requesting encrypted media "${e}" key-system access with config: ${pt(o)}`),u=this.requestMediaKeySystemAccess(e,o);const f=l=this.keySystemAccessPromises[e]={keySystemAccess:u};return u.catch(d=>{this.log(`Failed to obtain access to key-system "${e}": ${d}`)}),u.then(d=>{this.log(`Access for key-system "${d.keySystem}" obtained`);const m=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const g=f.mediaKeys=d.createMediaKeys().then(p=>(this.log(`Media-keys created for "${e}"`),f.hasMediaKeys=!0,m.then(E=>E?this.setMediaKeysServerCertificate(p,e,E):p)));return g.catch(p=>{this.error(`Failed to create media-keys for "${e}"}: ${p}`)}),g})}return u.then(()=>l.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:n}){this.log(`Creating key-system session "${t}" keyId: ${on(e.keyId||[])} keyUri: ${e.uri}`);const r=n.createSession(),o={decryptdata:e,keySystem:t,mediaKeys:n,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const n=this.createMediaKeySessionContext(e),r=Wc(t),o="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(n,o,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,t){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${on(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),n.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>zh(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:n})=>this.attemptSetMediaKeys(t,n))}selectKeySystem(e){return new Promise((t,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const o=zh(r);o?t(o):n(new Error(`Unable to find format for key-system "${r}"`))}).catch(n)})}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Qo(this.config),n=e.map(cu).filter(r=>!!r&&t.indexOf(r)!==-1);return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:t}=this;for(let n=0;n<t.length;n++){const r=xF(e,t[n]);if(r)return r}}loadKey(e){const t=e.keyInfo.decryptdata,n=Wc(t),r=this.bannedKeyIds[n];if(r||this.getKeyStatus(t)==="internal-error"){const u=UE(r||"internal-error",t);return this.handleError(u,e.frag),Promise.reject(u)}const o=`(keyId: ${n} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${o}`);const l=this.keyIdToKeySessionPromise[n];if(!l){const u=this.getKeySystemForKeyPromise(t).then(({keySystem:f,mediaKeys:d})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${o}`),this.attemptSetMediaKeys(f,d).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:f,mediaKeys:d,decryptdata:t}))))).then(f=>{const d="cenc",m=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(f,d,m,"playlist-key")});return u.catch(f=>this.handleError(f,e.frag)),this.keyIdToKeySessionPromise[n]=u,u}return l.catch(u=>{if(u instanceof jn){const f=ot({},u.data);this.getKeyStatus(t)==="internal-error"&&(f.decryptdata=t);const d=new jn(f,u.message);this.handleError(d,e.frag)}}),l}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,t){if(this.hls)if(e instanceof jn){t&&(e.data.frag=t);const n=e.data.decryptdata;this.error(`${e.message}${n?` (${on(n.keyId||[])})`:""}`),this.hls.trigger(L.ERROR,e.data)}else this.error(e.message),this.hls.trigger(L.ERROR,{type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const t=Wc(e),n=this.keyIdToKeySessionPromise[t];if(!n){const r=cu(e.keyFormat),o=r?[r]:Qo(this.config);return this.attemptKeySystemAccess(o)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Qo(this.config)),e.length===0)throw new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${pt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaResolved=void 0,this.mediaKeys===t)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(t):new Promise((o,l)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return l(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=t,this.media.setMediaKeys(t).then(o).catch(l)}}));return this.mediaKeys=t,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>n.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(e,t,n,r){var o;const l=(o=this.config.drmSystems)==null||(o=o[e.keySystem])==null?void 0:o.generateRequest;if(l)try{const S=l.call(this.hls,t,n,e);if(!S)throw new Error("Invalid response from configured generateRequest filter");t=S.initDataType,n=S.initData?S.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(S){if(this.warn(S.message),this.hls&&this.hls.config.debug)throw S}if(n===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=Wc(e.decryptdata),f=e.decryptdata.uri;this.log(`Generating key-session request for "${r}" keyId: ${u} URI: ${f} (init data type: ${t} length: ${n.byteLength})`);const d=new Mg,m=e._onmessage=S=>{const b=e.mediaKeysSession;if(!b){d.emit("error",new Error("invalid state"));return}const{messageType:T,message:A}=S;this.log(`"${T}" message event for session "${b.sessionId}" message size: ${A.byteLength}`),T==="license-request"||T==="license-renewal"?this.renewLicense(e,A).catch(_=>{d.eventNames().length?d.emit("error",_):this.handleError(_)}):T==="license-release"?e.keySystem===Ct.FAIRPLAY&&this.updateKeySession(e,Cm("acknowledged")).then(()=>this.removeSession(e)).catch(_=>this.handleError(_)):this.warn(`unhandled media key message type "${T}"`)},g=(S,b)=>{b.keyStatus=S;let T;S.startsWith("usable")?d.emit("resolved"):S==="internal-error"||S==="output-restricted"||S==="output-downscaled"?T=UE(S,b.decryptdata):S==="expired"?T=new Error(`key expired (keyId: ${u})`):S==="released"?T=new Error("key released"):S==="status-pending"||this.warn(`unhandled key status change "${S}" (keyId: ${u})`),T&&(d.eventNames().length?d.emit("error",T):this.handleError(T))},p=e._onkeystatuseschange=S=>{if(!e.mediaKeysSession){d.emit("error",new Error("invalid state"));return}const T=this.getKeyStatuses(e);if(!Object.keys(T).some(D=>T[D]!=="status-pending"))return;if(T[u]==="expired"){this.log(`Expired key ${pt(T)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let _=T[u];if(_)g(_,e);else{var w;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(w=e.keyStatusTimeouts)[u]||(w[u]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const O=this.getKeyStatus(e.decryptdata);if(O&&O!=="status-pending")return this.log(`No status for keyId ${u} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${O} from other session.`),g(O,e);this.log(`key status for ${u} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),_="internal-error",g(_,e)},1e3)),this.log(`No status for keyId ${u} (${pt(T)}).`)}};pn(e.mediaKeysSession,"message",m),pn(e.mediaKeysSession,"keystatuseschange",p);const E=new Promise((S,b)=>{d.on("error",b),d.on("resolved",S)});return e.mediaKeysSession.generateRequest(t,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${u} URI: ${f}`)}).catch(S=>{throw new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_NO_SESSION,error:S,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${S}`)}).then(()=>E).catch(S=>(d.removeAllListeners(),this.removeSession(e).then(()=>{throw S}))).then(()=>(d.removeAllListeners(),e))}getKeyStatuses(e){const t={};return e.mediaKeysSession.keyStatuses.forEach((n,r)=>{if(typeof r=="string"&&typeof n=="object"){const u=r;r=n,n=u}const o="buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r);if(e.keySystem===Ct.PLAYREADY&&o.length===16){const u=on(o);t[u]=n,mA(o)}const l=on(o);n==="internal-error"&&(this.bannedKeyIds[l]=n),this.log(`key status change "${n}" for keyStatuses keyId: ${l} key-session "${e.mediaKeysSession.sessionId}"`),t[l]=n}),t}fetchServerCertificate(e){const t=this.config,n=t.loader,r=new n(t),o=this.getServerCertificateUrl(e);return o?(this.log(`Fetching server certificate for "${e}"`),new Promise((l,u)=>{const f={responseType:"arraybuffer",url:o},d=t.certLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,E,S,b)=>{l(p.data)},onError:(p,E,S,b)=>{u(new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:ot({url:f.url,data:void 0},p)},`"${e}" certificate request failed (${o}). Status: ${p.code} (${p.text})`))},onTimeout:(p,E,S)=>{u(new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:S,response:{url:f.url,data:void 0}},`"${e}" certificate request timed out (${o})`))},onAbort:(p,E,S)=>{u(new Error("aborted"))}};r.load(f,m,g)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,n){return new Promise((r,o)=>{e.setServerCertificate(n).then(l=>{this.log(`setServerCertificate ${l?"success":"not supported by CDM"} (${n.byteLength}) on "${t}"`),r(e)}).catch(l=>{o(new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:l,fatal:!0},l.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(r=>{throw new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:r,fatal:!1},r.message)}))}unpackPlayReadyKeyMessage(e,t){const n=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(n,"application/xml"),o=r.querySelectorAll("HttpHeader");if(o.length>0){let m;for(let g=0,p=o.length;g<p;g++){var l,u;m=o[g];const E=(l=m.querySelector("name"))==null?void 0:l.textContent,S=(u=m.querySelector("value"))==null?void 0:u.textContent;E&&S&&e.setRequestHeader(E,S)}}const f=r.querySelector("Challenge"),d=f?.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return Cm(atob(d))}setupLicenseXHR(e,t,n,r){const o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return o.call(this.hls,e,t,n,r)}).catch(l=>{if(!n.decryptdata)throw l;return e.open("POST",t,!0),o.call(this.hls,e,t,n,r)}).then(l=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:l||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const n=this.config.keyLoadPolicy.default;return new Promise((r,o)=>{const l=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${l}`);const u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return o(new Error("invalid state"));if(u.readyState===4)if(u.status===200){this._requestLicenseFailureCount=0;let f=u.response;this.log(`License received ${f instanceof ArrayBuffer?f.byteLength:f}`);const d=this.config.licenseResponseCallback;if(d)try{f=d.call(this.hls,u,l,e)}catch(m){this.error(m)}r(f)}else{const f=n.errorRetry,d=f?f.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||u.status>=400&&u.status<500)o(new jn({type:Te.KEY_SYSTEM_ERROR,details:X.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:u,response:{url:l,data:void 0,code:u.status,text:u.statusText}},`License Request XHR failed (${l}). Status: ${u.status} (${u.statusText})`));else{const m=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${m} attempts left`),this.requestLicense(e,t).then(r,o)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=u,this.setupLicenseXHR(u,l,e,t).then(({xhr:f,licenseChallenge:d})=>{e.keySystem==Ct.PLAYREADY&&(d=this.unpackPlayReadyKeyMessage(f,d)),f.send(d)}).catch(o)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const n=t.media;this.media=n,pn(n,"encrypted",this.onMediaEncrypted),pn(n,"waitingforkey",this.onWaitingForKey);const r=this.mediaResolved;r?r():this.mediaKeys=n.mediaKeys}onMediaDetached(){const e=this.media;e&&(Rn(e,"encrypted",this.onMediaEncrypted),Rn(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const t=this.mediaResolved;if(t&&t(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Yi.clearKeyUriToKeyIdMap();const o=r.length;$a.CDMCleanupPromise=Promise.all(r.map(l=>this.removeSession(l)).concat((n==null||(e=n.setMediaKeys(null))==null?void 0:e.catch(l=>{this.log(`Could not clear media keys: ${l}`),this.hls&&this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${l}`)})}))||Promise.resolve())).catch(l=>{this.log(`Could not close sessions and clear media keys: ${l}`),this.hls&&this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${l}`)})}).then(()=>{o&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=t.reduce((r,o)=>(r.indexOf(o.keyFormat)===-1&&r.push(o.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:n,decryptdata:r}=e;if(t){this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${on(r?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const o=this.mediaKeySessions.indexOf(e);o>-1&&this.mediaKeySessions.splice(o,1);const{keyStatusTimeouts:l}=e;l&&Object.keys(l).forEach(d=>self.clearTimeout(l[d]));const{drmSystemOptions:u}=this.config;return(e2(u)?new Promise((d,m)=>{self.setTimeout(()=>m(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(d).catch(m)}):Promise.resolve()).catch(d=>{this.log(`Could not remove session: ${d}`),this.hls&&this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${d}`)})}).then(()=>t.close()).catch(d=>{this.log(`Could not close session: ${d}`),this.hls&&this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${d}`)})})}return Promise.resolve()}}$a.CDMCleanupPromise=void 0;function Wc(i){if(!i)throw new Error("Could not read keyId of undefined decryptdata");if(i.keyId===null)throw new Error("keyId is null");return on(i.keyId)}function xF(i,e){if(i.keyId&&e.mediaKeysSession.keyStatuses.has(i.keyId))return e.mediaKeysSession.keyStatuses.get(i.keyId);if(i.matches(e.decryptdata))return e.keyStatus}class jn extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function UE(i,e){const t=i==="output-restricted",n=t?X.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:X.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new jn({type:Te.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${i}"`)}class EF{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(L.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(L.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const n=this.hls.config;if(n.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,n){const r=performance.now();if(t){if(this.lastTime){const o=r-this.lastTime,l=n-this.lastDroppedFrames,u=t-this.lastDecodedFrames,f=1e3*l/o,d=this.hls;if(d.trigger(L.FPS_DROP,{currentDropped:l,currentDecoded:u,totalDroppedFrames:n}),f>0&&l>d.config.fpsDroppedMonitoringThreshold*u){let m=d.currentLevel;d.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+m),m>0&&(d.autoLevelCapping===-1||d.autoLevelCapping>=m)&&(m=m-1,d.trigger(L.FPS_DROP_LEVEL_CAPPING,{level:m,droppedLevel:d.currentLevel}),d.autoLevelCapping=m,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function a1(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function o1(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){lt.debug(`[texttrack-utils]: ${n}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){lt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(i.mode=t)}function ka(i,e){const t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues)for(let n=i.cues.length;n--;)e&&i.cues[n].removeEventListener("enter",e),i.removeCue(i.cues[n]);t==="disabled"&&(i.mode=t)}function km(i,e,t,n){const r=i.mode;if(r==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){const o=bF(i.cues,e,t);for(let l=0;l<o.length;l++)(!n||n(o[l]))&&i.removeCue(o[l])}r==="disabled"&&(i.mode=r)}function SF(i,e){if(e<=i[0].startTime)return 0;const t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t,o;for(;n<=r;)if(o=Math.floor((r+n)/2),e<i[o].startTime)r=o-1;else if(e>i[o].startTime&&n<t)n=o+1;else return o;return i[n].startTime-e<e-i[r].startTime?n:r}function bF(i,e,t){const n=[],r=SF(i,e);if(r>-1)for(let o=r,l=i.length;o<l;o++){const u=i[o];if(u.startTime>=e&&u.endTime<=t)n.push(u);else if(u.startTime>t)return n}return n}function hu(i){const e=[];for(let t=0;t<i.length;t++){const n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}class TF extends $g{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const n=hu(this.media.textTracks);for(let o=0;o<n.length;o++)if(n[o].mode==="hidden")t=n[o];else if(n[o].mode==="showing"){t=n[o];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const n=this.media;if(!n)return;const r=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;hu(n.textTracks).forEach(l=>{ka(l)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:n,groupId:r,details:o}=t,l=this.tracksInGroup[n];if(!l||l.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${l?.groupId}`);return}const u=l.details;l.details=t.details,this.log(`Subtitle track ${n} "${l.name}" lang:${l.lang} group:${r} loaded [${o.startSN}-${o.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,u)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const n=t.subtitleGroups||null,r=this.groupIds;let o=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(l=>r?.indexOf(l)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(m=>!n||n.indexOf(m.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(m=>m.default)&&(this.selectDefaultTrack=!1),l.forEach((m,g)=>{m.id=g});else if(!o&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const u=this.hls.config.subtitlePreference;if(!o&&u){this.selectDefaultTrack=!1;const m=Ms(u,l);if(m>-1)o=l[m];else{const g=Ms(u,this.tracks);o=this.tracks[g]}}let f=this.findTrackId(o);f===-1&&o&&(f=this.findTrackId(null));const d={subtitleTracks:l};this.log(`Updating subtitle tracks, ${l.length} track(s) found in "${n?.join(",")}" group-id`),this.hls.trigger(L.SUBTITLE_TRACKS_UPDATED,d),f!==-1&&this.trackId===-1&&this.setSubtitleTrack(f)}}findTrackId(e){const t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const o=t[r];if(!(n&&!o.default||!n&&!e)&&(!e||Lr(o,e)))return r}if(e){for(let r=0;r<t.length;r++){const o=t[r];if(dl(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const o=t[r];if(dl(e.attrs,o.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let n=0;n<t.length;n++){const r=t[n];if(Im(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===Ge.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const n=this.currentTrack;if(n&&Lr(e,n))return n;const r=Ms(e,this.tracksInGroup);if(r>-1){const o=this.tracksInGroup[r];return this.setSubtitleTrack(r),o}else{if(n)return null;{const o=Ms(e,t);if(o>-1)return t[o]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=e.id,r=e.groupId,o=this.getUrlWithDirectives(e.url,t),l=e.details,u=l?.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${o}`),this.hls.trigger(L.SUBTITLE_TRACK_LOADING,{url:o,id:n,groupId:r,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=hu(e.textTracks),n=this.currentTrack;let r;if(n&&(r=t.filter(o=>Im(n,o))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(o=>{o.mode!=="disabled"&&o!==r&&(o.mode="disabled")}),r){const o=this.subtitleDisplay?"showing":"hidden";r.mode!==o&&(r.mode=o)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!ge(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:e});return}const o=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&o)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:l,groupId:u="",name:f,type:d,url:m}=r;this.hls.trigger(L.SUBTITLE_TRACK_SWITCH,{id:l,groupId:u,name:f,type:d,url:m});const g=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(g)}}function AF(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?o:o&3|8).toString(16)})}}}function el(i){let e=5381,t=i.length;for(;t;)e=e*33^i.charCodeAt(--t);return(e>>>0).toString()}const Ga=.025;let $u=(function(i){return i[i.Point=0]="Point",i[i.Range=1]="Range",i})({});function RF(i,e,t){return`${i.identifier}-${t+1}-${el(e)}`}class CF{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return e<=0||isNaN(n)?!1:n===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Zh(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,n=Zh(t,e);return t-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=ge(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Zh(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<Ga))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?$u.Range:$u.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return LF(this)}}function Zh(i,e){return i-e.start<e.duration/2&&!(Math.abs(i-(e.start+e.duration))<Ga)?e.start:e.start+e.duration}function l1(i,e,t){const n=new self.URL(i,t);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function Jh(i,e){for(;(t=i.assetList[++e])!=null&&t.error;)var t;return e}function LF(i){return`["${i.identifier}" ${i.cue.pre?"<pre>":i.cue.post?"<post>":""}${i.timelineStart.toFixed(2)}-${i.resumeTime.toFixed(2)}]`}function Ma(i){const e=i.timelineStart,t=i.duration||0;return`["${i.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class _F{constructor(e,t,n,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(L.PLAYOUT_LIMIT_REACHED,{})};const o=this.hls=new e(t);this.interstitial=n,this.assetItem=r;const l=()=>{this.hasDetails=!0};o.once(L.LEVEL_LOADED,l),o.once(L.AUDIO_TRACK_LOADED,l),o.once(L.SUBTITLE_TRACK_LOADED,l),o.on(L.MEDIA_ATTACHING,(u,{media:f})=>{this.removeMediaListeners(),this.mediaAttached=f,this.interstitial.playoutLimit&&(f.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&o.on(L.BUFFER_APPENDED,()=>{const m=this.bufferedEnd;this.reachedPlayout(m)&&(this._bufferedEosTime=m,o.trigger(L.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=l1(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),r=this.timelineOffset,o=Oe.bufferInfo(e,r,0);return this.getAssetTime(o.end)>=n-.02}reachedPlayout(e){const n=this.interstitial.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Oe.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const t=this.interstitial.playoutLimit;if(t){const n=t-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const n=e-t;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-t),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const t=n=>delete n.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,n){var r;(r=this.hls)==null||r.on(e,t)}once(e,t,n){var r;(r=this.hls)==null||r.once(e,t)}off(e,t,n){var r;(r=this.hls)==null||r.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Ma(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const FE=.033;class wF extends cs{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((n,r)=>e<=r.startOffset&&t>r.startOffset?(delete r.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[n]||(t===void 0&&(t=e.start),n=this.findItemIndexAtTime(t));n>=0&&(o=r[n])!=null&&o.event;){var o;n--}return n}findItemIndexAtTime(e,t){const n=this.items;if(n)for(let r=0;r<n.length;r++){let o=n[r];if(t&&t!=="primary"&&(o=o[t]),e===o.start||e>o.start&&e<o.end)return r}return-1}findJumpRestrictedIndex(e,t){const n=this.items;if(n)for(let r=e;r<=t&&n[r];r++){const o=n[r].event;if(o!=null&&o.restrictions.jump&&!o.appendInPlace)return r}return-1}findEventIndex(e){const t=this.items;if(t)for(let r=t.length;r--;){var n;if(((n=t[r].event)==null?void 0:n.identifier)===e)return r}return-1}findAssetIndex(e,t){const n=e.assetList,r=n.length;if(r>1)for(let o=0;o<r;o++){const l=n[o];if(!l.error){const u=l.timelineStart;if(t===u||t>u&&(t<u+(l.duration||0)||o===r-1))return o}}return 0}get assetIdAtEnd(){var e;const t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){const n=t.assetList,r=n[n.length-1];if(r)return r.identifier}return null}parseInterstitialDateRanges(e,t){const n=e.main.details,{dateRanges:r}=n,o=this.events,l=this.parseDateRanges(r,{url:n.url},t),u=Object.keys(r),f=o?o.filter(d=>!u.includes(d.identifier)):[];l.length&&l.sort((d,m)=>{const g=d.cue.pre,p=d.cue.post,E=m.cue.pre,S=m.cue.post;if(g&&!E)return-1;if(E&&!g||p&&!S)return 1;if(S&&!p)return-1;if(!g&&!E&&!p&&!S){const b=d.startTime,T=m.startTime;if(b!==T)return b-T}return d.dateRange.tagOrder-m.dateRange.tagOrder}),this.events=l,f.forEach(d=>{this.removeEvent(d)}),this.updateSchedule(e,f)}updateSchedule(e,t=[],n=!1){const r=this.events||[];if(r.length||t.length||this.length<2){const o=this.items,l=this.parseSchedule(r,e);(n||t.length||o?.length!==l.length||l.some((f,d)=>Math.abs(f.playout.start-o[d].playout.start)>.005||Math.abs(f.playout.end-o[d].playout.end)>.005))&&(this.items=l,this.onScheduleUpdate(t,o))}}parseDateRanges(e,t,n){const r=[],o=Object.keys(e);for(let l=0;l<o.length;l++){const u=o[l],f=e[u];if(f.isInterstitial){let d=this.eventMap[u];d?d.setDateRange(f):(d=new CF(f,t),this.eventMap[u]=d,n===!1&&(d.appendInPlace=n)),r.push(d)}}return r}parseSchedule(e,t){const n=[],r=t.main.details,o=r.live?1/0:r.edge;let l=0;if(e=e.filter(f=>!f.error&&!(f.cue.once&&f.hasPlayed)),e.length){this.resolveOffsets(e,t);let f=0,d=0;if(e.forEach((m,g)=>{const p=m.cue.pre,E=m.cue.post,S=e[g-1]||null,b=m.appendInPlace,T=E?o:m.startOffset,A=m.duration,_=m.timelineOccupancy===$u.Range?A:0,w=m.resumptionOffset,D=S?.startTime===T,O=T+m.cumulativeDuration;let B=b?O+A:T+w;if(p||!E&&T<=0){const U=d;d+=_,m.timelineStart=O;const k=l;l+=A,n.push({event:m,start:O,end:B,playout:{start:k,end:l},integrated:{start:U,end:d}})}else if(T<=o){if(!D){const F=T-f;if(F>FE){const H=f,ne=d;d+=F;const J=l;l+=F;const le={previousEvent:e[g-1]||null,nextEvent:m,start:H,end:H+F,playout:{start:J,end:l},integrated:{start:ne,end:d}};n.push(le)}else F>0&&S&&(S.cumulativeDuration+=F,n[n.length-1].end=T)}E&&(B=O),m.timelineStart=O;const U=d;d+=_;const k=l;l+=A,n.push({event:m,start:O,end:B,playout:{start:k,end:l},integrated:{start:U,end:d}})}else return;const N=m.resumeTime;E||N>o?f=o:f=N}),f<o){var u;const m=f,g=d,p=o-f;d+=p;const E=l;l+=p,n.push({previousEvent:((u=n[n.length-1])==null?void 0:u.event)||null,nextEvent:null,start:f,end:m+p,playout:{start:E,end:l},integrated:{start:g,end:d}})}this.setDurations(o,l,d)}else n.push({previousEvent:null,nextEvent:null,start:0,end:o,playout:{start:0,end:o},integrated:{start:0,end:o}}),this.setDurations(o,o,o);return n}setDurations(e,t,n){this.durations={primary:e,playout:t,integrated:n}}resolveOffsets(e,t){const n=t.main.details,r=n.live?1/0:n.edge;let o=0,l=-1;e.forEach((u,f)=>{const d=u.cue.pre,m=u.cue.post,g=d?0:m?r:u.startTime;this.updateAssetDurations(u),l===g?u.cumulativeDuration=o:(o=0,l=g),!m&&u.snapOptions.in&&(u.resumeAnchor=Nr(null,n.fragments,u.startOffset+u.resumptionOffset,0,0)||void 0),u.appendInPlace&&!u.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(u,t)||(u.appendInPlace=!1)),!u.appendInPlace&&f+1<e.length&&e[f+1].startTime-e[f].resumeTime<FE&&(e[f+1].appendInPlace=!1,e[f+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${u}`));const E=ge(u.resumeOffset)?u.resumeOffset:u.duration;o+=E})}primaryCanResumeInPlaceAt(e,t){const n=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(n-r)>Ga?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${r}`),!1):!Object.keys(t).some(l=>{const u=t[l].details,f=u.edge;if(n>=f)return this.log(`"${e.identifier}" resumption ${n} past ${l} playlist end ${f}`),!1;const d=Nr(null,u.fragments,n);if(!d)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${l} playlist (${u.fragStart}-${u.fragmentEnd})`),!0;const m=l==="audio"?.175:0;return Math.abs(d.start-n)<Ga+m||Math.abs(d.end-n)<Ga+m?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${l} fragment bounds (${d.start}-${d.end} sn: ${d.sn} cc: ${d.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let n=0,r=!1,o=!1;for(let l=0;l<e.assetList.length;l++){const u=e.assetList[l],f=t+n;u.startOffset=n,u.timelineStart=f,r||(r=u.duration===null),o||(o=!!u.error);const d=u.error?0:u.duration||0;n+=d}r&&!o?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function gs(i){return`[${i.event?'"'+i.event.identifier+'"':"primary"}: ${i.start.toFixed(2)}-${i.end.toFixed(2)}]`}class DF{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const n=e.assetListUrl;let r;try{r=l1(n,this.hls.sessionId,e.baseUrl)}catch(p){const E=this.assignAssetListError(e,X.ASSET_LIST_LOAD_ERROR,p,n);this.hls.trigger(L.ERROR,E);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);const o=this.hls.config,l=o.loader,u=new l(o),f={responseType:"json",url:r.href},d=o.interstitialAssetListLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,E,S,b)=>{const T=p.data,A=T?.ASSETS;if(!Array.isArray(A)){const _=this.assignAssetListError(e,X.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),S.url,E,b);this.hls.trigger(L.ERROR,_);return}e.assetListResponse=T,this.hls.trigger(L.ASSET_LIST_LOADED,{event:e,assetListResponse:T,networkDetails:b})},onError:(p,E,S,b)=>{const T=this.assignAssetListError(e,X.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${E.url})`),E.url,b,S);this.hls.trigger(L.ERROR,T)},onTimeout:(p,E,S)=>{const b=this.assignAssetListError(e,X.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${E.url})`),E.url,p,S);this.hls.trigger(L.ERROR,b)}};return u.load(f,m,g),this.hls.trigger(L.ASSET_LIST_LOADING,{event:e}),u}assignAssetListError(e,t,n,r,o,l){return e.error=n,{type:Te.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:r,error:n,networkDetails:l,stats:o}}}function BE(i){var e;i==null||(e=i.play())==null||e.catch(()=>{})}function Qc(i,e){return`[${i}] Advancing timeline position to ${e}`}class IF extends cs{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled||!this.schedule)return;const r=n-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const l=r<=-.01;this.timelinePos=n,this.bufferedPos=n;const u=this.playingItem;if(!u){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(n,n-r)&&this.updateSchedule(!0),this.checkBuffer(),l&&n<u.start||n>=u.end){var f;const E=this.findItemIndex(u);let S=this.schedule.findItemIndexAtTime(n);if(S===-1&&(S=E+(l?-1:1),this.log(`seeked ${l?"back ":""}to position not covered by schedule ${n} (resolving from ${E} to ${S})`)),!this.isInterstitial(u)&&(f=this.media)!=null&&f.paused&&(this.shouldPlay=!1),!l&&S>E){const b=this.schedule.findJumpRestrictedIndex(E+1,S);if(b>E){this.setSchedulePosition(b);return}}this.setSchedulePosition(S);return}const d=this.playingAsset;if(!d){if(this.playingLastItem&&this.isInterstitial(u)){const E=u.event.assetList[0];E&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,E))}return}const m=d.timelineStart,g=d.duration||0;if(l&&n<m||n>=m+g){var p;(p=u.event)!=null&&p.appendInPlace&&(this.clearAssetPlayers(u.event,u),this.flushFrontBuffer(n)),this.setScheduleToAssetAtTime(n,d)}},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(n>=r.end){this.timelinePos=r.end;const u=this.findItemIndex(r);this.setSchedulePosition(u+1)}const o=this.playingAsset;if(!o)return;const l=o.timelineStart+(o.duration||0);n>=l&&this.setScheduleToAssetAtTime(n,o)},this.onScheduleUpdate=(n,r)=>{const o=this.schedule;if(!o)return;const l=this.playingItem,u=o.events||[],f=o.items||[],d=o.durations,m=n.map(b=>b.identifier),g=!!(u.length||m.length);(g||r)&&this.log(`INTERSTITIALS_UPDATED (${u.length}): ${u}
Schedule: ${f.map(b=>gs(b))} pos: ${this.timelinePos}`),m.length&&this.log(`Removed events ${m}`);let p=null,E=null;l&&(p=this.updateItem(l,this.timelinePos),this.itemsMatch(l,p)?this.playingItem=p:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const S=this.bufferingItem;if(S&&(E=this.updateItem(S,this.bufferedPos),this.itemsMatch(S,E)?this.bufferingItem=E:S.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(S.event,null))),n.forEach(b=>{b.assetList.forEach(T=>{this.clearAssetPlayer(T.identifier,null)})}),this.playerQueue.forEach(b=>{if(b.interstitial.appendInPlace){const T=b.assetItem.timelineStart,A=b.timelineOffset-T;if(A)try{b.timelineOffset=T}catch(_){Math.abs(A)>Ga&&this.warn(`${_} ("${b.assetId}" ${b.timelineOffset}->${T})`)}}}),g||r){if(this.hls.trigger(L.INTERSTITIALS_UPDATED,{events:u.slice(0),schedule:f.slice(0),durations:d,removedIds:m}),this.isInterstitial(l)&&m.includes(l.event.identifier)){this.warn(`Interstitial "${l.event.identifier}" removed while playing`),this.primaryFallback(l.event);return}l&&this.trimInPlace(p,l),S&&E!==p&&this.trimInPlace(E,S),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new DF(e),this.schedule=new wF(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(L.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(L.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(L.MEDIA_ENDED,this.onMediaEnded,this),e.on(L.ERROR,this.onError,this),e.on(L.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(L.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(L.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(L.BUFFER_CODECS,this.onBufferCodecs,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(L.MEDIA_ENDED,this.onMediaEnded,this),e.off(L.ERROR,this.onError,this),e.off(L.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Rn(e,"play",this.onPlay),Rn(e,"pause",this.onPause),Rn(e,"seeking",this.onSeeking),Rn(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const n=this.media=t.media;pn(n,"seeking",this.onSeeking),pn(n,"timeupdate",this.onTimeupdate),pn(n,"play",this.onPlay),pn(n,"pause",this.onPause)}onMediaAttached(e,t){const n=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!r){this.clearScheduleState();const o=this.findItemIndex(n);this.setSchedulePosition(o)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const n=!!t.transferMedia,r=this.media;if(this.media=null,!n&&(r&&this.removeMediaListeners(r),this.detachedData)){const o=this.getBufferingPlayer();o&&(this.log(`Removing schedule state for detachedData and ${o}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,o.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,t=()=>e.bufferingItem||e.waitingItem,n=g=>g&&e.getAssetPlayer(g.identifier),r=(g,p,E,S,b)=>{if(g){let T=g[p].start;const A=g.event;if(A){if(p==="playout"||A.timelineOccupancy!==$u.Point){const _=n(E);_?.interstitial===A&&(T+=_.assetItem.startOffset+_[b])}}else{const _=S==="bufferedPos"?l():e[S];T+=_-g.start}return T}return 0},o=(g,p)=>{var E;if(g!==0&&p!=="primary"&&(E=e.schedule)!=null&&E.length){var S;const b=e.schedule.findItemIndexAtTime(g),T=(S=e.schedule.items)==null?void 0:S[b];if(T){const A=T[p].start-T.start;return g+A}}return g},l=()=>{const g=e.bufferedPos;return g===Number.MAX_VALUE?u("primary"):Math.max(g,0)},u=g=>{var p,E;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:((E=e.schedule)==null?void 0:E.durations[g])||0},f=(g,p)=>{var E,S;const b=e.effectivePlayingItem;if(b!=null&&(E=b.event)!=null&&E.restrictions.skip||!e.schedule)return;e.log(`seek to ${g} "${p}"`);const T=e.effectivePlayingItem,A=e.schedule.findItemIndexAtTime(g,p),_=(S=e.schedule.items)==null?void 0:S[A],w=e.getBufferingPlayer(),D=w?.interstitial,O=D?.appendInPlace,B=T&&e.itemsMatch(T,_);if(T&&(O||B)){const N=n(e.playingAsset),U=N?.media||e.primaryMedia;if(U){const k=p==="primary"?U.currentTime:r(T,p,e.playingAsset,"timelinePos","currentTime"),F=g-k,H=(O?k:U.currentTime)+F;if(H>=0&&(!N||O||H<=N.duration)){U.currentTime=H;return}}}if(_){let N=g;if(p!=="primary"){const k=_[p].start,F=g-k;N=_.start+F}const U=!e.isInterstitial(_);if((!e.isInterstitial(T)||T.event.appendInPlace)&&(U||_.event.appendInPlace)){const k=e.media||(O?w?.media:null);k&&(k.currentTime=N)}else if(T){const k=e.findItemIndex(T);if(A>k){const H=e.schedule.findJumpRestrictedIndex(k+1,A);if(H>k){e.setSchedulePosition(H);return}}let F=0;if(U)e.timelinePos=N,e.checkBuffer();else{const H=_.event.assetList,ne=g-(_[p]||_).start;for(let J=H.length;J--;){const le=H[J];if(le.duration&&ne>=le.startOffset&&ne<le.startOffset+le.duration){F=J;break}}}e.setSchedulePosition(A,F)}}},d=()=>{const g=e.effectivePlayingItem;if(e.isInterstitial(g))return g;const p=t();return e.isInterstitial(p)?p:null},m={get bufferedEnd(){const g=t(),p=e.bufferingItem;if(p&&p===g){var E;return r(p,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-p.playout.start||((E=e.bufferingAsset)==null?void 0:E.startOffset)||0}return 0},get currentTime(){const g=d(),p=e.effectivePlayingItem;return p&&p===g?r(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(g){const p=d(),E=e.effectivePlayingItem;E&&E===p&&f(g+E.playout.start,"playout")},get duration(){const g=d();return g?g.playout.end-g.playout.start:0},get assetPlayers(){var g;const p=(g=d())==null?void 0:g.event.assetList;return p?p.map(E=>e.getAssetPlayer(E.identifier)):[]},get playingIndex(){var g;const p=(g=d())==null?void 0:g.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};return this.manager={get events(){var g;return((g=e.schedule)==null||(g=g.events)==null?void 0:g.slice(0))||[]},get schedule(){var g;return((g=e.schedule)==null||(g=g.items)==null?void 0:g.slice(0))||[]},get interstitialPlayer(){return d()?m:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const g=t();return e.findItemIndex(g)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const g=e.effectivePlayingItem;return e.findItemIndex(g)},primary:{get bufferedEnd(){return l()},get currentTime(){const g=e.timelinePos;return g>0?g:0},set currentTime(g){f(g,"primary")},get duration(){return u("primary")},get seekableStart(){var g;return((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(g){f(g,"integrated")},get duration(){return u("integrated")},get seekableStart(){var g;return o(((g=e.primaryDetails)==null?void 0:g.fragmentStart)||0,"integrated")}},skip:()=>{const g=e.effectivePlayingItem,p=g?.event;if(p&&!p.restrictions.skip){const E=e.findItemIndex(g);if(p.appendInPlace){const S=g.playout.start+g.event.duration;f(S+.001,"playout")}else e.advanceAfterAssetEnded(p,E,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!n?!1:this.findItemIndex(t)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let r=this.media;!r&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(r=this.primaryMedia);const o=(t=r)==null?void 0:t.currentTime;if(!(o===void 0||!ge(o)))return o}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,t)}transferMediaFromPlayer(e,t){const n=e.interstitial.appendInPlace,r=e.media;if(n&&r===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&r){this.detachedData={media:r};return}const o=e.transferMedia();this.log(`transfer MediaSource from ${e} ${pt(o)}`),this.detachedData=o}else t&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,t){var n,r;if(e.media===t)return;let o=null;const l=this.hls,u=e!==l,f=u&&e.interstitial.appendInPlace,d=(n=this.detachedData)==null?void 0:n.mediaSource;let m;if(l.media)f&&(o=l.transferMedia(),this.detachedData=o),m="Primary";else if(d){const S=this.getBufferingPlayer();S?(o=S.transferMedia(),m=`${S}`):m="detached MediaSource"}else m="detached media";if(!o){if(d)o=this.detachedData,this.log(`using detachedData: MediaSource ${pt(o)}`);else if(!this.detachedData||l.media===t){const S=this.playerQueue;S.length>1&&S.forEach(b=>{if(u&&b.interstitial.appendInPlace!==f){const T=b.interstitial;this.clearInterstitial(b.interstitial,null),T.appendInPlace=!1,T.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${T}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const g=o&&"mediaSource"in o&&((r=o.mediaSource)==null?void 0:r.readyState)!=="closed",p=g&&o?o:t;this.log(`${g?"transfering MediaSource":"attaching media"} to ${u?e:"Primary"} from ${m} (media.currentTime: ${t.currentTime})`);const E=this.schedule;if(p===o&&E){const S=u&&e.assetId===E.assetIdAtEnd;p.overrides={duration:E.duration,endOfStream:!u||S,cueRemoval:!u}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,r=this.effectivePlayingItem;if(n===-1){const o=this.hls.startPosition;if(this.log(Qc("checkStart",o)),this.timelinePos=o,t.length&&t[0].cue.pre){const l=e.findEventIndex(t[0].identifier);this.setSchedulePosition(l)}else if(o>=0||!this.primaryLive){const l=this.timelinePos=o>0?o:0,u=e.findItemIndexAtTime(l);this.setSchedulePosition(u)}}else if(r&&!this.playingItem){const o=e.findItemIndex(r);this.setSchedulePosition(o)}}advanceAssetBuffering(e,t){const n=e.event,r=n.findAssetIndex(t),o=Jh(n,r);if(!n.isAssetPastPlayoutLimit(o))this.bufferedToEvent(e,o);else if(this.schedule){var l;const u=(l=this.schedule.items)==null?void 0:l[this.findItemIndex(e)+1];u&&this.bufferedToItem(u)}}advanceAfterAssetEnded(e,t,n){const r=Jh(e,n);if(e.isAssetPastPlayoutLimit(r)){if(this.schedule){const o=this.schedule.items;if(o){const l=t+1,u=o.length;if(l>=u){this.setSchedulePosition(-1);return}const f=e.resumeTime;this.timelinePos<f&&(this.log(Qc("advanceAfterAssetEnded",f)),this.timelinePos=f,e.appendInPlace&&this.advanceInPlace(f),this.checkBuffer(this.bufferedPos<f)),this.setSchedulePosition(l)}}}else{if(e.appendInPlace){const o=e.assetList[r];o&&this.advanceInPlace(o.timelineStart)}this.setSchedulePosition(t,r)}}setScheduleToAssetAtTime(e,t){const n=this.schedule;if(!n)return;const r=t.parentIdentifier,o=n.getEvent(r);if(o){const l=n.findEventIndex(r),u=n.findAssetIndex(o,e);this.advanceAfterAssetEnded(o,l,u-1)}}setSchedulePosition(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(!r||this.playbackDisabled)return;const o=e>=0?r[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${o&&gs(o)}) pos: ${this.timelinePos}`);const l=this.waitingItem||this.playingItem,u=this.playingLastItem;if(this.isInterstitial(l)){const m=l.event,g=this.playingAsset,p=g?.identifier,E=p?this.getAssetPlayer(p):null;if(E&&p&&(!this.eventItemsMatch(l,o)||t!==void 0&&p!==m.assetList[t].identifier)){var f;const S=m.findAssetIndex(g);if(this.log(`INTERSTITIAL_ASSET_ENDED ${S+1}/${m.assetList.length} ${Ma(g)}`),this.endedAsset=g,this.playingAsset=null,this.hls.trigger(L.INTERSTITIAL_ASSET_ENDED,{asset:g,assetListIndex:S,event:m,schedule:r.slice(0),scheduleIndex:e,player:E}),l!==this.playingItem){this.itemsMatch(l,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(m,this.findItemIndex(this.playingItem),S);return}this.retreiveMediaSource(p,o),E.media&&!((f=this.detachedData)!=null&&f.mediaSource)&&E.detachMedia()}if(!this.eventItemsMatch(l,o)&&(this.endedItem=l,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${m} ${gs(l)}`),m.hasPlayed=!0,this.hls.trigger(L.INTERSTITIAL_ENDED,{event:m,schedule:r.slice(0),scheduleIndex:e}),m.cue.once)){var d;this.updateSchedule();const S=(d=this.schedule)==null?void 0:d.items;if(o&&S){const b=this.findItemIndex(o);this.advanceSchedule(b,S,t,l,u)}return}}this.advanceSchedule(e,r,t,l,u)}advanceSchedule(e,t,n,r,o){const l=this.schedule;if(!l)return;const u=t[e]||null,f=this.primaryMedia,d=this.playerQueue;if(d.length&&d.forEach(m=>{const g=m.interstitial,p=l.findEventIndex(g.identifier);(p<e||p>e+1)&&this.clearInterstitial(g,u)}),this.isInterstitial(u)){this.timelinePos=Math.min(Math.max(this.timelinePos,u.start),u.end);const m=u.event;if(n===void 0){n=l.findAssetIndex(m,this.timelinePos);const S=Jh(m,n-1);if(m.isAssetPastPlayoutLimit(S)||m.appendInPlace&&this.timelinePos===u.end){this.advanceAfterAssetEnded(m,e,n);return}n=S}const g=this.waitingItem;this.assetsBuffered(u,f)||this.setBufferingItem(u);let p=this.preloadAssets(m,n);if(this.eventItemsMatch(u,g||r)||(this.waitingItem=u,this.log(`INTERSTITIAL_STARTED ${gs(u)} ${m.appendInPlace?"append in place":""}`),this.hls.trigger(L.INTERSTITIAL_STARTED,{event:m,schedule:t.slice(0),scheduleIndex:e})),!m.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${m}`);return}if(m.assetListLoader&&(m.assetListLoader.destroy(),m.assetListLoader=void 0),!f){this.log(`Waiting for attachMedia to start Interstitial ${m}`);return}this.waitingItem=this.endedItem=null,this.playingItem=u;const E=m.assetList[n];if(!E){this.advanceAfterAssetEnded(m,e,n||0);return}if(p||(p=this.getAssetPlayer(E.identifier)),p===null||p.destroyed){const S=m.assetList.length;this.warn(`asset ${n+1}/${S} player destroyed ${m}`),p=this.createAssetPlayer(m,E,n),p.loadSource()}if(!this.eventItemsMatch(u,this.bufferingItem)&&m.appendInPlace&&this.isAssetBuffered(E))return;this.startAssetPlayer(p,n,t,e,f),this.shouldPlay&&BE(p.media)}else u?(this.resumePrimary(u,e,r),this.shouldPlay&&BE(this.hls.media)):o&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(l.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,n){var r,o;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${gs(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let u=this.timelinePos;(u<e.start||u>=e.end)&&(u=this.getPrimaryResumption(e,t),this.log(Qc("resumePrimary",u)),this.timelinePos=u),this.attachPrimary(u,e)}if(!n)return;const l=(o=this.schedule)==null?void 0:o.items;l&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${gs(e)}`),this.hls.trigger(L.INTERSTITIALS_PRIMARY_RESUMED,{schedule:l.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const n=e.start;if(this.primaryLive){const r=this.primaryDetails;if(t===0)return this.hls.startPosition;if(r&&(n<r.fragmentStart||n>r.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Oe.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,n){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const o=this.hls;o.media?this.checkBuffer():(this.transferMediaTo(o,r),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(Qc("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,t){var n;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((n=r.mainForwardBufferInfo)==null?void 0:n.start)||r.media.currentTime)-e)>.5?r.startLoad(e,t):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(L.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(L.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;const n=this.hls.levels[t.level];if(!n.details)return;const r=ot(ot({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const n=this.hls.audioTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=ot(ot({},this.altSelection),{},{audio:n});return}const o=ot(ot({},r),{},{audio:n});this.mediaSelection=o}onSubtitleTrackUpdated(e,t){const n=this.hls.subtitleTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=ot(ot({},this.altSelection),{},{subtitles:n});return}const o=ot(ot({},r),{},{subtitles:n});this.mediaSelection=o}onAudioTrackSwitching(e,t){const n=qx(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setAudioOption(t)||r.setAudioOption(n)))}onSubtitleTrackSwitch(e,t){const n=qx(t);this.playerQueue.forEach(({hls:r})=>r&&(r.setSubtitleOption(t)||t.id!==-1&&r.setSubtitleOption(n)))}onBufferCodecs(e,t){const n=t.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let r=0;r<t.length;r++){const o=t[r];if(o.cue.post){var n;const l=this.schedule.findEventIndex(o.identifier),u=(n=this.schedule.items)==null?void 0:n[l];this.isInterstitial(u)&&this.eventItemsMatch(u,this.bufferingItem)&&this.bufferedToItem(u,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const n=this.findItemIndex(t);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,t){var n;const r=(n=this.schedule)==null?void 0:n.items;if(e&&r){const o=this.findItemIndex(e,t);return r[o]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((o,l)=>{e.event.isAssetPastPlayoutLimit(l)&&this.clearAssetPlayer(o.identifier,null)});const n=e.end+.25,r=Oe.bufferInfo(this.primaryMedia,n,0);(r.end>n||(r.nextStart||0)>n)&&(this.log(`trim buffered interstitial ${gs(e)} (was ${gs(t)})`),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var n;return!!t&&(e===t||e.event.identifier===((n=t.event)==null?void 0:n.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;const n=this.mediaSelection;n&&((t=this.schedule)==null||t.updateSchedule(n,[],e))}checkBuffer(e){var t;const n=(t=this.schedule)==null?void 0:t.items;if(!n)return;const r=Oe.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=r.len<1),this.updateBufferedPos(r.end,n,e)}updateBufferedPos(e,t,n){const r=this.schedule,o=this.bufferingItem;if(this.bufferedPos>e||!r)return;if(t.length===1&&this.itemsMatch(t[0],o)){this.bufferedPos=e;return}const l=this.playingItem,u=this.findItemIndex(l);let f=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var d;const m=this.findItemIndex(o),g=Math.min(m+1,t.length-1),p=t[g];if((f===-1&&o&&e>=o.end||(d=p.event)!=null&&d.appendInPlace&&e+.01>=p.start)&&(f=g),this.isInterstitial(o)){const E=o.event;if(g-u>1&&E.appendInPlace===!1||E.assetList.length===0&&E.assetListLoader)return}if(this.bufferedPos=e,f>m&&f>u)this.bufferedToItem(p);else{const E=this.primaryDetails;this.primaryLive&&E&&e>E.edge-E.targetduration&&p.start<E.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(p)&&this.preloadAssets(p.event,0)}}else n&&l&&!this.itemsMatch(l,o)&&(f===u?this.bufferedToItem(l):f===u+1&&this.bufferedToItem(t[f]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const o=this.getAssetPlayer(r.identifier);return!(o!=null&&o.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,t)&&n){const{items:r,events:o}=n;if(!r||!o)return t;const l=this.isInterstitial(e),u=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const f=u?u.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${gs(e)}`+(t?` (${f.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(l){const d=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((m,g)=>{const p=this.getAssetPlayer(m.identifier);p&&(g===d&&p.loadSource(),p.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(d=>d.pauseBuffering());this.hls.trigger(L.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:o.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(n!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),n=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,t){const n=e.event,r=n.assetList.length===0&&!n.assetListLoader,o=n.cue.once;if(r||!o){const l=this.preloadAssets(n,t);if(l!=null&&l.interstitial.appendInPlace){const u=this.primaryMedia;u&&this.bufferAssetPlayer(l,u)}}}preloadAssets(e,t){const n=e.assetUrl,r=e.assetList.length,o=r===0&&!e.assetListLoader,l=e.cue.once;if(o){const f=e.timelineStart;if(e.appendInPlace){var u;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(u=p.nextEvent)==null?void 0:u.identifier)===e.identifier&&this.flushFrontBuffer(f+.25)}let d,m=0;if(!this.playingItem&&this.primaryLive&&(m=this.hls.startPosition,m===-1&&(m=this.hls.liveSyncPosition||0)),m&&!(e.cue.pre||e.cue.post)){const p=m-f;p>0&&(d=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${n?1:r} ${e}${d?` live-start: ${m} start-offset: ${d}`:""}`),n)return this.createAsset(e,0,0,f,e.duration,n);const g=this.assetListLoader.loadAssetList(e,d);g&&(e.assetListLoader=g)}else if(!l&&r){for(let d=t;d<r;d++){const m=e.assetList[d],g=this.getAssetPlayerQueueIndex(m.identifier);(g===-1||this.playerQueue[g].destroyed)&&!m.error&&this.createAssetPlayer(e,m,d)}const f=e.assetList[t];if(f){const d=this.getAssetPlayer(f.identifier);return d&&d.loadSource(),d}}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(L.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let n=0;n<t.length;n++)if(e===t[n].assetId)return n;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let n=0;n<e.length;n++)if(e[n].media===t)return e[n]}return null}createAsset(e,t,n,r,o,l){const u={parentIdentifier:e.identifier,identifier:RF(e,l,t),duration:o,startOffset:n,timelineStart:r,uri:l};return this.createAssetPlayer(e,u,t)}createAssetPlayer(e,t,n){const r=this.hls,o=r.userConfig;let l=o.videoPreference;const u=r.loadLevelObj||r.levels[r.currentLevel];(l||u)&&(l=ht({},l),u.videoCodec&&(l.videoCodec=u.videoCodec),u.videoRange&&(l.allowedVideoRanges=[u.videoRange]));const f=r.audioTracks[r.audioTrack],d=r.subtitleTracks[r.subtitleTrack];let m=0;if(this.primaryLive||e.appendInPlace){const D=this.timelinePos-t.timelineStart;if(D>1){const O=t.duration;O&&D<O&&(m=D)}}const g=t.identifier,p=ot(ot({},o),{},{maxMaxBufferLength:Math.min(180,r.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:g,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:m,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:l,audioPreference:f||o.audioPreference,subtitlePreference:d||o.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const E=p.cmcd;E!=null&&E.sessionId&&E.contentId&&(p.cmcd=ht({},E,{contentId:el(t.uri)})),this.getAssetPlayer(g)&&this.warn(`Duplicate date range identifier ${e} and asset ${g}`);const S=new _F(this.HlsPlayerClass,p,e,t);this.playerQueue.push(S),e.assetList[n]=t;let b=!0;const T=D=>{if(D.live){var O;const U=new Error(`Interstitials MUST be VOD assets ${e}`),k={fatal:!0,type:Te.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:U},F=((O=this.schedule)==null?void 0:O.findEventIndex(e.identifier))||-1;this.handleAssetItemError(k,e,F,n,U.message);return}const B=D.edge-D.fragmentStart,N=t.duration;(b||N===null||B>N)&&(b=!1,this.log(`Interstitial asset "${g}" duration change ${N} > ${B}`),t.duration=B,this.updateSchedule())};S.on(L.LEVEL_UPDATED,(D,{details:O})=>T(O)),S.on(L.LEVEL_PTS_UPDATED,(D,{details:O})=>T(O)),S.on(L.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const A=(D,O)=>{const B=this.getAssetPlayer(g);if(B&&O.tracks){B.off(L.BUFFER_CODECS,A),B.tracks=O.tracks;const N=this.primaryMedia;this.bufferingAsset===B.assetItem&&N&&!B.media&&this.bufferAssetPlayer(B,N)}};S.on(L.BUFFER_CODECS,A);const _=()=>{var D;const O=this.getAssetPlayer(g);if(this.log(`buffered to end of asset ${O}`),!O||!this.schedule)return;const B=this.schedule.findEventIndex(e.identifier),N=(D=this.schedule.items)==null?void 0:D[B];this.isInterstitial(N)&&this.advanceAssetBuffering(N,t)};S.on(L.BUFFERED_TO_END,_);const w=D=>()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;this.shouldPlay=!0;const B=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,B,D)};return S.once(L.MEDIA_ENDED,w(n)),S.once(L.PLAYOUT_LIMIT_REACHED,w(1/0)),S.on(L.ERROR,(D,O)=>{if(!this.schedule)return;const B=this.getAssetPlayer(g);if(O.details===X.BUFFER_STALLED_ERROR){if(B!=null&&B.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(O,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${O.error} ${e}`)}),S.on(L.DESTROYING,()=>{if(!this.getAssetPlayer(g)||!this.schedule)return;const O=new Error(`Asset player destroyed unexpectedly ${g}`),B={fatal:!0,type:Te.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:O};this.handleAssetItemError(B,e,this.schedule.findEventIndex(e.identifier),n,O.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Ma(t)}`),this.hls.trigger(L.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:n,event:e,player:S}),S}clearInterstitial(e,t){this.clearAssetPlayers(e,t),e.reset()}clearAssetPlayers(e,t){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,t)})}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[t];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,t){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){const r=this.playerQueue[n];this.log(`clear ${r} toSegment: ${t&&gs(t)}`),this.transferMediaFromPlayer(r,t),this.playerQueue.splice(n,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,n,r,o){const{interstitial:l,assetItem:u,assetId:f}=e,d=l.assetList.length,m=this.playingAsset;this.endedAsset=null,this.playingAsset=u,(!m||m.identifier!==f)&&(m&&(this.clearAssetPlayer(m.identifier,n[r]),delete m.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${Ma(u)}`),this.hls.trigger(L.INTERSTITIAL_ASSET_STARTED,{asset:u,assetListIndex:t,event:l,schedule:n.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,o)}bufferAssetPlayer(e,t){var n,r;if(!this.schedule)return;const{interstitial:o,assetItem:l}=e,u=this.schedule.findEventIndex(o.identifier),f=(n=this.schedule.items)==null?void 0:n[u];if(!f)return;e.loadSource(),this.setBufferingItem(f),this.bufferingAsset=l;const d=this.getBufferingPlayer();if(d===e)return;const m=o.appendInPlace;if(m&&d?.interstitial.appendInPlace===!1)return;const g=d?.tracks||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(m&&l!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(g&&!HT(g,e.tracks)){const p=new Error(`Asset ${Ma(l)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(g)}')`),E={fatal:!0,type:Te.OTHER_ERROR,details:X.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},S=o.findAssetIndex(l);this.handleAssetItemError(E,o,u,S,p.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){const t=this.schedule,n=this.primaryMedia;if(!t||!n)return;const r=n.currentTime,o=t.findAssetIndex(e,r),l=e.assetList[o];if(l){const u=this.getAssetPlayer(l.identifier);if(u){const f=u.currentTime||r-l.timelineStart,d=u.duration-f;if(this.warn(`Stalled at ${f} of ${f+d} in ${u} ${e} (media.currentTime: ${r})`),f&&(d/n.playbackRate<.5||u.bufferedInPlaceToEnd(n))&&u.hls){const m=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,m,o)}}}}advanceInPlace(e){const t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,n,r,o){if(e.details===X.BUFFER_STALLED_ERROR)return;const l=t.assetList[r]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${l&&Ma(l)} ${e.error}`),!this.schedule)return;const u=l?.identifier||"",f=this.getAssetPlayerQueueIndex(u),d=this.playerQueue[f]||null,m=this.schedule.items,g=ht({},e,{fatal:!1,errorAction:Ba(!0),asset:l,assetListIndex:r,event:t,schedule:m,scheduleIndex:n,player:d});if(this.hls.trigger(L.INTERSTITIAL_ASSET_ERROR,g),!e.fatal)return;const p=this.playingAsset,E=this.bufferingAsset,S=new Error(o);if(l&&(this.clearAssetPlayer(u,null),l.error=S),!t.assetList.some(b=>!b.error))t.error=S;else for(let b=r;b<t.assetList.length;b++)this.resetAssetPlayer(t.assetList[b].identifier);this.updateSchedule(!0),t.error?this.primaryFallback(t):p&&p.identifier===u?this.advanceAfterAssetEnded(t,n,r):E&&E.identifier===u&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,E)}primaryFallback(e){const t=e.timelineStart,n=this.effectivePlayingItem;let r=this.timelinePos;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${r} playing: ${gs(n)} error: ${e.error}`),r===-1&&(r=this.hls.startPosition);const l=this.updateItem(n,r);this.itemsMatch(n,l)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}else if(r===-1){this.checkStart();return}if(!this.schedule)return;const o=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(o)}onAssetListLoaded(e,t){var n,r;const o=t.event,l=o.identifier,u=t.assetListResponse.ASSETS;if(!((n=this.schedule)!=null&&n.hasEvent(l)))return;const f=o.timelineStart,d=o.duration;let m=0;u.forEach((b,T)=>{const A=parseFloat(b.DURATION);this.createAsset(o,T,m,f+m,A,b.URI),m+=A}),o.duration=m,this.log(`Loaded asset-list with duration: ${m} (was: ${d}) ${o}`);const g=this.waitingItem,p=g?.event.identifier===l;this.updateSchedule();const E=(r=this.bufferingItem)==null?void 0:r.event;if(p){var S;const b=this.schedule.findEventIndex(l),T=(S=this.schedule.items)==null?void 0:S[b];if(T){if(!this.playingItem&&this.timelinePos>T.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==b){o.error=new Error(`Interstitial ${u.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${o}`),this.log(o.error.message),this.updateSchedule(!0),this.primaryFallback(o);return}this.setBufferingItem(T)}this.setSchedulePosition(b)}else if(E?.identifier===l){const b=o.assetList[0];if(b){const T=this.getAssetPlayer(b.identifier);if(E.appendInPlace){const A=this.primaryMedia;T&&A&&this.bufferAssetPlayer(T,A)}else T&&T.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case X.ASSET_LIST_PARSING_ERROR:case X.ASSET_LIST_LOAD_ERROR:case X.ASSET_LIST_LOAD_TIMEOUT:{const n=t.interstitial;n&&(this.updateSchedule(!0),this.primaryFallback(n));break}case X.BUFFER_STALLED_ERROR:{const n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace){this.handleInPlaceStall(n.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const jE=500;class NF extends Og{constructor(e,t,n){super(e,t,n,"subtitle-stream-controller",pe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(L.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(L.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ae.IDLE,this.setInterval(jE),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:n,success:r}=t;if(this.fragContextChanged(n)||(Pt(n)&&(this.fragPrevious=n),this.state=ae.IDLE),!r)return;const o=this.tracksBuffered[this.currentTrackId];if(!o)return;let l;const u=n.start;for(let d=0;d<o.length;d++)if(u>=o[d].start&&u<=o[d].end){l=o[d];break}const f=n.start+n.duration;l?l.end=f:(l={start:u,end:f},o.push(l)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){const o=r-1;if(o<=0)return;t.endOffsetSubtitles=Math.max(0,o),this.tracksBuffered.forEach(l=>{for(let u=0;u<l.length;){if(l[u].end<=o){l.shift();continue}else if(l[u].start<o)l[u].start=o;else break;u++}}),this.fragmentTracker.removeFragmentsInRange(n,o,pe.SUBTITLE)}}onError(e,t){const n=t.frag;n?.type===pe.SUBTITLE&&(t.details===X.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==ae.STOPPED&&(this.state=ae.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&YA(this.levels,t)){this.levels=t.map(n=>new ol(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{const r=new ol(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,pe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==ae.STOPPED&&this.setInterval(jE)}onSubtitleTrackLoaded(e,t){var n;const{currentTrackId:r,levels:o}=this,{details:l,id:u}=t;if(!o){this.warn(`Subtitle tracks were reset while loading level ${u}`);return}const f=o[u];if(u>=o.length||!f)return;this.log(`Subtitle track ${u} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(l.live||(n=f.details)!=null&&n.live){if(l.deltaUpdateFailed)return;const g=this.mainDetails;if(!g){this.startFragRequested=!1;return}const p=g.fragments[0];if(!f.details)l.hasProgramDateTime&&g.hasProgramDateTime?(Bu(l,g),d=l.fragmentStart):p&&(d=p.start,_m(l,d));else{var m;d=this.alignPlaylists(l,f.details,(m=this.levelLastLoaded)==null?void 0:m.details),d===0&&p&&(d=p.start,_m(l,d))}g&&!this.startFragRequested&&this.setStartPosition(g,d)}f.details=l,this.levelLastLoaded=f,u===r&&(this.hls.trigger(L.SUBTITLE_TRACK_UPDATED,{details:l,id:u,groupId:t.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===ae.IDLE&&(Nr(null,l.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),f.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:n}=e,r=t.decryptdata,o=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&ja(r.method)){const l=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer,Ig(r.method)).catch(u=>{throw o.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:t}),u}).then(u=>{const f=performance.now();o.trigger(L.FRAG_DECRYPTED,{frag:t,payload:u,stats:{tstart:l,tdecrypt:f}})}).catch(u=>{this.warn(`${u.name}: ${u.message}`),this.state=ae.IDLE})}}doTick(){if(!this.media){this.state=ae.IDLE;return}if(this.state===ae.IDLE){const{currentTrackId:e,levels:t}=this,n=t?.[e];if(!n||!t.length||!n.details||this.waitForLive(n))return;const{config:r}=this,o=this.getLoadPosition(),l=Oe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],o,r.maxBufferHole),{end:u,len:f}=l,d=n.details,m=this.hls.maxBufferLength+d.levelTargetDuration;if(f>m)return;const g=d.fragments,p=g.length,E=d.edge;let S=null;const b=this.fragPrevious;if(u<E){const _=r.maxFragLookUpTolerance,w=u>E-_?0:_;S=Nr(b,g,Math.max(g[0].start,u),w),!S&&b&&b.start<g[0].start&&(S=g[0])}else S=g[p-1];if(S=this.filterReplacedPrimary(S,n.details),!S)return;const T=S.sn-d.startSN,A=g[T-1];if(A&&A.cc===S.cc&&this.fragmentTracker.getState(A)===Xt.NOT_LOADED&&(S=A),this.fragmentTracker.getState(S)===Xt.NOT_LOADED){const _=this.mapToInitFragWhenRequired(S);_&&this.loadFragment(_,n,u)}}}loadFragment(e,t,n){Pt(e)?super.loadFragment(e,t,n):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new OF(this.tracksBuffered[this.currentTrackId]||[])}}class OF{constructor(e){this.buffered=void 0;const t=(n,r,o)=>{if(r=r>>>0,r>o-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${o})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}}const MF={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},c1=i=>String.fromCharCode(MF[i]||i),ps=15,ci=100,kF={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},PF={17:2,18:4,21:6,22:8,23:10,19:13,20:15},UF={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},FF={25:2,26:4,29:6,30:8,31:10,27:13,28:15},BF=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class jF{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const n=typeof t=="function"?t():t;lt.log(`${this.time} [${e}] ${n}`)}}}const Ar=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t};class u1{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){const r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class $F{constructor(){this.uchar=" ",this.penState=new u1}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class GF{constructor(e){this.chars=[],this.pos=0,this.currPenState=new u1,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<ci;t++)this.chars.push(new $F);this.logger=e}equals(e){for(let t=0;t<ci;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<ci;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<ci;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>ci&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=ci)}moveCursor(e){const t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=c1(e);if(this.pos>=ci){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<ci;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let n=0;n<ci;n++){const r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class em{constructor(e){this.rows=[],this.currRow=ps-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<ps;t++)this.rows.push(new GF(e));this.logger=e}reset(){for(let e=0;e<ps;e++)this.rows[e].clear();this.currRow=ps-1}equals(e){let t=!0;for(let n=0;n<ps;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<ps;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<ps;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+pt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let u=0;u<ps;u++)this.rows[u].clear();const o=this.currRow+1-this.nrRollUpRows,l=this.lastOutputScreen;if(l){const u=l.rows[o].cueStartTime,f=this.logger.time;if(u!==null&&f!==null&&u<f)for(let d=0;d<this.nrRollUpRows;d++)this.rows[t-this.nrRollUpRows+d+1].copy(l.rows[o+d])}}this.currRow=t;const n=this.rows[this.currRow];if(e.indent!==null){const o=e.indent,l=Math.max(o-1,0);n.setCursor(e.indent),e.color=n.chars[l].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+pt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let n="",r=-1;for(let o=0;o<ps;o++){const l=this.rows[o].getTextString();l&&(r=o+1,e?t.push("Row "+r+": '"+l+"'"):t.push(l.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}}class $E{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new em(n),this.nonDisplayedMemory=new em(n),this.lastOutputScreen=new em(n),this.currRollUpRow=this.displayedMemory.rows[ps-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[ps-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+pt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class GE{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=HF(),this.logger=void 0;const r=this.logger=new jF;this.channels=[null,new $E(e,t,r),new $E(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){const r=t[n]&127,o=t[n+1]&127;let l=!1,u=null;if(r===0&&o===0)continue;this.logger.log(3,()=>"["+Ar([t[n],t[n+1]])+"] -> ("+Ar([r,o])+")");const f=this.cmdHistory;if(r>=16&&r<=31){if(zF(r,o,f)){Zc(null,null,f),this.logger.log(3,()=>"Repeated command ("+Ar([r,o])+") is dropped");continue}Zc(r,o,this.cmdHistory),l=this.parseCmd(r,o),l||(l=this.parseMidrow(r,o)),l||(l=this.parsePAC(r,o)),l||(l=this.parseBackgroundAttributes(r,o))}else Zc(null,null,f);if(!l&&(u=this.parseChars(r,o),u)){const m=this.currentChannel;m&&m>0?this.channels[m].insertChars(u):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!l&&!u&&this.logger.log(2,()=>"Couldn't parse cleaned data "+Ar([r,o])+" orig: "+Ar([t[n],t[n+1]]))}}parseCmd(e,t){const n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;const o=e===20||e===21||e===23?1:2,l=this.channels[o];return e===20||e===21||e===28||e===29?t===32?l.ccRCL():t===33?l.ccBS():t===34?l.ccAOF():t===35?l.ccAON():t===36?l.ccDER():t===37?l.ccRU(2):t===38?l.ccRU(3):t===39?l.ccRU(4):t===40?l.ccFON():t===41?l.ccRDC():t===42?l.ccTR():t===43?l.ccRTD():t===44?l.ccEDM():t===45?l.ccCR():t===46?l.ccENM():t===47&&l.ccEOC():l.ccTO(t-32),this.currentChannel=o,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Ar([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,o=(e===16||e===24)&&t>=64&&t<=95;if(!(r||o))return!1;const l=e<=23?1:2;t>=64&&t<=95?n=l===1?kF[e]:UF[e]:n=l===1?PF[e]:FF[e];const u=this.channels[l];return u?(u.setPAC(this.interpretPAC(n,t)),this.currentChannel=l,!0):!1}interpretPAC(e,t){let n;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,o=null;if(e>=25?(n=2,o=e-8):(n=1,o=e),o>=17&&o<=19){let l;o===17?l=t+80:o===18?l=t+112:l=t+144,this.logger.log(2,()=>"Special char '"+c1(l)+"' in channel "+n),r=[l]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+Ar(r).join(",")),r}parseBackgroundAttributes(e,t){const n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let o;const l={};e===16||e===24?(o=Math.floor((t-32)/2),l.background=BF[o],t%2===1&&(l.background=l.background+"_semi")):t===45?l.background="transparent":(l.foreground="black",t===47&&(l.underline=!0));const u=e<=23?1:2;return this.channels[u].setBkgData(l),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}Zc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const n=this.channels[t];n&&n.cueSplitAtTime(e)}}}function Zc(i,e,t){t.a=i,t.b=e}function zF(i,e,t){return t.a===i&&t.b===e}function HF(){return{a:null,b:null}}var Vg=(function(){if(Fu!=null&&Fu.VTTCue)return self.VTTCue;const i=["","lr","rl"],e=["start","middle","end","left","right"];function t(u,f){if(typeof f!="string"||!Array.isArray(u))return!1;const d=f.toLowerCase();return~u.indexOf(d)?d:!1}function n(u){return t(i,u)}function r(u){return t(e,u)}function o(u,...f){let d=1;for(;d<arguments.length;d++){const m=arguments[d];for(const g in m)u[g]=m[g]}return u}function l(u,f,d){const m=this,g={enumerable:!0};m.hasBeenReset=!1;let p="",E=!1,S=u,b=f,T=d,A=null,_="",w=!0,D="auto",O="start",B=50,N="middle",U=50,k="middle";Object.defineProperty(m,"id",o({},g,{get:function(){return p},set:function(F){p=""+F}})),Object.defineProperty(m,"pauseOnExit",o({},g,{get:function(){return E},set:function(F){E=!!F}})),Object.defineProperty(m,"startTime",o({},g,{get:function(){return S},set:function(F){if(typeof F!="number")throw new TypeError("Start time must be set to a number.");S=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"endTime",o({},g,{get:function(){return b},set:function(F){if(typeof F!="number")throw new TypeError("End time must be set to a number.");b=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"text",o({},g,{get:function(){return T},set:function(F){T=""+F,this.hasBeenReset=!0}})),Object.defineProperty(m,"region",o({},g,{get:function(){return A},set:function(F){A=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"vertical",o({},g,{get:function(){return _},set:function(F){const H=n(F);if(H===!1)throw new SyntaxError("An invalid or illegal string was specified.");_=H,this.hasBeenReset=!0}})),Object.defineProperty(m,"snapToLines",o({},g,{get:function(){return w},set:function(F){w=!!F,this.hasBeenReset=!0}})),Object.defineProperty(m,"line",o({},g,{get:function(){return D},set:function(F){if(typeof F!="number"&&F!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");D=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"lineAlign",o({},g,{get:function(){return O},set:function(F){const H=r(F);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");O=H,this.hasBeenReset=!0}})),Object.defineProperty(m,"position",o({},g,{get:function(){return B},set:function(F){if(F<0||F>100)throw new Error("Position must be between 0 and 100.");B=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"positionAlign",o({},g,{get:function(){return N},set:function(F){const H=r(F);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");N=H,this.hasBeenReset=!0}})),Object.defineProperty(m,"size",o({},g,{get:function(){return U},set:function(F){if(F<0||F>100)throw new Error("Size must be between 0 and 100.");U=F,this.hasBeenReset=!0}})),Object.defineProperty(m,"align",o({},g,{get:function(){return k},set:function(F){const H=r(F);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");k=H,this.hasBeenReset=!0}})),m.displayState=void 0}return l.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},l})();class VF{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function d1(i){function e(n,r,o,l){return(n|0)*3600+(r|0)*60+(o|0)+parseFloat(l||0)}const t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class KF{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}}function f1(i,e,t,n){const r=n?i.split(n):[i];for(const o in r){if(typeof r[o]!="string")continue;const l=r[o].split(t);if(l.length!==2)continue;const u=l[0],f=l[1];e(u,f)}}const Pm=new Vg(0,0,""),Jc=Pm.align==="middle"?"middle":"center";function YF(i,e,t){const n=i;function r(){const u=d1(i);if(u===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),u}function o(u,f){const d=new KF;f1(u,function(p,E){let S;switch(p){case"region":for(let b=t.length-1;b>=0;b--)if(t[b].id===E){d.set(p,t[b].region);break}break;case"vertical":d.alt(p,E,["rl","lr"]);break;case"line":S=E.split(","),d.integer(p,S[0]),d.percent(p,S[0])&&d.set("snapToLines",!1),d.alt(p,S[0],["auto"]),S.length===2&&d.alt("lineAlign",S[1],["start",Jc,"end"]);break;case"position":S=E.split(","),d.percent(p,S[0]),S.length===2&&d.alt("positionAlign",S[1],["start",Jc,"end","line-left","line-right","auto"]);break;case"size":d.percent(p,E);break;case"align":d.alt(p,E,["start",Jc,"end","left","right"]);break}},/:/,/\s/),f.region=d.get("region",null),f.vertical=d.get("vertical","");let m=d.get("line","auto");m==="auto"&&Pm.line===-1&&(m=-1),f.line=m,f.lineAlign=d.get("lineAlign","start"),f.snapToLines=d.get("snapToLines",!0),f.size=d.get("size",100),f.align=d.get("align",Jc);let g=d.get("position","auto");g==="auto"&&Pm.position===50&&(g=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=g}function l(){i=i.replace(/^\s+/,"")}if(l(),e.startTime=r(),l(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),l(),e.endTime=r(),l(),o(i,e)}function h1(i){return i.replace(/<br(?: \/)?>/gi,`
`)}class qF{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new VF,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let o=t.buffer,l=0;for(o=h1(o);l<o.length&&o[l]!=="\r"&&o[l]!==`
`;)++l;const u=o.slice(0,l);return o[l]==="\r"&&++l,o[l]===`
`&&++l,t.buffer=o.slice(l),u}function r(o){f1(o,function(l,u){},/:/)}try{let o="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;o=n();const u=o.match(/^()?WEBVTT([ \t].*)?$/);if(!(u!=null&&u[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let l=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(l?l=!1:o=n(),t.state){case"HEADER":/:/.test(o)?r(o):o||(t.state="ID");continue;case"NOTE":o||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){t.state="NOTE";break}if(!o)continue;if(t.cue=new Vg(0,0,""),t.state="CUE",o.indexOf("-->")===-1){t.cue.id=o;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{YF(o,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const u=o.indexOf("-->")!==-1;if(!o||u&&(l=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=o}continue;case"BADCUE":o||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const XF=/\r\n|\n\r|\n|\r/g,tm=function(e,t,n=0){return e.slice(n,n+t.length)===t},WF=function(e){let t=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),o=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!ge(t)||!ge(n)||!ge(r)||!ge(o))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=3600*1e3*o,t};function Kg(i,e,t){return el(i.toString())+el(e.toString())+el(t)}const QF=function(e,t,n){let r=e[t],o=e[r.prevCC];if(!o||!o.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(l=o)!=null&&l.new;){var l;e.ccOffset+=r.start-o.start,r.new=!1,r=o,o=e[r.prevCC]}e.presentationOffset=n};function ZF(i,e,t,n,r,o,l){const u=new qF,f=Kn(new Uint8Array(i)).trim().replace(XF,`
`).split(`
`),d=[],m=e?iU(e.baseTime,e.timescale):0;let g="00:00.000",p=0,E=0,S,b=!0;u.oncue=function(T){const A=t[n];let _=t.ccOffset;const w=(p-m)/9e4;if(A!=null&&A.new&&(E!==void 0?_=t.ccOffset=A.start:QF(t,n,w)),w){if(!e){S=new Error("Missing initPTS for VTT MPEGTS");return}_=w-t.presentationOffset}const D=T.endTime-T.startTime,O=Gn((T.startTime+_-E)*9e4,r*9e4)/9e4;T.startTime=Math.max(O,0),T.endTime=Math.max(O+D,0);const B=T.text.trim();T.text=decodeURIComponent(encodeURIComponent(B)),T.id||(T.id=Kg(T.startTime,T.endTime,B)),T.endTime>0&&d.push(T)},u.onparsingerror=function(T){S=T},u.onflush=function(){if(S){l(S);return}o(d)},f.forEach(T=>{if(b)if(tm(T,"X-TIMESTAMP-MAP=")){b=!1,T.slice(16).split(",").forEach(A=>{tm(A,"LOCAL:")?g=A.slice(6):tm(A,"MPEGTS:")&&(p=parseInt(A.slice(7)))});try{E=WF(g)/1e3}catch(A){S=A}return}else T===""&&(b=!1);u.parse(T+`
`)}),u.flush()}const nm="stpp.ttml.im1t",m1=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,g1=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,JF={left:"start",center:"center",right:"end",start:"start",end:"end"};function zE(i,e,t,n){const r=Be(new Uint8Array(i),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const o=r.map(u=>Kn(u)),l=sU(e.baseTime,1,e.timescale);try{o.forEach(u=>t(eB(u,l)))}catch(u){n(u)}}function eB(i,e){const r=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const o={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},l=Object.keys(o).reduce((g,p)=>(g[p]=r.getAttribute(`ttp:${p}`)||o[p],g),{}),u=r.getAttribute("xml:space")!=="preserve",f=HE(sm(r,"styling","style")),d=HE(sm(r,"layout","region")),m=sm(r,"body","[begin]");return[].map.call(m,g=>{const p=p1(g,u);if(!p||!g.hasAttribute("begin"))return null;const E=rm(g.getAttribute("begin"),l),S=rm(g.getAttribute("dur"),l);let b=rm(g.getAttribute("end"),l);if(E===null)throw VE(g);if(b===null){if(S===null)throw VE(g);b=E+S}const T=new Vg(E-e,b-e,p);T.id=Kg(T.startTime,T.endTime,T.text);const A=d[g.getAttribute("region")],_=f[g.getAttribute("style")],w=tB(A,_,f),{textAlign:D}=w;if(D){const O=JF[D];O&&(T.lineAlign=O),T.align=D}return ht(T,w),T}).filter(g=>g!==null)}function sm(i,e,t){const n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function HE(i){return i.reduce((e,t)=>{const n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function p1(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var o;return n.nodeName==="br"&&r?t+`
`:(o=n.childNodes)!=null&&o.length?p1(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function tB(i,e,t){const n="http://www.w3.org/ns/ttml#styling";let r=null;const o=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],l=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return l&&t.hasOwnProperty(l)&&(r=t[l]),o.reduce((u,f)=>{const d=im(e,n,f)||im(i,n,f)||im(r,n,f);return d&&(u[f]=d),u},{})}function im(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function VE(i){return new Error(`Could not parse ttml timestamp ${i}`)}function rm(i,e){if(!i)return null;let t=d1(i);return t===null&&(m1.test(i)?t=nB(i,e):g1.test(i)&&(t=sB(i,e))),t}function nB(i,e){const t=m1.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function sB(i,e){const t=g1.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class eu{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class iB{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=YE(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(L.FRAG_LOADING,this.onFragLoading,this),e.on(L.FRAG_LOADED,this.onFragLoaded,this),e.on(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(L.FRAG_LOADING,this.onFragLoading,this),e.off(L.FRAG_LOADED,this.onFragLoaded,this),e.off(L.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(L.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(L.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(L.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new eu(this,"textTrack1"),t=new eu(this,"textTrack2"),n=new eu(this,"textTrack3"),r=new eu(this,"textTrack4");this.cea608Parser1=new GE(1,e,t),this.cea608Parser2=new GE(3,n,r)}addCues(e,t,n,r,o){let l=!1;for(let u=o.length;u--;){const f=o[u],d=rB(f[0],f[1],t,n);if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],n),l=!0,d/(n-t)>.5))return}if(l||o.push([t,n]),this.config.renderTextTracksNatively){const u=this.captionsTracks[e];this.Cues.newCue(u,t,n,r)}else{const u=this.Cues.newCue(null,t,n,r);this.hls.trigger(L.CUES_PARSED,{type:"captions",cues:u,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:o,trackId:l}){const{unparsedVttFrags:u}=this;n===pe.MAIN&&(this.initPTS[t.cc]={baseTime:r,timescale:o,trackId:l}),u.length&&(this.unparsedVttFrags=[],u.forEach(f=>{this.initPTS[f.frag.cc]?this.onFragLoaded(L.FRAG_LOADED,f):this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){const{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){const o=n.textTracks[r];if(KE(o,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return o}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:n,media:r}=this,{label:o,languageCode:l}=t[e],u=this.getExistingTrack(o,l);if(u)n[e]=u,ka(n[e]),a1(n[e],r);else{const f=this.createTextTrack("captions",o,l);f&&(f[e]=!0,n[e]=f)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){const r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const n=!!t.transferMedia;if(this.media=null,n)return;const{captionsTracks:r}=this;Object.keys(r).forEach(o=>{ka(r[o]),delete r[o]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=YE(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let n=0;n<t.length;n++)ka(t[n])}onSubtitleTracksUpdated(e,t){const n=t.subtitleTracks||[],r=n.some(o=>o.textCodec===nm);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(YA(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const l=this.media,u=l?hu(l.textTracks):null;if(this.tracks.forEach((f,d)=>{let m;if(u){let g=null;for(let p=0;p<u.length;p++)if(u[p]&&KE(u[p],f)){g=u[p],u[p]=null;break}g&&(m=g)}if(m)ka(m);else{const g=v1(f);m=this.createTextTrack(g,f.name,f.lang),m&&(m.mode="disabled")}m&&this.textTracks.push(m)}),u!=null&&u.length){const f=u.filter(d=>d!==null).map(d=>d.label);f.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${f.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const l=this.tracks.map(u=>({label:u.name,kind:u.type.toLowerCase(),default:u.default,subtitleTrack:u}));this.hls.trigger(L.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{const r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;const o=`textTrack${r[1]}`,l=this.captionsProperties[o];l&&(l.label=n.name,n.lang&&(l.languageCode=n.lang),l.media=n)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===pe.MAIN){var n,r;const{cea608Parser1:o,cea608Parser2:l,lastSn:u}=this,{cc:f,sn:d}=t.frag,m=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;o&&l&&(d!==u+1||d===u&&m!==this.lastPartIndex+1||f!==this.lastCc)&&(o.reset(),l.reset()),this.lastCc=f,this.lastSn=d,this.lastPartIndex=m}}onFragLoaded(e,t){const{frag:n,payload:r}=t;if(n.type===pe.SUBTITLE)if(r.byteLength){const o=n.decryptdata,l="stats"in t;if(o==null||!o.encrypted||l){const u=this.tracks[n.level],f=this.vttCCs;f[n.cc]||(f[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),u&&u.textCodec===nm?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const n=this.hls;zE(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{n.logger.log(`Failed to parse IMSC1: ${r}`),n.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:n,payload:r}=e,{initPTS:o,unparsedVttFrags:l}=this,u=o.length-1;if(!o[n.cc]&&u===-1){l.push(e);return}const f=this.hls,d=(t=n.initSegment)!=null&&t.data?as(n.initSegment.data,new Uint8Array(r)).buffer:r;ZF(d,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,m=>{this._appendCues(m,n.level),f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},m=>{const g=m.message==="Missing initPTS for VTT MPEGTS";g?l.push(e):this._fallbackToIMSC1(n,r),f.logger.log(`Failed to parse VTT cue: ${m}`),!(g&&u>n.cc)&&f.trigger(L.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:m})})}_fallbackToIMSC1(e,t){const n=this.tracks[e.level];n.textCodec||zE(t,this.initPTS[e.cc],()=>{n.textCodec=nm,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){const n=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(o=>o1(r,o))}else{const r=this.tracks[t];if(!r)return;const o=r.default?"default":"subtitles"+t;n.trigger(L.CUES_PARSED,{type:"subtitles",cues:e,track:o})}}onFragDecrypted(e,t){const{frag:n}=t;n.type===pe.SUBTITLE&&this.onFragLoaded(L.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:r}=t;if(!(n.type===pe.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let o=0;o<r.length;o++){const l=r[o].bytes;if(l){this.cea608Parser1||this.initCea608Parsers();const u=this.extractCea608Data(l);this.cea608Parser1.addData(r[o].pts,u[0]),this.cea608Parser2.addData(r[o].pts,u[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:o}){const{media:l}=this;if(!(!l||l.currentTime<n)){if(!o||o==="video"){const{captionsTracks:u}=this;Object.keys(u).forEach(f=>km(u[f],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:u}=this;Object.keys(u).forEach(f=>km(u[f],t,r))}}}extractCea608Data(e){const t=[[],[]],n=e[0]&31;let r=2;for(let o=0;o<n;o++){const l=e[r++],u=127&e[r++],f=127&e[r++];if(u===0&&f===0)continue;if((4&l)!==0){const m=3&l;(m===0||m===1)&&(t[m].push(u),t[m].push(f))}}return t}}function v1(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function KE(i,e){return!!i&&i.kind===v1(e)&&Im(e,i)}function rB(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function YE(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const aB=/\s/,oB={newCue(i,e,t,n){const r=[];let o,l,u,f,d;const m=self.VTTCue||self.TextTrackCue;for(let p=0;p<n.rows.length;p++)if(o=n.rows[p],u=!0,f=0,d="",!o.isEmpty()){var g;for(let b=0;b<o.chars.length;b++)aB.test(o.chars[b].uchar)&&u?f++:(d+=o.chars[b].uchar,u=!1);o.cueStartTime=e,e===t&&(t+=1e-4),f>=16?f--:f++;const E=h1(d.trim()),S=Kg(e,t,E);i!=null&&(g=i.cues)!=null&&g.getCueById(S)||(l=new m(e,t,E),l.id=S,l.line=p+1,l.align="left",l.position=10+Math.min(80,Math.floor(f*8/32)*10),r.push(l))}return i&&r.length&&(r.sort((p,E)=>p.line==="auto"||E.line==="auto"?0:p.line>8&&E.line>8?E.line-p.line:p.line-E.line),r.forEach(p=>o1(i,p))),r}};function lB(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const cB=/(\d+)-(\d+)\/(\d+)/;class qE{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||hB,this.controller=new self.AbortController,this.stats=new Ag}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const o=uB(e,this.controller.signal),l=e.responseType==="arraybuffer",u=l?"byteLength":"length",{maxTimeToFirstByteMs:f,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,o),self.clearTimeout(this.requestTimeout),t.timeout=f&&ge(f)?f:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout),(ul(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(g=>{var p;this.response=this.loader=g;const E=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},d-(E-r.loading.start)),!g.ok){const{status:b,statusText:T}=g;throw new mB(T||"fetch, bad network response",b,g)}r.loading.first=E,r.total=fB(g.headers)||r.total;const S=(p=this.callbacks)==null?void 0:p.onProgress;return S&&ge(t.highWaterMark)?this.loadProgressively(g,r,e,t.highWaterMark,S):l?g.arrayBuffer():e.responseType==="json"?g.json():g.text()}).then(g=>{var p,E;const S=this.response;if(!S)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const b=g[u];b&&(r.loaded=r.total=b);const T={url:S.url,data:g,code:S.status},A=(p=this.callbacks)==null?void 0:p.onProgress;A&&!ge(t.highWaterMark)&&A(r,e,g,S),(E=this.callbacks)==null||E.onSuccess(T,r,e,S)}).catch(g=>{var p;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const E=g&&g.code||0,S=g?g.message:null;(p=this.callbacks)==null||p.onError({code:E,text:S},e,g?g.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,o){const l=new LA,u=e.body.getReader(),f=()=>u.read().then(d=>{if(d.done)return l.dataLength&&o(t,n,l.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const m=d.value,g=m.length;return t.loaded+=g,g<r||l.dataLength?(l.push(m),l.dataLength>=r&&o(t,n,l.flush().buffer,e)):o(t,n,m.buffer,e),f()}).catch(()=>Promise.reject());return f()}}function uB(i,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(ht({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function dB(i){const e=cB.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function fB(i){const e=i.get("Content-Range");if(e){const n=dB(e);if(ge(n))return n}const t=i.get("Content-Length");if(t)return parseInt(t)}function hB(i,e){return new self.Request(i.url,e)}class mB extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}}const gB=/^age:\s*[\d.]+\s*$/im;class y1{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ag,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const o=this.xhrSetup;o?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return o(n,t.url)}).catch(l=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),o(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(l=>{var u;(u=this.callbacks)==null||u.onError({code:n.status,text:l.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:o,maxLoadTimeMs:l}=n.loadPolicy;if(r)for(const u in r)e.setRequestHeader(u,r[u]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=o&&ge(o)?o:l,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:n}=this;if(!e||!t)return;const r=t.readyState,o=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),o.timeout!==o.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),o.timeout=o.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),o.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const d=t.status,m=t.responseType==="text"?t.responseText:null;if(d>=200&&d<300){const S=m??t.response;if(S!=null){var l,u;n.loading.end=Math.max(self.performance.now(),n.loading.first);const b=t.responseType==="arraybuffer"?S.byteLength:S.length;n.loaded=n.total=b,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const T=(l=this.callbacks)==null?void 0:l.onProgress;T&&T(n,e,S,t);const A={url:t.responseURL,data:S,code:d};(u=this.callbacks)==null||u.onSuccess(A,n,e,t);return}}const g=o.loadPolicy.errorRetry,p=n.retry,E={url:e.url,data:void 0,code:d};if(Pu(g,p,!1,E))this.retry(g);else{var f;lt.error(`${d} while loading ${e.url}`),(f=this.callbacks)==null||f.onError({code:d,text:t.statusText},e,t,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Pu(e,t,!0))this.retry(e);else{var n;lt.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:n}=this;this.retryDelay=_g(e,n.retry),n.retry++,lt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&gB.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const pB={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},vB=ot(ot({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:y1,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:wP,bufferController:xU,capLevelController:Gg,errorController:MP,fpsController:EF,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:pA,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:pB},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},yB()),{},{subtitleStreamController:NF,subtitleTrackController:TF,timelineController:iB,audioStreamController:gU,audioTrackController:pU,emeController:$a,cmcdController:pF,contentSteeringController:yF,interstitialsController:IF});function yB(){return{cueHandler:oB,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function xB(i,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Um(i),r=["manifest","level","frag"],o=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(l=>{const u=`${l==="level"?"playlist":l}LoadPolicy`,f=e[u]===void 0,d=[];o.forEach(m=>{const g=`${l}Loading${m}`,p=e[g];if(p!==void 0&&f){d.push(g);const E=n[u].default;switch(e[u]={default:E},m){case"TimeOut":E.maxLoadTimeMs=p,E.maxTimeToFirstByteMs=p;break;case"MaxRetry":E.errorRetry.maxNumRetry=p,E.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":E.errorRetry.retryDelayMs=p,E.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":E.errorRetry.maxRetryDelayMs=p,E.timeoutRetry.maxRetryDelayMs=p;break}}}),d.length&&t.warn(`hls.js config: "${d.join('", "')}" setting(s) are deprecated, use "${u}": ${pt(e[u])}`)}),ot(ot({},n),e)}function Um(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(Um):Object.keys(i).reduce((e,t)=>(e[t]=Um(i[t]),e),{}):i}function EB(i,e){const t=i.loader;t!==qE&&t!==y1?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):lB()&&(i.loader=qE,i.progressive=!0,i.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const mu=2,SB=.1,bB=.05,TB=100;class AB extends dA{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(TB),this.mediaSource=t.mediaSource;const n=this.media=t.media;pn(n,"playing",this.onMediaPlaying),pn(n,"waiting",this.onMediaWaiting),pn(n,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:n}=this;n&&(Rn(n,"playing",this.onMediaPlaying),Rn(n,"waiting",this.onMediaWaiting),Rn(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var n,r;const o=(n=this.hls)==null?void 0:n.config;if(!o)return;const l=this.media;if(!l)return;const{seeking:u}=l,f=this.seeking&&!u,d=!this.seeking&&u,m=l.paused&&!u||l.ended||l.playbackRate===0;if(this.seeking=u,e!==t){t&&(this.ended=0),this.moved=!0,u||(this.nudgeRetry=0,o.nudgeOnVideoHole&&!m&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(d||f){f&&this.stallResolved(e);return}if(m){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&l.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!1}));return}if(!Oe.getBuffered(l).length){this.nudgeRetry=0;return}const g=Oe.bufferInfo(l,e,0),p=g.nextStart||0,E=this.fragmentTracker;if(u&&E&&this.hls){const B=XE(this.hls.inFlightFragments,e),N=g.len>mu,U=!p||B||p-e>mu&&!E.getPartialFragment(e);if(N||U)return;this.moved=!1}const S=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&E){if(!(g.len>0)&&!p)return;const N=Math.max(p,g.start||0)-e,k=!!(S!=null&&S.live)?S.targetduration*2:mu,F=tu(e,E);if(N>0&&(N<=k||F)){l.paused||this._trySkipBufferHole(F);return}}const b=o.detectStallWithCurrentTimeMs,T=self.performance.now(),A=this.waiting;let _=this.stalled;if(_===null)if(A>0&&T-A<b)_=this.stalled=A;else{this.stalled=T;return}const w=T-_;if(!u&&(w>=b||A)&&this.hls){var D;if(((D=this.mediaSource)==null?void 0:D.readyState)==="ended"&&!(S!=null&&S.live)&&Math.abs(e-(S?.edge||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(L.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(g),!this.media||!this.hls)return}const O=Oe.bufferInfo(l,e,o.maxBufferHole);this._tryFixBufferStall(O,w,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(L.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var n;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&r&&r.length>1&&e>r.end(0)){const o=Oe.bufferedInfo(Oe.timeRangesToArray(this.buffered.audio),e,0);if(o.len>1&&t>=o.start){const l=Oe.timeRangesToArray(r),u=Oe.bufferedInfo(l,t,0).bufferedIndex;if(u>-1&&u<l.length-1){const f=Oe.bufferedInfo(l,e,0).bufferedIndex,d=l[u].end,m=l[u+1].start;if((f===-1||f>u)&&m-d<1&&e-d<2){const g=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${d} -> ${m} buffered index: ${f}`);this.warn(g.message),this.media.currentTime+=1e-6;let p=tu(e,this.fragmentTracker);p&&"fragment"in p?p=p.fragment:p||(p=void 0);const E=Oe.bufferInfo(this.media,e,0);this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:g,reason:g.message,frag:p,buffer:E.len,bufferInfo:E})}}}}}_tryFixBufferStall(e,t,n){var r,o;const{fragmentTracker:l,media:u}=this,f=(r=this.hls)==null?void 0:r.config;if(!u||!l||!f)return;const d=(o=this.hls)==null?void 0:o.latestLevelDetails,m=tu(n,l);if((m||d!=null&&d.live&&n<d.fragmentStart)&&(this._trySkipBufferHole(m)||!this.media))return;const g=e.buffered,p=this.adjacentTraversal(e,n);(g&&g.length>1&&e.len>f.maxBufferHole||e.nextStart&&(e.nextStart-n<f.maxBufferHole||p))&&(t>f.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const n=this.fragmentTracker,r=e.nextStart;if(n&&r){const o=n.getFragAtPos(t,pe.MAIN),l=n.getFragAtPos(r,pe.MAIN);if(o&&l)return l.sn-o.sn<2}return!1}_reportStall(e){const{hls:t,media:n,stallReported:r,stalled:o}=this;if(!r&&o!==null&&n&&t){this.stallReported=!0;const l=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${pt(e)})`);this.warn(l.message),t.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_STALLED_ERROR,fatal:!1,error:l,buffer:e.len,bufferInfo:e,stalled:{start:o}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:n,media:r}=this,o=(t=this.hls)==null?void 0:t.config;if(!r||!n||!o)return 0;const l=r.currentTime,u=Oe.bufferInfo(r,l,0),f=l<u.start?u.start:u.nextStart;if(f&&this.hls){const m=u.len<=o.maxBufferHole,g=u.len>0&&u.len<1&&r.readyState<3,p=f-l;if(p>0&&(m||g)){if(p>o.maxBufferHole){let S=!1;if(l===0){const b=n.getAppendedFrag(0,pe.MAIN);b&&f<b.end&&(S=!0)}if(!S&&e){var d;if(!((d=this.hls.loadLevelObj)!=null&&d.details)||XE(this.hls.inFlightFragments,f))return 0;let T=!1,A=e.end;for(;A<f;){const _=tu(A,n);if(_)A+=_.duration;else{T=!0;break}}if(T)return 0}}const E=Math.max(f+bB,l+SB);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${E}`),this.moved=!0,r.currentTime=E,!(e!=null&&e.gap)){const S=new Error(`fragment loaded with buffer holes, seeking from ${l} to ${E}`),b={type:Te.MEDIA_ERROR,details:X.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:S,reason:S.message,buffer:u.len,bufferInfo:u};e&&("fragment"in e?b.part=e:b.frag=e),this.hls.trigger(L.ERROR,b)}return E}}return 0}_tryNudgeBuffer(e){const{hls:t,media:n,nudgeRetry:r}=this,o=t?.config;if(!n||!o)return 0;const l=n.currentTime;if(this.nudgeRetry++,r<o.nudgeMaxRetry){const u=l+(r+1)*o.nudgeOffset,f=new Error(`Nudging 'currentTime' from ${l} to ${u}`);this.warn(f.message),n.currentTime=u,t.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_NUDGE_ON_STALL,error:f,fatal:!1,buffer:e.len,bufferInfo:e})}else{const u=new Error(`Playhead still not moving while enough data buffered @${l} after ${o.nudgeMaxRetry} nudges`);this.error(u.message),t.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.BUFFER_STALLED_ERROR,error:u,fatal:!0,buffer:e.len,bufferInfo:e})}}}function XE(i,e){const t=WE(i.main);if(t&&t.start<=e)return t;const n=WE(i.audio);return n&&n.start<=e?n:null}function WE(i){if(!i)return null;switch(i.state){case ae.IDLE:case ae.STOPPED:case ae.ENDED:case ae.ERROR:return null}return i.frag}function tu(i,e){return e.getAppendedFrag(i,pe.MAIN)||e.getPartialFragment(i)}const RB=.25;function Fm(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function am(i,e,t,n,r){let o=new i(e,t,"");try{o.value=n,r&&(o.type=r)}catch{o=new i(e,t,pt(r?ot({type:r},n):n))}return o}const nu=(()=>{const i=Fm();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class CB{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(L.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(L.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var n;this.media=t.media,((n=t.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&ka(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const n=e[t];if(n.kind==="metadata"&&n.label==="id3")return a1(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:r}=this.hls.config;if(!n&&!r)return;const{samples:o}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=Fm();if(l)for(let u=0;u<o.length;u++){const f=o[u].type;if(f===Hn.emsg&&!n||!r)continue;const d=MA(o[u].data),m=o[u].pts;let g=m+o[u].duration;g>nu&&(g=nu),g-m<=0&&(g=m+RB);for(let E=0;E<d.length;E++){const S=d[E];if(!kA(S)){this.updateId3CueEnds(m,f);const b=am(l,m,g,S,f);b&&this.id3Track.addCue(b)}}}}updateId3CueEnds(e,t){var n;const r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let o=r.length;o--;){const l=r[o];l.type===t&&l.startTime<e&&l.endTime===nu&&(l.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){const{id3Track:o,hls:l}=this;if(!l)return;const{config:{enableEmsgMetadataCues:u,enableID3MetadataCues:f}}=l;if(o&&(u||f)){let d;r==="audio"?d=m=>m.type===Hn.audioId3&&f:r==="video"?d=m=>m.type===Hn.emsg&&u:d=m=>m.type===Hn.audioId3&&f||m.type===Hn.emsg&&u,km(o,t,n,d)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:r,enableDateRangeMetadataCues:o,interstitialsController:l}=this.hls.config;if(!o)return;const u=Fm();if(n&&r&&!l){const{fragmentStart:b,fragmentEnd:T}=e;let A=this.assetCue;A?(A.startTime=b,A.endTime=T):u&&(A=this.assetCue=am(u,b,T,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),A&&(A.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(A),A.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:f}=this,{dateRanges:d}=e,m=Object.keys(d);let g=this.dateRangeCuesAppended;if(f&&t){var p;if((p=f.cues)!=null&&p.length){const b=Object.keys(g).filter(T=>!m.includes(T));for(let T=b.length;T--;){var E;const A=b[T],_=(E=g[A])==null?void 0:E.cues;delete g[A],_&&Object.keys(_).forEach(w=>{const D=_[w];if(D){D.removeEventListener("enter",this.onEventCueEnter);try{f.removeCue(D)}catch{}}})}}else g=this.dateRangeCuesAppended={}}const S=e.fragments[e.fragments.length-1];if(!(m.length===0||!ge(S?.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let b=0;b<m.length;b++){const T=m[b],A=d[T],_=A.startTime,w=g[T],D=w?.cues||{};let O=w?.durationKnown||!1,B=nu;const{duration:N,endDate:U}=A;if(U&&N!==null)B=_+N,O=!0;else if(A.endOnNext&&!O){const F=m.reduce((H,ne)=>{if(ne!==A.id){const J=d[ne];if(J.class===A.class&&J.startDate>A.startDate&&(!H||A.startDate<H.startDate))return J}return H},null);F&&(B=F.startTime,O=!0)}const k=Object.keys(A.attr);for(let F=0;F<k.length;F++){const H=k[F];if(!YP(H))continue;const ne=D[H];if(ne)O&&!(w!=null&&w.durationKnown)?ne.endTime=B:Math.abs(ne.startTime-_)>.01&&(ne.startTime=_,ne.endTime=B);else if(u){let J=A.attr[H];qP(H)&&(J=VT(J));const de=am(u,_,B,{key:H,data:J},Hn.dateRange);de&&(de.id=T,this.id3Track.addCue(de),D[H]=de,l&&(H==="X-ASSET-LIST"||H==="X-ASSET-URL")&&de.addEventListener("enter",this.onEventCueEnter))}}g[T]={cues:D,dateRange:A,durationKnown:O}}}}}class LB{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,n=this.levelDetails;if(!t||!n)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:o,maxLiveSyncPlaybackRate:l}=this.config;if(!o||l===1||!n.live)return;const u=this.targetLatency;if(u===null)return;const f=r-u,d=Math.min(this.maxLatency,u+n.targetduration);if(f<d&&f>.05&&this.forwardBufferLength>1){const g=Math.min(2,Math.max(1,l)),p=Math.round(2/(1+Math.exp(-.75*f-this.edgeStalled))*20)/20,E=Math.min(g,Math.max(1,p));this.changeMediaPlaybackRate(t,E)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:o,liveSyncDurationCount:l,lowLatencyMode:u}=this.config,f=this.hls.userConfig;let d=u&&n||t;(this._targetLatencyUpdated||f.liveSyncDuration||f.liveSyncDurationCount||d===0)&&(d=o!==void 0?o:l*r);const m=r;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,m)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const n=this.levelDetails;if(n===null)return null;const r=n.edge,o=e-t-this.edgeStalled,l=r-n.totalduration,u=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(l,o),u)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(L.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(L.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(L.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(L.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var n;t.details===X.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var n,r;e.playbackRate!==t&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class _B extends $g{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this),e.on(L.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this),e.off(L.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const n=this.hls.config.preferManagedMediaSource,r=[],o={},l={};let u=!1,f=!1,d=!1;t.levels.forEach(m=>{const g=m.attrs;let{audioCodec:p,videoCodec:E}=m;p&&(m.audioCodec=p=Nu(p,n)||void 0),E&&(E=m.videoCodec=uP(E));const{width:S,height:b,unknownCodecs:T}=m,A=T?.length||0;if(u||(u=!!(S&&b)),f||(f=!!E),d||(d=!!p),A||p&&!this.isAudioSupported(p)||E&&!this.isVideoSupported(E)){this.log(`Some or all CODECS not supported "${g.CODECS}"`);return}const{CODECS:_,"FRAME-RATE":w,"HDCP-LEVEL":D,"PATHWAY-ID":O,RESOLUTION:B,"VIDEO-RANGE":N}=g,k=`${`${O||"."}-`}${m.bitrate}-${B}-${w}-${_}-${N}-${D}`;if(o[k])if(o[k].uri!==m.url&&!m.attrs["PATHWAY-ID"]){const F=l[k]+=1;m.attrs["PATHWAY-ID"]=new Array(F+1).join(".");const H=this.createLevel(m);o[k]=H,r.push(H)}else o[k].addGroupId("audio",g.AUDIO),o[k].addGroupId("text",g.SUBTITLES);else{const F=this.createLevel(m);o[k]=F,l[k]=1,r.push(F)}}),this.filterAndSortMediaOptions(r,t,u,f,d)}createLevel(e){const t=new ol(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(r.message),t.supportedResult=sA(r,[])}return t}isAudioSupported(e){return rl(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return rl(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,n,r,o){var l;let u=[],f=[],d=e;const m=((l=t.stats)==null?void 0:l.parsing)||{};if((n||r)&&o&&(d=d.filter(({videoCodec:_,videoRange:w,width:D,height:O})=>(!!_||!!(D&&O))&&EP(w))),d.length===0){Promise.resolve().then(()=>{if(this.hls){let _="no level with compatible codecs found in manifest",w=_;t.levels.length&&(w=`one or more CODECS in variant not supported: ${pt(t.levels.map(O=>O.attrs.CODECS).filter((O,B,N)=>N.indexOf(O)===B))}`,this.warn(w),_+=` (${w})`);const D=new Error(_);this.hls.trigger(L.ERROR,{type:Te.MEDIA_ERROR,details:X.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:D,reason:w})}}),m.end=performance.now();return}t.audioTracks&&(u=t.audioTracks.filter(_=>!_.audioCodec||this.isAudioSupported(_.audioCodec)),QE(u)),t.subtitles&&(f=t.subtitles,QE(f));const g=d.slice(0);d.sort((_,w)=>{if(_.attrs["HDCP-LEVEL"]!==w.attrs["HDCP-LEVEL"])return(_.attrs["HDCP-LEVEL"]||"")>(w.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&_.height!==w.height)return _.height-w.height;if(_.frameRate!==w.frameRate)return _.frameRate-w.frameRate;if(_.videoRange!==w.videoRange)return Ou.indexOf(_.videoRange)-Ou.indexOf(w.videoRange);if(_.videoCodec!==w.videoCodec){const D=Gx(_.videoCodec),O=Gx(w.videoCodec);if(D!==O)return O-D}if(_.uri===w.uri&&_.codecSet!==w.codecSet){const D=Iu(_.codecSet),O=Iu(w.codecSet);if(D!==O)return O-D}return _.averageBitrate!==w.averageBitrate?_.averageBitrate-w.averageBitrate:0});let p=g[0];if(this.steering&&(d=this.steering.filterParsedLevels(d),d.length!==g.length)){for(let _=0;_<g.length;_++)if(g[_].pathwayId===d[0].pathwayId){p=g[_];break}}this._levels=d;for(let _=0;_<d.length;_++)if(d[_]===p){var E;this._firstLevel=_;const w=p.bitrate,D=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${d.length} level(s) found, first bitrate: ${w}`),((E=this.hls.userConfig)==null?void 0:E.abrEwmaDefaultEstimate)===void 0){const O=Math.min(w,this.hls.config.abrEwmaDefaultEstimateMax);O>D&&D===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=O)}break}const S=o&&!r,b=this.hls.config,T=!!(b.audioStreamController&&b.audioTrackController),A={levels:d,audioTracks:u,subtitleTracks:f,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:o,video:r,altAudio:T&&!S&&u.some(_=>!!_.url)};m.end=performance.now(),this.hls.trigger(L.MANIFEST_PARSED,A)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const m=new Error("invalid level idx"),g=e<0;if(this.hls.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.LEVEL_SWITCH_ERROR,level:e,fatal:g,error:m,reason:m.message}),g)return;e=Math.min(e,t.length-1)}const n=this.currentLevelIndex,r=this.currentLevel,o=r?r.attrs["PATHWAY-ID"]:void 0,l=t[e],u=l.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=l,n===e&&r&&o===u)return;this.log(`Switching to level ${e} (${l.height?l.height+"p ":""}${l.videoRange?l.videoRange+" ":""}${l.codecSet?l.codecSet+" ":""}@${l.bitrate})${u?" with Pathway "+u:""} from level ${n}${o?" with Pathway "+o:""}`);const f={level:e,attrs:l.attrs,details:l.details,bitrate:l.bitrate,averageBitrate:l.averageBitrate,maxBitrate:l.maxBitrate,realBitrate:l.realBitrate,width:l.width,height:l.height,codecSet:l.codecSet,audioCodec:l.audioCodec,videoCodec:l.videoCodec,audioGroups:l.audioGroups,subtitleGroups:l.subtitleGroups,loaded:l.loaded,loadError:l.loadError,fragmentError:l.fragmentError,name:l.name,id:l.id,uri:l.uri,url:l.url,urlId:0,audioGroupIds:l.audioGroupIds,textGroupIds:l.textGroupIds};this.hls.trigger(L.LEVEL_SWITCHING,f);const d=l.details;if(!d||d.live){const m=this.switchParams(l.uri,r?.details,d);this.loadPlaylist(m)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),n=e.filter(r=>t.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=n}}onError(e,t){t.fatal||!t.context||t.context.type===Ge.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===pe.MAIN){const n=t.elementaryStreams;if(!Object.keys(n).some(o=>!!n[o]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;const{level:r,details:o}=t,l=t.levelInfo;if(!l){var u;this.warn(`Invalid level index ${r}`),(u=t.deliveryDirectives)!=null&&u.skip&&(o.deltaUpdateFailed=!0);return}if(l===this.currentLevel||t.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let f=l.details;f===t.details&&f.advanced&&(f=void 0),this.playlistLoaded(r,t,f)}else(n=t.deliveryDirectives)!=null&&n.skip&&(o.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const n=this.getUrlWithDirectives(e.uri,t),r=this.currentLevelIndex,o=e.attrs["PATHWAY-ID"],l=e.details,u=l?.age;this.log(`Loading level index ${r}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${o?" Pathway "+o:""}${u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""} ${n}`),this.hls.trigger(L.LEVEL_LOADING,{url:n,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const n=this._levels.filter((o,l)=>l!==e?!0:(this.steering&&this.steering.removeLevel(o),o===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,o.details&&o.details.fragments.forEach(u=>u.level=-1)),!1));AA(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=n.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(L.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(L.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function QE(i){const e={};i.forEach(t=>{const n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}function x1(){return self.SourceBuffer||self.WebKitSourceBuffer}function E1(){if(!Qi())return!1;const e=x1();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function wB(){if(!E1())return!1;const i=Qi();return typeof i?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(al(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(al(e,"audio"))))}function DB(){var i;const e=x1();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}const IB=100;class NB extends Og{constructor(e,t,n){super(e,t,n,"stream-controller",pe.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,o=r?r.currentTime:null;if(o===null||!ge(o)||(this.log(`Media seeked to ${o.toFixed(3)}`),!this.getBufferedFrag(o)))return;const l=this.getFwdBufferInfoAtPos(r,o,pe.MAIN,0);if(l===null||l.len===0){this.warn(`Main forward buffer length at ${o} on "seeked" event ${l?l.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(L.MANIFEST_PARSED,this.onManifestParsed,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.LEVEL_LOADED,this.onLevelLoaded,this),e.on(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(L.BUFFER_CREATED,this.onBufferCreated,this),e.on(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(L.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(L.MANIFEST_PARSED,this.onManifestParsed,this),e.off(L.LEVEL_LOADED,this.onLevelLoaded,this),e.off(L.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(L.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(L.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(L.BUFFER_CREATED,this.onBufferCreated,this),e.off(L.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(L.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:n,hls:r}=this;if(this.stopLoad(),this.setInterval(IB),this.level=-1,!this.startFragRequested){let o=r.startLevel;o===-1&&(r.config.testBandwidth&&this.levels.length>1?(o=0,this.bitrateTest=!0):o=r.firstAutoLevel),r.nextLoadLevel=o,this.level=r.loadLevel,this._hasEnoughToStart=!!t}n>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=ae.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=ae.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case ae.WAITING_LEVEL:{const{levels:e,level:t}=this,n=e?.[t],r=n?.details;if(r&&(!r.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(r))break;this.state=ae.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=ae.IDLE;break}break}case ae.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===ae.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const o=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[o]))return;const l=n[o],u=this.getMainFwdBufferInfo();if(u===null)return;const f=this.getLevelDetails();if(f&&this._streamEnded(u,f)){const b={};this.altAudio===2&&(b.type="video"),this.hls.trigger(L.BUFFER_EOS,b),this.state=ae.ENDED;return}if(!this.buffering)return;e.loadLevel!==o&&e.manualLevel===-1&&this.log(`Adapting to level ${o} from level ${this.level}`),this.level=e.nextLoadLevel=o;const d=l.details;if(!d||this.state===ae.WAITING_LEVEL||this.waitForLive(l)){this.level=o,this.state=ae.WAITING_LEVEL,this.startFragRequested=!1;return}const m=u.len,g=this.getMaxBufferLength(l.maxBitrate);if(m>=g)return;this.backtrackFragment&&this.backtrackFragment.start>u.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:u.end;let E=this.getNextFragment(p,d);if(this.couldBacktrack&&!this.fragPrevious&&E&&Pt(E)&&this.fragmentTracker.getState(E)!==Xt.OK){var S;const T=((S=this.backtrackFragment)!=null?S:E).sn-d.startSN,A=d.fragments[T-1];A&&E.cc===A.cc&&(E=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&u.len&&(this.backtrackFragment=null);if(E&&this.isLoopLoading(E,p)){if(!E.gap){const T=this.audioOnly&&!this.altAudio?gt.AUDIO:gt.VIDEO,A=(T===gt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,T,pe.MAIN)}E=this.getNextFragmentLoopLoading(E,d,u,pe.MAIN,g)}E&&(E.initSegment&&!E.initSegment.data&&!this.bitrateTest&&(E=E.initSegment),this.loadFragment(E,l,p))}loadFragment(e,t,n){const r=this.fragmentTracker.getState(e);r===Xt.NOT_LOADED||r===Xt.PARTIAL?Pt(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,pe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let n;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const o=this.getLevelDetails();if(o!=null&&o.live){const u=this.getMainFwdBufferInfo();if(!u||u.len<o.targetduration*2)return}if(!t.paused&&e){const u=this.hls.nextLoadLevel,f=e[u],d=this.fragLastKbps;d&&this.fragCurrent?n=this.fragCurrent.duration*f.maxBitrate/(1e3*d)+1:n=0}else n=0;const l=this.getBufferedFrag(t.currentTime+n);if(l){const u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();const f=u.maxStartPTS?u.maxStartPTS:u.start,d=u.duration,m=Math.max(l.end,f+Math.min(Math.max(d-this.config.maxFragLookUpTolerance,d*(this.couldBacktrack?.5:.125)),d*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(m,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case ae.KEY_LOADING:case ae.FRAG_LOADING:case ae.FRAG_LOADING_WAITING_RETRY:case ae.PARSING:case ae.PARSED:this.state=ae.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const n=t.media;pn(n,"playing",this.onMediaPlaying),pn(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:n}=this;n&&(Rn(n,"playing",this.onMediaPlaying),Rn(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(L.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let n=!1,r=!1;for(let o=0;o<t.levels.length;o++){const l=t.levels[o].audioCodec;l&&(n=n||l.indexOf("mp4a.40.2")!==-1,r=r||l.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=n&&r&&!DB(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:n}=this;if(!n||this.state!==ae.IDLE)return;const r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=ae.WAITING_LEVEL)}onLevelLoaded(e,t){var n;const{levels:r,startFragRequested:o}=this,l=t.level,u=t.details,f=u.totalduration;if(!r){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${u.startSN},${u.endSN}]${u.lastPartSn?`[part-${u.lastPartSn}-${u.lastPartIndex}]`:""}, cc [${u.startCC}, ${u.endCC}] duration:${f}`);const d=t.levelInfo,m=this.fragCurrent;m&&(this.state===ae.FRAG_LOADING||this.state===ae.FRAG_LOADING_WAITING_RETRY)&&m.level!==t.level&&m.loader&&this.abortCurrentFrag();let g=0;if(u.live||(n=d.details)!=null&&n.live){var p;if(this.checkLiveUpdate(u),u.deltaUpdateFailed)return;g=this.alignPlaylists(u,d.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(d.details=u,this.levelLastLoaded=d,o||this.setStartPosition(u,g),this.hls.trigger(L.LEVEL_UPDATED,{details:u,level:l}),this.state===ae.WAITING_LEVEL){if(this.waitForCdnTuneIn(u))return;this.state=ae.IDLE}o&&u.live&&this.synchronizeToLiveEdge(u),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:n}=this;if(!n)return;const r=this.hls.liveSyncPosition,o=this.getLoadPosition(),l=e.fragmentStart,u=e.edge,f=o>=l-t.maxFragLookUpTolerance&&o<=u;if(r!==null&&n.duration>r&&(o<r||!f)){const m=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!f&&n.readyState<4||o<u-m)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),n.readyState))if(this.warn(`Playback: ${o.toFixed(3)} is located too far from the end of live sliding playlist: ${u}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var d;const g=Oe.bufferInfo(n,r,0);if(!((d=g.buffered)!=null&&d.length)){n.currentTime=r;return}if(g.start<=o){n.currentTime=r;return}const{nextStart:E}=Oe.bufferedInfo(g.buffered,o,0);E&&(n.currentTime=E)}else n.currentTime=r}}_handleFragmentLoadProgress(e){var t;const n=e.frag,{part:r,payload:o}=e,{levels:l}=this;if(!l){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=l[n.level];if(!u){this.warn(`Level ${n.level} not found on progress`);return}const f=u.details;if(!f){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const d=u.videoCodec,m=f.PTSKnown||!f.live,g=(t=n.initSegment)==null?void 0:t.data,p=this._getAudioCodec(u),E=this.transmuxer=this.transmuxer||new KA(this.hls,pe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),S=r?r.index:-1,b=S!==-1,T=new Dg(n.level,n.sn,n.stats.chunkCount,o.byteLength,S,b),A=this.initPTS[n.cc];E.push(o,g,p,d,n,r,f.totalduration,m,T,A)}onAudioTrackSwitching(e,t){const n=this.hls,r=this.altAudio!==0;if(Mu(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const l=this.fragCurrent;l&&(this.log("Switching to main audio track, cancel main fragment load"),l.abortRequests(),this.fragmentTracker.removeFragment(l)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(L.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(L.AUDIO_TRACK_SWITCHED,t)}),n.trigger(L.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(L.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const n=Mu(t.url,this.hls);if(n){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,t){const n=t.tracks;let r,o,l=!1;for(const u in n){const f=n[u];if(f.id==="main"){if(o=u,r=f,u==="video"){const d=n[u];d&&(this.videoBuffer=d.buffer)}}else l=!0}l&&r?(this.log(`Alternate track found, use ${o}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:n,part:r}=t,o=n.type===pe.MAIN;if(o){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===ae.PARSED&&(this.state=ae.IDLE);return}const u=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*u.total/(u.buffering.end-u.loading.first)),Pt(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}const l=this.media;l&&(!this._hasEnoughToStart&&Oe.getBuffered(l).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),o&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var n;if(t.fatal){this.state=ae.ERROR;return}switch(t.details){case X.FRAG_GAP:case X.FRAG_PARSING_ERROR:case X.FRAG_DECRYPT_ERROR:case X.FRAG_LOAD_ERROR:case X.FRAG_LOAD_TIMEOUT:case X.KEY_LOAD_ERROR:case X.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(pe.MAIN,t);break;case X.LEVEL_LOAD_ERROR:case X.LEVEL_LOAD_TIMEOUT:case X.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===ae.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===Ge.LEVEL&&(this.state=ae.IDLE);break;case X.BUFFER_ADD_CODEC_ERROR:case X.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case X.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case X.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=ae.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==gt.AUDIO||!this.altAudio){const n=(t===gt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,t,pe.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}const r=this.timelineOffset;r&&n&&(n+=r);const o=this.getLevelDetails(),l=Oe.getBuffered(e),u=l.length?l.start(0):0,f=u-n,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||f>0&&(f<d||this.loadingParts&&f<2*(o?.partTarget||0)))&&(this.log(`adjusting start position by ${f} to match buffer start`),n+=f,this.startPosition=n),t<n&&(this.log(`seek to target start position ${n} from current time ${t} buffer start ${u}`),e.currentTime=n)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{const{hls:r}=this,o=n?.frag;if(!o||this.fragContextChanged(o))return;t.fragmentError=0,this.state=ae.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const l=o.stats;l.parsing.start=l.parsing.end=l.buffering.start=l.buffering.end=self.performance.now(),r.trigger(L.FRAG_LOADED,n),o.bitrateTest=!1}).catch(n=>{this.state===ae.STOPPED||this.state===ae.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const t=this.playlistType,{hls:n}=this,{remuxResult:r,chunkMeta:o}=e,l=this.getCurrentContext(o);if(!l){this.resetWhenMissingContext(o);return}const{frag:u,part:f,level:d}=l,{video:m,text:g,id3:p,initSegment:E}=r,{details:S}=d,b=this.altAudio?void 0:r.audio;if(this.fragContextChanged(u)){this.fragmentTracker.removeFragment(u);return}if(this.state=ae.PARSING,E){const T=E.tracks;if(T){const D=u.initSegment||u;if(this.unhandledEncryptionError(E,u))return;this._bufferInitSegment(d,T,D,o),n.trigger(L.FRAG_PARSING_INIT_SEGMENT,{frag:D,id:t,tracks:T})}const A=E.initPTS,_=E.timescale,w=this.initPTS[u.cc];if(ge(A)&&(!w||w.baseTime!==A||w.timescale!==_)){const D=E.trackId;this.initPTS[u.cc]={baseTime:A,timescale:_,trackId:D},n.trigger(L.INIT_PTS_FOUND,{frag:u,id:t,initPTS:A,timescale:_,trackId:D})}}if(m&&S){b&&m.type==="audiovideo"&&this.logMuxedErr(u);const T=S.fragments[u.sn-1-S.startSN],A=u.sn===S.startSN,_=!T||u.cc>T.cc;if(r.independent!==!1){const{startPTS:w,endPTS:D,startDTS:O,endDTS:B}=m;if(f)f.elementaryStreams[m.type]={startPTS:w,endPTS:D,startDTS:O,endDTS:B};else if(m.firstKeyFrame&&m.independent&&o.id===1&&!_&&(this.couldBacktrack=!0),m.dropped&&m.independent){const N=this.getMainFwdBufferInfo(),U=(N?N.end:this.getLoadPosition())+this.config.maxBufferHole,k=m.firstKeyFramePTS?m.firstKeyFramePTS:w;if(!A&&U<k-this.config.maxBufferHole&&!_){this.backtrack(u);return}else _&&(u.gap=!0);u.setElementaryStreamInfo(m.type,u.start,D,u.start,B,!0)}else A&&w-(S.appliedTimelineOffset||0)>mu&&(u.gap=!0);u.setElementaryStreamInfo(m.type,w,D,O,B),this.backtrackFragment&&(this.backtrackFragment=u),this.bufferFragmentData(m,u,f,o,A||_)}else if(A||_)u.gap=!0;else{this.backtrack(u);return}}if(b){const{startPTS:T,endPTS:A,startDTS:_,endDTS:w}=b;f&&(f.elementaryStreams[gt.AUDIO]={startPTS:T,endPTS:A,startDTS:_,endDTS:w}),u.setElementaryStreamInfo(gt.AUDIO,T,A,_,w),this.bufferFragmentData(b,u,f,o)}if(S&&p!=null&&p.samples.length){const T={id:t,frag:u,details:S,samples:p.samples};n.trigger(L.FRAG_PARSING_METADATA,T)}if(S&&g){const T={id:t,frag:u,details:S,samples:g.samples};n.trigger(L.FRAG_PARSING_USERDATA,T)}}logMuxedErr(e){this.warn(`${Pt(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,n,r){if(this.state!==ae.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(n));const{audio:o,video:l,audiovideo:u}=t;if(o){const d=e.audioCodec;let m=ou(o.codec,d);m==="mp4a"&&(m="mp4a.40.5");const g=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){m&&(m.indexOf("mp4a.40.5")!==-1?m="mp4a.40.2":m="mp4a.40.5");const p=o.metadata;p&&"channelCount"in p&&(p.channelCount||1)!==1&&g.indexOf("firefox")===-1&&(m="mp4a.40.5")}m&&m.indexOf("mp4a.40.5")!==-1&&g.indexOf("android")!==-1&&o.container!=="audio/mpeg"&&(m="mp4a.40.2",this.log(`Android: force audio codec to ${m}`)),d&&d!==m&&this.log(`Swapping manifest audio codec "${d}" for "${m}"`),o.levelCodec=m,o.id=pe.MAIN,this.log(`Init audio buffer, container:${o.container}, codecs[selected/level/parsed]=[${m||""}/${d||""}/${o.codec}]`),delete t.audiovideo}if(l){l.levelCodec=e.videoCodec,l.id=pe.MAIN;const d=l.codec;if(d?.length===4)switch(d){case"hvc1":case"hev1":l.codec="hvc1.1.6.L120.90";break;case"av01":l.codec="av01.0.04M.08";break;case"avc1":l.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${l.container}, codecs[level/parsed]=[${e.videoCodec||""}/${d}]${l.codec!==d?" parsed-corrected="+l.codec:""}${l.supplemental?" supplemental="+l.supplemental:""}`),delete t.audiovideo}u&&(this.log(`Init audiovideo buffer, container:${u.container}, codecs[level/parsed]=[${e.codecs}/${u.codec}]`),delete t.video,delete t.audio);const f=Object.keys(t);if(f.length){if(this.hls.trigger(L.BUFFER_CODECS,t),!this.hls)return;f.forEach(d=>{const g=t[d].initSegment;g!=null&&g.byteLength&&this.hls.trigger(L.BUFFER_APPENDING,{type:d,data:g,frag:n,part:null,chunkMeta:r,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,pe.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,n=e?.[t];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ae.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(Oe.isBuffered(e,n)?t=this.getAppendedFrag(n):Oe.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,o=t.level;(!r||t.sn!==r.sn||r.level!==o)&&(this.fragPlaying=t,this.hls.trigger(L.FRAG_CHANGED,{frag:t}),(!r||r.level!==o)&&this.hls.trigger(L.LEVEL_SWITCHED,{level:o}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return ge(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(ge(t)){const n=this.getLevelDetails(),r=this.currentFrag||(n?Nr(null,n.fragments,t):null);if(r){const o=r.programDateTime;if(o!==null){const l=o+(t-r.start)*1e3;return new Date(l)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class OB extends cs{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=X.KEY_LOAD_ERROR,n,r,o){return new ui({type:Te.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:o,error:n,networkDetails:r})}loadClear(e,t,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let r=0,o=t.length;r<o;r++){const l=t[r];if(e.cc<=l.cc&&(!Pt(e)||!Pt(l)||e.sn<l.sn)||!n&&r==o-1)return this.emeController.selectKeySystemFormat(l).then(u=>{if(!this.emeController)return;l.setKeyFormat(u);const f=cu(u);if(f)return this.emeController.getKeySystemAccess([f])})}if(this.config.requireKeySystemAccessOnStart){const r=Qo(this.config);if(r.length)return this.emeController.getKeySystemAccess(r)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);const o=e.decryptdata;if(!o){const d=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,d))}const l=o.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${l}"`)));const u=om(o);let f=this.keyIdToKeyInfo[u];if((n=f)!=null&&n.decryptdata.key)return o.key=f.decryptdata.key,Promise.resolve({frag:e,keyInfo:f});if(this.emeController&&(r=f)!=null&&r.keyLoadPromise)switch(this.emeController.getKeyStatus(f.decryptdata)){case"usable":case"usable-in-future":return f.keyLoadPromise.then(m=>{const{keyInfo:g}=m;return o.key=g.decryptdata.key,{frag:e,keyInfo:g}})}switch(this.log(`${this.keyIdToKeyInfo[u]?"Rel":"L"}oading${o.keyId?" keyId: "+on(o.keyId):""} URI: ${o.uri} from ${e.type} ${e.level}`),f=this.keyIdToKeyInfo[u]={decryptdata:o,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},o.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return o.keyFormat==="identity"?this.loadKeyHTTP(f,e):this.loadKeyEME(f,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(f,e);default:return Promise.reject(this.createKeyLoadError(e,X.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${o.method}"`)))}}loadKeyEME(e,t){const n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var r;if(!e.decryptdata.keyId&&(r=t.initSegment)!=null&&r.data){const l=Zk(t.initSegment.data);if(l.length){let u=l[0];u.some(f=>f!==0)?(this.log(`Using keyId found in init segment ${on(u)}`),Yi.setKeyIdForUri(e.decryptdata.uri,u)):(u=Yi.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${on(u)}`)),e.decryptdata.keyId=u}}if(!e.decryptdata.keyId&&!Pt(t))return Promise.resolve(n);const o=this.emeController.loadKey(n);return(e.keyLoadPromise=o.then(l=>(e.mediaKeySessionContext=l,n))).catch(l=>{throw e.keyLoadPromise=null,"data"in l&&(l.data.frag=t),l})}return Promise.resolve(n)}loadKeyHTTP(e,t){const n=this.config,r=n.loader,o=new r(n);return t.keyLoader=e.loader=o,e.keyLoadPromise=new Promise((l,u)=>{const f={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},d=n.keyLoadPolicy.default,m={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},g={onSuccess:(p,E,S,b)=>{const{frag:T,keyInfo:A}=S,_=om(A.decryptdata);if(!T.decryptdata||A!==this.keyIdToKeyInfo[_])return u(this.createKeyLoadError(T,X.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),b));A.decryptdata.key=T.decryptdata.key=new Uint8Array(p.data),T.keyLoader=null,A.loader=null,l({frag:T,keyInfo:A})},onError:(p,E,S,b)=>{this.resetLoader(E),u(this.createKeyLoadError(t,X.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),S,ot({url:f.url,data:void 0},p)))},onTimeout:(p,E,S)=>{this.resetLoader(E),u(this.createKeyLoadError(t,X.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),S))},onAbort:(p,E,S)=>{this.resetLoader(E),u(this.createKeyLoadError(t,X.INTERNAL_ABORTED,new Error("key loading aborted"),S))}};o.load(f,m,g)})}resetLoader(e){const{frag:t,keyInfo:n,url:r}=e,o=n.loader;t.keyLoader===o&&(t.keyLoader=null,n.loader=null);const l=om(n.decryptdata)||r;delete this.keyIdToKeyInfo[l],o&&o.destroy()}}function om(i){if(i.keyFormat!==ln.FAIRPLAY){const e=i.keyId;if(e)return on(e)}return i.uri}function ZE(i){const{type:e}=i;switch(e){case Ge.AUDIO_TRACK:return pe.AUDIO;case Ge.SUBTITLE_TRACK:return pe.SUBTITLE;default:return pe.MAIN}}function lm(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class MB{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(L.MANIFEST_LOADING,this.onManifestLoading,this),e.on(L.LEVEL_LOADING,this.onLevelLoading,this),e.on(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(L.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(L.MANIFEST_LOADING,this.onManifestLoading,this),e.off(L.LEVEL_LOADING,this.onLevelLoading,this),e.off(L.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(L.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(L.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,n=t.pLoader,r=t.loader,o=n||r,l=new o(t);return this.loaders[e.type]=l,l}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ge.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:n,level:r,pathwayId:o,url:l,deliveryDirectives:u,levelInfo:f}=t;this.load({id:n,level:r,pathwayId:o,responseType:"text",type:Ge.LEVEL,url:l,deliveryDirectives:u,levelOrTrack:f})}onAudioTrackLoading(e,t){const{id:n,groupId:r,url:o,deliveryDirectives:l,track:u}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Ge.AUDIO_TRACK,url:o,deliveryDirectives:l,levelOrTrack:u})}onSubtitleTrackLoading(e,t){const{id:n,groupId:r,url:o,deliveryDirectives:l,track:u}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:Ge.SUBTITLE_TRACK,url:o,deliveryDirectives:l,levelOrTrack:u})}onLevelsUpdated(e,t){const n=this.loaders[Ge.LEVEL];if(n){const r=n.context;r&&!t.levels.some(o=>o===r.levelOrTrack)&&(n.abort(),delete this.loaders[Ge.LEVEL])}}load(e){var t;const n=this.hls.config;let r=this.getInternalLoader(e);if(r){const d=this.hls.logger,m=r.context;if(m&&m.levelOrTrack===e.levelOrTrack&&(m.url===e.url||m.deliveryDirectives&&!e.deliveryDirectives)){m.url===e.url?d.log(`[playlist-loader]: ignore ${e.url} ongoing request`):d.log(`[playlist-loader]: ignore ${e.url} in favor of ${m.url}`);return}d.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let o;if(e.type===Ge.MANIFEST?o=n.manifestLoadPolicy.default:o=ht({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),ge((t=e.deliveryDirectives)==null?void 0:t.part)){let d;if(e.type===Ge.LEVEL&&e.level!==null?d=this.hls.levels[e.level].details:e.type===Ge.AUDIO_TRACK&&e.id!==null?d=this.hls.audioTracks[e.id].details:e.type===Ge.SUBTITLE_TRACK&&e.id!==null&&(d=this.hls.subtitleTracks[e.id].details),d){const m=d.partTarget,g=d.targetduration;if(m&&g){const p=Math.max(m*3,g*.8)*1e3;o=ht({},o,{maxTimeToFirstByteMs:Math.min(p,o.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,o.maxTimeToFirstByteMs)})}}}const l=o.errorRetry||o.timeoutRetry||{},u={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},f={onSuccess:(d,m,g,p)=>{const E=this.getInternalLoader(g);this.resetInternalLoader(g.type);const S=d.data;m.parsing.start=performance.now(),ks.isMediaPlaylist(S)||g.type!==Ge.MANIFEST?this.handleTrackOrLevelPlaylist(d,m,g,p||null,E):this.handleMasterPlaylist(d,m,g,p)},onError:(d,m,g,p)=>{this.handleNetworkError(m,g,!1,d,p)},onTimeout:(d,m,g)=>{this.handleNetworkError(m,g,!0,void 0,d)}};r.load(e,u,f)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,n,r){const o=this.hls,l=e.data,u=lm(e,n),f=ks.parseMasterPlaylist(l,u);if(f.playlistParsingError){t.parsing.end=performance.now(),this.handleManifestParsingError(e,n,f.playlistParsingError,r,t);return}const{contentSteering:d,levels:m,sessionData:g,sessionKeys:p,startTimeOffset:E,variableList:S}=f;this.variableList=S,m.forEach(_=>{const{unknownCodecs:w}=_;if(w){const{preferManagedMediaSource:D}=this.hls.config;let{audioCodec:O,videoCodec:B}=_;for(let N=w.length;N--;){const U=w[N];rl(U,"audio",D)?(_.audioCodec=O=O?`${O},${U}`:U,Va.audio[O.substring(0,4)]=2,w.splice(N,1)):rl(U,"video",D)&&(_.videoCodec=B=B?`${B},${U}`:U,Va.video[B.substring(0,4)]=2,w.splice(N,1))}}});const{AUDIO:b=[],SUBTITLES:T,"CLOSED-CAPTIONS":A}=ks.parseMasterPlaylistMedia(l,u,f);b.length&&!b.some(w=>!w.url)&&m[0].audioCodec&&!m[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new At({}),bitrate:0,url:""})),o.trigger(L.MANIFEST_LOADED,{levels:m,audioTracks:b,subtitles:T,captions:A,contentSteering:d,url:u,stats:t,networkDetails:r,sessionData:g,sessionKeys:p,startTimeOffset:E,variableList:S})}handleTrackOrLevelPlaylist(e,t,n,r,o){const l=this.hls,{id:u,level:f,type:d}=n,m=lm(e,n),g=ge(f)?f:ge(u)?u:0,p=ZE(n),E=ks.parseLevelPlaylist(e.data,m,g,p,0,this.variableList);if(d===Ge.MANIFEST){const S={attrs:new At({}),bitrate:0,details:E,name:"",url:m};E.requestScheduled=t.loading.start+SA(E,0),l.trigger(L.MANIFEST_LOADED,{levels:[S],audioTracks:[],url:m,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=E,this.handlePlaylistLoaded(E,e,t,n,r,o)}handleManifestParsingError(e,t,n,r,o){this.hls.trigger(L.ERROR,{type:Te.NETWORK_ERROR,details:X.MANIFEST_PARSING_ERROR,fatal:t.type===Ge.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:o})}handleNetworkError(e,t,n=!1,r,o){let l=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===Ge.LEVEL?l+=`: ${e.level} id: ${e.id}`:(e.type===Ge.AUDIO_TRACK||e.type===Ge.SUBTITLE_TRACK)&&(l+=` id: ${e.id} group-id: "${e.groupId}"`);const u=new Error(l);this.hls.logger.warn(`[playlist-loader]: ${l}`);let f=X.UNKNOWN,d=!1;const m=this.getInternalLoader(e);switch(e.type){case Ge.MANIFEST:f=n?X.MANIFEST_LOAD_TIMEOUT:X.MANIFEST_LOAD_ERROR,d=!0;break;case Ge.LEVEL:f=n?X.LEVEL_LOAD_TIMEOUT:X.LEVEL_LOAD_ERROR,d=!1;break;case Ge.AUDIO_TRACK:f=n?X.AUDIO_TRACK_LOAD_TIMEOUT:X.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Ge.SUBTITLE_TRACK:f=n?X.SUBTITLE_TRACK_LOAD_TIMEOUT:X.SUBTITLE_LOAD_ERROR,d=!1;break}m&&this.resetInternalLoader(e.type);const g={type:Te.NETWORK_ERROR,details:f,fatal:d,url:e.url,loader:m,context:e,error:u,networkDetails:t,stats:o};if(r){const p=t?.url||e.url;g.response=ot({url:p,data:void 0},r)}this.hls.trigger(L.ERROR,g)}handlePlaylistLoaded(e,t,n,r,o,l){const u=this.hls,{type:f,level:d,levelOrTrack:m,id:g,groupId:p,deliveryDirectives:E}=r,S=lm(t,r),b=ZE(r);let T=typeof r.level=="number"&&b===pe.MAIN?d:void 0;const A=e.playlistParsingError;if(A){if(this.hls.logger.warn(`${A} ${e.url}`),!u.config.ignorePlaylistParsingErrors){u.trigger(L.ERROR,{type:Te.NETWORK_ERROR,details:X.LEVEL_PARSING_ERROR,fatal:!1,url:S,error:A,reason:A.message,response:t,context:r,level:T,parent:b,networkDetails:o,stats:n});return}e.playlistParsingError=null}if(!e.fragments.length){const _=e.playlistParsingError=new Error("No Segments found in Playlist");u.trigger(L.ERROR,{type:Te.NETWORK_ERROR,details:X.LEVEL_EMPTY_ERROR,fatal:!1,url:S,error:_,reason:_.message,response:t,context:r,level:T,parent:b,networkDetails:o,stats:n});return}switch(e.live&&l&&(l.getCacheAge&&(e.ageHeader=l.getCacheAge()||0),(!l.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),f){case Ge.MANIFEST:case Ge.LEVEL:if(T){if(!m)T=0;else if(m!==u.levels[T]){const _=u.levels.indexOf(m);_>-1&&(T=_)}}u.trigger(L.LEVEL_LOADED,{details:e,levelInfo:m||u.levels[0],level:T||0,id:g||0,stats:n,networkDetails:o,deliveryDirectives:E,withoutMultiVariant:f===Ge.MANIFEST});break;case Ge.AUDIO_TRACK:u.trigger(L.AUDIO_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:p||"",stats:n,networkDetails:o,deliveryDirectives:E});break;case Ge.SUBTITLE_TRACK:u.trigger(L.SUBTITLE_TRACK_LOADED,{details:e,track:m,id:g||0,groupId:p||"",stats:n,networkDetails:o,deliveryDirectives:E});break}}}class ys{static get version(){return ll}static isMSESupported(){return E1()}static isSupported(){return wB()}static getMediaSource(){return Qi()}static get Events(){return L}static get MetadataSchema(){return Hn}static get ErrorTypes(){return Te}static get ErrorDetails(){return X}static get DefaultConfig(){return ys.defaultConfig?ys.defaultConfig:vB}static set DefaultConfig(e){ys.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Mg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=jk(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=xB(ys.DefaultConfig,e,t);this.userConfig=e,n.progressive&&EB(n,t);const{abrController:r,bufferController:o,capLevelController:l,errorController:u,fpsController:f}=n,d=new u(this),m=this.abrController=new r(this),g=new kP(this),p=n.interstitialsController,E=p?this.interstitialsController=new p(this,ys):null,S=this.bufferController=new o(this,g),b=this.capLevelController=new l(this),T=new f(this),A=new MB(this),_=n.contentSteeringController,w=_?new _(this):null,D=this.levelController=new _B(this,w),O=new CB(this),B=new OB(this.config,this.logger),N=this.streamController=new NB(this,g,B),U=this.gapController=new AB(this,g);b.setStreamController(N),T.setStreamController(N);const k=[A,D,N];E&&k.splice(1,0,E),w&&k.splice(1,0,w),this.networkControllers=k;const F=[m,S,U,b,T,O,g];this.audioTrackController=this.createController(n.audioTrackController,k);const H=n.audioStreamController;H&&k.push(this.audioStreamController=new H(this,g,B)),this.subtitleTrackController=this.createController(n.subtitleTrackController,k);const ne=n.subtitleStreamController;ne&&k.push(this.subtititleStreamController=new ne(this,g,B)),this.createController(n.timelineController,F),B.emeController=this.emeController=this.createController(n.emeController,F),this.cmcdController=this.createController(n.cmcdController,F),this.latencyController=this.createController(LB,F),this.coreComponents=F,k.push(d);const J=d.onErrorOut;typeof J=="function"&&this.on(L.ERROR,J,d),this.on(L.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(e,t){if(e){const n=new e(this);return t&&t.push(n),n}return null}on(e,t,n=this){this._emitter.on(e,t,n)}once(e,t,n=this){this._emitter.once(e,t,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,n=this,r){this._emitter.off(e,t,n,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,n){return this._emitter.emit(e,t,n)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const r=e===L.ERROR;this.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.INTERNAL_EXCEPTION,fatal:r,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(L.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const o=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(L.ERROR,{type:Te.OTHER_ERROR,details:X.ATTACH_MEDIA_ERROR,fatal:!0,error:o});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,n=t?e.media:e,r=t?e:{media:n};this._media=n,this.trigger(L.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(L.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(L.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,n=this._url,r=this._url=Tg.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),t&&n&&(n!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(L.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,t),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[pe.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[pe.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[pe.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=AF()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){xP(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const n=e.length;for(let r=0;r<n;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:n}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,n)for(let o=r;o--;){const l=e[o].attrs["HDCP-LEVEL"];if(l&&l<=n)return o}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const n=aA(t);return iA(e,n,navigator.mediaCapabilities)}}ys.defaultConfig=void 0;function kB({courseTitle:i,courseId:e,children:t}){const[n,r]=R.useState(!1),[o,l]=R.useState(!1),[u,f]=R.useState(0),[d,m]=R.useState(100),[g,p]=R.useState(0),[E,S]=R.useState(0),[b,T]=R.useState(0),[A,_]=R.useState(null),[w,D]=R.useState([]),[O,B]=R.useState(!1),[N,U]=R.useState(null),[k,F]=R.useState(!1),[H,ne]=R.useState(null),J=R.useRef(null),le=R.useRef(null),de=()=>{const V=J.current;if(!V)return;const se=document.createElement("canvas");se.width=V.videoWidth||1280,se.height=V.videoHeight||720;const ce=se.getContext("2d");V.currentTime=2;const fe=()=>{V.readyState>=2?(ce.drawImage(V,0,0,se.width,se.height),_(se.toDataURL()),V.currentTime=0):setTimeout(fe,100)};setTimeout(fe,500)},P=(V,se)=>{const ce=document.createElement("canvas");ce.width=320,ce.height=180;const fe=ce.getContext("2d"),ve=fe.createLinearGradient(0,0,320,180);ve.addColorStop(0,"#059669"),ve.addColorStop(1,"#047857"),fe.fillStyle=ve,fe.fillRect(0,0,320,180),fe.fillStyle="white",fe.font="bold 24px sans-serif",fe.textAlign="center",fe.textBaseline="middle";const Ae=280,Qe=V.split(" ");let Ze="",Lt=90;for(let Tt=0;Tt<Qe.length;Tt++){const Se=Ze+Qe[Tt]+" ";fe.measureText(Se).width>Ae&&Tt>0?(fe.fillText(Ze,160,Lt),Ze=Qe[Tt]+" ",Lt+=30):Ze=Se}return fe.fillText(Ze,160,Lt),ce.toDataURL()},K=[{id:"l1",title:"Introduo ao Curso",duration:"12:45",description:"Conceitos fundamentais e estrutura do curso",thumbnail:P("Introduo ao Curso")},{id:"l2",title:"Configurao do Ambiente",duration:"18:30",description:"Setup das ferramentas e ambiente de desenvolvimento",thumbnail:P("Configurao do Ambiente")},{id:"l3",title:"Primeiros Passos Prticos",duration:"25:15",description:"Exerccios prticos iniciais",thumbnail:P("Primeiros Passos Prticos")},{id:"l4",title:"Tcnicas Avanadas",duration:"32:20",description:"Conceitos avanados e aplicaes",thumbnail:P("Tcnicas Avanadas")}];R.useEffect(()=>{n&&e&&(async()=>{try{B(!0),U(null);const fe=((await Du.getLessonsByCourse(e))?.Result?.lessons||[]).map(ve=>({id:`l${ve.id}`,title:ve.title,duration:ve.duration,description:ve.description||"Aula prtica do curso",thumbnail:`https://images.unsplash.com/photo-${Math.floor(Math.random()*1e9)}?w=800&h=450&fit=crop`}));D(fe)}catch(se){console.error("Erro ao buscar aulas:",se),U(se.message),D([])}finally{B(!1)}})()},[n,e]);const j=w.length>0?w:K;R.useEffect(()=>{if(n&&j[u]){const V=j[u].id;console.log("Tentando carregar aula com ID:",V),W(V)}return()=>{le.current&&(le.current.destroy(),le.current=null),J.current&&(J.current.src="")}},[n,u,j]);const W=async V=>{if(J.current)try{F(!0),ne(null),le.current&&(le.current.destroy(),le.current=null);const se=await Du.getSignedUrl(V);console.log("Resposta da API (M3U8):",se);const ce=se;if(!ce)throw new Error("Resposta vazia da API");if(ce.includes("StatusCode"))try{const Ae=JSON.parse(ce);if(Ae.StatusCode===500){ne(`Aula no encontrada: ${Ae.StatusMessage}`),F(!1);return}}catch{}if(!ce.includes("#EXTM3U"))throw new Error("Resposta no contm playlist M3U8 vlido");const fe=new Blob([ce],{type:"application/vnd.apple.mpegurl"}),ve=URL.createObjectURL(fe);if(ys.isSupported()){const Ae=new ys({enableWorker:!0,lowLatencyMode:!0,backBufferLength:90,maxBufferLength:30,maxMaxBufferLength:600,liveSyncDurationCount:3,preferManagedMediaSource:!0});return le.current=Ae,Ae.loadSource(ve),Ae.attachMedia(J.current),Ae.on(ys.Events.MANIFEST_PARSED,()=>{console.log("Playlist M3U8 carregado com sucesso")}),Ae.on(ys.Events.ERROR,(Qe,Ze)=>{console.error("Erro HLS.js:",Ze),Ze.fatal&&ne("Erro ao carregar o vdeo")}),()=>{URL.revokeObjectURL(ve)}}else if(J.current.canPlayType("application/vnd.apple.mpegurl"))J.current.src=ve;else throw new Error("HLS no suportado neste navegador")}catch(se){console.error("Erro ao carregar vdeo:",se),ne("Erro ao carregar o vdeo. Usando contedo de demonstrao.")}finally{F(!1)}},he=async()=>{if(J.current)try{o?J.current.pause():await J.current.play(),l(!o)}catch(V){console.error("Erro ao reproduzir/pausar:",V),V.name!=="AbortError"&&ne("Erro ao reproduzir o vdeo")}},M=V=>{f(V),l(!1),ne(null),p(0),T(0),_(null)},G=V=>{const se=V.target.value;if(p(se),J.current&&J.current.duration){const ce=se/100*J.current.duration;J.current.currentTime=ce,T(ce)}},te=V=>{if(!V||isNaN(V))return"0:00";const se=Math.floor(V/60),ce=Math.floor(V%60);return`${se}:${ce.toString().padStart(2,"0")}`};return R.useEffect(()=>{J.current&&(J.current.volume=d/100)},[d,J.current]),R.useEffect(()=>{const V=J.current;if(!V)return;const se=()=>{T(V.currentTime),S(V.duration||0),p(V.duration?V.currentTime/V.duration*100:0)},ce=()=>{se()};return V.addEventListener("timeupdate",se),V.addEventListener("loadedmetadata",ce),V.addEventListener("seeked",se),()=>{V.removeEventListener("timeupdate",se),V.removeEventListener("loadedmetadata",ce),V.removeEventListener("seeked",se)}},[J.current]),y.jsxs(Cn,{open:n,onOpenChange:r,children:[y.jsx(er,{asChild:!0,children:t}),y.jsx(Ln,{showCloseButton:!1,className:"bg-neutral-950 border-neutral-800 text-white max-w-[98vw]! w-[98vw]! h-[95dvh]! max-h-[95dvh]! overflow-hidden p-0! sm:max-w-none! sm:h-[95vh]! sm:max-h-[95vh]!",children:y.jsxs("div",{className:"flex flex-col h-full",children:[y.jsxs(_n,{className:"px-4 py-3 sm:px-6 sm:py-4 border-b border-neutral-800 relative",children:[y.jsx(Ce,{onClick:()=>r(!1),className:"absolute right-2 top-2 sm:right-4 sm:top-4 text-white hover:bg-white/20 rounded-full p-2 h-8 w-8 sm:h-10 sm:w-10",variant:"ghost",size:"icon",children:y.jsx(Vu,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),y.jsx(wn,{className:"text-lg sm:text-xl font-bold text-white pr-12 sm:pr-16",children:i}),y.jsx(Dn,{className:"text-neutral-400 hidden sm:block",children:"Aulas prticas e exemplos reais"})]}),y.jsxs("div",{className:"flex flex-1 overflow-hidden flex-col sm:flex-row",children:[y.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[y.jsxs("div",{className:"relative bg-black flex items-center justify-center w-full aspect-video overflow-hidden sm:aspect-auto sm:flex-1 sm:min-h-0",children:[y.jsx("div",{className:"absolute inset-0 bg-linear-to-b from-transparent via-transparent to-black/50 z-10"}),y.jsx("video",{ref:J,className:"absolute inset-0 z-0 w-full h-full object-contain",controls:!1,playsInline:!0,onPlay:()=>{l(!0),_(null)},onPause:()=>l(!1),onLoadedMetadata:()=>{A||de()},poster:A}),!o&&A&&!k&&!H&&y.jsxs("div",{className:"absolute inset-0 z-10",children:[y.jsx("img",{src:A,alt:"Video poster",className:"w-full h-full object-contain"}),y.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center",children:y.jsx("button",{onClick:he,className:"bg-green-600 hover:bg-green-500 rounded-full p-6 transition-all duration-200 transform hover:scale-110 shadow-2xl backdrop-blur-sm border-2 border-white/20",children:y.jsx(su,{className:"h-12 w-12 text-white ml-1"})})})]}),k&&y.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center z-30",children:y.jsxs("div",{className:"text-center",children:[y.jsx(Y_,{className:"h-8 w-8 animate-spin text-white mx-auto mb-2"}),y.jsx("p",{className:"text-white text-sm",children:"Carregando vdeo..."})]})}),H&&y.jsx("div",{className:"absolute inset-0 bg-black/80 flex items-center justify-center z-30",children:y.jsxs("div",{className:"text-center p-4",children:[y.jsx("p",{className:"text-red-400 text-sm mb-2",children:H}),y.jsx(Ce,{variant:"outline",size:"sm",onClick:()=>W(j[u].id),className:"text-white border-white/20 hover:bg-white/10",children:"Tentar novamente"})]})}),!k&&!H&&!A&&y.jsx("button",{onClick:he,className:"absolute z-20 bg-white/20 backdrop-blur-sm rounded-full p-3 sm:p-4 hover:bg-white/30 transition-colors",children:o?y.jsx(Rh,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white"}):y.jsx(su,{className:"h-6 w-6 sm:h-8 sm:w-8 text-white ml-1"})}),y.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-linear-to-t from-black/80 to-transparent p-3 sm:p-4 z-20",children:[y.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[y.jsx(Ce,{variant:"ghost",size:"icon",onClick:he,disabled:k||!!H,className:"text-white hover:bg-white/20 disabled:opacity-50",children:o?y.jsx(Rh,{className:"h-5 w-5"}):y.jsx(su,{className:"h-5 w-5"})}),y.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[y.jsx(_w,{className:"h-4 w-4 text-white"}),y.jsx("input",{type:"range",min:"0",max:"100",value:d,onChange:V=>{const se=V.target.value;m(se),J.current&&(J.current.volume=se/100)},className:"w-16 sm:w-24 h-1 bg-neutral-600 rounded-lg appearance-none cursor-pointer slider-volume",style:{background:`linear-gradient(to right, #10b981 0%, #10b981 ${d}%, #4b5563 ${d}%, #4b5563 100%)`}})]}),y.jsx("span",{className:"text-white text-xs min-w-[40px]",children:te(b)}),y.jsx(Ce,{variant:"ghost",size:"icon",onClick:()=>{J.current&&J.current.requestFullscreen&&J.current.requestFullscreen()},className:"text-white hover:bg-white/20",children:y.jsx(sw,{className:"h-5 w-5"})})]}),y.jsxs("div",{className:"mt-3",children:[y.jsx("input",{type:"range",min:"0",max:"100",value:g,onChange:G,className:"w-full h-1 bg-neutral-600 rounded-lg appearance-none cursor-pointer slider-progress",style:{background:`linear-gradient(to right, #10b981 0%, #10b981 ${g}%, #4b5563 ${g}%, #4b5563 100%)`}}),y.jsxs("div",{className:"flex justify-between mt-1",children:[y.jsx("span",{className:"text-xs text-neutral-400",children:te(b)}),y.jsx("span",{className:"text-xs text-neutral-400",children:te(E)})]})]})]})]}),y.jsxs("div",{className:"p-3 sm:p-4 border-t border-neutral-800",children:[y.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white mb-2",children:j[u].title}),y.jsx("p",{className:"text-neutral-400 text-sm",children:j[u].description})]})]}),y.jsxs("div",{className:"w-full sm:w-80 max-h-[40dvh] sm:max-h-none border-t sm:border-t-0 sm:border-l border-neutral-800 flex flex-col min-h-0 overflow-hidden",children:[y.jsxs("div",{className:"p-3 sm:p-4 border-b border-neutral-800",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(kS,{className:"h-5 w-5 text-green-400"}),y.jsx("h3",{className:"font-semibold text-white",children:"Aulas do Curso"})]}),y.jsxs("p",{className:"text-sm text-neutral-400 mt-1",children:[j.length," aulas  ",j.reduce((V,se)=>{const[ce,fe]=se.duration.split(":").map(Number);return V+ce+fe/60},0).toFixed(0),"min total"]})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto",children:[O&&y.jsx("div",{className:"p-4 text-center text-neutral-400",children:"Carregando aulas..."}),N&&y.jsx("div",{className:"p-4 text-center text-red-400",children:"Erro ao carregar aulas. Exibindo contedo de demonstrao."}),!O&&!N&&j.map((V,se)=>y.jsx("div",{onClick:()=>M(se),className:`p-3 sm:p-4 border-b border-neutral-800 cursor-pointer transition-colors ${u===se?"bg-neutral-800":"hover:bg-neutral-900"}`,children:y.jsxs("div",{className:"flex gap-3",children:[y.jsxs("div",{className:"relative shrink-0 w-16 h-10 sm:w-20 sm:h-12 rounded overflow-hidden",children:[y.jsx("img",{src:V.thumbnail||P(V.title),alt:V.title,className:"w-full h-full object-cover",onError:ce=>{ce.target.src=P(V.title)}}),u===se&&o&&y.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:y.jsx(Rh,{className:"h-4 w-4 text-white"})})]}),y.jsxs("div",{className:"flex-1 min-w-0",children:[y.jsx("h4",{className:"font-medium text-white text-sm truncate",children:V.title}),y.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[y.jsx(Eu,{className:"h-3 w-3 text-neutral-400"}),y.jsx("span",{className:"text-xs text-neutral-400",children:V.duration})]})]})]})},V.id))]}),y.jsx("div",{className:"p-3 sm:p-4 border-t border-neutral-800",children:y.jsxs(Ce,{variant:"ghost",className:"w-full border border-green-600/30 text-green-400 bg-neutral-900/50 hover:bg-green-600/10 hover:text-green-300",children:[y.jsx(fl,{className:"h-4 w-4 mr-2"}),"Recursos do Curso"]})})]})]})]})})]})}function PB(){const[i,e]=R.useState([]),[t,n]=R.useState(!0),[r,o]=R.useState(null),[l,u]=R.useState(""),[f,d]=R.useState({}),[m,g]=R.useState({});R.useEffect(()=>{(async()=>{try{n(!0);const w=(await Du.getCategories())?.Result?.categories||[];e(w),w.length>0&&u(w[0].name),o(null)}catch(_){o(_.message),console.error("Erro ao buscar categorias:",_),e([])}finally{n(!1)}})()},[]);const p=async A=>{if(!f[A])try{g(D=>({...D,[A]:!0}));const w=(await Du.getCoursesByCategory(A))?.Result?.courses||[];d(D=>({...D,[A]:w}))}catch(_){console.error("Erro ao buscar cursos:",_)}finally{g(_=>({..._,[A]:!1}))}};R.useEffect(()=>{const A=i.find(_=>_.name===l);A&&p(A.id)},[l,i]);const E=R.useMemo(()=>{const A=i.find(_=>_.name===l);return A?f[A.id]||[]:[]},[l,i,f]),S=R.useMemo(()=>[{categoria:"Engenharia Reversa",items:["Anlise de Binrios","Decompilao","Debugging","Cracking de Software"]},{categoria:"Game Hacking",items:["Memory Hacking (Cheat Engine)","Hooking (WinAPI / DirectX)","Pattern Scanning & Signatures","Anti-Cheat: Fundamentos & Deteco"]},{categoria:"Atualizaes",items:["Novos cursos toda semana","Mdulos revisados e atualizados","Contedo alinhado ao cenrio atual","Roadmap pblico + comunidade ativa"]}],[]),b=t||r?S:i.map(A=>({categoria:A.name,id:A.id})),T=t||r?S.find(A=>A.categoria===l)?.items||[]:E;return y.jsxs(is,{"data-cursos-card":!0,className:"bg-neutral-950 border-neutral-800 text-white shadow-2xl",children:[y.jsxs(wr,{className:"space-y-2",children:[y.jsx(Dr,{className:"text-2xl sm:text-3xl font-bold text-white",children:"Cursos"}),y.jsx(Tb,{className:"text-neutral-300",children:"Selecione uma categoria para ver os cursos disponveis."})]}),y.jsxs(vs,{className:"space-y-6",children:[y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsx(wk,{className:"bg-neutral-950 border-neutral-800 shadow-none w-full overflow-x-auto overflow-y-visible h-16 sm:h-12",children:b.map(A=>y.jsx(Dk,{children:y.jsx(Ik,{onClick:()=>u(A.categoria),className:l===A.categoria?"bg-neutral-800 text-white":"text-neutral-300 hover:bg-neutral-900",children:A.categoria})},A.categoria||A.id))}),y.jsxs("div",{className:"flex items-center justify-between gap-3",children:[y.jsxs("div",{className:"flex items-center gap-2 text-neutral-300",children:[y.jsx(fl,{className:"h-4 w-4 text-green-400"}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("span",{className:"text-sm font-medium",children:l}),(()=>{const A=i.find(_=>_.name===l);return A?.description?y.jsx("span",{className:"text-xs text-neutral-400",children:A.description}):null})()]})]}),y.jsxs("span",{className:"text-xs text-neutral-400",children:[T.length," itens"]})]})]}),t&&y.jsx("div",{className:"text-center text-neutral-400 py-8",children:"Carregando categorias..."}),r&&y.jsx("div",{className:"text-center text-red-400 py-8",children:"Erro ao carregar categorias. Exibindo contedo de demonstrao."}),!t&&!r&&T.length===0&&y.jsx("div",{className:"text-center text-neutral-400 py-8",children:"Nenhum curso encontrado nesta categoria."}),y.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(A=>{const _=typeof A=="string"?A:A.title,w=typeof A=="string"?null:A.description,D=typeof A=="string"?null:A.id;return y.jsx(kB,{courseTitle:_,courseId:D,children:y.jsx("div",{className:"rounded-lg border border-neutral-800 bg-neutral-900/50 p-4 hover:bg-neutral-900 transition-colors cursor-pointer group",children:y.jsxs("div",{className:"flex items-start justify-between gap-3",children:[y.jsxs("div",{className:"space-y-1",children:[y.jsx("div",{className:"font-semibold text-white group-hover:text-green-400 transition-colors",children:_}),y.jsx("div",{className:"text-sm text-neutral-400",children:w||"Aulas prticas, exemplos reais e desafios."})]}),y.jsxs("div",{className:"shrink-0 rounded-md border border-green-600/30 bg-green-600/10 px-2 py-1 text-xs text-green-300 flex items-center gap-1",children:[y.jsx(su,{className:"h-3 w-3"}),l==="Atualizaes"?"Novo":"Curso"]})]})})},_)})})]})]})}function UB(){return y.jsxs(is,{className:"bg-neutral-950 border-neutral-800 text-white shadow-2xl",children:[y.jsx(wr,{children:y.jsx(Dr,{className:"text-2xl sm:text-3xl font-bold text-white",children:"Contato"})}),y.jsx(vs,{className:"space-y-6",children:y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-white",children:"Entre em contato"}),y.jsxs("div",{className:"space-y-3",children:[y.jsxs("div",{className:"flex items-center gap-3 text-neutral-300",children:[y.jsx(J_,{className:"h-5 w-5 text-green-400"}),y.jsx("span",{children:"contato@ring0x.com"})]}),y.jsxs("div",{className:"flex items-center gap-3 text-neutral-300",children:[y.jsx(uw,{className:"h-5 w-5 text-green-400"}),y.jsx("span",{children:"+55 (11) 9999-9999"})]}),y.jsxs("div",{className:"flex items-center gap-3 text-neutral-300",children:[y.jsx(tw,{className:"h-5 w-5 text-green-400"}),y.jsx("span",{children:"So Paulo, Brasil"})]})]})]}),y.jsxs("div",{className:"space-y-4",children:[y.jsx("h3",{className:"text-lg font-semibold text-white",children:"Redes sociais"}),y.jsxs("div",{className:"flex gap-3",children:[y.jsx(Ce,{variant:"outline",size:"sm",className:"border-gray-600 bg-gray-900 text-gray-100 hover:bg-gray-800 hover:text-white hover:border-gray-500",asChild:!0,children:y.jsx("a",{href:"https://github.com/RuanCardoso",target:"_blank",rel:"noopener noreferrer",children:y.jsx(F_,{className:"h-4 w-4"})})}),y.jsx(Ce,{variant:"outline",size:"sm",className:"border-blue-600 bg-blue-950 text-blue-300 hover:bg-blue-800 hover:text-white hover:border-blue-500",asChild:!0,children:y.jsx("a",{href:"https://www.linkedin.com/in/ruan-cardoso-dev/",target:"_blank",rel:"noopener noreferrer",children:y.jsx(H_,{className:"h-4 w-4"})})}),y.jsx(Ce,{variant:"outline",size:"sm",className:"border-indigo-600 bg-indigo-950 text-indigo-300 hover:bg-indigo-800 hover:text-white hover:border-indigo-500",asChild:!0,children:y.jsx("a",{href:"https://discord.gg/Xn2GrhwRz8",target:"_blank",rel:"noopener noreferrer",children:y.jsx(ow,{className:"h-4 w-4"})})})]})]})]})})]})}function FB(){return y.jsxs("div",{className:"w-full px-4 sm:px-8 lg:px-16 pt-0 space-y-6",children:[y.jsx(is,{className:"bg-neutral-950 border-neutral-800 text-white shadow-2xl",children:y.jsxs(vs,{className:"space-y-10",children:[y.jsx(pN,{}),y.jsx(vN,{}),y.jsx(yN,{})]})}),y.jsx(xN,{}),y.jsx(PB,{}),y.jsx(UB,{}),y.jsx("div",{className:"h-8"})]})}function BB(){const[i,e]=R.useState(!1),t=jb();return R.useEffect(()=>{if(!t)return;const n=()=>{i&&e(!1)};let r=0;const o=u=>{r=u.touches[0].clientY},l=u=>{if(!i)return;const f=u.touches[0].clientY;Math.abs(f-r)>10&&e(!1)};return document.addEventListener("scroll",n,{passive:!0}),document.addEventListener("touchstart",o,{passive:!0}),document.addEventListener("touchmove",l,{passive:!0}),()=>{document.removeEventListener("scroll",n),document.removeEventListener("touchstart",o),document.removeEventListener("touchmove",l)}},[i,t]),y.jsxs("div",{className:"flex h-dvh",children:[y.jsx(gN,{isOpen:i,setIsOpen:e}),y.jsxs("main",{className:"relative flex-1 overflow-y-auto overflow-x-hidden bg-linear-to-br from-black via-neutral-950 to-neutral-950 text-white scrollbar-hide",children:[y.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[y.jsx("div",{className:"absolute -top-40 -left-40 h-112 w-md rounded-full bg-white/3 blur-3xl"}),y.jsx("div",{className:"absolute -top-32 -right-40 h-104 w-104 rounded-full bg-violet-500/6 blur-3xl"}),y.jsx("div",{className:"absolute -bottom-40 left-1/3 h-120 w-120 rounded-full bg-amber-400/4 blur-3xl"})]}),y.jsx("div",{className:"relative z-10 flex items-center gap-4 px-4 pt-4",children:y.jsx(Ce,{variant:"ghost",size:"lg",onClick:()=>e(!i),className:"lg:hidden text-white hover:bg-neutral-800",children:y.jsx(rw,{className:"h-6 w-6"})})}),y.jsx("div",{className:"relative z-10",children:y.jsx(FB,{})})]})]})}$C.createRoot(document.getElementById("root")).render(y.jsx(R.StrictMode,{children:y.jsx(BB,{})}));
